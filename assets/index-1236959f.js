(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const FT=[{name:"Admin",password:"e73589d79cd25a65ddb5e4aa4d566034"}],zm=[{name:"ББ",number:18,gosb:[8586,8600,8601,8603]},{name:"ВВБ",number:42,gosb:[6984,8589,8610,8611,8612,8613,8614,8618,9042]},{name:"ДВБ",number:70,gosb:[4157,8556,8567,8635,8636,8645,9070]},{name:"МБ",number:38,gosb:[9038]},{name:"ПБ",number:54,gosb:[6991,8588,8621,8622,8623,8624,8625]},{name:"СЗБ",number:55,gosb:[8617,8626,8627,8628,8629,8630,8637,8638,9055]},{name:"СБ",number:44,gosb:[8047,8558,8591,8602,8615,8616,8634,8644,8646]},{name:"СРБ",number:40,gosb:[17,8604,8605,8606,8607,8608,8609,8639,8640,9040]},{name:"УБ",number:16,gosb:[5940,7003,8369,8597,8598,8599,8647]},{name:"ЦЧБ",number:13,gosb:[8592,8593,8594,8595,8596,9013]},{name:"ЮЗБ",number:52,gosb:[1806,5221,5230,8579,8585,8590,8619,8620,8631,8632,8633,8643]}],Jf=[];var ut=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Td(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function RT(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function i(){if(this instanceof i){var n=[null];n.push.apply(n,arguments);var s=Function.bind.apply(e,n);return new s}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),t}var Um={exports:{}};function IT(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ef={exports:{}};const BT={},NT=Object.freeze(Object.defineProperty({__proto__:null,default:BT},Symbol.toStringTag,{value:"Module"})),HT=RT(NT);var Hg;function Ft(){return Hg||(Hg=1,function(r,e){(function(t,i){r.exports=i()})(ut,function(){var t=t||function(i,n){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof ut<"u"&&ut.crypto&&(s=ut.crypto),!s&&typeof IT=="function")try{s=HT}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},l=Object.create||function(){function E(){}return function(k){var C;return E.prototype=k,C=new E,E.prototype=null,C}}(),h={},c=h.lib={},p=c.Base=function(){return{extend:function(E){var k=l(this);return E&&k.mixIn(E),(!k.hasOwnProperty("init")||this.init===k.init)&&(k.init=function(){k.$super.init.apply(this,arguments)}),k.init.prototype=k,k.$super=this,k},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var k in E)E.hasOwnProperty(k)&&(this[k]=E[k]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=c.WordArray=p.extend({init:function(E,k){E=this.words=E||[],k!=n?this.sigBytes=k:this.sigBytes=E.length*4},toString:function(E){return(E||_).stringify(this)},concat:function(E){var k=this.words,C=E.words,O=this.sigBytes,F=E.sigBytes;if(this.clamp(),O%4)for(var D=0;D<F;D++){var N=C[D>>>2]>>>24-D%4*8&255;k[O+D>>>2]|=N<<24-(O+D)%4*8}else for(var D=0;D<F;D+=4)k[O+D>>>2]=C[D>>>2];return this.sigBytes+=F,this},clamp:function(){var E=this.words,k=this.sigBytes;E[k>>>2]&=4294967295<<32-k%4*8,E.length=i.ceil(k/4)},clone:function(){var E=p.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var k=[],C=0;C<E;C+=4)k.push(a());return new g.init(k,E)}}),m=h.enc={},_=m.Hex={stringify:function(E){for(var k=E.words,C=E.sigBytes,O=[],F=0;F<C;F++){var D=k[F>>>2]>>>24-F%4*8&255;O.push((D>>>4).toString(16)),O.push((D&15).toString(16))}return O.join("")},parse:function(E){for(var k=E.length,C=[],O=0;O<k;O+=2)C[O>>>3]|=parseInt(E.substr(O,2),16)<<24-O%8*4;return new g.init(C,k/2)}},b=m.Latin1={stringify:function(E){for(var k=E.words,C=E.sigBytes,O=[],F=0;F<C;F++){var D=k[F>>>2]>>>24-F%4*8&255;O.push(String.fromCharCode(D))}return O.join("")},parse:function(E){for(var k=E.length,C=[],O=0;O<k;O++)C[O>>>2]|=(E.charCodeAt(O)&255)<<24-O%4*8;return new g.init(C,k)}},x=m.Utf8={stringify:function(E){try{return decodeURIComponent(escape(b.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return b.parse(unescape(encodeURIComponent(E)))}},w=c.BufferedBlockAlgorithm=p.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=x.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var k,C=this._data,O=C.words,F=C.sigBytes,D=this.blockSize,N=D*4,X=F/N;E?X=i.ceil(X):X=i.max((X|0)-this._minBufferSize,0);var z=X*D,U=i.min(z*4,F);if(z){for(var j=0;j<z;j+=D)this._doProcessBlock(O,j);k=O.splice(0,z),C.sigBytes-=U}return new g.init(k,U)},clone:function(){var E=p.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0});c.Hasher=w.extend({cfg:p.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var k=this._doFinalize();return k},blockSize:16,_createHelper:function(E){return function(k,C){return new E.init(C).finalize(k)}},_createHmacHelper:function(E){return function(k,C){return new P.HMAC.init(E,C).finalize(k)}}});var P=h.algo={};return h}(Math);return t})}(ef)),ef.exports}var tf={exports:{}},zg;function Hc(){return zg||(zg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(i){var n=t,s=n.lib,a=s.Base,l=s.WordArray,h=n.x64={};h.Word=a.extend({init:function(c,p){this.high=c,this.low=p}}),h.WordArray=a.extend({init:function(c,p){c=this.words=c||[],p!=i?this.sigBytes=p:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,p=c.length,g=[],m=0;m<p;m++){var _=c[m];g.push(_.high),g.push(_.low)}return l.create(g,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),p=c.words=this.words.slice(0),g=p.length,m=0;m<g;m++)p[m]=p[m].clone();return c}})}(),t})}(tf)),tf.exports}var rf={exports:{}},Ug;function zT(){return Ug||(Ug=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(){if(typeof ArrayBuffer=="function"){var i=t,n=i.lib,s=n.WordArray,a=s.init,l=s.init=function(h){if(h instanceof ArrayBuffer&&(h=new Uint8Array(h)),(h instanceof Int8Array||typeof Uint8ClampedArray<"u"&&h instanceof Uint8ClampedArray||h instanceof Int16Array||h instanceof Uint16Array||h instanceof Int32Array||h instanceof Uint32Array||h instanceof Float32Array||h instanceof Float64Array)&&(h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength)),h instanceof Uint8Array){for(var c=h.byteLength,p=[],g=0;g<c;g++)p[g>>>2]|=h[g]<<24-g%4*8;a.call(this,p,c)}else a.apply(this,arguments)};l.prototype=s}}(),t.lib.WordArray})}(rf)),rf.exports}var nf={exports:{}},Wg;function UT(){return Wg||(Wg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.WordArray,a=i.enc;a.Utf16=a.Utf16BE={stringify:function(h){for(var c=h.words,p=h.sigBytes,g=[],m=0;m<p;m+=2){var _=c[m>>>2]>>>16-m%4*8&65535;g.push(String.fromCharCode(_))}return g.join("")},parse:function(h){for(var c=h.length,p=[],g=0;g<c;g++)p[g>>>1]|=h.charCodeAt(g)<<16-g%2*16;return s.create(p,c*2)}},a.Utf16LE={stringify:function(h){for(var c=h.words,p=h.sigBytes,g=[],m=0;m<p;m+=2){var _=l(c[m>>>2]>>>16-m%4*8&65535);g.push(String.fromCharCode(_))}return g.join("")},parse:function(h){for(var c=h.length,p=[],g=0;g<c;g++)p[g>>>1]|=l(h.charCodeAt(g)<<16-g%2*16);return s.create(p,c*2)}};function l(h){return h<<8&4278255360|h>>>8&16711935}}(),t.enc.Utf16})}(nf)),nf.exports}var sf={exports:{}},jg;function ml(){return jg||(jg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.WordArray,a=i.enc;a.Base64={stringify:function(h){var c=h.words,p=h.sigBytes,g=this._map;h.clamp();for(var m=[],_=0;_<p;_+=3)for(var b=c[_>>>2]>>>24-_%4*8&255,x=c[_+1>>>2]>>>24-(_+1)%4*8&255,w=c[_+2>>>2]>>>24-(_+2)%4*8&255,P=b<<16|x<<8|w,E=0;E<4&&_+E*.75<p;E++)m.push(g.charAt(P>>>6*(3-E)&63));var k=g.charAt(64);if(k)for(;m.length%4;)m.push(k);return m.join("")},parse:function(h){var c=h.length,p=this._map,g=this._reverseMap;if(!g){g=this._reverseMap=[];for(var m=0;m<p.length;m++)g[p.charCodeAt(m)]=m}var _=p.charAt(64);if(_){var b=h.indexOf(_);b!==-1&&(c=b)}return l(h,c,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(h,c,p){for(var g=[],m=0,_=0;_<c;_++)if(_%4){var b=p[h.charCodeAt(_-1)]<<_%4*2,x=p[h.charCodeAt(_)]>>>6-_%4*2,w=b|x;g[m>>>2]|=w<<24-m%4*8,m++}return s.create(g,m)}}(),t.enc.Base64})}(sf)),sf.exports}var af={exports:{}},Xg;function xl(){return Xg||(Xg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(i){var n=t,s=n.lib,a=s.WordArray,l=s.Hasher,h=n.algo,c=[];(function(){for(var x=0;x<64;x++)c[x]=i.abs(i.sin(x+1))*4294967296|0})();var p=h.MD5=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,w){for(var P=0;P<16;P++){var E=w+P,k=x[E];x[E]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}var C=this._hash.words,O=x[w+0],F=x[w+1],D=x[w+2],N=x[w+3],X=x[w+4],z=x[w+5],U=x[w+6],j=x[w+7],q=x[w+8],pe=x[w+9],fe=x[w+10],Ee=x[w+11],de=x[w+12],De=x[w+13],ee=x[w+14],Fe=x[w+15],se=C[0],R=C[1],J=C[2],Y=C[3];se=g(se,R,J,Y,O,7,c[0]),Y=g(Y,se,R,J,F,12,c[1]),J=g(J,Y,se,R,D,17,c[2]),R=g(R,J,Y,se,N,22,c[3]),se=g(se,R,J,Y,X,7,c[4]),Y=g(Y,se,R,J,z,12,c[5]),J=g(J,Y,se,R,U,17,c[6]),R=g(R,J,Y,se,j,22,c[7]),se=g(se,R,J,Y,q,7,c[8]),Y=g(Y,se,R,J,pe,12,c[9]),J=g(J,Y,se,R,fe,17,c[10]),R=g(R,J,Y,se,Ee,22,c[11]),se=g(se,R,J,Y,de,7,c[12]),Y=g(Y,se,R,J,De,12,c[13]),J=g(J,Y,se,R,ee,17,c[14]),R=g(R,J,Y,se,Fe,22,c[15]),se=m(se,R,J,Y,F,5,c[16]),Y=m(Y,se,R,J,U,9,c[17]),J=m(J,Y,se,R,Ee,14,c[18]),R=m(R,J,Y,se,O,20,c[19]),se=m(se,R,J,Y,z,5,c[20]),Y=m(Y,se,R,J,fe,9,c[21]),J=m(J,Y,se,R,Fe,14,c[22]),R=m(R,J,Y,se,X,20,c[23]),se=m(se,R,J,Y,pe,5,c[24]),Y=m(Y,se,R,J,ee,9,c[25]),J=m(J,Y,se,R,N,14,c[26]),R=m(R,J,Y,se,q,20,c[27]),se=m(se,R,J,Y,De,5,c[28]),Y=m(Y,se,R,J,D,9,c[29]),J=m(J,Y,se,R,j,14,c[30]),R=m(R,J,Y,se,de,20,c[31]),se=_(se,R,J,Y,z,4,c[32]),Y=_(Y,se,R,J,q,11,c[33]),J=_(J,Y,se,R,Ee,16,c[34]),R=_(R,J,Y,se,ee,23,c[35]),se=_(se,R,J,Y,F,4,c[36]),Y=_(Y,se,R,J,X,11,c[37]),J=_(J,Y,se,R,j,16,c[38]),R=_(R,J,Y,se,fe,23,c[39]),se=_(se,R,J,Y,De,4,c[40]),Y=_(Y,se,R,J,O,11,c[41]),J=_(J,Y,se,R,N,16,c[42]),R=_(R,J,Y,se,U,23,c[43]),se=_(se,R,J,Y,pe,4,c[44]),Y=_(Y,se,R,J,de,11,c[45]),J=_(J,Y,se,R,Fe,16,c[46]),R=_(R,J,Y,se,D,23,c[47]),se=b(se,R,J,Y,O,6,c[48]),Y=b(Y,se,R,J,j,10,c[49]),J=b(J,Y,se,R,ee,15,c[50]),R=b(R,J,Y,se,z,21,c[51]),se=b(se,R,J,Y,de,6,c[52]),Y=b(Y,se,R,J,N,10,c[53]),J=b(J,Y,se,R,fe,15,c[54]),R=b(R,J,Y,se,F,21,c[55]),se=b(se,R,J,Y,q,6,c[56]),Y=b(Y,se,R,J,Fe,10,c[57]),J=b(J,Y,se,R,U,15,c[58]),R=b(R,J,Y,se,De,21,c[59]),se=b(se,R,J,Y,X,6,c[60]),Y=b(Y,se,R,J,Ee,10,c[61]),J=b(J,Y,se,R,D,15,c[62]),R=b(R,J,Y,se,pe,21,c[63]),C[0]=C[0]+se|0,C[1]=C[1]+R|0,C[2]=C[2]+J|0,C[3]=C[3]+Y|0},_doFinalize:function(){var x=this._data,w=x.words,P=this._nDataBytes*8,E=x.sigBytes*8;w[E>>>5]|=128<<24-E%32;var k=i.floor(P/4294967296),C=P;w[(E+64>>>9<<4)+15]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,w[(E+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,x.sigBytes=(w.length+1)*4,this._process();for(var O=this._hash,F=O.words,D=0;D<4;D++){var N=F[D];F[D]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}return O},clone:function(){var x=l.clone.call(this);return x._hash=this._hash.clone(),x}});function g(x,w,P,E,k,C,O){var F=x+(w&P|~w&E)+k+O;return(F<<C|F>>>32-C)+w}function m(x,w,P,E,k,C,O){var F=x+(w&E|P&~E)+k+O;return(F<<C|F>>>32-C)+w}function _(x,w,P,E,k,C,O){var F=x+(w^P^E)+k+O;return(F<<C|F>>>32-C)+w}function b(x,w,P,E,k,C,O){var F=x+(P^(w|~E))+k+O;return(F<<C|F>>>32-C)+w}n.MD5=l._createHelper(p),n.HmacMD5=l._createHmacHelper(p)}(Math),t.MD5})}(af)),af.exports}var of={exports:{}},Gg;function kd(){return Gg||(Gg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.WordArray,a=n.Hasher,l=i.algo,h=[],c=l.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(p,g){for(var m=this._hash.words,_=m[0],b=m[1],x=m[2],w=m[3],P=m[4],E=0;E<80;E++){if(E<16)h[E]=p[g+E]|0;else{var k=h[E-3]^h[E-8]^h[E-14]^h[E-16];h[E]=k<<1|k>>>31}var C=(_<<5|_>>>27)+P+h[E];E<20?C+=(b&x|~b&w)+1518500249:E<40?C+=(b^x^w)+1859775393:E<60?C+=(b&x|b&w|x&w)-1894007588:C+=(b^x^w)-899497514,P=w,w=x,x=b<<30|b>>>2,b=_,_=C}m[0]=m[0]+_|0,m[1]=m[1]+b|0,m[2]=m[2]+x|0,m[3]=m[3]+w|0,m[4]=m[4]+P|0},_doFinalize:function(){var p=this._data,g=p.words,m=this._nDataBytes*8,_=p.sigBytes*8;return g[_>>>5]|=128<<24-_%32,g[(_+64>>>9<<4)+14]=Math.floor(m/4294967296),g[(_+64>>>9<<4)+15]=m,p.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}});i.SHA1=a._createHelper(c),i.HmacSHA1=a._createHmacHelper(c)}(),t.SHA1})}(of)),of.exports}var lf={exports:{}},Yg;function Wm(){return Yg||(Yg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){return function(i){var n=t,s=n.lib,a=s.WordArray,l=s.Hasher,h=n.algo,c=[],p=[];(function(){function _(P){for(var E=i.sqrt(P),k=2;k<=E;k++)if(!(P%k))return!1;return!0}function b(P){return(P-(P|0))*4294967296|0}for(var x=2,w=0;w<64;)_(x)&&(w<8&&(c[w]=b(i.pow(x,1/2))),p[w]=b(i.pow(x,1/3)),w++),x++})();var g=[],m=h.SHA256=l.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(_,b){for(var x=this._hash.words,w=x[0],P=x[1],E=x[2],k=x[3],C=x[4],O=x[5],F=x[6],D=x[7],N=0;N<64;N++){if(N<16)g[N]=_[b+N]|0;else{var X=g[N-15],z=(X<<25|X>>>7)^(X<<14|X>>>18)^X>>>3,U=g[N-2],j=(U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10;g[N]=z+g[N-7]+j+g[N-16]}var q=C&O^~C&F,pe=w&P^w&E^P&E,fe=(w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22),Ee=(C<<26|C>>>6)^(C<<21|C>>>11)^(C<<7|C>>>25),de=D+Ee+q+p[N]+g[N],De=fe+pe;D=F,F=O,O=C,C=k+de|0,k=E,E=P,P=w,w=de+De|0}x[0]=x[0]+w|0,x[1]=x[1]+P|0,x[2]=x[2]+E|0,x[3]=x[3]+k|0,x[4]=x[4]+C|0,x[5]=x[5]+O|0,x[6]=x[6]+F|0,x[7]=x[7]+D|0},_doFinalize:function(){var _=this._data,b=_.words,x=this._nDataBytes*8,w=_.sigBytes*8;return b[w>>>5]|=128<<24-w%32,b[(w+64>>>9<<4)+14]=i.floor(x/4294967296),b[(w+64>>>9<<4)+15]=x,_.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var _=l.clone.call(this);return _._hash=this._hash.clone(),_}});n.SHA256=l._createHelper(m),n.HmacSHA256=l._createHmacHelper(m)}(Math),t.SHA256})}(lf)),lf.exports}var uf={exports:{}},Vg;function WT(){return Vg||(Vg=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Wm())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.WordArray,a=i.algo,l=a.SHA256,h=a.SHA224=l.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=l._doFinalize.call(this);return c.sigBytes-=4,c}});i.SHA224=l._createHelper(h),i.HmacSHA224=l._createHmacHelper(h)}(),t.SHA224})}(uf)),uf.exports}var hf={exports:{}},Zg;function jm(){return Zg||(Zg=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Hc())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.Hasher,a=i.x64,l=a.Word,h=a.WordArray,c=i.algo;function p(){return l.create.apply(l,arguments)}var g=[p(1116352408,3609767458),p(1899447441,602891725),p(3049323471,3964484399),p(3921009573,2173295548),p(961987163,4081628472),p(1508970993,3053834265),p(2453635748,2937671579),p(2870763221,3664609560),p(3624381080,2734883394),p(310598401,1164996542),p(607225278,1323610764),p(1426881987,3590304994),p(1925078388,4068182383),p(2162078206,991336113),p(2614888103,633803317),p(3248222580,3479774868),p(3835390401,2666613458),p(4022224774,944711139),p(264347078,2341262773),p(604807628,2007800933),p(770255983,1495990901),p(1249150122,1856431235),p(1555081692,3175218132),p(1996064986,2198950837),p(2554220882,3999719339),p(2821834349,766784016),p(2952996808,2566594879),p(3210313671,3203337956),p(3336571891,1034457026),p(3584528711,2466948901),p(113926993,3758326383),p(338241895,168717936),p(666307205,1188179964),p(773529912,1546045734),p(1294757372,1522805485),p(1396182291,2643833823),p(1695183700,2343527390),p(1986661051,1014477480),p(2177026350,1206759142),p(2456956037,344077627),p(2730485921,1290863460),p(2820302411,3158454273),p(3259730800,3505952657),p(3345764771,106217008),p(3516065817,3606008344),p(3600352804,1432725776),p(4094571909,1467031594),p(275423344,851169720),p(430227734,3100823752),p(506948616,1363258195),p(659060556,3750685593),p(883997877,3785050280),p(958139571,3318307427),p(1322822218,3812723403),p(1537002063,2003034995),p(1747873779,3602036899),p(1955562222,1575990012),p(2024104815,1125592928),p(2227730452,2716904306),p(2361852424,442776044),p(2428436474,593698344),p(2756734187,3733110249),p(3204031479,2999351573),p(3329325298,3815920427),p(3391569614,3928383900),p(3515267271,566280711),p(3940187606,3454069534),p(4118630271,4000239992),p(116418474,1914138554),p(174292421,2731055270),p(289380356,3203993006),p(460393269,320620315),p(685471733,587496836),p(852142971,1086792851),p(1017036298,365543100),p(1126000580,2618297676),p(1288033470,3409855158),p(1501505948,4234509866),p(1607167915,987167468),p(1816402316,1246189591)],m=[];(function(){for(var b=0;b<80;b++)m[b]=p()})();var _=c.SHA512=s.extend({_doReset:function(){this._hash=new h.init([new l.init(1779033703,4089235720),new l.init(3144134277,2227873595),new l.init(1013904242,4271175723),new l.init(2773480762,1595750129),new l.init(1359893119,2917565137),new l.init(2600822924,725511199),new l.init(528734635,4215389547),new l.init(1541459225,327033209)])},_doProcessBlock:function(b,x){for(var w=this._hash.words,P=w[0],E=w[1],k=w[2],C=w[3],O=w[4],F=w[5],D=w[6],N=w[7],X=P.high,z=P.low,U=E.high,j=E.low,q=k.high,pe=k.low,fe=C.high,Ee=C.low,de=O.high,De=O.low,ee=F.high,Fe=F.low,se=D.high,R=D.low,J=N.high,Y=N.low,ie=X,he=z,Pe=U,we=j,Oe=q,Le=pe,it=fe,te=Ee,ft=de,Ge=De,_t=ee,rt=Fe,Be=se,St=R,ii=J,Ht=Y,vt=0;vt<80;vt++){var zt,Ut,Kt=m[vt];if(vt<16)Ut=Kt.high=b[x+vt*2]|0,zt=Kt.low=b[x+vt*2+1]|0;else{var Ti=m[vt-15],ki=Ti.high,pi=Ti.low,Bt=(ki>>>1|pi<<31)^(ki>>>8|pi<<24)^ki>>>7,gi=(pi>>>1|ki<<31)^(pi>>>8|ki<<24)^(pi>>>7|ki<<25),nt=m[vt-2],Pt=nt.high,Jt=nt.low,Xt=(Pt>>>19|Jt<<13)^(Pt<<3|Jt>>>29)^Pt>>>6,ji=(Jt>>>19|Pt<<13)^(Jt<<3|Pt>>>29)^(Jt>>>6|Pt<<26),qr=m[vt-7],Gn=qr.high,Pi=qr.low,Lr=m[vt-16],Gs=Lr.high,gs=Lr.low;zt=gi+Pi,Ut=Bt+Gn+(zt>>>0<gi>>>0?1:0),zt=zt+ji,Ut=Ut+Xt+(zt>>>0<ji>>>0?1:0),zt=zt+gs,Ut=Ut+Gs+(zt>>>0<gs>>>0?1:0),Kt.high=Ut,Kt.low=zt}var pr=ft&_t^~ft&Be,Mi=Ge&rt^~Ge&St,Fi=ie&Pe^ie&Oe^Pe&Oe,Ys=he&we^he&Le^we&Le,Ta=(ie>>>28|he<<4)^(ie<<30|he>>>2)^(ie<<25|he>>>7),gr=(he>>>28|ie<<4)^(he<<30|ie>>>2)^(he<<25|ie>>>7),Or=(ft>>>14|Ge<<18)^(ft>>>18|Ge<<14)^(ft<<23|Ge>>>9),Vs=(Ge>>>14|ft<<18)^(Ge>>>18|ft<<14)^(Ge<<23|ft>>>9),Pn=g[vt],Yn=Pn.high,Ri=Pn.low,_i=Ht+Vs,Xi=ii+Or+(_i>>>0<Ht>>>0?1:0),_i=_i+Mi,Xi=Xi+pr+(_i>>>0<Mi>>>0?1:0),_i=_i+Ri,Xi=Xi+Yn+(_i>>>0<Ri>>>0?1:0),_i=_i+zt,Xi=Xi+Ut+(_i>>>0<zt>>>0?1:0),Vn=gr+Ys,_s=Ta+Fi+(Vn>>>0<gr>>>0?1:0);ii=Be,Ht=St,Be=_t,St=rt,_t=ft,rt=Ge,Ge=te+_i|0,ft=it+Xi+(Ge>>>0<te>>>0?1:0)|0,it=Oe,te=Le,Oe=Pe,Le=we,Pe=ie,we=he,he=_i+Vn|0,ie=Xi+_s+(he>>>0<_i>>>0?1:0)|0}z=P.low=z+he,P.high=X+ie+(z>>>0<he>>>0?1:0),j=E.low=j+we,E.high=U+Pe+(j>>>0<we>>>0?1:0),pe=k.low=pe+Le,k.high=q+Oe+(pe>>>0<Le>>>0?1:0),Ee=C.low=Ee+te,C.high=fe+it+(Ee>>>0<te>>>0?1:0),De=O.low=De+Ge,O.high=de+ft+(De>>>0<Ge>>>0?1:0),Fe=F.low=Fe+rt,F.high=ee+_t+(Fe>>>0<rt>>>0?1:0),R=D.low=R+St,D.high=se+Be+(R>>>0<St>>>0?1:0),Y=N.low=Y+Ht,N.high=J+ii+(Y>>>0<Ht>>>0?1:0)},_doFinalize:function(){var b=this._data,x=b.words,w=this._nDataBytes*8,P=b.sigBytes*8;x[P>>>5]|=128<<24-P%32,x[(P+128>>>10<<5)+30]=Math.floor(w/4294967296),x[(P+128>>>10<<5)+31]=w,b.sigBytes=x.length*4,this._process();var E=this._hash.toX32();return E},clone:function(){var b=s.clone.call(this);return b._hash=this._hash.clone(),b},blockSize:1024/32});i.SHA512=s._createHelper(_),i.HmacSHA512=s._createHmacHelper(_)}(),t.SHA512})}(hf)),hf.exports}var cf={exports:{}},Kg;function jT(){return Kg||(Kg=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Hc(),jm())})(ut,function(t){return function(){var i=t,n=i.x64,s=n.Word,a=n.WordArray,l=i.algo,h=l.SHA512,c=l.SHA384=h.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var p=h._doFinalize.call(this);return p.sigBytes-=16,p}});i.SHA384=h._createHelper(c),i.HmacSHA384=h._createHmacHelper(c)}(),t.SHA384})}(cf)),cf.exports}var ff={exports:{}},$g;function XT(){return $g||($g=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Hc())})(ut,function(t){return function(i){var n=t,s=n.lib,a=s.WordArray,l=s.Hasher,h=n.x64,c=h.Word,p=n.algo,g=[],m=[],_=[];(function(){for(var w=1,P=0,E=0;E<24;E++){g[w+5*P]=(E+1)*(E+2)/2%64;var k=P%5,C=(2*w+3*P)%5;w=k,P=C}for(var w=0;w<5;w++)for(var P=0;P<5;P++)m[w+5*P]=P+(2*w+3*P)%5*5;for(var O=1,F=0;F<24;F++){for(var D=0,N=0,X=0;X<7;X++){if(O&1){var z=(1<<X)-1;z<32?N^=1<<z:D^=1<<z-32}O&128?O=O<<1^113:O<<=1}_[F]=c.create(D,N)}})();var b=[];(function(){for(var w=0;w<25;w++)b[w]=c.create()})();var x=p.SHA3=l.extend({cfg:l.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],P=0;P<25;P++)w[P]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,P){for(var E=this._state,k=this.blockSize/2,C=0;C<k;C++){var O=w[P+2*C],F=w[P+2*C+1];O=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,F=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360;var D=E[C];D.high^=F,D.low^=O}for(var N=0;N<24;N++){for(var X=0;X<5;X++){for(var z=0,U=0,j=0;j<5;j++){var D=E[X+5*j];z^=D.high,U^=D.low}var q=b[X];q.high=z,q.low=U}for(var X=0;X<5;X++)for(var pe=b[(X+4)%5],fe=b[(X+1)%5],Ee=fe.high,de=fe.low,z=pe.high^(Ee<<1|de>>>31),U=pe.low^(de<<1|Ee>>>31),j=0;j<5;j++){var D=E[X+5*j];D.high^=z,D.low^=U}for(var De=1;De<25;De++){var z,U,D=E[De],ee=D.high,Fe=D.low,se=g[De];se<32?(z=ee<<se|Fe>>>32-se,U=Fe<<se|ee>>>32-se):(z=Fe<<se-32|ee>>>64-se,U=ee<<se-32|Fe>>>64-se);var R=b[m[De]];R.high=z,R.low=U}var J=b[0],Y=E[0];J.high=Y.high,J.low=Y.low;for(var X=0;X<5;X++)for(var j=0;j<5;j++){var De=X+5*j,D=E[De],ie=b[De],he=b[(X+1)%5+5*j],Pe=b[(X+2)%5+5*j];D.high=ie.high^~he.high&Pe.high,D.low=ie.low^~he.low&Pe.low}var D=E[0],we=_[N];D.high^=we.high,D.low^=we.low}},_doFinalize:function(){var w=this._data,P=w.words;this._nDataBytes*8;var E=w.sigBytes*8,k=this.blockSize*32;P[E>>>5]|=1<<24-E%32,P[(i.ceil((E+1)/k)*k>>>5)-1]|=128,w.sigBytes=P.length*4,this._process();for(var C=this._state,O=this.cfg.outputLength/8,F=O/8,D=[],N=0;N<F;N++){var X=C[N],z=X.high,U=X.low;z=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,D.push(U),D.push(z)}return new a.init(D,O)},clone:function(){for(var w=l.clone.call(this),P=w._state=this._state.slice(0),E=0;E<25;E++)P[E]=P[E].clone();return w}});n.SHA3=l._createHelper(x),n.HmacSHA3=l._createHmacHelper(x)}(Math),t.SHA3})}(ff)),ff.exports}var df={exports:{}},qg;function GT(){return qg||(qg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(i){var n=t,s=n.lib,a=s.WordArray,l=s.Hasher,h=n.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),p=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),g=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),_=a.create([0,1518500249,1859775393,2400959708,2840853838]),b=a.create([1352829926,1548603684,1836072691,2053994217,0]),x=h.RIPEMD160=l.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(F,D){for(var N=0;N<16;N++){var X=D+N,z=F[X];F[X]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360}var U=this._hash.words,j=_.words,q=b.words,pe=c.words,fe=p.words,Ee=g.words,de=m.words,De,ee,Fe,se,R,J,Y,ie,he,Pe;J=De=U[0],Y=ee=U[1],ie=Fe=U[2],he=se=U[3],Pe=R=U[4];for(var we,N=0;N<80;N+=1)we=De+F[D+pe[N]]|0,N<16?we+=w(ee,Fe,se)+j[0]:N<32?we+=P(ee,Fe,se)+j[1]:N<48?we+=E(ee,Fe,se)+j[2]:N<64?we+=k(ee,Fe,se)+j[3]:we+=C(ee,Fe,se)+j[4],we=we|0,we=O(we,Ee[N]),we=we+R|0,De=R,R=se,se=O(Fe,10),Fe=ee,ee=we,we=J+F[D+fe[N]]|0,N<16?we+=C(Y,ie,he)+q[0]:N<32?we+=k(Y,ie,he)+q[1]:N<48?we+=E(Y,ie,he)+q[2]:N<64?we+=P(Y,ie,he)+q[3]:we+=w(Y,ie,he)+q[4],we=we|0,we=O(we,de[N]),we=we+Pe|0,J=Pe,Pe=he,he=O(ie,10),ie=Y,Y=we;we=U[1]+Fe+he|0,U[1]=U[2]+se+Pe|0,U[2]=U[3]+R+J|0,U[3]=U[4]+De+Y|0,U[4]=U[0]+ee+ie|0,U[0]=we},_doFinalize:function(){var F=this._data,D=F.words,N=this._nDataBytes*8,X=F.sigBytes*8;D[X>>>5]|=128<<24-X%32,D[(X+64>>>9<<4)+14]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,F.sigBytes=(D.length+1)*4,this._process();for(var z=this._hash,U=z.words,j=0;j<5;j++){var q=U[j];U[j]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}return z},clone:function(){var F=l.clone.call(this);return F._hash=this._hash.clone(),F}});function w(F,D,N){return F^D^N}function P(F,D,N){return F&D|~F&N}function E(F,D,N){return(F|~D)^N}function k(F,D,N){return F&N|D&~N}function C(F,D,N){return F^(D|~N)}function O(F,D){return F<<D|F>>>32-D}n.RIPEMD160=l._createHelper(x),n.HmacRIPEMD160=l._createHmacHelper(x)}(),t.RIPEMD160})}(df)),df.exports}var pf={exports:{}},Jg;function Pd(){return Jg||(Jg=1,function(r,e){(function(t,i){r.exports=i(Ft())})(ut,function(t){(function(){var i=t,n=i.lib,s=n.Base,a=i.enc,l=a.Utf8,h=i.algo;h.HMAC=s.extend({init:function(c,p){c=this._hasher=new c.init,typeof p=="string"&&(p=l.parse(p));var g=c.blockSize,m=g*4;p.sigBytes>m&&(p=c.finalize(p)),p.clamp();for(var _=this._oKey=p.clone(),b=this._iKey=p.clone(),x=_.words,w=b.words,P=0;P<g;P++)x[P]^=1549556828,w[P]^=909522486;_.sigBytes=b.sigBytes=m,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var p=this._hasher,g=p.finalize(c);p.reset();var m=p.finalize(this._oKey.clone().concat(g));return m}})})()})}(pf)),pf.exports}var gf={exports:{}},Qg;function YT(){return Qg||(Qg=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),kd(),Pd())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.Base,a=n.WordArray,l=i.algo,h=l.SHA1,c=l.HMAC,p=l.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:h,iterations:1}),init:function(g){this.cfg=this.cfg.extend(g)},compute:function(g,m){for(var _=this.cfg,b=c.create(_.hasher,g),x=a.create(),w=a.create([1]),P=x.words,E=w.words,k=_.keySize,C=_.iterations;P.length<k;){var O=b.update(m).finalize(w);b.reset();for(var F=O.words,D=F.length,N=O,X=1;X<C;X++){N=b.finalize(N),b.reset();for(var z=N.words,U=0;U<D;U++)F[U]^=z[U]}x.concat(O),E[0]++}return x.sigBytes=k*4,x}});i.PBKDF2=function(g,m,_){return p.create(_).compute(g,m)}}(),t.PBKDF2})}(gf)),gf.exports}var _f={exports:{}},e_;function po(){return e_||(e_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),kd(),Pd())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.Base,a=n.WordArray,l=i.algo,h=l.MD5,c=l.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:h,iterations:1}),init:function(p){this.cfg=this.cfg.extend(p)},compute:function(p,g){for(var m,_=this.cfg,b=_.hasher.create(),x=a.create(),w=x.words,P=_.keySize,E=_.iterations;w.length<P;){m&&b.update(m),m=b.update(p).finalize(g),b.reset();for(var k=1;k<E;k++)m=b.finalize(m),b.reset();x.concat(m)}return x.sigBytes=P*4,x}});i.EvpKDF=function(p,g,m){return c.create(m).compute(p,g)}}(),t.EvpKDF})}(_f)),_f.exports}var mf={exports:{}},t_;function Qi(){return t_||(t_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),po())})(ut,function(t){t.lib.Cipher||function(i){var n=t,s=n.lib,a=s.Base,l=s.WordArray,h=s.BufferedBlockAlgorithm,c=n.enc;c.Utf8;var p=c.Base64,g=n.algo,m=g.EvpKDF,_=s.Cipher=h.extend({cfg:a.extend(),createEncryptor:function(z,U){return this.create(this._ENC_XFORM_MODE,z,U)},createDecryptor:function(z,U){return this.create(this._DEC_XFORM_MODE,z,U)},init:function(z,U,j){this.cfg=this.cfg.extend(j),this._xformMode=z,this._key=U,this.reset()},reset:function(){h.reset.call(this),this._doReset()},process:function(z){return this._append(z),this._process()},finalize:function(z){z&&this._append(z);var U=this._doFinalize();return U},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function z(U){return typeof U=="string"?X:F}return function(U){return{encrypt:function(j,q,pe){return z(q).encrypt(U,j,q,pe)},decrypt:function(j,q,pe){return z(q).decrypt(U,j,q,pe)}}}}()});s.StreamCipher=_.extend({_doFinalize:function(){var z=this._process(!0);return z},blockSize:1});var b=n.mode={},x=s.BlockCipherMode=a.extend({createEncryptor:function(z,U){return this.Encryptor.create(z,U)},createDecryptor:function(z,U){return this.Decryptor.create(z,U)},init:function(z,U){this._cipher=z,this._iv=U}}),w=b.CBC=function(){var z=x.extend();z.Encryptor=z.extend({processBlock:function(j,q){var pe=this._cipher,fe=pe.blockSize;U.call(this,j,q,fe),pe.encryptBlock(j,q),this._prevBlock=j.slice(q,q+fe)}}),z.Decryptor=z.extend({processBlock:function(j,q){var pe=this._cipher,fe=pe.blockSize,Ee=j.slice(q,q+fe);pe.decryptBlock(j,q),U.call(this,j,q,fe),this._prevBlock=Ee}});function U(j,q,pe){var fe,Ee=this._iv;Ee?(fe=Ee,this._iv=i):fe=this._prevBlock;for(var de=0;de<pe;de++)j[q+de]^=fe[de]}return z}(),P=n.pad={},E=P.Pkcs7={pad:function(z,U){for(var j=U*4,q=j-z.sigBytes%j,pe=q<<24|q<<16|q<<8|q,fe=[],Ee=0;Ee<q;Ee+=4)fe.push(pe);var de=l.create(fe,q);z.concat(de)},unpad:function(z){var U=z.words[z.sigBytes-1>>>2]&255;z.sigBytes-=U}};s.BlockCipher=_.extend({cfg:_.cfg.extend({mode:w,padding:E}),reset:function(){var z;_.reset.call(this);var U=this.cfg,j=U.iv,q=U.mode;this._xformMode==this._ENC_XFORM_MODE?z=q.createEncryptor:(z=q.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==z?this._mode.init(this,j&&j.words):(this._mode=z.call(q,this,j&&j.words),this._mode.__creator=z)},_doProcessBlock:function(z,U){this._mode.processBlock(z,U)},_doFinalize:function(){var z,U=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(U.pad(this._data,this.blockSize),z=this._process(!0)):(z=this._process(!0),U.unpad(z)),z},blockSize:128/32});var k=s.CipherParams=a.extend({init:function(z){this.mixIn(z)},toString:function(z){return(z||this.formatter).stringify(this)}}),C=n.format={},O=C.OpenSSL={stringify:function(z){var U,j=z.ciphertext,q=z.salt;return q?U=l.create([1398893684,1701076831]).concat(q).concat(j):U=j,U.toString(p)},parse:function(z){var U,j=p.parse(z),q=j.words;return q[0]==1398893684&&q[1]==1701076831&&(U=l.create(q.slice(2,4)),q.splice(0,4),j.sigBytes-=16),k.create({ciphertext:j,salt:U})}},F=s.SerializableCipher=a.extend({cfg:a.extend({format:O}),encrypt:function(z,U,j,q){q=this.cfg.extend(q);var pe=z.createEncryptor(j,q),fe=pe.finalize(U),Ee=pe.cfg;return k.create({ciphertext:fe,key:j,iv:Ee.iv,algorithm:z,mode:Ee.mode,padding:Ee.padding,blockSize:z.blockSize,formatter:q.format})},decrypt:function(z,U,j,q){q=this.cfg.extend(q),U=this._parse(U,q.format);var pe=z.createDecryptor(j,q).finalize(U.ciphertext);return pe},_parse:function(z,U){return typeof z=="string"?U.parse(z,this):z}}),D=n.kdf={},N=D.OpenSSL={execute:function(z,U,j,q){q||(q=l.random(64/8));var pe=m.create({keySize:U+j}).compute(z,q),fe=l.create(pe.words.slice(U),j*4);return pe.sigBytes=U*4,k.create({key:pe,iv:fe,salt:q})}},X=s.PasswordBasedCipher=F.extend({cfg:F.cfg.extend({kdf:N}),encrypt:function(z,U,j,q){q=this.cfg.extend(q);var pe=q.kdf.execute(j,z.keySize,z.ivSize);q.iv=pe.iv;var fe=F.encrypt.call(this,z,U,pe.key,q);return fe.mixIn(pe),fe},decrypt:function(z,U,j,q){q=this.cfg.extend(q),U=this._parse(U,q.format);var pe=q.kdf.execute(j,z.keySize,z.ivSize,U.salt);q.iv=pe.iv;var fe=F.decrypt.call(this,z,U,pe.key,q);return fe}})}()})}(mf)),mf.exports}var xf={exports:{}},i_;function VT(){return i_||(i_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.mode.CFB=function(){var i=t.lib.BlockCipherMode.extend();i.Encryptor=i.extend({processBlock:function(s,a){var l=this._cipher,h=l.blockSize;n.call(this,s,a,h,l),this._prevBlock=s.slice(a,a+h)}}),i.Decryptor=i.extend({processBlock:function(s,a){var l=this._cipher,h=l.blockSize,c=s.slice(a,a+h);n.call(this,s,a,h,l),this._prevBlock=c}});function n(s,a,l,h){var c,p=this._iv;p?(c=p.slice(0),this._iv=void 0):c=this._prevBlock,h.encryptBlock(c,0);for(var g=0;g<l;g++)s[a+g]^=c[g]}return i}(),t.mode.CFB})}(xf)),xf.exports}var vf={exports:{}},r_;function ZT(){return r_||(r_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.mode.CTR=function(){var i=t.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var l=this._cipher,h=l.blockSize,c=this._iv,p=this._counter;c&&(p=this._counter=c.slice(0),this._iv=void 0);var g=p.slice(0);l.encryptBlock(g,0),p[h-1]=p[h-1]+1|0;for(var m=0;m<h;m++)s[a+m]^=g[m]}});return i.Decryptor=n,i}(),t.mode.CTR})}(vf)),vf.exports}var yf={exports:{}},n_;function KT(){return n_||(n_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var i=t.lib.BlockCipherMode.extend();function n(l){if((l>>24&255)===255){var h=l>>16&255,c=l>>8&255,p=l&255;h===255?(h=0,c===255?(c=0,p===255?p=0:++p):++c):++h,l=0,l+=h<<16,l+=c<<8,l+=p}else l+=1<<24;return l}function s(l){return(l[0]=n(l[0]))===0&&(l[1]=n(l[1])),l}var a=i.Encryptor=i.extend({processBlock:function(l,h){var c=this._cipher,p=c.blockSize,g=this._iv,m=this._counter;g&&(m=this._counter=g.slice(0),this._iv=void 0),s(m);var _=m.slice(0);c.encryptBlock(_,0);for(var b=0;b<p;b++)l[h+b]^=_[b]}});return i.Decryptor=a,i}(),t.mode.CTRGladman})}(yf)),yf.exports}var bf={exports:{}},s_;function $T(){return s_||(s_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.mode.OFB=function(){var i=t.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var l=this._cipher,h=l.blockSize,c=this._iv,p=this._keystream;c&&(p=this._keystream=c.slice(0),this._iv=void 0),l.encryptBlock(p,0);for(var g=0;g<h;g++)s[a+g]^=p[g]}});return i.Decryptor=n,i}(),t.mode.OFB})}(bf)),bf.exports}var wf={exports:{}},a_;function qT(){return a_||(a_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.mode.ECB=function(){var i=t.lib.BlockCipherMode.extend();return i.Encryptor=i.extend({processBlock:function(n,s){this._cipher.encryptBlock(n,s)}}),i.Decryptor=i.extend({processBlock:function(n,s){this._cipher.decryptBlock(n,s)}}),i}(),t.mode.ECB})}(wf)),wf.exports}var Tf={exports:{}},o_;function JT(){return o_||(o_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.pad.AnsiX923={pad:function(i,n){var s=i.sigBytes,a=n*4,l=a-s%a,h=s+l-1;i.clamp(),i.words[h>>>2]|=l<<24-h%4*8,i.sigBytes+=l},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},t.pad.Ansix923})}(Tf)),Tf.exports}var kf={exports:{}},l_;function QT(){return l_||(l_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.pad.Iso10126={pad:function(i,n){var s=n*4,a=s-i.sigBytes%s;i.concat(t.lib.WordArray.random(a-1)).concat(t.lib.WordArray.create([a<<24],1))},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},t.pad.Iso10126})}(kf)),kf.exports}var Pf={exports:{}},u_;function ek(){return u_||(u_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.pad.Iso97971={pad:function(i,n){i.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(i,n)},unpad:function(i){t.pad.ZeroPadding.unpad(i),i.sigBytes--}},t.pad.Iso97971})}(Pf)),Pf.exports}var Ef={exports:{}},h_;function tk(){return h_||(h_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.pad.ZeroPadding={pad:function(i,n){var s=n*4;i.clamp(),i.sigBytes+=s-(i.sigBytes%s||s)},unpad:function(i){for(var n=i.words,s=i.sigBytes-1,s=i.sigBytes-1;s>=0;s--)if(n[s>>>2]>>>24-s%4*8&255){i.sigBytes=s+1;break}}},t.pad.ZeroPadding})}(Ef)),Ef.exports}var Af={exports:{}},c_;function ik(){return c_||(c_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(Af)),Af.exports}var Cf={exports:{}},f_;function rk(){return f_||(f_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),Qi())})(ut,function(t){return function(i){var n=t,s=n.lib,a=s.CipherParams,l=n.enc,h=l.Hex,c=n.format;c.Hex={stringify:function(p){return p.ciphertext.toString(h)},parse:function(p){var g=h.parse(p);return a.create({ciphertext:g})}}}(),t.format.Hex})}(Cf)),Cf.exports}var Sf={exports:{}},d_;function nk(){return d_||(d_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),ml(),xl(),po(),Qi())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.BlockCipher,a=i.algo,l=[],h=[],c=[],p=[],g=[],m=[],_=[],b=[],x=[],w=[];(function(){for(var k=[],C=0;C<256;C++)C<128?k[C]=C<<1:k[C]=C<<1^283;for(var O=0,F=0,C=0;C<256;C++){var D=F^F<<1^F<<2^F<<3^F<<4;D=D>>>8^D&255^99,l[O]=D,h[D]=O;var N=k[O],X=k[N],z=k[X],U=k[D]*257^D*16843008;c[O]=U<<24|U>>>8,p[O]=U<<16|U>>>16,g[O]=U<<8|U>>>24,m[O]=U;var U=z*16843009^X*65537^N*257^O*16843008;_[D]=U<<24|U>>>8,b[D]=U<<16|U>>>16,x[D]=U<<8|U>>>24,w[D]=U,O?(O=N^k[k[k[z^N]]],F^=k[k[F]]):O=F=1}})();var P=[0,1,2,4,8,16,32,64,128,27,54],E=a.AES=s.extend({_doReset:function(){var k;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var C=this._keyPriorReset=this._key,O=C.words,F=C.sigBytes/4,D=this._nRounds=F+6,N=(D+1)*4,X=this._keySchedule=[],z=0;z<N;z++)z<F?X[z]=O[z]:(k=X[z-1],z%F?F>6&&z%F==4&&(k=l[k>>>24]<<24|l[k>>>16&255]<<16|l[k>>>8&255]<<8|l[k&255]):(k=k<<8|k>>>24,k=l[k>>>24]<<24|l[k>>>16&255]<<16|l[k>>>8&255]<<8|l[k&255],k^=P[z/F|0]<<24),X[z]=X[z-F]^k);for(var U=this._invKeySchedule=[],j=0;j<N;j++){var z=N-j;if(j%4)var k=X[z];else var k=X[z-4];j<4||z<=4?U[j]=k:U[j]=_[l[k>>>24]]^b[l[k>>>16&255]]^x[l[k>>>8&255]]^w[l[k&255]]}}},encryptBlock:function(k,C){this._doCryptBlock(k,C,this._keySchedule,c,p,g,m,l)},decryptBlock:function(k,C){var O=k[C+1];k[C+1]=k[C+3],k[C+3]=O,this._doCryptBlock(k,C,this._invKeySchedule,_,b,x,w,h);var O=k[C+1];k[C+1]=k[C+3],k[C+3]=O},_doCryptBlock:function(k,C,O,F,D,N,X,z){for(var U=this._nRounds,j=k[C]^O[0],q=k[C+1]^O[1],pe=k[C+2]^O[2],fe=k[C+3]^O[3],Ee=4,de=1;de<U;de++){var De=F[j>>>24]^D[q>>>16&255]^N[pe>>>8&255]^X[fe&255]^O[Ee++],ee=F[q>>>24]^D[pe>>>16&255]^N[fe>>>8&255]^X[j&255]^O[Ee++],Fe=F[pe>>>24]^D[fe>>>16&255]^N[j>>>8&255]^X[q&255]^O[Ee++],se=F[fe>>>24]^D[j>>>16&255]^N[q>>>8&255]^X[pe&255]^O[Ee++];j=De,q=ee,pe=Fe,fe=se}var De=(z[j>>>24]<<24|z[q>>>16&255]<<16|z[pe>>>8&255]<<8|z[fe&255])^O[Ee++],ee=(z[q>>>24]<<24|z[pe>>>16&255]<<16|z[fe>>>8&255]<<8|z[j&255])^O[Ee++],Fe=(z[pe>>>24]<<24|z[fe>>>16&255]<<16|z[j>>>8&255]<<8|z[q&255])^O[Ee++],se=(z[fe>>>24]<<24|z[j>>>16&255]<<16|z[q>>>8&255]<<8|z[pe&255])^O[Ee++];k[C]=De,k[C+1]=ee,k[C+2]=Fe,k[C+3]=se},keySize:256/32});i.AES=s._createHelper(E)}(),t.AES})}(Sf)),Sf.exports}var Df={exports:{}},p_;function sk(){return p_||(p_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),ml(),xl(),po(),Qi())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.WordArray,a=n.BlockCipher,l=i.algo,h=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],p=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],g=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],_=l.DES=a.extend({_doReset:function(){for(var P=this._key,E=P.words,k=[],C=0;C<56;C++){var O=h[C]-1;k[C]=E[O>>>5]>>>31-O%32&1}for(var F=this._subKeys=[],D=0;D<16;D++){for(var N=F[D]=[],X=p[D],C=0;C<24;C++)N[C/6|0]|=k[(c[C]-1+X)%28]<<31-C%6,N[4+(C/6|0)]|=k[28+(c[C+24]-1+X)%28]<<31-C%6;N[0]=N[0]<<1|N[0]>>>31;for(var C=1;C<7;C++)N[C]=N[C]>>>(C-1)*4+3;N[7]=N[7]<<5|N[7]>>>27}for(var z=this._invSubKeys=[],C=0;C<16;C++)z[C]=F[15-C]},encryptBlock:function(P,E){this._doCryptBlock(P,E,this._subKeys)},decryptBlock:function(P,E){this._doCryptBlock(P,E,this._invSubKeys)},_doCryptBlock:function(P,E,k){this._lBlock=P[E],this._rBlock=P[E+1],b.call(this,4,252645135),b.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),b.call(this,1,1431655765);for(var C=0;C<16;C++){for(var O=k[C],F=this._lBlock,D=this._rBlock,N=0,X=0;X<8;X++)N|=g[X][((D^O[X])&m[X])>>>0];this._lBlock=D,this._rBlock=F^N}var z=this._lBlock;this._lBlock=this._rBlock,this._rBlock=z,b.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),b.call(this,16,65535),b.call(this,4,252645135),P[E]=this._lBlock,P[E+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function b(P,E){var k=(this._lBlock>>>P^this._rBlock)&E;this._rBlock^=k,this._lBlock^=k<<P}function x(P,E){var k=(this._rBlock>>>P^this._lBlock)&E;this._lBlock^=k,this._rBlock^=k<<P}i.DES=a._createHelper(_);var w=l.TripleDES=a.extend({_doReset:function(){var P=this._key,E=P.words;if(E.length!==2&&E.length!==4&&E.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var k=E.slice(0,2),C=E.length<4?E.slice(0,2):E.slice(2,4),O=E.length<6?E.slice(0,2):E.slice(4,6);this._des1=_.createEncryptor(s.create(k)),this._des2=_.createEncryptor(s.create(C)),this._des3=_.createEncryptor(s.create(O))},encryptBlock:function(P,E){this._des1.encryptBlock(P,E),this._des2.decryptBlock(P,E),this._des3.encryptBlock(P,E)},decryptBlock:function(P,E){this._des3.decryptBlock(P,E),this._des2.encryptBlock(P,E),this._des1.decryptBlock(P,E)},keySize:192/32,ivSize:64/32,blockSize:64/32});i.TripleDES=a._createHelper(w)}(),t.TripleDES})}(Df)),Df.exports}var Lf={exports:{}},g_;function ak(){return g_||(g_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),ml(),xl(),po(),Qi())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.StreamCipher,a=i.algo,l=a.RC4=s.extend({_doReset:function(){for(var p=this._key,g=p.words,m=p.sigBytes,_=this._S=[],b=0;b<256;b++)_[b]=b;for(var b=0,x=0;b<256;b++){var w=b%m,P=g[w>>>2]>>>24-w%4*8&255;x=(x+_[b]+P)%256;var E=_[b];_[b]=_[x],_[x]=E}this._i=this._j=0},_doProcessBlock:function(p,g){p[g]^=h.call(this)},keySize:256/32,ivSize:0});function h(){for(var p=this._S,g=this._i,m=this._j,_=0,b=0;b<4;b++){g=(g+1)%256,m=(m+p[g])%256;var x=p[g];p[g]=p[m],p[m]=x,_|=p[(p[g]+p[m])%256]<<24-b*8}return this._i=g,this._j=m,_}i.RC4=s._createHelper(l);var c=a.RC4Drop=l.extend({cfg:l.cfg.extend({drop:192}),_doReset:function(){l._doReset.call(this);for(var p=this.cfg.drop;p>0;p--)h.call(this)}});i.RC4Drop=s._createHelper(c)}(),t.RC4})}(Lf)),Lf.exports}var Of={exports:{}},__;function ok(){return __||(__=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),ml(),xl(),po(),Qi())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.StreamCipher,a=i.algo,l=[],h=[],c=[],p=a.Rabbit=s.extend({_doReset:function(){for(var m=this._key.words,_=this.cfg.iv,b=0;b<4;b++)m[b]=(m[b]<<8|m[b]>>>24)&16711935|(m[b]<<24|m[b]>>>8)&4278255360;var x=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],w=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var b=0;b<4;b++)g.call(this);for(var b=0;b<8;b++)w[b]^=x[b+4&7];if(_){var P=_.words,E=P[0],k=P[1],C=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,O=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,F=C>>>16|O&4294901760,D=O<<16|C&65535;w[0]^=C,w[1]^=F,w[2]^=O,w[3]^=D,w[4]^=C,w[5]^=F,w[6]^=O,w[7]^=D;for(var b=0;b<4;b++)g.call(this)}},_doProcessBlock:function(m,_){var b=this._X;g.call(this),l[0]=b[0]^b[5]>>>16^b[3]<<16,l[1]=b[2]^b[7]>>>16^b[5]<<16,l[2]=b[4]^b[1]>>>16^b[7]<<16,l[3]=b[6]^b[3]>>>16^b[1]<<16;for(var x=0;x<4;x++)l[x]=(l[x]<<8|l[x]>>>24)&16711935|(l[x]<<24|l[x]>>>8)&4278255360,m[_+x]^=l[x]},blockSize:128/32,ivSize:64/32});function g(){for(var m=this._X,_=this._C,b=0;b<8;b++)h[b]=_[b];_[0]=_[0]+1295307597+this._b|0,_[1]=_[1]+3545052371+(_[0]>>>0<h[0]>>>0?1:0)|0,_[2]=_[2]+886263092+(_[1]>>>0<h[1]>>>0?1:0)|0,_[3]=_[3]+1295307597+(_[2]>>>0<h[2]>>>0?1:0)|0,_[4]=_[4]+3545052371+(_[3]>>>0<h[3]>>>0?1:0)|0,_[5]=_[5]+886263092+(_[4]>>>0<h[4]>>>0?1:0)|0,_[6]=_[6]+1295307597+(_[5]>>>0<h[5]>>>0?1:0)|0,_[7]=_[7]+3545052371+(_[6]>>>0<h[6]>>>0?1:0)|0,this._b=_[7]>>>0<h[7]>>>0?1:0;for(var b=0;b<8;b++){var x=m[b]+_[b],w=x&65535,P=x>>>16,E=((w*w>>>17)+w*P>>>15)+P*P,k=((x&4294901760)*x|0)+((x&65535)*x|0);c[b]=E^k}m[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,m[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,m[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,m[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,m[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,m[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,m[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,m[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.Rabbit=s._createHelper(p)}(),t.Rabbit})}(Of)),Of.exports}var Mf={exports:{}},m_;function lk(){return m_||(m_=1,function(r,e){(function(t,i,n){r.exports=i(Ft(),ml(),xl(),po(),Qi())})(ut,function(t){return function(){var i=t,n=i.lib,s=n.StreamCipher,a=i.algo,l=[],h=[],c=[],p=a.RabbitLegacy=s.extend({_doReset:function(){var m=this._key.words,_=this.cfg.iv,b=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],x=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var w=0;w<4;w++)g.call(this);for(var w=0;w<8;w++)x[w]^=b[w+4&7];if(_){var P=_.words,E=P[0],k=P[1],C=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,O=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,F=C>>>16|O&4294901760,D=O<<16|C&65535;x[0]^=C,x[1]^=F,x[2]^=O,x[3]^=D,x[4]^=C,x[5]^=F,x[6]^=O,x[7]^=D;for(var w=0;w<4;w++)g.call(this)}},_doProcessBlock:function(m,_){var b=this._X;g.call(this),l[0]=b[0]^b[5]>>>16^b[3]<<16,l[1]=b[2]^b[7]>>>16^b[5]<<16,l[2]=b[4]^b[1]>>>16^b[7]<<16,l[3]=b[6]^b[3]>>>16^b[1]<<16;for(var x=0;x<4;x++)l[x]=(l[x]<<8|l[x]>>>24)&16711935|(l[x]<<24|l[x]>>>8)&4278255360,m[_+x]^=l[x]},blockSize:128/32,ivSize:64/32});function g(){for(var m=this._X,_=this._C,b=0;b<8;b++)h[b]=_[b];_[0]=_[0]+1295307597+this._b|0,_[1]=_[1]+3545052371+(_[0]>>>0<h[0]>>>0?1:0)|0,_[2]=_[2]+886263092+(_[1]>>>0<h[1]>>>0?1:0)|0,_[3]=_[3]+1295307597+(_[2]>>>0<h[2]>>>0?1:0)|0,_[4]=_[4]+3545052371+(_[3]>>>0<h[3]>>>0?1:0)|0,_[5]=_[5]+886263092+(_[4]>>>0<h[4]>>>0?1:0)|0,_[6]=_[6]+1295307597+(_[5]>>>0<h[5]>>>0?1:0)|0,_[7]=_[7]+3545052371+(_[6]>>>0<h[6]>>>0?1:0)|0,this._b=_[7]>>>0<h[7]>>>0?1:0;for(var b=0;b<8;b++){var x=m[b]+_[b],w=x&65535,P=x>>>16,E=((w*w>>>17)+w*P>>>15)+P*P,k=((x&4294901760)*x|0)+((x&65535)*x|0);c[b]=E^k}m[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,m[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,m[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,m[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,m[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,m[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,m[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,m[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.RabbitLegacy=s._createHelper(p)}(),t.RabbitLegacy})}(Mf)),Mf.exports}(function(r,e){(function(t,i,n){r.exports=i(Ft(),Hc(),zT(),UT(),ml(),xl(),kd(),Wm(),WT(),jm(),jT(),XT(),GT(),Pd(),YT(),po(),Qi(),VT(),ZT(),KT(),$T(),qT(),JT(),QT(),ek(),tk(),ik(),rk(),nk(),sk(),ak(),ok(),lk())})(ut,function(t){return t})})(Um);var uk=Um.exports;const hk=Td(uk);var Qf={exports:{}};/* @preserve
 * Leaflet 1.6.0, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2019 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(r,e){(function(t,i){i(e)})(ut,function(t){var i="1.6.0",n=Object.freeze;Object.freeze=function(o){return o};function s(o){var f,v,T,S;for(v=1,T=arguments.length;v<T;v++){S=arguments[v];for(f in S)o[f]=S[f]}return o}var a=Object.create||function(){function o(){}return function(f){return o.prototype=f,new o}}();function l(o,f){var v=Array.prototype.slice;if(o.bind)return o.bind.apply(o,v.call(arguments,1));var T=v.call(arguments,2);return function(){return o.apply(f,T.length?T.concat(v.call(arguments)):arguments)}}var h=0;function c(o){return o._leaflet_id=o._leaflet_id||++h,o._leaflet_id}function p(o,f,v){var T,S,B,re;return re=function(){T=!1,S&&(B.apply(v,S),S=!1)},B=function(){T?S=arguments:(o.apply(v,arguments),setTimeout(re,f),T=!0)},B}function g(o,f,v){var T=f[1],S=f[0],B=T-S;return o===T&&v?o:((o-S)%B+B)%B+S}function m(){return!1}function _(o,f){var v=Math.pow(10,f===void 0?6:f);return Math.round(o*v)/v}function b(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function x(o){return b(o).split(/\s+/)}function w(o,f){o.hasOwnProperty("options")||(o.options=o.options?a(o.options):{});for(var v in f)o.options[v]=f[v];return o.options}function P(o,f,v){var T=[];for(var S in o)T.push(encodeURIComponent(v?S.toUpperCase():S)+"="+encodeURIComponent(o[S]));return(!f||f.indexOf("?")===-1?"?":"&")+T.join("&")}var E=/\{ *([\w_-]+) *\}/g;function k(o,f){return o.replace(E,function(v,T){var S=f[T];if(S===void 0)throw new Error("No value provided for variable "+v);return typeof S=="function"&&(S=S(f)),S})}var C=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function O(o,f){for(var v=0;v<o.length;v++)if(o[v]===f)return v;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function D(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var N=0;function X(o){var f=+new Date,v=Math.max(0,16-(f-N));return N=f+v,window.setTimeout(o,v)}var z=window.requestAnimationFrame||D("RequestAnimationFrame")||X,U=window.cancelAnimationFrame||D("CancelAnimationFrame")||D("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function j(o,f,v){if(v&&z===X)o.call(f);else return z.call(window,l(o,f))}function q(o){o&&U.call(window,o)}var pe=(Object.freeze||Object)({freeze:n,extend:s,create:a,bind:l,lastId:h,stamp:c,throttle:p,wrapNum:g,falseFn:m,formatNum:_,trim:b,splitWords:x,setOptions:w,getParamString:P,template:k,isArray:C,indexOf:O,emptyImageUrl:F,requestFn:z,cancelFn:U,requestAnimFrame:j,cancelAnimFrame:q});function fe(){}fe.extend=function(o){var f=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=f.__super__=this.prototype,T=a(v);T.constructor=f,f.prototype=T;for(var S in this)this.hasOwnProperty(S)&&S!=="prototype"&&S!=="__super__"&&(f[S]=this[S]);return o.statics&&(s(f,o.statics),delete o.statics),o.includes&&(Ee(o.includes),s.apply(null,[T].concat(o.includes)),delete o.includes),T.options&&(o.options=s(a(T.options),o.options)),s(T,o),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var B=0,re=T._initHooks.length;B<re;B++)T._initHooks[B].call(this)}},f},fe.include=function(o){return s(this.prototype,o),this},fe.mergeOptions=function(o){return s(this.prototype.options,o),this},fe.addInitHook=function(o){var f=Array.prototype.slice.call(arguments,1),v=typeof o=="function"?o:function(){this[o].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function Ee(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=C(o)?o:[o];for(var f=0;f<o.length;f++)o[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(o,f,v){if(typeof o=="object")for(var T in o)this._on(T,o[T],f);else{o=x(o);for(var S=0,B=o.length;S<B;S++)this._on(o[S],f,v)}return this},off:function(o,f,v){if(!o)delete this._events;else if(typeof o=="object")for(var T in o)this._off(T,o[T],f);else{o=x(o);for(var S=0,B=o.length;S<B;S++)this._off(o[S],f,v)}return this},_on:function(o,f,v){this._events=this._events||{};var T=this._events[o];T||(T=[],this._events[o]=T),v===this&&(v=void 0);for(var S={fn:f,ctx:v},B=T,re=0,ue=B.length;re<ue;re++)if(B[re].fn===f&&B[re].ctx===v)return;B.push(S)},_off:function(o,f,v){var T,S,B;if(this._events&&(T=this._events[o],!!T)){if(!f){for(S=0,B=T.length;S<B;S++)T[S].fn=m;delete this._events[o];return}if(v===this&&(v=void 0),T)for(S=0,B=T.length;S<B;S++){var re=T[S];if(re.ctx===v&&re.fn===f){re.fn=m,this._firingCount&&(this._events[o]=T=T.slice()),T.splice(S,1);return}}}},fire:function(o,f,v){if(!this.listens(o,v))return this;var T=s({},f,{type:o,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var S=this._events[o];if(S){this._firingCount=this._firingCount+1||1;for(var B=0,re=S.length;B<re;B++){var ue=S[B];ue.fn.call(ue.ctx||this,T)}this._firingCount--}}return v&&this._propagateEvent(T),this},listens:function(o,f){var v=this._events&&this._events[o];if(v&&v.length)return!0;if(f){for(var T in this._eventParents)if(this._eventParents[T].listens(o,f))return!0}return!1},once:function(o,f,v){if(typeof o=="object"){for(var T in o)this.once(T,o[T],f);return this}var S=l(function(){this.off(o,f,v).off(o,S,v)},this);return this.on(o,f,v).on(o,S,v)},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[c(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[c(o)],this},_propagateEvent:function(o){for(var f in this._eventParents)this._eventParents[f].fire(o.type,s({layer:o.target,propagatedFrom:o.target},o),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var De=fe.extend(de);function ee(o,f,v){this.x=v?Math.round(o):o,this.y=v?Math.round(f):f}var Fe=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};ee.prototype={clone:function(){return new ee(this.x,this.y)},add:function(o){return this.clone()._add(se(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(se(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new ee(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new ee(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Fe(this.x),this.y=Fe(this.y),this},distanceTo:function(o){o=se(o);var f=o.x-this.x,v=o.y-this.y;return Math.sqrt(f*f+v*v)},equals:function(o){return o=se(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=se(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function se(o,f,v){return o instanceof ee?o:C(o)?new ee(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new ee(o.x,o.y):new ee(o,f,v)}function R(o,f){if(o)for(var v=f?[o,f]:o,T=0,S=v.length;T<S;T++)this.extend(v[T])}R.prototype={extend:function(o){return o=se(o),!this.min&&!this.max?(this.min=o.clone(),this.max=o.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(o.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(o.y,this.max.y)),this},getCenter:function(o){return new ee((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return new ee(this.min.x,this.max.y)},getTopRight:function(){return new ee(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var f,v;return typeof o[0]=="number"||o instanceof ee?o=se(o):o=J(o),o instanceof R?(f=o.min,v=o.max):f=v=o,f.x>=this.min.x&&v.x<=this.max.x&&f.y>=this.min.y&&v.y<=this.max.y},intersects:function(o){o=J(o);var f=this.min,v=this.max,T=o.min,S=o.max,B=S.x>=f.x&&T.x<=v.x,re=S.y>=f.y&&T.y<=v.y;return B&&re},overlaps:function(o){o=J(o);var f=this.min,v=this.max,T=o.min,S=o.max,B=S.x>f.x&&T.x<v.x,re=S.y>f.y&&T.y<v.y;return B&&re},isValid:function(){return!!(this.min&&this.max)}};function J(o,f){return!o||o instanceof R?o:new R(o,f)}function Y(o,f){if(o)for(var v=f?[o,f]:o,T=0,S=v.length;T<S;T++)this.extend(v[T])}Y.prototype={extend:function(o){var f=this._southWest,v=this._northEast,T,S;if(o instanceof he)T=o,S=o;else if(o instanceof Y){if(T=o._southWest,S=o._northEast,!T||!S)return this}else return o?this.extend(Pe(o)||ie(o)):this;return!f&&!v?(this._southWest=new he(T.lat,T.lng),this._northEast=new he(S.lat,S.lng)):(f.lat=Math.min(T.lat,f.lat),f.lng=Math.min(T.lng,f.lng),v.lat=Math.max(S.lat,v.lat),v.lng=Math.max(S.lng,v.lng)),this},pad:function(o){var f=this._southWest,v=this._northEast,T=Math.abs(f.lat-v.lat)*o,S=Math.abs(f.lng-v.lng)*o;return new Y(new he(f.lat-T,f.lng-S),new he(v.lat+T,v.lng+S))},getCenter:function(){return new he((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new he(this.getNorth(),this.getWest())},getSouthEast:function(){return new he(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof he||"lat"in o?o=Pe(o):o=ie(o);var f=this._southWest,v=this._northEast,T,S;return o instanceof Y?(T=o.getSouthWest(),S=o.getNorthEast()):T=S=o,T.lat>=f.lat&&S.lat<=v.lat&&T.lng>=f.lng&&S.lng<=v.lng},intersects:function(o){o=ie(o);var f=this._southWest,v=this._northEast,T=o.getSouthWest(),S=o.getNorthEast(),B=S.lat>=f.lat&&T.lat<=v.lat,re=S.lng>=f.lng&&T.lng<=v.lng;return B&&re},overlaps:function(o){o=ie(o);var f=this._southWest,v=this._northEast,T=o.getSouthWest(),S=o.getNorthEast(),B=S.lat>f.lat&&T.lat<v.lat,re=S.lng>f.lng&&T.lng<v.lng;return B&&re},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,f){return o?(o=ie(o),this._southWest.equals(o.getSouthWest(),f)&&this._northEast.equals(o.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ie(o,f){return o instanceof Y?o:new Y(o,f)}function he(o,f,v){if(isNaN(o)||isNaN(f))throw new Error("Invalid LatLng object: ("+o+", "+f+")");this.lat=+o,this.lng=+f,v!==void 0&&(this.alt=+v)}he.prototype={equals:function(o,f){if(!o)return!1;o=Pe(o);var v=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return v<=(f===void 0?1e-9:f)},toString:function(o){return"LatLng("+_(this.lat,o)+", "+_(this.lng,o)+")"},distanceTo:function(o){return Oe.distance(this,Pe(o))},wrap:function(){return Oe.wrapLatLng(this)},toBounds:function(o){var f=180*o/40075017,v=f/Math.cos(Math.PI/180*this.lat);return ie([this.lat-f,this.lng-v],[this.lat+f,this.lng+v])},clone:function(){return new he(this.lat,this.lng,this.alt)}};function Pe(o,f,v){return o instanceof he?o:C(o)&&typeof o[0]!="object"?o.length===3?new he(o[0],o[1],o[2]):o.length===2?new he(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new he(o.lat,"lng"in o?o.lng:o.lon,o.alt):f===void 0?null:new he(o,f,v)}var we={latLngToPoint:function(o,f){var v=this.projection.project(o),T=this.scale(f);return this.transformation._transform(v,T)},pointToLatLng:function(o,f){var v=this.scale(f),T=this.transformation.untransform(o,v);return this.projection.unproject(T)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var f=this.projection.bounds,v=this.scale(o),T=this.transformation.transform(f.min,v),S=this.transformation.transform(f.max,v);return new R(T,S)},infinite:!1,wrapLatLng:function(o){var f=this.wrapLng?g(o.lng,this.wrapLng,!0):o.lng,v=this.wrapLat?g(o.lat,this.wrapLat,!0):o.lat,T=o.alt;return new he(v,f,T)},wrapLatLngBounds:function(o){var f=o.getCenter(),v=this.wrapLatLng(f),T=f.lat-v.lat,S=f.lng-v.lng;if(T===0&&S===0)return o;var B=o.getSouthWest(),re=o.getNorthEast(),ue=new he(B.lat-T,B.lng-S),be=new he(re.lat-T,re.lng-S);return new Y(ue,be)}},Oe=s({},we,{wrapLng:[-180,180],R:6371e3,distance:function(o,f){var v=Math.PI/180,T=o.lat*v,S=f.lat*v,B=Math.sin((f.lat-o.lat)*v/2),re=Math.sin((f.lng-o.lng)*v/2),ue=B*B+Math.cos(T)*Math.cos(S)*re*re,be=2*Math.atan2(Math.sqrt(ue),Math.sqrt(1-ue));return this.R*be}}),Le=6378137,it={R:Le,MAX_LATITUDE:85.0511287798,project:function(o){var f=Math.PI/180,v=this.MAX_LATITUDE,T=Math.max(Math.min(v,o.lat),-v),S=Math.sin(T*f);return new ee(this.R*o.lng*f,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(o){var f=180/Math.PI;return new he((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*f,o.x*f/this.R)},bounds:function(){var o=Le*Math.PI;return new R([-o,-o],[o,o])}()};function te(o,f,v,T){if(C(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=f,this._c=v,this._d=T}te.prototype={transform:function(o,f){return this._transform(o.clone(),f)},_transform:function(o,f){return f=f||1,o.x=f*(this._a*o.x+this._b),o.y=f*(this._c*o.y+this._d),o},untransform:function(o,f){return f=f||1,new ee((o.x/f-this._b)/this._a,(o.y/f-this._d)/this._c)}};function ft(o,f,v,T){return new te(o,f,v,T)}var Ge=s({},Oe,{code:"EPSG:3857",projection:it,transformation:function(){var o=.5/(Math.PI*it.R);return ft(o,.5,-o,.5)}()}),_t=s({},Ge,{code:"EPSG:900913"});function rt(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Be(o,f){var v="",T,S,B,re,ue,be;for(T=0,B=o.length;T<B;T++){for(ue=o[T],S=0,re=ue.length;S<re;S++)be=ue[S],v+=(S?"L":"M")+be.x+" "+be.y;v+=f?Pn?"z":"x":""}return v||"M0 0"}var St=document.documentElement.style,ii="ActiveXObject"in window,Ht=ii&&!document.addEventListener,vt="msLaunchUri"in navigator&&!("documentMode"in document),zt=Ri("webkit"),Ut=Ri("android"),Kt=Ri("android 2")||Ri("android 3"),Ti=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ki=Ut&&Ri("Google")&&Ti<537&&!("AudioNode"in window),pi=!!window.opera,Bt=Ri("chrome"),gi=Ri("gecko")&&!zt&&!pi&&!ii,nt=!Bt&&Ri("safari"),Pt=Ri("phantom"),Jt="OTransition"in St,Xt=navigator.platform.indexOf("Win")===0,ji=ii&&"transition"in St,qr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Kt,Gn="MozPerspective"in St,Pi=!window.L_DISABLE_3D&&(ji||qr||Gn)&&!Jt&&!Pt,Lr=typeof orientation<"u"||Ri("mobile"),Gs=Lr&&zt,gs=Lr&&qr,pr=!window.PointerEvent&&window.MSPointerEvent,Mi=!zt&&!!(window.PointerEvent||pr),Fi=!window.L_NO_TOUCH&&(Mi||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Ys=Lr&&pi,Ta=Lr&&gi,gr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Or=function(){var o=!1;try{var f=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",m,f),window.removeEventListener("testPassiveEventSupport",m,f)}catch{}return o},Vs=function(){return!!document.createElement("canvas").getContext}(),Pn=!!(document.createElementNS&&rt("svg").createSVGRect),Yn=!Pn&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var f=o.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}();function Ri(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var _i=(Object.freeze||Object)({ie:ii,ielt9:Ht,edge:vt,webkit:zt,android:Ut,android23:Kt,androidStock:ki,opera:pi,chrome:Bt,gecko:gi,safari:nt,phantom:Pt,opera12:Jt,win:Xt,ie3d:ji,webkit3d:qr,gecko3d:Gn,any3d:Pi,mobile:Lr,mobileWebkit:Gs,mobileWebkit3d:gs,msPointer:pr,pointer:Mi,touch:Fi,mobileOpera:Ys,mobileGecko:Ta,retina:gr,passiveEvents:Or,canvas:Vs,svg:Pn,vml:Yn}),Xi=pr?"MSPointerDown":"pointerdown",Vn=pr?"MSPointerMove":"pointermove",_s=pr?"MSPointerUp":"pointerup",I=pr?"MSPointerCancel":"pointercancel",Z=["INPUT","SELECT","OPTION"],G={},V=!1,K=0;function Q(o,f,v,T){return f==="touchstart"?Te(o,v,T):f==="touchmove"?Ne(o,v,T):f==="touchend"&&We(o,v,T),this}function _e(o,f,v){var T=o["_leaflet_"+f+v];return f==="touchstart"?o.removeEventListener(Xi,T,!1):f==="touchmove"?o.removeEventListener(Vn,T,!1):f==="touchend"&&(o.removeEventListener(_s,T,!1),o.removeEventListener(I,T,!1)),this}function Te(o,f,v){var T=l(function(S){if(S.pointerType!=="mouse"&&S.MSPOINTER_TYPE_MOUSE&&S.pointerType!==S.MSPOINTER_TYPE_MOUSE)if(Z.indexOf(S.target.tagName)<0)Rr(S);else return;Re(S,f)});o["_leaflet_touchstart"+v]=T,o.addEventListener(Xi,T,!1),V||(document.documentElement.addEventListener(Xi,ge,!0),document.documentElement.addEventListener(Vn,me,!0),document.documentElement.addEventListener(_s,xe,!0),document.documentElement.addEventListener(I,xe,!0),V=!0)}function ge(o){G[o.pointerId]=o,K++}function me(o){G[o.pointerId]&&(G[o.pointerId]=o)}function xe(o){delete G[o.pointerId],K--}function Re(o,f){o.touches=[];for(var v in G)o.touches.push(G[v]);o.changedTouches=[o],f(o)}function Ne(o,f,v){var T=function(S){(S.pointerType===S.MSPOINTER_TYPE_MOUSE||S.pointerType==="mouse")&&S.buttons===0||Re(S,f)};o["_leaflet_touchmove"+v]=T,o.addEventListener(Vn,T,!1)}function We(o,f,v){var T=function(S){Re(S,f)};o["_leaflet_touchend"+v]=T,o.addEventListener(_s,T,!1),o.addEventListener(I,T,!1)}var Ie=pr?"MSPointerDown":Mi?"pointerdown":"touchstart",He=pr?"MSPointerUp":Mi?"pointerup":"touchend",$e="_leaflet_";function Gt(o,f,v){var T,S,B=!1,re=250;function ue(Se){var je;if(Mi){if(!vt||Se.pointerType==="mouse")return;je=K}else je=Se.touches.length;if(!(je>1)){var Ke=Date.now(),yt=Ke-(T||Ke);S=Se.touches?Se.touches[0]:Se,B=yt>0&&yt<=re,T=Ke}}function be(Se){if(B&&!S.cancelBubble){if(Mi){if(!vt||Se.pointerType==="mouse")return;var je={},Ke,yt;for(yt in S)Ke=S[yt],je[yt]=Ke&&Ke.bind?Ke.bind(S):Ke;S=je}S.type="dblclick",S.button=0,f(S),T=null}}return o[$e+Ie+v]=ue,o[$e+He+v]=be,o[$e+"dblclick"+v]=f,o.addEventListener(Ie,ue,Or?{passive:!1}:!1),o.addEventListener(He,be,Or?{passive:!1}:!1),o.addEventListener("dblclick",f,!1),this}function Yt(o,f){var v=o[$e+Ie+f],T=o[$e+He+f],S=o[$e+"dblclick"+f];return o.removeEventListener(Ie,v,Or?{passive:!1}:!1),o.removeEventListener(He,T,Or?{passive:!1}:!1),vt||o.removeEventListener("dblclick",S,!1),this}var ri=Aa(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Mr=Aa(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),En=Mr==="webkitTransition"||Mr==="OTransition"?Mr+"End":"transitionend";function Zn(o){return typeof o=="string"?document.getElementById(o):o}function _r(o,f){var v=o.style[f]||o.currentStyle&&o.currentStyle[f];if((!v||v==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(o,null);v=T?T[f]:null}return v==="auto"?null:v}function wt(o,f,v){var T=document.createElement(o);return T.className=f||"",v&&v.appendChild(T),T}function Et(o){var f=o.parentNode;f&&f.removeChild(o)}function ka(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function ms(o){var f=o.parentNode;f&&f.lastChild!==o&&f.appendChild(o)}function xs(o){var f=o.parentNode;f&&f.firstChild!==o&&f.insertBefore(o,f.firstChild)}function Pa(o,f){if(o.classList!==void 0)return o.classList.contains(f);var v=Ea(o);return v.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(v)}function ht(o,f){if(o.classList!==void 0)for(var v=x(f),T=0,S=v.length;T<S;T++)o.classList.add(v[T]);else if(!Pa(o,f)){var B=Ea(o);Zs(o,(B?B+" ":"")+f)}}function Qt(o,f){o.classList!==void 0?o.classList.remove(f):Zs(o,b((" "+Ea(o)+" ").replace(" "+f+" "," ")))}function Zs(o,f){o.className.baseVal===void 0?o.className=f:o.className.baseVal=f}function Ea(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Fr(o,f){"opacity"in o.style?o.style.opacity=f:"filter"in o.style&&ih(o,f)}function ih(o,f){var v=!1,T="DXImageTransform.Microsoft.Alpha";try{v=o.filters.item(T)}catch{if(f===1)return}f=Math.round(f*100),v?(v.Enabled=f!==100,v.Opacity=f):o.style.filter+=" progid:"+T+"(opacity="+f+")"}function Aa(o){for(var f=document.documentElement.style,v=0;v<o.length;v++)if(o[v]in f)return o[v];return!1}function An(o,f,v){var T=f||new ee(0,0);o.style[ri]=(ji?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(v?" scale("+v+")":"")}function oi(o,f){o._leaflet_pos=f,Pi?An(o,f):(o.style.left=f.x+"px",o.style.top=f.y+"px")}function Cn(o){return o._leaflet_pos||new ee(0,0)}var vs,ys,Kn;if("onselectstart"in document)vs=function(){mt(window,"selectstart",Rr)},ys=function(){ni(window,"selectstart",Rr)};else{var Ks=Aa(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);vs=function(){if(Ks){var o=document.documentElement.style;Kn=o[Ks],o[Ks]="none"}},ys=function(){Ks&&(document.documentElement.style[Ks]=Kn,Kn=void 0)}}function bo(){mt(window,"dragstart",Rr)}function kl(){ni(window,"dragstart",Rr)}var Ca,wo;function To(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(Sa(),Ca=o,wo=o.style.outline,o.style.outline="none",mt(window,"keydown",Sa))}function Sa(){Ca&&(Ca.style.outline=wo,Ca=void 0,wo=void 0,ni(window,"keydown",Sa))}function rh(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function Pl(o){var f=o.getBoundingClientRect();return{x:f.width/o.offsetWidth||1,y:f.height/o.offsetHeight||1,boundingClientRect:f}}var $c=(Object.freeze||Object)({TRANSFORM:ri,TRANSITION:Mr,TRANSITION_END:En,get:Zn,getStyle:_r,create:wt,remove:Et,empty:ka,toFront:ms,toBack:xs,hasClass:Pa,addClass:ht,removeClass:Qt,setClass:Zs,getClass:Ea,setOpacity:Fr,testProp:Aa,setTransform:An,setPosition:oi,getPosition:Cn,disableTextSelection:vs,enableTextSelection:ys,disableImageDrag:bo,enableImageDrag:kl,preventOutline:To,restoreOutline:Sa,getSizedParentNode:rh,getScale:Pl});function mt(o,f,v,T){if(typeof f=="object")for(var S in f)ko(o,S,f[S],v);else{f=x(f);for(var B=0,re=f.length;B<re;B++)ko(o,f[B],v,T)}return this}var Jr="_leaflet_events";function ni(o,f,v,T){if(typeof f=="object")for(var S in f)El(o,S,f[S],v);else if(f){f=x(f);for(var B=0,re=f.length;B<re;B++)El(o,f[B],v,T)}else{for(var ue in o[Jr])El(o,ue,o[Jr][ue]);delete o[Jr]}return this}function ko(o,f,v,T){var S=f+c(v)+(T?"_"+c(T):"");if(o[Jr]&&o[Jr][S])return this;var B=function(ue){return v.call(T||o,ue||window.event)},re=B;Mi&&f.indexOf("touch")===0?Q(o,f,B,S):Fi&&f==="dblclick"&&Gt&&!(Mi&&Bt)?Gt(o,B,S):"addEventListener"in o?f==="mousewheel"?o.addEventListener("onwheel"in o?"wheel":"mousewheel",B,Or?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(B=function(ue){ue=ue||window.event,Po(o,ue)&&re(ue)},o.addEventListener(f==="mouseenter"?"mouseover":"mouseout",B,!1)):(f==="click"&&Ut&&(B=function(ue){qc(ue,re)}),o.addEventListener(f,B,!1)):"attachEvent"in o&&o.attachEvent("on"+f,B),o[Jr]=o[Jr]||{},o[Jr][S]=B}function El(o,f,v,T){var S=f+c(v)+(T?"_"+c(T):""),B=o[Jr]&&o[Jr][S];if(!B)return this;Mi&&f.indexOf("touch")===0?_e(o,f,S):Fi&&f==="dblclick"&&Yt&&!(Mi&&Bt)?Yt(o,S):"removeEventListener"in o?f==="mousewheel"?o.removeEventListener("onwheel"in o?"wheel":"mousewheel",B,Or?{passive:!1}:!1):o.removeEventListener(f==="mouseenter"?"mouseover":f==="mouseleave"?"mouseout":f,B,!1):"detachEvent"in o&&o.detachEvent("on"+f,B),o[Jr][S]=null}function Sn(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,Dl(o),this}function Al(o){return ko(o,"mousewheel",Sn),this}function Da(o){return mt(o,"mousedown touchstart dblclick",Sn),ko(o,"click",Sl),this}function Rr(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function hn(o){return Rr(o),Sn(o),this}function nh(o,f){if(!f)return new ee(o.clientX,o.clientY);var v=Pl(f),T=v.boundingClientRect;return new ee((o.clientX-T.left)/v.x-f.clientLeft,(o.clientY-T.top)/v.y-f.clientTop)}var Vt=Xt&&Bt?2*window.devicePixelRatio:gi?window.devicePixelRatio:1;function Wt(o){return vt?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/Vt:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}var Cl={};function Sl(o){Cl[o.type]=!0}function Dl(o){var f=Cl[o.type];return Cl[o.type]=!1,f}function Po(o,f){var v=f.relatedTarget;if(!v)return!0;try{for(;v&&v!==o;)v=v.parentNode}catch{return!1}return v!==o}var Ll;function qc(o,f){var v=o.timeStamp||o.originalEvent&&o.originalEvent.timeStamp,T=Ll&&v-Ll;if(T&&T>100&&T<500||o.target._simulatedClick&&!o._simulated){hn(o);return}Ll=v,f(o)}var sh=(Object.freeze||Object)({on:mt,off:ni,stopPropagation:Sn,disableScrollPropagation:Al,disableClickPropagation:Da,preventDefault:Rr,stop:hn,getMousePosition:nh,getWheelDelta:Wt,fakeStop:Sl,skipped:Dl,isExternalTarget:Po,addListener:mt,removeListener:ni}),ah=De.extend({run:function(o,f,v,T){this.stop(),this._el=o,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=Cn(o),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=j(this._animate,this),this._step()},_step:function(o){var f=+new Date-this._startTime,v=this._duration*1e3;f<v?this._runFrame(this._easeOut(f/v),o):(this._runFrame(1),this._complete())},_runFrame:function(o,f){var v=this._startPos.add(this._offset.multiplyBy(o));f&&v._round(),oi(this._el,v),this.fire("step")},_complete:function(){q(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),qe=De.extend({options:{crs:Ge,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,f){f=w(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(Pe(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Mr&&Pi&&!Ys&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),mt(this._proxy,En,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,f,v){if(f=f===void 0?this._zoom:this._limitZoom(f),o=this._limitCenter(Pe(o),f,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=s({animate:v.animate},v.zoom),v.pan=s({animate:v.animate,duration:v.duration},v.pan));var T=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,f,v.zoom):this._tryAnimatedPan(o,v.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(o,f),this},setZoom:function(o,f){return this._loaded?this.setView(this.getCenter(),o,{zoom:f}):(this._zoom=o,this)},zoomIn:function(o,f){return o=o||(Pi?this.options.zoomDelta:1),this.setZoom(this._zoom+o,f)},zoomOut:function(o,f){return o=o||(Pi?this.options.zoomDelta:1),this.setZoom(this._zoom-o,f)},setZoomAround:function(o,f,v){var T=this.getZoomScale(f),S=this.getSize().divideBy(2),B=o instanceof ee?o:this.latLngToContainerPoint(o),re=B.subtract(S).multiplyBy(1-1/T),ue=this.containerPointToLatLng(S.add(re));return this.setView(ue,f,{zoom:v})},_getBoundsCenterZoom:function(o,f){f=f||{},o=o.getBounds?o.getBounds():ie(o);var v=se(f.paddingTopLeft||f.padding||[0,0]),T=se(f.paddingBottomRight||f.padding||[0,0]),S=this.getBoundsZoom(o,!1,v.add(T));if(S=typeof f.maxZoom=="number"?Math.min(f.maxZoom,S):S,S===1/0)return{center:o.getCenter(),zoom:S};var B=T.subtract(v).divideBy(2),re=this.project(o.getSouthWest(),S),ue=this.project(o.getNorthEast(),S),be=this.unproject(re.add(ue).divideBy(2).add(B),S);return{center:be,zoom:S}},fitBounds:function(o,f){if(o=ie(o),!o.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(o,f);return this.setView(v.center,v.zoom,f)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,f){return this.setView(o,this._zoom,{pan:f})},panBy:function(o,f){if(o=se(o).round(),f=f||{},!o.x&&!o.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ah,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,v,f.duration||.25,f.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,f,v){if(v=v||{},v.animate===!1||!Pi)return this.setView(o,f,v);this._stop();var T=this.project(this.getCenter()),S=this.project(o),B=this.getSize(),re=this._zoom;o=Pe(o),f=f===void 0?re:f;var ue=Math.max(B.x,B.y),be=ue*this.getZoomScale(re,f),Se=S.distanceTo(T)||1,je=1.42,Ke=je*je;function yt(ui){var Ps=ui?-1:1,za=ui?be:ue,kh=be*be-ue*ue+Ps*Ke*Ke*Se*Se,H=2*za*Ke*Se,rs=kh/H,Ua=Math.sqrt(rs*rs+1)-rs,Wr=Ua<1e-9?-18:Math.log(Ua);return Wr}function vr(ui){return(Math.exp(ui)-Math.exp(-ui))/2}function On(ui){return(Math.exp(ui)+Math.exp(-ui))/2}function Mn(ui){return vr(ui)/On(ui)}var Ur=yt(0);function ks(ui){return ue*(On(Ur)/On(Ur+je*ui))}function Yo(ui){return ue*(On(Ur)*Mn(Ur+je*ui)-vr(Ur))/Ke}function ia(ui){return 1-Math.pow(1-ui,1.5)}var l0=Date.now(),wh=(yt(1)-Ur)/je,u0=v.duration?1e3*v.duration:1e3*wh*.8;function Th(){var ui=(Date.now()-l0)/u0,Ps=ia(ui)*wh;ui<=1?(this._flyToFrame=j(Th,this),this._move(this.unproject(T.add(S.subtract(T).multiplyBy(Yo(Ps)/Se)),re),this.getScaleZoom(ue/ks(Ps),re),{flyTo:!0})):this._move(o,f)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Th.call(this),this},flyToBounds:function(o,f){var v=this._getBoundsCenterZoom(o,f);return this.flyTo(v.center,v.zoom,f)},setMaxBounds:function(o){if(o=ie(o),o.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);return this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(o){var f=this.options.minZoom;return this.options.minZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var f=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,f){this._enforcingBounds=!0;var v=this.getCenter(),T=this._limitCenter(v,this._zoom,ie(o));return v.equals(T)||this.panTo(T,f),this._enforcingBounds=!1,this},panInside:function(o,f){f=f||{};var v=se(f.paddingTopLeft||f.padding||[0,0]),T=se(f.paddingBottomRight||f.padding||[0,0]),S=this.getCenter(),B=this.project(S),re=this.project(o),ue=this.getPixelBounds(),be=ue.getSize().divideBy(2),Se=J([ue.min.add(v),ue.max.subtract(T)]);if(!Se.contains(re)){this._enforcingBounds=!0;var je=B.subtract(re),Ke=se(re.x+je.x,re.y+je.y);(re.x<Se.min.x||re.x>Se.max.x)&&(Ke.x=B.x-je.x,je.x>0?Ke.x+=be.x-v.x:Ke.x-=be.x-T.x),(re.y<Se.min.y||re.y>Se.max.y)&&(Ke.y=B.y-je.y,je.y>0?Ke.y+=be.y-v.y:Ke.y-=be.y-T.y),this.panTo(this.unproject(Ke),f),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=s({animate:!1,pan:!0},o===!0?{animate:!0}:o);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),T=f.divideBy(2).round(),S=v.divideBy(2).round(),B=T.subtract(S);return!B.x&&!B.y?this:(o.animate&&o.pan?this.panBy(B):(o.pan&&this._rawPanBy(B),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=s({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,v,o):navigator.geolocation.getCurrentPosition(f,v,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){var f=o.code,v=o.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+v+"."})},_handleGeolocationResponse:function(o){var f=o.coords.latitude,v=o.coords.longitude,T=new he(f,v),S=T.toBounds(o.coords.accuracy*2),B=this._locateOptions;if(B.setView){var re=this.getBoundsZoom(S);this.setView(T,B.maxZoom?Math.min(re,B.maxZoom):re)}var ue={latlng:T,bounds:S,timestamp:o.timestamp};for(var be in o.coords)typeof o.coords[be]=="number"&&(ue[be]=o.coords[be]);this.fire("locationfound",ue)},addHandler:function(o,f){if(!f)return this;var v=this[o]=new f(this);return this._handlers.push(v),this.options[o]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(q(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)Et(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,f){var v="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),T=wt("div",v,f||this._mapPane);return o&&(this._panes[o]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),f=this.unproject(o.getBottomLeft()),v=this.unproject(o.getTopRight());return new Y(f,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,f,v){o=ie(o),v=se(v||[0,0]);var T=this.getZoom()||0,S=this.getMinZoom(),B=this.getMaxZoom(),re=o.getNorthWest(),ue=o.getSouthEast(),be=this.getSize().subtract(v),Se=J(this.project(ue,T),this.project(re,T)).getSize(),je=Pi?this.options.zoomSnap:1,Ke=be.x/Se.x,yt=be.y/Se.y,vr=f?Math.max(Ke,yt):Math.min(Ke,yt);return T=this.getScaleZoom(vr,T),je&&(T=Math.round(T/(je/100))*(je/100),T=f?Math.ceil(T/je)*je:Math.floor(T/je)*je),Math.max(S,Math.min(B,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ee(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,f){var v=this._getTopLeftPoint(o,f);return new R(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,f){var v=this.options.crs;return f=f===void 0?this._zoom:f,v.scale(o)/v.scale(f)},getScaleZoom:function(o,f){var v=this.options.crs;f=f===void 0?this._zoom:f;var T=v.zoom(o*v.scale(f));return isNaN(T)?1/0:T},project:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(Pe(o),f)},unproject:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(se(o),f)},layerPointToLatLng:function(o){var f=se(o).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(o){var f=this.project(Pe(o))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(Pe(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(ie(o))},distance:function(o,f){return this.options.crs.distance(Pe(o),Pe(f))},containerPointToLayerPoint:function(o){return se(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return se(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var f=this.containerPointToLayerPoint(se(o));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Pe(o)))},mouseEventToContainerPoint:function(o){return nh(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var f=this._container=Zn(o);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");mt(f,"scroll",this._onScroll,this),this._containerId=c(f)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pi,ht(o,"leaflet-container"+(Fi?" leaflet-touch":"")+(gr?" leaflet-retina":"")+(Ht?" leaflet-oldie":"")+(nt?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=_r(o,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),oi(this._mapPane,new ee(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(o.markerPane,"leaflet-zoom-hide"),ht(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,f){oi(this._mapPane,new ee(0,0));var v=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var T=this._zoom!==f;this._moveStart(T,!1)._move(o,f)._moveEnd(T),this.fire("viewreset"),v&&this.fire("load")},_moveStart:function(o,f){return o&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(o,f,v){f===void 0&&(f=this._zoom);var T=this._zoom!==f;return this._zoom=f,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),(T||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return q(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){oi(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[c(this._container)]=this;var f=o?ni:mt;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),Pi&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){q(this._resizeRequest),this._resizeRequest=j(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,f){for(var v=[],T,S=f==="mouseout"||f==="mouseover",B=o.target||o.srcElement,re=!1;B;){if(T=this._targets[c(B)],T&&(f==="click"||f==="preclick")&&!o._simulated&&this._draggableMoved(T)){re=!0;break}if(T&&T.listens(f,!0)&&(S&&!Po(B,o)||(v.push(T),S))||B===this._container)break;B=B.parentNode}return!v.length&&!re&&!S&&Po(B,o)&&(v=[this]),v},_handleDOMEvent:function(o){if(!(!this._loaded||Dl(o))){var f=o.type;(f==="mousedown"||f==="keypress"||f==="keyup"||f==="keydown")&&To(o.target||o.srcElement),this._fireDOMEvent(o,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,f,v){if(o.type==="click"){var T=s({},o);T.type="preclick",this._fireDOMEvent(T,T.type,v)}if(!o._stopped&&(v=(v||[]).concat(this._findEventTargets(o,f)),!!v.length)){var S=v[0];f==="contextmenu"&&S.listens(f,!0)&&Rr(o);var B={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var re=S.getLatLng&&(!S._radius||S._radius<=10);B.containerPoint=re?this.latLngToContainerPoint(S.getLatLng()):this.mouseEventToContainerPoint(o),B.layerPoint=this.containerPointToLayerPoint(B.containerPoint),B.latlng=re?S.getLatLng():this.layerPointToLatLng(B.layerPoint)}for(var ue=0;ue<v.length;ue++)if(v[ue].fire(f,B,!0),B.originalEvent._stopped||v[ue].options.bubblingMouseEvents===!1&&O(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,f=this._handlers.length;o<f;o++)this._handlers[o].disable()},whenReady:function(o,f){return this._loaded?o.call(f||this,{target:this}):this.on("load",o,f),this},_getMapPanePos:function(){return Cn(this._mapPane)||new ee(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,f){var v=o&&f!==void 0?this._getNewPixelOrigin(o,f):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,f){var v=this.getSize()._divideBy(2);return this.project(o,f)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,f,v){var T=this._getNewPixelOrigin(v,f);return this.project(o,f)._subtract(T)},_latLngBoundsToNewLayerBounds:function(o,f,v){var T=this._getNewPixelOrigin(v,f);return J([this.project(o.getSouthWest(),f)._subtract(T),this.project(o.getNorthWest(),f)._subtract(T),this.project(o.getSouthEast(),f)._subtract(T),this.project(o.getNorthEast(),f)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,f,v){if(!v)return o;var T=this.project(o,f),S=this.getSize().divideBy(2),B=new R(T.subtract(S),T.add(S)),re=this._getBoundsOffset(B,v,f);return re.round().equals([0,0])?o:this.unproject(T.add(re),f)},_limitOffset:function(o,f){if(!f)return o;var v=this.getPixelBounds(),T=new R(v.min.add(o),v.max.add(o));return o.add(this._getBoundsOffset(T,f))},_getBoundsOffset:function(o,f,v){var T=J(this.project(f.getNorthEast(),v),this.project(f.getSouthWest(),v)),S=T.min.subtract(o.min),B=T.max.subtract(o.max),re=this._rebound(S.x,-B.x),ue=this._rebound(S.y,-B.y);return new ee(re,ue)},_rebound:function(o,f){return o+f>0?Math.round(o-f)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(f))},_limitZoom:function(o){var f=this.getMinZoom(),v=this.getMaxZoom(),T=Pi?this.options.zoomSnap:1;return T&&(o=Math.round(o/T)*T),Math.max(f,Math.min(v,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Qt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,f){var v=this._getCenterOffset(o)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,f),!0)},_createAnimProxy:function(){var o=this._proxy=wt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(f){var v=ri,T=this._proxy.style[v];An(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),T===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),f=this.getZoom();An(this._proxy,this.project(o,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,f,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(f),S=this._getCenterOffset(o)._divideBy(1-1/T);return v.animate!==!0&&!this.getSize().contains(S)?!1:(j(function(){this._moveStart(!0,!1)._animateZoom(o,f,!0)},this),!0)},_animateZoom:function(o,f,v,T){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=f,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:f,noUpdate:T}),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Qt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),j(function(){this._moveEnd(!0)},this))}});function Ol(o,f){return new qe(o,f)}var Ii=fe.extend({options:{position:"topright"},initialize:function(o){w(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var f=this._map;return f&&f.removeControl(this),this.options.position=o,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var f=this._container=this.onAdd(o),v=this.getPosition(),T=o._controlCorners[v];return ht(f,"leaflet-control"),v.indexOf("bottom")!==-1?T.insertBefore(f,T.firstChild):T.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),$s=function(o){return new Ii(o)};qe.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},f="leaflet-",v=this._controlContainer=wt("div",f+"control-container",this._container);function T(S,B){var re=f+S+" "+f+B;o[S+B]=wt("div",re,v)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)Et(this._controlCorners[o]);Et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Eo=Ii.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,f,v,T){return v<T?-1:T<v?1:0}},initialize:function(o,f,v){w(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var T in o)this._addLayer(o[T],T);for(T in f)this._addLayer(f[T],T,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Ii.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,f){return this._addLayer(o,f),this._map?this._update():this},addOverlay:function(o,f){return this._addLayer(o,f,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var f=this._getLayer(c(o));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):Qt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Qt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",f=this._container=wt("div",o),v=this.options.collapsed;f.setAttribute("aria-haspopup",!0),Da(f),Al(f);var T=this._section=wt("section",o+"-list");v&&(this._map.on("click",this.collapse,this),Ut||mt(f,{mouseenter:this.expand,mouseleave:this.collapse},this));var S=this._layersLink=wt("a",o+"-toggle",f);S.href="#",S.title="Layers",Fi?(mt(S,"click",hn),mt(S,"click",this.expand,this)):mt(S,"focus",this.expand,this),v||this.expand(),this._baseLayersList=wt("div",o+"-base",T),this._separator=wt("div",o+"-separator",T),this._overlaysList=wt("div",o+"-overlays",T),f.appendChild(T)},_getLayer:function(o){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&c(this._layers[f].layer)===o)return this._layers[f]},_addLayer:function(o,f,v){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:f,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(T,S){return this.options.sortFunction(T.layer,S.layer,T.name,S.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ka(this._baseLayersList),ka(this._overlaysList),this._layerControlInputs=[];var o,f,v,T,S=0;for(v=0;v<this._layers.length;v++)T=this._layers[v],this._addItem(T),f=f||T.overlay,o=o||!T.overlay,S+=T.overlay?0:1;return this.options.hideSingleBase&&(o=o&&S>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=f&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var f=this._getLayer(c(o.target)),v=f.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;v&&this._map.fire(v,f)},_createRadioElement:function(o,f){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(f?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=v,T.firstChild},_addItem:function(o){var f=document.createElement("label"),v=this._map.hasLayer(o.layer),T;o.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=v):T=this._createRadioElement("leaflet-base-layers_"+c(this),v),this._layerControlInputs.push(T),T.layerId=c(o.layer),mt(T,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+o.name;var B=document.createElement("div");f.appendChild(B),B.appendChild(T),B.appendChild(S);var re=o.overlay?this._overlaysList:this._baseLayersList;return re.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){var o=this._layerControlInputs,f,v,T=[],S=[];this._handlingClick=!0;for(var B=o.length-1;B>=0;B--)f=o[B],v=this._getLayer(f.layerId).layer,f.checked?T.push(v):f.checked||S.push(v);for(B=0;B<S.length;B++)this._map.hasLayer(S[B])&&this._map.removeLayer(S[B]);for(B=0;B<T.length;B++)this._map.hasLayer(T[B])||this._map.addLayer(T[B]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,f,v,T=this._map.getZoom(),S=o.length-1;S>=0;S--)f=o[S],v=this._getLayer(f.layerId).layer,f.disabled=v.options.minZoom!==void 0&&T<v.options.minZoom||v.options.maxZoom!==void 0&&T>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Ir=function(o,f,v){return new Eo(o,f,v)},Ao=Ii.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(o){var f="leaflet-control-zoom",v=wt("div",f+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,f+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,f+"-out",v,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,f,v,T,S){var B=wt("a",v,T);return B.innerHTML=o,B.href="#",B.title=f,B.setAttribute("role","button"),B.setAttribute("aria-label",f),Da(B),mt(B,"click",hn),mt(B,"click",S,this),mt(B,"click",this._refocusOnMap,this),B},_updateDisabled:function(){var o=this._map,f="leaflet-disabled";Qt(this._zoomInButton,f),Qt(this._zoomOutButton,f),(this._disabled||o._zoom===o.getMinZoom())&&ht(this._zoomOutButton,f),(this._disabled||o._zoom===o.getMaxZoom())&&ht(this._zoomInButton,f)}});qe.mergeOptions({zoomControl:!0}),qe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ao,this.addControl(this.zoomControl))});var oh=function(o){return new Ao(o)},Ml=Ii.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var f="leaflet-control-scale",v=wt("div",f),T=this.options;return this._addScales(T,f+"-line",v),o.on(T.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),v},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,f,v){o.metric&&(this._mScale=wt("div",f,v)),o.imperial&&(this._iScale=wt("div",f,v))},_update:function(){var o=this._map,f=o.getSize().y/2,v=o.distance(o.containerPointToLatLng([0,f]),o.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(v)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var f=this._getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,v,f/o)},_updateImperial:function(o){var f=o*3.2808399,v,T,S;f>5280?(v=f/5280,T=this._getRoundNum(v),this._updateScale(this._iScale,T+" mi",T/v)):(S=this._getRoundNum(f),this._updateScale(this._iScale,S+" ft",S/f))},_updateScale:function(o,f,v){o.style.width=Math.round(this.options.maxWidth*v)+"px",o.innerHTML=f},_getRoundNum:function(o){var f=Math.pow(10,(Math.floor(o)+"").length-1),v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}}),lh=function(o){return new Ml(o)},Co=Ii.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(o){w(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=wt("div","leaflet-control-attribution"),Da(this._container);for(var f in o._layers)o._layers[f].getAttribution&&this.addAttribution(o._layers[f].getAttribution());return this._update(),this._container},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var f in this._attributions)this._attributions[f]&&o.push(f);var v=[];this.options.prefix&&v.push(this.options.prefix),o.length&&v.push(o.join(", ")),this._container.innerHTML=v.join(" | ")}}});qe.mergeOptions({attributionControl:!0}),qe.addInitHook(function(){this.options.attributionControl&&new Co().addTo(this)});var uh=function(o){return new Co(o)};Ii.Layers=Eo,Ii.Zoom=Ao,Ii.Scale=Ml,Ii.Attribution=Co,$s.layers=Ir,$s.zoom=oh,$s.scale=lh,$s.attribution=uh;var ei=fe.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ei.addTo=function(o,f){return o.addHandler(f,this),this};var Jc={Events:de},mr=Fi?"touchstart mousedown":"mousedown",hh={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},So={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},er=De.extend({options:{clickTolerance:3},initialize:function(o,f,v,T){w(this,T),this._element=o,this._dragStartTarget=f||o,this._preventOutline=v},enable:function(){this._enabled||(mt(this._dragStartTarget,mr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(er._dragging===this&&this.finishDrag(),ni(this._dragStartTarget,mr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(!(o._simulated||!this._enabled)&&(this._moved=!1,!Pa(this._element,"leaflet-zoom-anim")&&!(er._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(er._dragging=this,this._preventOutline&&To(this._element),bo(),vs(),!this._moving))){this.fire("down");var f=o.touches?o.touches[0]:o,v=rh(this._element);this._startPoint=new ee(f.clientX,f.clientY),this._parentScale=Pl(v),mt(document,So[o.type],this._onMove,this),mt(document,hh[o.type],this._onUp,this)}},_onMove:function(o){if(!(o._simulated||!this._enabled)){if(o.touches&&o.touches.length>1){this._moved=!0;return}var f=o.touches&&o.touches.length===1?o.touches[0]:o,v=new ee(f.clientX,f.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,Rr(o),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Cn(this._element).subtract(v),ht(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,q(this._animRequest),this._lastEvent=o,this._animRequest=j(this._updatePosition,this,!0))}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),oi(this._element,this._newPos),this.fire("drag",o)},_onUp:function(o){o._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){Qt(document.body,"leaflet-dragging"),this._lastTarget&&(Qt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var o in So)ni(document,So[o],this._onMove,this),ni(document,hh[o],this._onUp,this);kl(),ys(),this._moved&&this._moving&&(q(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,er._dragging=!1}});function La(o,f){if(!f||!o.length)return o.slice();var v=f*f;return o=Qc(o,v),o=$n(o,v),o}function Do(o,f,v){return Math.sqrt(qn(o,f,v,!0))}function $t(o,f,v){return qn(o,f,v)}function $n(o,f){var v=o.length,T=typeof Uint8Array!=void 0+""?Uint8Array:Array,S=new T(v);S[0]=S[v-1]=1,Oa(o,S,f,0,v-1);var B,re=[];for(B=0;B<v;B++)S[B]&&re.push(o[B]);return re}function Oa(o,f,v,T,S){var B=0,re,ue,be;for(ue=T+1;ue<=S-1;ue++)be=qn(o[ue],o[T],o[S],!0),be>B&&(re=ue,B=be);B>v&&(f[re]=1,Oa(o,f,v,T,re),Oa(o,f,v,re,S))}function Qc(o,f){for(var v=[o[0]],T=1,S=0,B=o.length;T<B;T++)fh(o[T],o[S])>f&&(v.push(o[T]),S=T);return S<B-1&&v.push(o[B-1]),v}var Lo;function ch(o,f,v,T,S){var B=T?Lo:bs(o,v),re=bs(f,v),ue,be,Se;for(Lo=re;;){if(!(B|re))return[o,f];if(B&re)return!1;ue=B||re,be=Oo(o,f,ue,v,S),Se=bs(be,v),ue===B?(o=be,B=Se):(f=be,re=Se)}}function Oo(o,f,v,T,S){var B=f.x-o.x,re=f.y-o.y,ue=T.min,be=T.max,Se,je;return v&8?(Se=o.x+B*(be.y-o.y)/re,je=be.y):v&4?(Se=o.x+B*(ue.y-o.y)/re,je=ue.y):v&2?(Se=be.x,je=o.y+re*(be.x-o.x)/B):v&1&&(Se=ue.x,je=o.y+re*(ue.x-o.x)/B),new ee(Se,je,S)}function bs(o,f){var v=0;return o.x<f.min.x?v|=1:o.x>f.max.x&&(v|=2),o.y<f.min.y?v|=4:o.y>f.max.y&&(v|=8),v}function fh(o,f){var v=f.x-o.x,T=f.y-o.y;return v*v+T*T}function qn(o,f,v,T){var S=f.x,B=f.y,re=v.x-S,ue=v.y-B,be=re*re+ue*ue,Se;return be>0&&(Se=((o.x-S)*re+(o.y-B)*ue)/be,Se>1?(S=v.x,B=v.y):Se>0&&(S+=re*Se,B+=ue*Se)),re=o.x-S,ue=o.y-B,T?re*re+ue*ue:new ee(S,B)}function tr(o){return!C(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function dh(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),tr(o)}var ph=(Object.freeze||Object)({simplify:La,pointToSegmentDistance:Do,closestPointOnSegment:$t,clipSegment:ch,_getEdgeIntersection:Oo,_getBitCode:bs,_sqClosestPointOnSegment:qn,isFlat:tr,_flat:dh});function Fl(o,f,v){var T,S=[1,4,2,8],B,re,ue,be,Se,je,Ke,yt;for(B=0,je=o.length;B<je;B++)o[B]._code=bs(o[B],f);for(ue=0;ue<4;ue++){for(Ke=S[ue],T=[],B=0,je=o.length,re=je-1;B<je;re=B++)be=o[B],Se=o[re],be._code&Ke?Se._code&Ke||(yt=Oo(Se,be,Ke,f,v),yt._code=bs(yt,f),T.push(yt)):(Se._code&Ke&&(yt=Oo(Se,be,Ke,f,v),yt._code=bs(yt,f),T.push(yt)),T.push(be));o=T}return o}var Rl=(Object.freeze||Object)({clipPolygon:Fl}),Ma={project:function(o){return new ee(o.lng,o.lat)},unproject:function(o){return new he(o.y,o.x)},bounds:new R([-180,-90],[180,90])},Mo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new R([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var f=Math.PI/180,v=this.R,T=o.lat*f,S=this.R_MINOR/v,B=Math.sqrt(1-S*S),re=B*Math.sin(T),ue=Math.tan(Math.PI/4-T/2)/Math.pow((1-re)/(1+re),B/2);return T=-v*Math.log(Math.max(ue,1e-10)),new ee(o.lng*f*v,T)},unproject:function(o){for(var f=180/Math.PI,v=this.R,T=this.R_MINOR/v,S=Math.sqrt(1-T*T),B=Math.exp(-o.y/v),re=Math.PI/2-2*Math.atan(B),ue=0,be=.1,Se;ue<15&&Math.abs(be)>1e-7;ue++)Se=S*Math.sin(re),Se=Math.pow((1-Se)/(1+Se),S/2),be=Math.PI/2-2*Math.atan(B*Se)-re,re+=be;return new he(re*f,o.x*f/v)}},e0=(Object.freeze||Object)({LonLat:Ma,Mercator:Mo,SphericalMercator:it}),Il=s({},Oe,{code:"EPSG:3395",projection:Mo,transformation:function(){var o=.5/(Math.PI*Mo.R);return ft(o,.5,-o,.5)}()}),Fo=s({},Oe,{code:"EPSG:4326",projection:Ma,transformation:ft(1/180,1,-1/180,.5)}),t0=s({},we,{projection:Ma,transformation:ft(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,f){var v=f.lng-o.lng,T=f.lat-o.lat;return Math.sqrt(v*v+T*T)},infinite:!0});we.Earth=Oe,we.EPSG3395=Il,we.EPSG3857=Ge,we.EPSG900913=_t,we.EPSG4326=Fo,we.Simple=t0;var Br=De.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[c(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[c(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var f=o.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var v=this.getEvents();f.on(v,this),this.once("remove",function(){f.off(v,this)},this)}this.onAdd(f),this.getAttribution&&f.attributionControl&&f.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),f.fire("layeradd",{layer:this})}}});qe.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var f=c(o);return this._layers[f]?this:(this._layers[f]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var f=c(o);return this._layers[f]?(this._loaded&&o.onRemove(this),o.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(o.getAttribution()),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return!!o&&c(o)in this._layers},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},_addLayers:function(o){o=o?C(o)?o:[o]:[];for(var f=0,v=o.length;f<v;f++)this.addLayer(o[f])},_addZoomLimit:function(o){(isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[c(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var f=c(o);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,f=-1/0,v=this._getZoomSpan();for(var T in this._zoomBoundLayers){var S=this._zoomBoundLayers[T].options;o=S.minZoom===void 0?o:Math.min(o,S.minZoom),f=S.maxZoom===void 0?f:Math.max(f,S.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=o===1/0?void 0:o,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ei=Br.extend({initialize:function(o,f){w(this,f),this._layers={};var v,T;if(o)for(v=0,T=o.length;v<T;v++)this.addLayer(o[v])},addLayer:function(o){var f=this.getLayerId(o);return this._layers[f]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var f=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(o){return!!o&&(o in this._layers||this.getLayerId(o)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var f=Array.prototype.slice.call(arguments,1),v,T;for(v in this._layers)T=this._layers[v],T[o]&&T[o].apply(T,f);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return c(o)}}),Bl=function(o,f){return new Ei(o,f)},cn=Ei.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Ei.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Ei.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new Y;for(var f in this._layers){var v=this._layers[f];o.extend(v.getBounds?v.getBounds():v.getLatLng())}return o}}),gh=function(o){return new cn(o)},ws=fe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(o){w(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,f){var v=this._getIconUrl(o);if(!v){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(v,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(T,o),T},_setIconStyles:function(o,f){var v=this.options,T=v[f+"Size"];typeof T=="number"&&(T=[T,T]);var S=se(T),B=se(f==="shadow"&&v.shadowAnchor||v.iconAnchor||S&&S.divideBy(2,!0));o.className="leaflet-marker-"+f+" "+(v.className||""),B&&(o.style.marginLeft=-B.x+"px",o.style.marginTop=-B.y+"px"),S&&(o.style.width=S.x+"px",o.style.height=S.y+"px")},_createImg:function(o,f){return f=f||document.createElement("img"),f.src=o,f},_getIconUrl:function(o){return gr&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function i0(o){return new ws(o)}var Fa=ws.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return Fa.imagePath||(Fa.imagePath=this._detectIconPath()),(this.options.imagePath||Fa.imagePath)+ws.prototype._getIconUrl.call(this,o)},_detectIconPath:function(){var o=wt("div","leaflet-default-icon-path",document.body),f=_r(o,"background-image")||_r(o,"backgroundImage");return document.body.removeChild(o),f===null||f.indexOf("url")!==0?f="":f=f.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,""),f}}),_h=ei.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new er(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Qt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var f=this._marker,v=f._map,T=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,B=Cn(f._icon),re=v.getPixelBounds(),ue=v.getPixelOrigin(),be=J(re.min._subtract(ue).add(S),re.max._subtract(ue).subtract(S));if(!be.contains(B)){var Se=se((Math.max(be.max.x,B.x)-be.max.x)/(re.max.x-be.max.x)-(Math.min(be.min.x,B.x)-be.min.x)/(re.min.x-be.min.x),(Math.max(be.max.y,B.y)-be.max.y)/(re.max.y-be.max.y)-(Math.min(be.min.y,B.y)-be.min.y)/(re.min.y-be.min.y)).multiplyBy(T);v.panBy(Se,{animate:!1}),this._draggable._newPos._add(Se),this._draggable._startPos._add(Se),oi(f._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=j(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(q(this._panRequest),this._panRequest=j(this._adjustPan.bind(this,o)))},_onDrag:function(o){var f=this._marker,v=f._shadow,T=Cn(f._icon),S=f._map.layerPointToLatLng(T);v&&oi(v,T),f._latlng=S,o.latlng=S,o.oldLatLng=this._oldLatLng,f.fire("move",o).fire("drag",o)},_onDragEnd:function(o){q(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Ro=Br.extend({options:{icon:new Fa,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,f){w(this,f),this._latlng=Pe(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var f=this._latlng;return this._latlng=Pe(o),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=o.icon.createIcon(this._icon),T=!1;v!==this._icon&&(this._icon&&this._removeIcon(),T=!0,o.title&&(v.title=o.title),v.tagName==="IMG"&&(v.alt=o.alt||"")),ht(v,f),o.keyboard&&(v.tabIndex="0"),this._icon=v,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var S=o.icon.createShadow(this._shadow),B=!1;S!==this._shadow&&(this._removeShadow(),B=!0),S&&(ht(S,f),S.alt=""),this._shadow=S,o.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&B&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),Et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Et(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&oi(this._icon,o),this._shadow&&oi(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_h)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _h(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&Fr(this._icon,o),this._shadow&&Fr(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function r0(o,f){return new Ro(o,f)}var xr=Br.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return w(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&o.hasOwnProperty("weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Io=xr.extend({options:{fill:!0,radius:10},initialize:function(o,f){w(this,f),this._latlng=Pe(o),this._radius=this.options.radius},setLatLng:function(o){var f=this._latlng;return this._latlng=Pe(o),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var f=o&&o.radius||this._radius;return xr.prototype.setStyle.call(this,o),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,f=this._radiusY||o,v=this._clickTolerance(),T=[o+v,f+v];this._pxBounds=new R(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function n0(o,f){return new Io(o,f)}var Ra=Io.extend({initialize:function(o,f,v){if(typeof f=="number"&&(f=s({},v,{radius:f})),w(this,f),this._latlng=Pe(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new Y(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:xr.prototype.setStyle,_project:function(){var o=this._latlng.lng,f=this._latlng.lat,v=this._map,T=v.options.crs;if(T.distance===Oe.distance){var S=Math.PI/180,B=this._mRadius/Oe.R/S,re=v.project([f+B,o]),ue=v.project([f-B,o]),be=re.add(ue).divideBy(2),Se=v.unproject(be).lat,je=Math.acos((Math.cos(B*S)-Math.sin(f*S)*Math.sin(Se*S))/(Math.cos(f*S)*Math.cos(Se*S)))/S;(isNaN(je)||je===0)&&(je=B/Math.cos(Math.PI/180*f)),this._point=be.subtract(v.getPixelOrigin()),this._radius=isNaN(je)?0:be.x-v.project([Se,o-je]).x,this._radiusY=be.y-re.y}else{var Ke=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(Ke).x}this._updateBounds()}});function mh(o,f,v){return new Ra(o,f,v)}var Gi=xr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,f){w(this,f),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var f=1/0,v=null,T=qn,S,B,re=0,ue=this._parts.length;re<ue;re++)for(var be=this._parts[re],Se=1,je=be.length;Se<je;Se++){S=be[Se-1],B=be[Se];var Ke=T(o,S,B,!0);Ke<f&&(f=Ke,v=T(o,S,B))}return v&&(v.distance=Math.sqrt(f)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var o,f,v,T,S,B,re,ue=this._rings[0],be=ue.length;if(!be)return null;for(o=0,f=0;o<be-1;o++)f+=ue[o].distanceTo(ue[o+1])/2;if(f===0)return this._map.layerPointToLatLng(ue[0]);for(o=0,T=0;o<be-1;o++)if(S=ue[o],B=ue[o+1],v=S.distanceTo(B),T+=v,T>f)return re=(T-f)/v,this._map.layerPointToLatLng([B.x-re*(B.x-S.x),B.y-re*(B.y-S.y)])},getBounds:function(){return this._bounds},addLatLng:function(o,f){return f=f||this._defaultShape(),o=Pe(o),f.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new Y,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return tr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var f=[],v=tr(o),T=0,S=o.length;T<S;T++)v?(f[T]=Pe(o[T]),this._bounds.extend(f[T])):f[T]=this._convertLatLngs(o[T]);return f},_project:function(){var o=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),f=new ee(o,o);this._pxBounds=new R([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)])},_projectLatlngs:function(o,f,v){var T=o[0]instanceof he,S=o.length,B,re;if(T){for(re=[],B=0;B<S;B++)re[B]=this._map.latLngToLayerPoint(o[B]),v.extend(re[B]);f.push(re)}else for(B=0;B<S;B++)this._projectLatlngs(o[B],f,v)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,v,T,S,B,re,ue,be;for(v=0,S=0,B=this._rings.length;v<B;v++)for(be=this._rings[v],T=0,re=be.length;T<re-1;T++)ue=ch(be[T],be[T+1],o,T,!0),ue&&(f[S]=f[S]||[],f[S].push(ue[0]),(ue[1]!==be[T+1]||T===re-2)&&(f[S].push(ue[1]),S++))}},_simplifyPoints:function(){for(var o=this._parts,f=this.options.smoothFactor,v=0,T=o.length;v<T;v++)o[v]=La(o[v],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,f){var v,T,S,B,re,ue,be=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(v=0,B=this._parts.length;v<B;v++)for(ue=this._parts[v],T=0,re=ue.length,S=re-1;T<re;S=T++)if(!(!f&&T===0)&&Do(o,ue[S],ue[T])<=be)return!0;return!1}});function Bo(o,f){return new Gi(o,f)}Gi._flat=dh;var qs=Gi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var o,f,v,T,S,B,re,ue,be,Se=this._rings[0],je=Se.length;if(!je)return null;for(B=re=ue=0,o=0,f=je-1;o<je;f=o++)v=Se[o],T=Se[f],S=v.y*T.x-T.y*v.x,re+=(v.x+T.x)*S,ue+=(v.y+T.y)*S,B+=S*3;return B===0?be=Se[0]:be=[re/B,ue/B],this._map.layerPointToLatLng(be)},_convertLatLngs:function(o){var f=Gi.prototype._convertLatLngs.call(this,o),v=f.length;return v>=2&&f[0]instanceof he&&f[0].equals(f[v-1])&&f.pop(),f},_setLatLngs:function(o){Gi.prototype._setLatLngs.call(this,o),tr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return tr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,f=this.options.weight,v=new ee(f,f);if(o=new R(o.min.subtract(v),o.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,S=this._rings.length,B;T<S;T++)B=Fl(this._rings[T],o,!0),B.length&&this._parts.push(B)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var f=!1,v,T,S,B,re,ue,be,Se;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(B=0,be=this._parts.length;B<be;B++)for(v=this._parts[B],re=0,Se=v.length,ue=Se-1;re<Se;ue=re++)T=v[re],S=v[ue],T.y>o.y!=S.y>o.y&&o.x<(S.x-T.x)*(o.y-T.y)/(S.y-T.y)+T.x&&(f=!f);return f||Gi.prototype._containsPoint.call(this,o,!0)}});function s0(o,f){return new qs(o,f)}var Dn=cn.extend({initialize:function(o,f){w(this,f),this._layers={},o&&this.addData(o)},addData:function(o){var f=C(o)?o:o.features,v,T,S;if(f){for(v=0,T=f.length;v<T;v++)S=f[v],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var B=this.options;if(B.filter&&!B.filter(o))return this;var re=Jn(o,B);return re?(re.feature=Uo(o),re.defaultOptions=re.options,this.resetStyle(re),B.onEachFeature&&B.onEachFeature(o,re),this.addLayer(re)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=s({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(f){this._setLayerStyle(f,o)},this)},_setLayerStyle:function(o,f){o.setStyle&&(typeof f=="function"&&(f=f(o.feature)),o.setStyle(f))}});function Jn(o,f){var v=o.type==="Feature"?o.geometry:o,T=v?v.coordinates:null,S=[],B=f&&f.pointToLayer,re=f&&f.coordsToLatLng||No,ue,be,Se,je;if(!T&&!v)return null;switch(v.type){case"Point":return ue=re(T),Nr(B,o,ue,f);case"MultiPoint":for(Se=0,je=T.length;Se<je;Se++)ue=re(T[Se]),S.push(Nr(B,o,ue,f));return new cn(S);case"LineString":case"MultiLineString":return be=Ho(T,v.type==="LineString"?0:1,re),new Gi(be,f);case"Polygon":case"MultiPolygon":return be=Ho(T,v.type==="Polygon"?1:2,re),new qs(be,f);case"GeometryCollection":for(Se=0,je=v.geometries.length;Se<je;Se++){var Ke=Jn({geometry:v.geometries[Se],type:"Feature",properties:o.properties},f);Ke&&S.push(Ke)}return new cn(S);default:throw new Error("Invalid GeoJSON object.")}}function Nr(o,f,v,T){return o?o(f,v):new Ro(v,T&&T.markersInheritOptions&&T)}function No(o){return new he(o[1],o[0],o[2])}function Ho(o,f,v){for(var T=[],S=0,B=o.length,re;S<B;S++)re=f?Ho(o[S],f-1,v):(v||No)(o[S]),T.push(re);return T}function Nl(o,f){return f=typeof f=="number"?f:6,o.alt!==void 0?[_(o.lng,f),_(o.lat,f),_(o.alt,f)]:[_(o.lng,f),_(o.lat,f)]}function zo(o,f,v,T){for(var S=[],B=0,re=o.length;B<re;B++)S.push(f?zo(o[B],f-1,v,T):Nl(o[B],T));return!f&&v&&S.push(S[0]),S}function Js(o,f){return o.feature?s({},o.feature,{geometry:f}):Uo(f)}function Uo(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Qn={toGeoJSON:function(o){return Js(this,{type:"Point",coordinates:Nl(this.getLatLng(),o)})}};Ro.include(Qn),Ra.include(Qn),Io.include(Qn),Gi.include({toGeoJSON:function(o){var f=!tr(this._latlngs),v=zo(this._latlngs,f?1:0,!1,o);return Js(this,{type:(f?"Multi":"")+"LineString",coordinates:v})}}),qs.include({toGeoJSON:function(o){var f=!tr(this._latlngs),v=f&&!tr(this._latlngs[0]),T=zo(this._latlngs,v?2:f?1:0,!0,o);return f||(T=[T]),Js(this,{type:(v?"Multi":"")+"Polygon",coordinates:T})}}),Ei.include({toMultiPoint:function(o){var f=[];return this.eachLayer(function(v){f.push(v.toGeoJSON(o).geometry.coordinates)}),Js(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(o){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(o);var v=f==="GeometryCollection",T=[];return this.eachLayer(function(S){if(S.toGeoJSON){var B=S.toGeoJSON(o);if(v)T.push(B.geometry);else{var re=Uo(B);re.type==="FeatureCollection"?T.push.apply(T,re.features):T.push(re)}}}),v?Js(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function oe(o,f){return new Dn(o,f)}var ke=oe,ye=Br.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,f,v){this._url=o,this._bounds=ie(f),w(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&ms(this._image),this},bringToBack:function(){return this._map&&xs(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=ie(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",f=this._image=o?this._url:wt("img");if(ht(f,"leaflet-image-layer"),this._zoomAnimated&&ht(f,"leaflet-zoom-animated"),this.options.className&&ht(f,this.options.className),f.onselectstart=m,f.onmousemove=m,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(o){var f=this._map.getZoomScale(o.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;An(this._image,v,f)},_reset:function(){var o=this._image,f=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=f.getSize();oi(o,f.min),o.style.width=v.x+"px",o.style.height=v.y+"px"},_updateOpacity:function(){Fr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)}}),Xe=function(o,f,v){return new ye(o,f,v)},at=ye.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",f=this._image=o?this._url:wt("video");if(ht(f,"leaflet-image-layer"),this._zoomAnimated&&ht(f,"leaflet-zoom-animated"),this.options.className&&ht(f,this.options.className),f.onselectstart=m,f.onmousemove=m,f.onloadeddata=l(this.fire,this,"load"),o){for(var v=f.getElementsByTagName("source"),T=[],S=0;S<v.length;S++)T.push(v[S].src);this._url=v.length>0?T:[f.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&f.style.hasOwnProperty("objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop;for(var B=0;B<this._url.length;B++){var re=wt("source");re.src=this._url[B],f.appendChild(re)}}});function Ot(o,f,v){return new at(o,f,v)}var li=ye.extend({_initImage:function(){var o=this._image=this._url;ht(o,"leaflet-image-layer"),this._zoomAnimated&&ht(o,"leaflet-zoom-animated"),this.options.className&&ht(o,this.options.className),o.onselectstart=m,o.onmousemove=m}});function jt(o,f,v){return new li(o,f,v)}var Qr=Br.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(o,f){w(this,o),this._source=f},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Fr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Fr(this._container,1),this.bringToFront()},onRemove:function(o){o._fadeAnimated?(Fr(this._container,0),this._removeTimeout=setTimeout(l(Et,void 0,this._container),200)):Et(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=Pe(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ms(this._container),this},bringToBack:function(){return this._map&&xs(this._container),this},_prepareOpen:function(o,f,v){if(f instanceof Br||(v=f,f=o),f instanceof cn)for(var T in o._layers){f=o._layers[T];break}if(!v)if(f.getCenter)v=f.getCenter();else if(f.getLatLng)v=f.getLatLng();else throw new Error("Unable to get source layer LatLng.");return this._source=f,this.update(),v},_updateContent:function(){if(this._content){var o=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")o.innerHTML=f;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),f=se(this.options.offset),v=this._getAnchor();this._zoomAnimated?oi(this._container,o.add(v)):f=f.add(o).add(v);var T=this._containerBottom=-f.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=T+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}}),Qs=Qr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o.openPopup(this),this},onAdd:function(o){Qr.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof xr||this._source.on("preclick",Sn))},onRemove:function(o){Qr.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof xr||this._source.off("preclick",Sn))},getEvents:function(){var o=Qr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this._close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var o="leaflet-popup",f=this._container=wt("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=wt("div",o+"-content-wrapper",f);if(this._contentNode=wt("div",o+"-content",v),Da(v),Al(this._contentNode),mt(v,"contextmenu",Sn),this._tipContainer=wt("div",o+"-tip-container",f),this._tip=wt("div",o+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=wt("a",o+"-close-button",f);T.href="#close",T.innerHTML="&#215;",mt(T,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var o=this._contentNode,f=o.style;f.width="",f.whiteSpace="nowrap";var v=o.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),f.width=v+1+"px",f.whiteSpace="",f.height="";var T=o.offsetHeight,S=this.options.maxHeight,B="leaflet-popup-scrolled";S&&T>S?(f.height=S+"px",ht(o,B)):Qt(o,B),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),v=this._getAnchor();oi(this._container,f.add(v))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var o=this._map,f=parseInt(_r(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+f,T=this._containerWidth,S=new ee(this._containerLeft,-v-this._containerBottom);S._add(Cn(this._container));var B=o.layerPointToContainerPoint(S),re=se(this.options.autoPanPadding),ue=se(this.options.autoPanPaddingTopLeft||re),be=se(this.options.autoPanPaddingBottomRight||re),Se=o.getSize(),je=0,Ke=0;B.x+T+be.x>Se.x&&(je=B.x+T-Se.x+be.x),B.x-je-ue.x<0&&(je=B.x-ue.x),B.y+v+be.y>Se.y&&(Ke=B.y+v-Se.y+be.y),B.y-Ke-ue.y<0&&(Ke=B.y-ue.y),(je||Ke)&&o.fire("autopanstart").panBy([je,Ke])}},_onCloseButtonClick:function(o){this._close(),hn(o)},_getAnchor:function(){return se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Hr=function(o,f){return new Qs(o,f)};qe.mergeOptions({closePopupOnClick:!0}),qe.include({openPopup:function(o,f,v){return o instanceof Qs||(o=new Qs(v).setContent(o)),f&&o.setLatLng(f),this.hasLayer(o)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=o,this.addLayer(o))},closePopup:function(o){return(!o||o===this._popup)&&(o=this._popup,this._popup=null),o&&this.removeLayer(o),this}}),Br.include({bindPopup:function(o,f){return o instanceof Qs?(w(o,f),this._popup=o,o._source=this):((!this._popup||f)&&(this._popup=new Qs(f,this)),this._popup.setContent(o)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o,f){return this._popup&&this._map&&(f=this._popup._prepareOpen(this,o,f),this._map.openPopup(this._popup,f)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(o){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(o)),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){var f=o.layer||o.target;if(this._popup&&this._map){if(hn(o),f instanceof xr){this.openPopup(o.layer||o.target,o.latlng);return}this._map.hasLayer(this._popup)&&this._popup._source===f?this.closePopup():this.openPopup(f,o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Ln=Qr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(o){Qr.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(o){Qr.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var o=Qr.prototype.getEvents.call(this);return Fi&&!this.options.permanent&&(o.preclick=this._close),o},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var o="leaflet-tooltip",f=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=wt("div",f)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var f=this._map,v=this._container,T=f.latLngToContainerPoint(f.getCenter()),S=f.layerPointToContainerPoint(o),B=this.options.direction,re=v.offsetWidth,ue=v.offsetHeight,be=se(this.options.offset),Se=this._getAnchor();B==="top"?o=o.add(se(-re/2+be.x,-ue+be.y+Se.y,!0)):B==="bottom"?o=o.subtract(se(re/2-be.x,-be.y,!0)):B==="center"?o=o.subtract(se(re/2+be.x,ue/2-Se.y+be.y,!0)):B==="right"||B==="auto"&&S.x<T.x?(B="right",o=o.add(se(be.x+Se.x,Se.y-ue/2+be.y,!0))):(B="left",o=o.subtract(se(re+Se.x-be.x,ue/2-Se.y-be.y,!0))),Qt(v,"leaflet-tooltip-right"),Qt(v,"leaflet-tooltip-left"),Qt(v,"leaflet-tooltip-top"),Qt(v,"leaflet-tooltip-bottom"),ht(v,"leaflet-tooltip-"+B),oi(v,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Fr(this._container,o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(f)},_getAnchor:function(){return se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),a0=function(o,f){return new Ln(o,f)};qe.include({openTooltip:function(o,f,v){return o instanceof Ln||(o=new Ln(v).setContent(o)),f&&o.setLatLng(f),this.hasLayer(o)?this:this.addLayer(o)},closeTooltip:function(o){return o&&this.removeLayer(o),this}}),Br.include({bindTooltip:function(o,f){return o instanceof Ln?(w(o,f),this._tooltip=o,o._source=this):((!this._tooltip||f)&&(this._tooltip=new Ln(f,this)),this._tooltip.setContent(o)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var f=o?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),Fi&&(v.click=this._openTooltip)),this[f](v),this._tooltipHandlersAdded=!o}},openTooltip:function(o,f){return this._tooltip&&this._map&&(f=this._tooltip._prepareOpen(this,o,f),this._map.openTooltip(this._tooltip,f),this._tooltip.options.interactive&&this._tooltip._container&&(ht(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Qt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(o){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(o)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_openTooltip:function(o){var f=o.layer||o.target;!this._tooltip||!this._map||this.openTooltip(f,this._tooltip.options.sticky?o.latlng:void 0)},_moveTooltip:function(o){var f=o.latlng,v,T;this._tooltip.options.sticky&&o.originalEvent&&(v=this._map.mouseEventToContainerPoint(o.originalEvent),T=this._map.containerPointToLayerPoint(v),f=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(f)}});var Ts=ws.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var f=o&&o.tagName==="DIV"?o:document.createElement("div"),v=this.options;if(v.html instanceof Element?(ka(f),f.appendChild(v.html)):f.innerHTML=v.html!==!1?v.html:"",v.bgPos){var T=se(v.bgPos);f.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Wo(o){return new Ts(o)}ws.Default=Fa;var es=Br.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lr,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){w(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),Et(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ms(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(xs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof ee?o:new ee(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var f=this.getPane().children,v=-o(-1/0,1/0),T=0,S=f.length,B;T<S;T++)B=f[T].style.zIndex,f[T]!==this._container&&B&&(v=o(v,+B));isFinite(v)&&(this.options.zIndex=v+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ht){Fr(this._container,this.options.opacity);var o=+new Date,f=!1,v=!1;for(var T in this._tiles){var S=this._tiles[T];if(!(!S.current||!S.loaded)){var B=Math.min(1,(o-S.loaded)/200);Fr(S.el,B),B<1?f=!0:(S.active?v=!0:this._onOpaqueTile(S),S.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),f&&(q(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=wt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,f=this.options.maxZoom;if(o!==void 0){for(var v in this._levels)this._levels[v].el.children.length||v===o?(this._levels[v].el.style.zIndex=f-Math.abs(o-v),this._onUpdateLevel(v)):(Et(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var T=this._levels[o],S=this._map;return T||(T=this._levels[o]={},T.el=wt("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=f,T.origin=S.project(S.unproject(S.getPixelOrigin()),o).round(),T.zoom=o,this._setZoomTransform(T,S.getCenter(),S.getZoom()),m(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var o,f,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)f=this._tiles[o],f.retain=f.current;for(o in this._tiles)if(f=this._tiles[o],f.current&&!f.active){var T=f.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var f in this._tiles)this._tiles[f].coords.z===o&&this._removeTile(f)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)Et(this._levels[o].el),this._onRemoveLevel(o),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,f,v,T){var S=Math.floor(o/2),B=Math.floor(f/2),re=v-1,ue=new ee(+S,+B);ue.z=+re;var be=this._tileCoordsToKey(ue),Se=this._tiles[be];return Se&&Se.active?(Se.retain=!0,!0):(Se&&Se.loaded&&(Se.retain=!0),re>T?this._retainParent(S,B,re,T):!1)},_retainChildren:function(o,f,v,T){for(var S=2*o;S<2*o+2;S++)for(var B=2*f;B<2*f+2;B++){var re=new ee(S,B);re.z=v+1;var ue=this._tileCoordsToKey(re),be=this._tiles[ue];if(be&&be.active){be.retain=!0;continue}else be&&be.loaded&&(be.retain=!0);v+1<T&&this._retainChildren(S,B,v+1,T)}},_resetView:function(o){var f=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var f=this.options;return f.minNativeZoom!==void 0&&o<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<o?f.maxNativeZoom:o},_setView:function(o,f,v,T){var S=this._clampZoom(Math.round(f));(this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom)&&(S=void 0);var B=this.options.updateWhenZooming&&S!==this._tileZoom;(!T||B)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(o),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(o,f)},_setZoomTransforms:function(o,f){for(var v in this._levels)this._setZoomTransform(this._levels[v],o,f)},_setZoomTransform:function(o,f,v){var T=this._map.getZoomScale(v,o.zoom),S=o.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(f,v)).round();Pi?An(o.el,S,T):oi(o.el,S)},_resetGrid:function(){var o=this._map,f=o.options.crs,v=this._tileSize=this.getTileSize(),T=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,f.wrapLng[0]],T).x/v.x),Math.ceil(o.project([0,f.wrapLng[1]],T).x/v.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([f.wrapLat[0],0],T).y/v.x),Math.ceil(o.project([f.wrapLat[1],0],T).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var f=this._map,v=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),T=f.getZoomScale(v,this._tileZoom),S=f.project(o,this._tileZoom).floor(),B=f.getSize().divideBy(T*2);return new R(S.subtract(B),S.add(B))},_update:function(o){var f=this._map;if(f){var v=this._clampZoom(f.getZoom());if(o===void 0&&(o=f.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(o),S=this._pxBoundsToTileRange(T),B=S.getCenter(),re=[],ue=this.options.keepBuffer,be=new R(S.getBottomLeft().subtract([ue,-ue]),S.getTopRight().add([ue,-ue]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Se in this._tiles){var je=this._tiles[Se].coords;(je.z!==this._tileZoom||!be.contains(new ee(je.x,je.y)))&&(this._tiles[Se].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(o,v);return}for(var Ke=S.min.y;Ke<=S.max.y;Ke++)for(var yt=S.min.x;yt<=S.max.x;yt++){var vr=new ee(yt,Ke);if(vr.z=this._tileZoom,!!this._isValidTile(vr)){var On=this._tiles[this._tileCoordsToKey(vr)];On?On.current=!0:re.push(vr)}}if(re.sort(function(Ur,ks){return Ur.distanceTo(B)-ks.distanceTo(B)}),re.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mn=document.createDocumentFragment();for(yt=0;yt<re.length;yt++)this._addTile(re[yt],Mn);this._level.el.appendChild(Mn)}}}},_isValidTile:function(o){var f=this._map.options.crs;if(!f.infinite){var v=this._globalTileRange;if(!f.wrapLng&&(o.x<v.min.x||o.x>v.max.x)||!f.wrapLat&&(o.y<v.min.y||o.y>v.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(o);return ie(this.options.bounds).overlaps(T)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var f=this._map,v=this.getTileSize(),T=o.scaleBy(v),S=T.add(v),B=f.unproject(T,o.z),re=f.unproject(S,o.z);return[B,re]},_tileCoordsToBounds:function(o){var f=this._tileCoordsToNwSe(o),v=new Y(f[0],f[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var f=o.split(":"),v=new ee(+f[0],+f[1]);return v.z=+f[2],v},_removeTile:function(o){var f=this._tiles[o];f&&(Et(f.el),delete this._tiles[o],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){ht(o,"leaflet-tile");var f=this.getTileSize();o.style.width=f.x+"px",o.style.height=f.y+"px",o.onselectstart=m,o.onmousemove=m,Ht&&this.options.opacity<1&&Fr(o,this.options.opacity),Ut&&!Kt&&(o.style.WebkitBackfaceVisibility="hidden")},_addTile:function(o,f){var v=this._getTilePos(o),T=this._tileCoordsToKey(o),S=this.createTile(this._wrapCoords(o),l(this._tileReady,this,o));this._initTile(S),this.createTile.length<2&&j(l(this._tileReady,this,o,null,S)),oi(S,v),this._tiles[T]={el:S,coords:o,current:!0},f.appendChild(S),this.fire("tileloadstart",{tile:S,coords:o})},_tileReady:function(o,f,v){f&&this.fire("tileerror",{error:f,tile:v,coords:o});var T=this._tileCoordsToKey(o);v=this._tiles[T],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Fr(v.el,0),q(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),f||(ht(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ht||!this._map._fadeAnimated?j(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var f=new ee(this._wrapX?g(o.x,this._wrapX):o.x,this._wrapY?g(o.y,this._wrapY):o.y);return f.z=o.z,f},_pxBoundsToTileRange:function(o){var f=this.getTileSize();return new R(o.min.unscaleBy(f).floor(),o.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Rt(o){return new es(o)}var ea=es.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(o,f){this._url=o,f=w(this,f),f.detectRetina&&gr&&f.maxZoom>0&&(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom++):(f.zoomOffset++,f.maxZoom--),f.minZoom=Math.max(0,f.minZoom)),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),Ut||this.on("tileunload",this._onTileRemove)},setUrl:function(o,f){return this._url===o&&f===void 0&&(f=!0),this._url=o,f||this.redraw(),this},createTile:function(o,f){var v=document.createElement("img");return mt(v,"load",l(this._tileOnLoad,this,f,v)),mt(v,"error",l(this._tileOnError,this,f,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),v.alt="",v.setAttribute("role","presentation"),v.src=this.getTileUrl(o),v},getTileUrl:function(o){var f={r:gr?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-o.y;this.options.tms&&(f.y=v),f["-y"]=v}return k(this._url,s(f,this.options))},_tileOnLoad:function(o,f){Ht?setTimeout(l(o,this,null,f),0):o(null,f)},_tileOnError:function(o,f,v){var T=this.options.errorTileUrl;T&&f.getAttribute("src")!==T&&(f.src=T),o(v,f)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,f=this.options.maxZoom,v=this.options.zoomReverse,T=this.options.zoomOffset;return v&&(o=f-o),o+T},_getSubdomain:function(o){var f=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var o,f;for(o in this._tiles)this._tiles[o].coords.z!==this._tileZoom&&(f=this._tiles[o].el,f.onload=m,f.onerror=m,f.complete||(f.src=F,Et(f),delete this._tiles[o]))},_removeTile:function(o){var f=this._tiles[o];if(f)return ki||f.el.setAttribute("src",F),es.prototype._removeTile.call(this,o)},_tileReady:function(o,f,v){if(!(!this._map||v&&v.getAttribute("src")===F))return es.prototype._tileReady.call(this,o,f,v)}});function Hl(o,f){return new ea(o,f)}var Ia=ea.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,f){this._url=o;var v=s({},this.defaultWmsParams);for(var T in f)T in this.options||(v[T]=f[T]);f=w(this,f);var S=f.detectRetina&&gr?2:1,B=this.getTileSize();v.width=B.x*S,v.height=B.y*S,this.wmsParams=v},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,ea.prototype.onAdd.call(this,o)},getTileUrl:function(o){var f=this._tileCoordsToNwSe(o),v=this._crs,T=J(v.project(f[0]),v.project(f[1])),S=T.min,B=T.max,re=(this._wmsVersion>=1.3&&this._crs===Fo?[S.y,S.x,B.y,B.x]:[S.x,S.y,B.x,B.y]).join(","),ue=ea.prototype.getTileUrl.call(this,o);return ue+P(this.wmsParams,ue,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+re},setParams:function(o,f){return s(this.wmsParams,o),f||this.redraw(),this}});function o0(o,f){return new Ia(o,f)}ea.WMS=Ia,Hl.wms=o0;var fn=Br.extend({options:{padding:.1,tolerance:0},initialize:function(o){w(this,o),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,f){var v=this._map.getZoomScale(f,this._zoom),T=Cn(this._container),S=this._map.getSize().multiplyBy(.5+this.options.padding),B=this._map.project(this._center,f),re=this._map.project(o,f),ue=re.subtract(B),be=S.multiplyBy(-v).add(T).add(S).subtract(ue);Pi?An(this._container,be,v):oi(this._container,be)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,f=this._map.getSize(),v=this._map.containerPointToLayerPoint(f.multiplyBy(-o)).round();this._bounds=new R(v,v.add(f.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),xh=fn.extend({getEvents:function(){var o=fn.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");mt(o,"mousemove",this._onMouseMove,this),mt(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),mt(o,"mouseout",this._handleMouseOut,this),this._ctx=o.getContext("2d")},_destroyContainer:function(){q(this._redrawRequest),delete this._ctx,Et(this._container),ni(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var f in this._layers)o=this._layers[f],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fn.prototype._update.call(this);var o=this._bounds,f=this._container,v=o.getSize(),T=gr?2:1;oi(f,o.min),f.width=T*v.x,f.height=T*v.y,f.style.width=v.x+"px",f.style.height=v.y+"px",gr&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){fn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[c(o)]=o;var f=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var f=o._order,v=f.next,T=f.prev;v?v.prev=T:this._drawLast=T,T?T.next=v:this._drawFirst=v,delete o._order,delete this._layers[c(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var f=o.options.dashArray.split(/[, ]+/),v=[],T,S;for(S=0;S<f.length;S++){if(T=Number(f[S]),isNaN(T))return;v.push(T)}o.options._dashArray=v}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||j(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var f=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(o._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(o._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var f=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,f.x,f.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var o,f=this._redrawBounds;if(this._ctx.save(),f){var v=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)o=T.layer,(!f||o._pxBounds&&o._pxBounds.intersects(f))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,f){if(this._drawing){var v,T,S,B,re=o._parts,ue=re.length,be=this._ctx;if(ue){for(be.beginPath(),v=0;v<ue;v++){for(T=0,S=re[v].length;T<S;T++)B=re[v][T],be[T?"lineTo":"moveTo"](B.x,B.y);f&&be.closePath()}this._fillStroke(be,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var f=o._point,v=this._ctx,T=Math.max(Math.round(o._radius),1),S=(Math.max(Math.round(o._radiusY),1)||T)/T;S!==1&&(v.save(),v.scale(1,S)),v.beginPath(),v.arc(f.x,f.y/S,T,0,Math.PI*2,!1),S!==1&&v.restore(),this._fillStroke(v,o)}},_fillStroke:function(o,f){var v=f.options;v.fill&&(o.globalAlpha=v.fillOpacity,o.fillStyle=v.fillColor||v.color,o.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(o.setLineDash&&o.setLineDash(f.options&&f.options._dashArray||[]),o.globalAlpha=v.opacity,o.lineWidth=v.weight,o.strokeStyle=v.color,o.lineCap=v.lineCap,o.lineJoin=v.lineJoin,o.stroke())},_onClick:function(o){for(var f=this._map.mouseEventToLayerPoint(o),v,T,S=this._drawFirst;S;S=S.next)v=S.layer,v.options.interactive&&v._containsPoint(f)&&!this._map._draggableMoved(v)&&(T=v);T&&(Sl(o),this._fireEvent([T],o))},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,f)}},_handleMouseOut:function(o){var f=this._hoveredLayer;f&&(Qt(this._container,"leaflet-interactive"),this._fireEvent([f],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,f){if(!this._mouseHoverThrottled){for(var v,T,S=this._drawFirst;S;S=S.next)v=S.layer,v.options.interactive&&v._containsPoint(f)&&(T=v);T!==this._hoveredLayer&&(this._handleMouseOut(o),T&&(ht(this._container,"leaflet-interactive"),this._fireEvent([T],o,"mouseover"),this._hoveredLayer=T)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],o),this._mouseHoverThrottled=!0,setTimeout(L.bind(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,f,v){this._map._fireDOMEvent(f,v||f.type,o)},_bringToFront:function(o){var f=o._order;if(f){var v=f.next,T=f.prev;if(v)v.prev=T;else return;T?T.next=v:v&&(this._drawFirst=v),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(o)}},_bringToBack:function(o){var f=o._order;if(f){var v=f.next,T=f.prev;if(T)T.next=v;else return;v?v.prev=T:T&&(this._drawLast=T),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(o)}}});function Ba(o){return Vs?new xh(o):null}var zr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),jo={_initContainer:function(){this._container=wt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fn.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var f=o._container=zr("shape");ht(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",o._path=zr("path"),f.appendChild(o._path),this._updateStyle(o),this._layers[c(o)]=o},_addPath:function(o){var f=o._container;this._container.appendChild(f),o.options.interactive&&o.addInteractiveTarget(f)},_removePath:function(o){var f=o._container;Et(f),o.removeInteractiveTarget(f),delete this._layers[c(o)]},_updateStyle:function(o){var f=o._stroke,v=o._fill,T=o.options,S=o._container;S.stroked=!!T.stroke,S.filled=!!T.fill,T.stroke?(f||(f=o._stroke=zr("stroke")),S.appendChild(f),f.weight=T.weight+"px",f.color=T.color,f.opacity=T.opacity,T.dashArray?f.dashStyle=C(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=T.lineCap.replace("butt","flat"),f.joinstyle=T.lineJoin):f&&(S.removeChild(f),o._stroke=null),T.fill?(v||(v=o._fill=zr("fill")),S.appendChild(v),v.color=T.fillColor||T.color,v.opacity=T.fillOpacity):v&&(S.removeChild(v),o._fill=null)},_updateCircle:function(o){var f=o._point.round(),v=Math.round(o._radius),T=Math.round(o._radiusY||v);this._setPath(o,o._empty()?"M0 0":"AL "+f.x+","+f.y+" "+v+","+T+" 0,"+65535*360)},_setPath:function(o,f){o._path.v=f},_bringToFront:function(o){ms(o._container)},_bringToBack:function(o){xs(o._container)}},Na=Yn?zr:rt,ts=fn.extend({getEvents:function(){var o=fn.prototype.getEvents.call(this);return o.zoomstart=this._onZoomStart,o},_initContainer:function(){this._container=Na("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Na("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Et(this._container),ni(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fn.prototype._update.call(this);var o=this._bounds,f=o.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,v.setAttribute("width",f.x),v.setAttribute("height",f.y)),oi(v,o.min),v.setAttribute("viewBox",[o.min.x,o.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(o){var f=o._path=Na("path");o.options.className&&ht(f,o.options.className),o.options.interactive&&ht(f,"leaflet-interactive"),this._updateStyle(o),this._layers[c(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){Et(o._path),o.removeInteractiveTarget(o._path),delete this._layers[c(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var f=o._path,v=o.options;f&&(v.stroke?(f.setAttribute("stroke",v.color),f.setAttribute("stroke-opacity",v.opacity),f.setAttribute("stroke-width",v.weight),f.setAttribute("stroke-linecap",v.lineCap),f.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?f.setAttribute("stroke-dasharray",v.dashArray):f.removeAttribute("stroke-dasharray"),v.dashOffset?f.setAttribute("stroke-dashoffset",v.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),v.fill?(f.setAttribute("fill",v.fillColor||v.color),f.setAttribute("fill-opacity",v.fillOpacity),f.setAttribute("fill-rule",v.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(o,f){this._setPath(o,Be(o._parts,f))},_updateCircle:function(o){var f=o._point,v=Math.max(Math.round(o._radius),1),T=Math.max(Math.round(o._radiusY),1)||v,S="a"+v+","+T+" 0 1,0 ",B=o._empty()?"M0 0":"M"+(f.x-v)+","+f.y+S+v*2+",0 "+S+-v*2+",0 ";this._setPath(o,B)},_setPath:function(o,f){o._path.setAttribute("d",f)},_bringToFront:function(o){ms(o._path)},_bringToBack:function(o){xs(o._path)}});Yn&&ts.include(jo);function zl(o){return Pn||Yn?new ts(o):null}qe.include({getRenderer:function(o){var f=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var f=this._paneRenderers[o];return f===void 0&&(f=this._createRenderer({pane:o}),this._paneRenderers[o]=f),f},_createRenderer:function(o){return this.options.preferCanvas&&Ba(o)||zl(o)}});var Ul=qs.extend({initialize:function(o,f){qs.prototype.initialize.call(this,this._boundsToLatLngs(o),f)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=ie(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function Xo(o,f){return new Ul(o,f)}ts.create=Na,ts.pointsToPath=Be,Dn.geometryToLayer=Jn,Dn.coordsToLatLng=No,Dn.coordsToLatLngs=Ho,Dn.latLngToCoords=Nl,Dn.latLngsToCoords=zo,Dn.getFeature=Js,Dn.asFeature=Uo,qe.mergeOptions({boxZoom:!0});var Wl=ei.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){mt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ni(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),vs(),bo(),this._startPoint=this._map.mouseEventToContainerPoint(o),mt(document,{contextmenu:hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=wt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var f=new R(this._point,this._startPoint),v=f.getSize();oi(this._box,f.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Et(this._box),Qt(this._container,"leaflet-crosshair")),ys(),kl(),ni(document,{contextmenu:hn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new Y(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(o){o.keyCode===27&&this._finish()}});qe.addInitHook("addHandler","boxZoom",Wl),qe.mergeOptions({doubleClickZoom:!0});var ta=ei.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var f=this._map,v=f.getZoom(),T=f.options.zoomDelta,S=o.originalEvent.shiftKey?v-T:v+T;f.options.doubleClickZoom==="center"?f.setZoom(S):f.setZoomAround(o.containerPoint,S)}});qe.addInitHook("addHandler","doubleClickZoom",ta),qe.mergeOptions({dragging:!0,inertia:!Kt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var is=ei.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new er(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Qt(this._map._container,"leaflet-grab"),Qt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=ie(this._map.options.maxBounds);this._offsetLimit=J(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var f=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(f),this._prunePositions(f)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,f){return o-(o-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;o.x<f.min.x&&(o.x=this._viscousLimit(o.x,f.min.x)),o.y<f.min.y&&(o.y=this._viscousLimit(o.y,f.min.y)),o.x>f.max.x&&(o.x=this._viscousLimit(o.x,f.max.x)),o.y>f.max.y&&(o.y=this._viscousLimit(o.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,f=Math.round(o/2),v=this._initialWorldOffset,T=this._draggable._newPos.x,S=(T-f+v)%o+f-v,B=(T+f+v)%o-f-v,re=Math.abs(S+v)<Math.abs(B+v)?S:B;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=re},_onDragEnd:function(o){var f=this._map,v=f.options,T=!v.inertia||this._times.length<2;if(f.fire("dragend",o),T)f.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),B=(this._lastTime-this._times[0])/1e3,re=v.easeLinearity,ue=S.multiplyBy(re/B),be=ue.distanceTo([0,0]),Se=Math.min(v.inertiaMaxSpeed,be),je=ue.multiplyBy(Se/be),Ke=Se/(v.inertiaDeceleration*re),yt=je.multiplyBy(-Ke/2).round();!yt.x&&!yt.y?f.fire("moveend"):(yt=f._limitOffset(yt,f.options.maxBounds),j(function(){f.panBy(yt,{duration:Ke,easeLinearity:re,noMoveStart:!0,animate:!0})}))}}});qe.addInitHook("addHandler","dragging",is),qe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ha=ei.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),mt(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ni(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,f=document.documentElement,v=o.scrollTop||f.scrollTop,T=o.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(T,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var f=this._panKeys={},v=this.keyCodes,T,S;for(T=0,S=v.left.length;T<S;T++)f[v.left[T]]=[-1*o,0];for(T=0,S=v.right.length;T<S;T++)f[v.right[T]]=[o,0];for(T=0,S=v.down.length;T<S;T++)f[v.down[T]]=[0,o];for(T=0,S=v.up.length;T<S;T++)f[v.up[T]]=[0,-1*o]},_setZoomDelta:function(o){var f=this._zoomKeys={},v=this.keyCodes,T,S;for(T=0,S=v.zoomIn.length;T<S;T++)f[v.zoomIn[T]]=o;for(T=0,S=v.zoomOut.length;T<S;T++)f[v.zoomOut[T]]=-o},_addHooks:function(){mt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ni(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var f=o.keyCode,v=this._map,T;if(f in this._panKeys)(!v._panAnim||!v._panAnim._inProgress)&&(T=this._panKeys[f],o.shiftKey&&(T=se(T).multiplyBy(3)),v.panBy(T),v.options.maxBounds&&v.panInsideBounds(v.options.maxBounds));else if(f in this._zoomKeys)v.setZoom(v.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;hn(o)}}});qe.addInitHook("addHandler","keyboard",Ha),qe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vh=ei.extend({addHooks:function(){mt(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ni(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var f=Wt(o),v=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var T=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),T),hn(o)},_performZoom:function(){var o=this._map,f=o.getZoom(),v=this._map.options.zoomSnap||0;o._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,B=v?Math.ceil(S/v)*v:S,re=o._limitZoom(f+(this._delta>0?B:-B))-f;this._delta=0,this._startTime=null,re&&(o.options.scrollWheelZoom==="center"?o.setZoom(f+re):o.setZoomAround(this._lastMousePos,f+re))}});qe.addInitHook("addHandler","scrollWheelZoom",vh),qe.mergeOptions({tap:!0,tapTolerance:15});var yh=ei.extend({addHooks:function(){mt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ni(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(o.touches){if(Rr(o),this._fireClick=!0,o.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var f=o.touches[0],v=f.target;this._startPos=this._newPos=new ee(f.clientX,f.clientY),v.tagName&&v.tagName.toLowerCase()==="a"&&ht(v,"leaflet-active"),this._holdTimeout=setTimeout(l(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",f))},this),1e3),this._simulateEvent("mousedown",f),mt(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(o){if(clearTimeout(this._holdTimeout),ni(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&o&&o.changedTouches){var f=o.changedTouches[0],v=f.target;v&&v.tagName&&v.tagName.toLowerCase()==="a"&&Qt(v,"leaflet-active"),this._simulateEvent("mouseup",f),this._isTapValid()&&this._simulateEvent("click",f)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(o){var f=o.touches[0];this._newPos=new ee(f.clientX,f.clientY),this._simulateEvent("mousemove",f)},_simulateEvent:function(o,f){var v=document.createEvent("MouseEvents");v._simulated=!0,f.target._simulatedClick=!0,v.initMouseEvent(o,!0,!0,window,1,f.screenX,f.screenY,f.clientX,f.clientY,!1,!1,!1,!1,0,null),f.target.dispatchEvent(v)}});Fi&&!Mi&&qe.addInitHook("addHandler","tap",yh),qe.mergeOptions({touchZoom:Fi&&!Kt,bounceAtZoomLimits:!0});var bh=ei.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),mt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Qt(this._map._container,"leaflet-touch-zoom"),ni(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var f=this._map;if(!(!o.touches||o.touches.length!==2||f._animatingZoom||this._zooming)){var v=f.mouseEventToContainerPoint(o.touches[0]),T=f.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(v.add(T)._divideBy(2))),this._startDist=v.distanceTo(T),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),mt(document,"touchmove",this._onTouchMove,this),mt(document,"touchend",this._onTouchEnd,this),Rr(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var f=this._map,v=f.mouseEventToContainerPoint(o.touches[0]),T=f.mouseEventToContainerPoint(o.touches[1]),S=v.distanceTo(T)/this._startDist;if(this._zoom=f.getScaleZoom(S,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&S<1||this._zoom>f.getMaxZoom()&&S>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var B=v._add(T)._divideBy(2)._subtract(this._centerPoint);if(S===1&&B.x===0&&B.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(B),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),q(this._animRequest);var re=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=j(re,this,!0),Rr(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,q(this._animRequest),ni(document,"touchmove",this._onTouchMove),ni(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});qe.addInitHook("addHandler","touchZoom",bh),qe.BoxZoom=Wl,qe.DoubleClickZoom=ta,qe.Drag=is,qe.Keyboard=Ha,qe.ScrollWheelZoom=vh,qe.Tap=yh,qe.TouchZoom=bh,Object.freeze=n,t.version=i,t.Control=Ii,t.control=$s,t.Browser=_i,t.Evented=De,t.Mixin=Jc,t.Util=pe,t.Class=fe,t.Handler=ei,t.extend=s,t.bind=l,t.stamp=c,t.setOptions=w,t.DomEvent=sh,t.DomUtil=$c,t.PosAnimation=ah,t.Draggable=er,t.LineUtil=ph,t.PolyUtil=Rl,t.Point=ee,t.point=se,t.Bounds=R,t.bounds=J,t.Transformation=te,t.transformation=ft,t.Projection=e0,t.LatLng=he,t.latLng=Pe,t.LatLngBounds=Y,t.latLngBounds=ie,t.CRS=we,t.GeoJSON=Dn,t.geoJSON=oe,t.geoJson=ke,t.Layer=Br,t.LayerGroup=Ei,t.layerGroup=Bl,t.FeatureGroup=cn,t.featureGroup=gh,t.ImageOverlay=ye,t.imageOverlay=Xe,t.VideoOverlay=at,t.videoOverlay=Ot,t.SVGOverlay=li,t.svgOverlay=jt,t.DivOverlay=Qr,t.Popup=Qs,t.popup=Hr,t.Tooltip=Ln,t.tooltip=a0,t.Icon=ws,t.icon=i0,t.DivIcon=Ts,t.divIcon=Wo,t.Marker=Ro,t.marker=r0,t.TileLayer=ea,t.tileLayer=Hl,t.GridLayer=es,t.gridLayer=Rt,t.SVG=ts,t.svg=zl,t.Renderer=fn,t.Canvas=xh,t.canvas=Ba,t.Path=xr,t.CircleMarker=Io,t.circleMarker=n0,t.Circle=Ra,t.circle=mh,t.Polyline=Gi,t.polyline=Bo,t.Polygon=qs,t.polygon=s0,t.Rectangle=Ul,t.rectangle=Xo,t.Map=qe,t.map=Ol;var Go=window.L;t.noConflict=function(){return window.L=Go,this},window.L=t})})(Qf,Qf.exports);var ck=Qf.exports;const Tr=Td(ck);var x_={exports:{}};(function(r,e){(function(t,i){i(e)})(ut,function(t){var i=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(s){L.Util.setOptions(this,s),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var a=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,a?this._withAnimation:this._noAnimation),this._markerCluster=a?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(s){if(s instanceof L.LayerGroup)return this.addLayers([s]);if(!s.getLatLng)return this._nonPointGroup.addLayer(s),this.fire("layeradd",{layer:s}),this;if(!this._map)return this._needsClustering.push(s),this.fire("layeradd",{layer:s}),this;if(this.hasLayer(s))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(s,this._maxZoom),this.fire("layeradd",{layer:s}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var a=s,l=this._zoom;if(s.__parent)for(;a.__parent._zoom>=l;)a=a.__parent;return this._currentShownBounds.contains(a.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(s,a):this._animationAddLayerNonAnimated(s,a)),this},removeLayer:function(s){return s instanceof L.LayerGroup?this.removeLayers([s]):s.getLatLng?this._map?s.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(s)),this._removeLayer(s,!0),this.fire("layerremove",{layer:s}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),s.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(s)&&(this._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,s)&&this.hasLayer(s)&&this._needsRemoving.push({layer:s,latlng:s._latlng}),this.fire("layerremove",{layer:s}),this):(this._nonPointGroup.removeLayer(s),this.fire("layerremove",{layer:s}),this)},addLayers:function(s,a){if(!L.Util.isArray(s))return this.addLayer(s);var l=this._featureGroup,h=this._nonPointGroup,c=this.options.chunkedLoading,p=this.options.chunkInterval,g=this.options.chunkProgress,m=s.length,_=0,b=!0,x;if(this._map){var w=new Date().getTime(),P=L.bind(function(){var k=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();_<m;_++){if(c&&_%200===0){var C=new Date().getTime()-k;if(C>p)break}if(x=s[_],x instanceof L.LayerGroup){b&&(s=s.slice(),b=!1),this._extractNonGroupLayers(x,s),m=s.length;continue}if(!x.getLatLng){h.addLayer(x),a||this.fire("layeradd",{layer:x});continue}if(!this.hasLayer(x)&&(this._addLayer(x,this._maxZoom),a||this.fire("layeradd",{layer:x}),x.__parent&&x.__parent.getChildCount()===2)){var O=x.__parent.getAllChildMarkers(),F=O[0]===x?O[1]:O[0];l.removeLayer(F)}}g&&g(_,m,new Date().getTime()-w),_===m?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(P,this.options.chunkDelay)},this);P()}else for(var E=this._needsClustering;_<m;_++){if(x=s[_],x instanceof L.LayerGroup){b&&(s=s.slice(),b=!1),this._extractNonGroupLayers(x,s),m=s.length;continue}if(!x.getLatLng){h.addLayer(x);continue}this.hasLayer(x)||E.push(x)}return this},removeLayers:function(s){var a,l,h=s.length,c=this._featureGroup,p=this._nonPointGroup,g=!0;if(!this._map){for(a=0;a<h;a++){if(l=s[a],l instanceof L.LayerGroup){g&&(s=s.slice(),g=!1),this._extractNonGroupLayers(l,s),h=s.length;continue}this._arraySplice(this._needsClustering,l),p.removeLayer(l),this.hasLayer(l)&&this._needsRemoving.push({layer:l,latlng:l._latlng}),this.fire("layerremove",{layer:l})}return this}if(this._unspiderfy){this._unspiderfy();var m=s.slice(),_=h;for(a=0;a<_;a++){if(l=m[a],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,m),_=m.length;continue}this._unspiderfyLayer(l)}}for(a=0;a<h;a++){if(l=s[a],l instanceof L.LayerGroup){g&&(s=s.slice(),g=!1),this._extractNonGroupLayers(l,s),h=s.length;continue}if(!l.__parent){p.removeLayer(l),this.fire("layerremove",{layer:l});continue}this._removeLayer(l,!0,!0),this.fire("layerremove",{layer:l}),c.hasLayer(l)&&(c.removeLayer(l),l.clusterShow&&l.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(s){s.off(this._childMarkerEventHandlers,this),delete s.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var s=new L.LatLngBounds;this._topClusterLevel&&s.extend(this._topClusterLevel._bounds);for(var a=this._needsClustering.length-1;a>=0;a--)s.extend(this._needsClustering[a].getLatLng());return s.extend(this._nonPointGroup.getBounds()),s},eachLayer:function(s,a){var l=this._needsClustering.slice(),h=this._needsRemoving,c,p,g;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(l),p=l.length-1;p>=0;p--){for(c=!0,g=h.length-1;g>=0;g--)if(h[g].layer===l[p]){c=!1;break}c&&s.call(a,l[p])}this._nonPointGroup.eachLayer(s,a)},getLayers:function(){var s=[];return this.eachLayer(function(a){s.push(a)}),s},getLayer:function(s){var a=null;return s=parseInt(s,10),this.eachLayer(function(l){L.stamp(l)===s&&(a=l)}),a},hasLayer:function(s){if(!s)return!1;var a,l=this._needsClustering;for(a=l.length-1;a>=0;a--)if(l[a]===s)return!0;for(l=this._needsRemoving,a=l.length-1;a>=0;a--)if(l[a].layer===s)return!1;return!!(s.__parent&&s.__parent._group===this)||this._nonPointGroup.hasLayer(s)},zoomToShowLayer:function(s,a){var l=this._map;typeof a!="function"&&(a=function(){});var h=function(){(l.hasLayer(s)||l.hasLayer(s.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",h,this),this.off("animationend",h,this),l.hasLayer(s)?a():s.__parent._icon&&(this.once("spiderfied",a,this),s.__parent.spiderfy()))};s._icon&&this._map.getBounds().contains(s.getLatLng())?a():s.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",h,this),this._map.panTo(s.getLatLng())):(this._map.on("moveend",h,this),this.on("animationend",h,this),s.__parent.zoomToBounds())},onAdd:function(s){this._map=s;var a,l,h;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(s),this._nonPointGroup.addTo(s),this._gridClusters||this._generateInitialClusters(),this._maxLat=s.options.crs.projection.MAX_LATITUDE,a=0,l=this._needsRemoving.length;a<l;a++)h=this._needsRemoving[a],h.newlatlng=h.layer._latlng,h.layer._latlng=h.latlng;for(a=0,l=this._needsRemoving.length;a<l;a++)h=this._needsRemoving[a],this._removeLayer(h.layer,!0),h.layer._latlng=h.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),l=this._needsClustering,this._needsClustering=[],this.addLayers(l,!0)},onRemove:function(s){s.off("zoomend",this._zoomEnd,this),s.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(s){for(var a=s;a&&!a._icon;)a=a.__parent;return a||null},_arraySplice:function(s,a){for(var l=s.length-1;l>=0;l--)if(s[l]===a)return s.splice(l,1),!0},_removeFromGridUnclustered:function(s,a){for(var l=this._map,h=this._gridUnclustered,c=Math.floor(this._map.getMinZoom());a>=c&&h[a].removeObject(s,l.project(s.getLatLng(),a));a--);},_childMarkerDragStart:function(s){s.target.__dragStart=s.target._latlng},_childMarkerMoved:function(s){if(!this._ignoreMove&&!s.target.__dragStart){var a=s.target._popup&&s.target._popup.isOpen();this._moveChild(s.target,s.oldLatLng,s.latlng),a&&s.target.openPopup()}},_moveChild:function(s,a,l){s._latlng=a,this.removeLayer(s),s._latlng=l,this.addLayer(s)},_childMarkerDragEnd:function(s){var a=s.target.__dragStart;delete s.target.__dragStart,a&&this._moveChild(s.target,a,s.target._latlng)},_removeLayer:function(s,a,l){var h=this._gridClusters,c=this._gridUnclustered,p=this._featureGroup,g=this._map,m=Math.floor(this._map.getMinZoom());a&&this._removeFromGridUnclustered(s,this._maxZoom);var _=s.__parent,b=_._markers,x;for(this._arraySplice(b,s);_&&(_._childCount--,_._boundsNeedUpdate=!0,!(_._zoom<m));)a&&_._childCount<=1?(x=_._markers[0]===s?_._markers[1]:_._markers[0],h[_._zoom].removeObject(_,g.project(_._cLatLng,_._zoom)),c[_._zoom].addObject(x,g.project(x.getLatLng(),_._zoom)),this._arraySplice(_.__parent._childClusters,_),_.__parent._markers.push(x),x.__parent=_.__parent,_._icon&&(p.removeLayer(_),l||p.addLayer(x))):_._iconNeedsUpdate=!0,_=_.__parent;delete s.__parent},_isOrIsParent:function(s,a){for(;a;){if(s===a)return!0;a=a.parentNode}return!1},fire:function(s,a,l){if(a&&a.layer instanceof L.MarkerCluster){if(a.originalEvent&&this._isOrIsParent(a.layer._icon,a.originalEvent.relatedTarget))return;s="cluster"+s}L.FeatureGroup.prototype.fire.call(this,s,a,l)},listens:function(s,a){return L.FeatureGroup.prototype.listens.call(this,s,a)||L.FeatureGroup.prototype.listens.call(this,"cluster"+s,a)},_defaultIconCreateFunction:function(s){var a=s.getChildCount(),l=" marker-cluster-";return a<10?l+="small":a<100?l+="medium":l+="large",new L.DivIcon({html:"<div><span>"+a+"</span></div>",className:"marker-cluster"+l,iconSize:new L.Point(40,40)})},_bindEvents:function(){var s=this._map,a=this.options.spiderfyOnMaxZoom,l=this.options.showCoverageOnHover,h=this.options.zoomToBoundsOnClick,c=this.options.spiderfyOnEveryZoom;(a||h||c)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),l&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),s.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(s){var a=s.layer,l=a;if(!(s.type==="clusterkeypress"&&s.originalEvent&&s.originalEvent.keyCode!==13)){for(;l._childClusters.length===1;)l=l._childClusters[0];l._zoom===this._maxZoom&&l._childCount===a._childCount&&this.options.spiderfyOnMaxZoom?a.spiderfy():this.options.zoomToBoundsOnClick&&a.zoomToBounds(),this.options.spiderfyOnEveryZoom&&a.spiderfy(),s.originalEvent&&s.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(s){var a=this._map;this._inZoomAnimation||(this._shownPolygon&&a.removeLayer(this._shownPolygon),s.layer.getChildCount()>2&&s.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(s.layer.getConvexHull(),this.options.polygonOptions),a.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var s=this.options.spiderfyOnMaxZoom,a=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,h=this.options.spiderfyOnEveryZoom,c=this._map;(s||l||h)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),a&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),c.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var s=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,s),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),s),this._currentShownBounds=s}},_generateInitialClusters:function(){var s=Math.ceil(this._map.getMaxZoom()),a=Math.floor(this._map.getMinZoom()),l=this.options.maxClusterRadius,h=l;typeof l!="function"&&(h=function(){return l}),this.options.disableClusteringAtZoom!==null&&(s=this.options.disableClusteringAtZoom-1),this._maxZoom=s,this._gridClusters={},this._gridUnclustered={};for(var c=s;c>=a;c--)this._gridClusters[c]=new L.DistanceGrid(h(c)),this._gridUnclustered[c]=new L.DistanceGrid(h(c));this._topClusterLevel=new this._markerCluster(this,a-1)},_addLayer:function(s,a){var l=this._gridClusters,h=this._gridUnclustered,c=Math.floor(this._map.getMinZoom()),p,g;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(s),s.on(this._childMarkerEventHandlers,this);a>=c;a--){p=this._map.project(s.getLatLng(),a);var m=l[a].getNearObject(p);if(m){m._addChild(s),s.__parent=m;return}if(m=h[a].getNearObject(p),m){var _=m.__parent;_&&this._removeLayer(m,!1);var b=new this._markerCluster(this,a,m,s);l[a].addObject(b,this._map.project(b._cLatLng,a)),m.__parent=b,s.__parent=b;var x=b;for(g=a-1;g>_._zoom;g--)x=new this._markerCluster(this,g,x),l[g].addObject(x,this._map.project(m.getLatLng(),g));_._addChild(x),this._removeFromGridUnclustered(m,a);return}h[a].addObject(s,p)}this._topClusterLevel._addChild(s),s.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(s){s instanceof L.MarkerCluster&&s._iconNeedsUpdate&&s._updateIcon()})},_enqueue:function(s){this._queue.push(s),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var s=0;s<this._queue.length;s++)this._queue[s].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var s=Math.round(this._map._zoom);this._processQueue(),this._zoom<s&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,s)):this._zoom>s?(this._animationStart(),this._animationZoomOut(this._zoom,s)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(s){var a=this._maxLat;return a!==void 0&&(s.getNorth()>=a&&(s._northEast.lat=1/0),s.getSouth()<=-a&&(s._southWest.lat=-1/0)),s},_animationAddLayerNonAnimated:function(s,a){if(a===s)this._featureGroup.addLayer(s);else if(a._childCount===2){a._addToMap();var l=a.getAllChildMarkers();this._featureGroup.removeLayer(l[0]),this._featureGroup.removeLayer(l[1])}else a._updateIcon()},_extractNonGroupLayers:function(s,a){var l=s.getLayers(),h=0,c;for(a=a||[];h<l.length;h++){if(c=l[h],c instanceof L.LayerGroup){this._extractNonGroupLayers(c,a);continue}a.push(c)}return a},_overrideMarkerIcon:function(s){var a=s.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[s]}});return a}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(s,a){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(s,a){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(s,a){this._animationAddLayerNonAnimated(s,a)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(s,a){var l=this._getExpandedVisibleBounds(),h=this._featureGroup,c=Math.floor(this._map.getMinZoom()),p;this._ignoreMove=!0,this._topClusterLevel._recursively(l,s,c,function(g){var m=g._latlng,_=g._markers,b;for(l.contains(m)||(m=null),g._isSingleParent()&&s+1===a?(h.removeLayer(g),g._recursivelyAddChildrenToMap(null,a,l)):(g.clusterHide(),g._recursivelyAddChildrenToMap(m,a,l)),p=_.length-1;p>=0;p--)b=_[p],l.contains(b._latlng)||h.removeLayer(b)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(l,a),h.eachLayer(function(g){!(g instanceof L.MarkerCluster)&&g._icon&&g.clusterShow()}),this._topClusterLevel._recursively(l,s,a,function(g){g._recursivelyRestoreChildPositions(a)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(l,s,c,function(g){h.removeLayer(g),g.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(s,a){this._animationZoomOutSingle(this._topClusterLevel,s-1,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,a,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),s,this._getExpandedVisibleBounds())},_animationAddLayer:function(s,a){var l=this,h=this._featureGroup;h.addLayer(s),a!==s&&(a._childCount>2?(a._updateIcon(),this._forceLayout(),this._animationStart(),s._setPos(this._map.latLngToLayerPoint(a.getLatLng())),s.clusterHide(),this._enqueue(function(){h.removeLayer(s),s.clusterShow(),l._animationEnd()})):(this._forceLayout(),l._animationStart(),l._animationZoomOutSingle(a,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(s,a,l){var h=this._getExpandedVisibleBounds(),c=Math.floor(this._map.getMinZoom());s._recursivelyAnimateChildrenInAndAddSelfToMap(h,c,a+1,l);var p=this;this._forceLayout(),s._recursivelyBecomeVisible(h,l),this._enqueue(function(){if(s._childCount===1){var g=s._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else s._recursively(h,l,c,function(m){m._recursivelyRemoveChildrenFromMap(h,c,a+1)});p._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(s){return new L.MarkerClusterGroup(s)};var n=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(s,a,l,h){L.Marker.prototype.initialize.call(this,l?l._cLatLng||l.getLatLng():new L.LatLng(0,0),{icon:this,pane:s.options.clusterPane}),this._group=s,this._zoom=a,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,l&&this._addChild(l),h&&this._addChild(h)},getAllChildMarkers:function(s,a){s=s||[];for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l].getAllChildMarkers(s,a);for(var h=this._markers.length-1;h>=0;h--)a&&this._markers[h].__dragStart||s.push(this._markers[h]);return s},getChildCount:function(){return this._childCount},zoomToBounds:function(s){for(var a=this._childClusters.slice(),l=this._group._map,h=l.getBoundsZoom(this._bounds),c=this._zoom+1,p=l.getZoom(),g;a.length>0&&h>c;){c++;var m=[];for(g=0;g<a.length;g++)m=m.concat(a[g]._childClusters);a=m}h>c?this._group._map.setView(this._latlng,c):h<=p?this._group._map.setView(this._latlng,p+1):this._group._map.fitBounds(this._bounds,s)},getBounds:function(){var s=new L.LatLngBounds;return s.extend(this._bounds),s},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(s,a){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(s),s instanceof L.MarkerCluster?(a||(this._childClusters.push(s),s.__parent=this),this._childCount+=s._childCount):(a||this._markers.push(s),this._childCount++),this.__parent&&this.__parent._addChild(s,!0)},_setClusterCenter:function(s){this._cLatLng||(this._cLatLng=s._cLatLng||s._latlng)},_resetBounds:function(){var s=this._bounds;s._southWest&&(s._southWest.lat=1/0,s._southWest.lng=1/0),s._northEast&&(s._northEast.lat=-1/0,s._northEast.lng=-1/0)},_recalculateBounds:function(){var s=this._markers,a=this._childClusters,l=0,h=0,c=this._childCount,p,g,m,_;if(c!==0){for(this._resetBounds(),p=0;p<s.length;p++)m=s[p]._latlng,this._bounds.extend(m),l+=m.lat,h+=m.lng;for(p=0;p<a.length;p++)g=a[p],g._boundsNeedUpdate&&g._recalculateBounds(),this._bounds.extend(g._bounds),m=g._wLatLng,_=g._childCount,l+=m.lat*_,h+=m.lng*_;this._latlng=this._wLatLng=new L.LatLng(l/c,h/c),this._boundsNeedUpdate=!1}},_addToMap:function(s){s&&(this._backupLatlng=this._latlng,this.setLatLng(s)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(s,a,l){this._recursively(s,this._group._map.getMinZoom(),l-1,function(h){var c=h._markers,p,g;for(p=c.length-1;p>=0;p--)g=c[p],g._icon&&(g._setPos(a),g.clusterHide())},function(h){var c=h._childClusters,p,g;for(p=c.length-1;p>=0;p--)g=c[p],g._icon&&(g._setPos(a),g.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(s,a,l,h){this._recursively(s,h,a,function(c){c._recursivelyAnimateChildrenIn(s,c._group._map.latLngToLayerPoint(c.getLatLng()).round(),l),c._isSingleParent()&&l-1===h?(c.clusterShow(),c._recursivelyRemoveChildrenFromMap(s,a,l)):c.clusterHide(),c._addToMap()})},_recursivelyBecomeVisible:function(s,a){this._recursively(s,this._group._map.getMinZoom(),a,null,function(l){l.clusterShow()})},_recursivelyAddChildrenToMap:function(s,a,l){this._recursively(l,this._group._map.getMinZoom()-1,a,function(h){if(a!==h._zoom)for(var c=h._markers.length-1;c>=0;c--){var p=h._markers[c];l.contains(p._latlng)&&(s&&(p._backupLatlng=p.getLatLng(),p.setLatLng(s),p.clusterHide&&p.clusterHide()),h._group._featureGroup.addLayer(p))}},function(h){h._addToMap(s)})},_recursivelyRestoreChildPositions:function(s){for(var a=this._markers.length-1;a>=0;a--){var l=this._markers[a];l._backupLatlng&&(l.setLatLng(l._backupLatlng),delete l._backupLatlng)}if(s-1===this._zoom)for(var h=this._childClusters.length-1;h>=0;h--)this._childClusters[h]._restorePosition();else for(var c=this._childClusters.length-1;c>=0;c--)this._childClusters[c]._recursivelyRestoreChildPositions(s)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(s,a,l,h){var c,p;this._recursively(s,a-1,l-1,function(g){for(p=g._markers.length-1;p>=0;p--)c=g._markers[p],(!h||!h.contains(c._latlng))&&(g._group._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow())},function(g){for(p=g._childClusters.length-1;p>=0;p--)c=g._childClusters[p],(!h||!h.contains(c._latlng))&&(g._group._featureGroup.removeLayer(c),c.clusterShow&&c.clusterShow())})},_recursively:function(s,a,l,h,c){var p=this._childClusters,g=this._zoom,m,_;if(a<=g&&(h&&h(this),c&&g===l&&c(this)),g<a||g<l)for(m=p.length-1;m>=0;m--)_=p[m],_._boundsNeedUpdate&&_._recalculateBounds(),s.intersects(_._bounds)&&_._recursively(s,a,l,h,c)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var s=this.options.opacity;return this.setOpacity(0),this.options.opacity=s,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(s){this._cellSize=s,this._sqCellSize=s*s,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(s,a){var l=this._getCoord(a.x),h=this._getCoord(a.y),c=this._grid,p=c[h]=c[h]||{},g=p[l]=p[l]||[],m=L.Util.stamp(s);this._objectPoint[m]=a,g.push(s)},updateObject:function(s,a){this.removeObject(s),this.addObject(s,a)},removeObject:function(s,a){var l=this._getCoord(a.x),h=this._getCoord(a.y),c=this._grid,p=c[h]=c[h]||{},g=p[l]=p[l]||[],m,_;for(delete this._objectPoint[L.Util.stamp(s)],m=0,_=g.length;m<_;m++)if(g[m]===s)return g.splice(m,1),_===1&&delete p[l],!0},eachObject:function(s,a){var l,h,c,p,g,m,_,b=this._grid;for(l in b){g=b[l];for(h in g)for(m=g[h],c=0,p=m.length;c<p;c++)_=s.call(a,m[c]),_&&(c--,p--)}},getNearObject:function(s){var a=this._getCoord(s.x),l=this._getCoord(s.y),h,c,p,g,m,_,b,x,w=this._objectPoint,P=this._sqCellSize,E=null;for(h=l-1;h<=l+1;h++)if(g=this._grid[h],g){for(c=a-1;c<=a+1;c++)if(m=g[c],m)for(p=0,_=m.length;p<_;p++)b=m[p],x=this._sqDist(w[L.Util.stamp(b)],s),(x<P||x<=P&&E===null)&&(P=x,E=b)}return E},_getCoord:function(s){var a=Math.floor(s/this._cellSize);return isFinite(a)?a:s},_sqDist:function(s,a){var l=a.x-s.x,h=a.y-s.y;return l*l+h*h}},function(){L.QuickHull={getDistant:function(s,a){var l=a[1].lat-a[0].lat,h=a[0].lng-a[1].lng;return h*(s.lat-a[0].lat)+l*(s.lng-a[0].lng)},findMostDistantPointFromBaseLine:function(s,a){var l=0,h=null,c=[],p,g,m;for(p=a.length-1;p>=0;p--){if(g=a[p],m=this.getDistant(g,s),m>0)c.push(g);else continue;m>l&&(l=m,h=g)}return{maxPoint:h,newPoints:c}},buildConvexHull:function(s,a){var l=[],h=this.findMostDistantPointFromBaseLine(s,a);return h.maxPoint?(l=l.concat(this.buildConvexHull([s[0],h.maxPoint],h.newPoints)),l=l.concat(this.buildConvexHull([h.maxPoint,s[1]],h.newPoints)),l):[s[0]]},getConvexHull:function(s){var a=!1,l=!1,h=!1,c=!1,p=null,g=null,m=null,_=null,b=null,x=null,w;for(w=s.length-1;w>=0;w--){var P=s[w];(a===!1||P.lat>a)&&(p=P,a=P.lat),(l===!1||P.lat<l)&&(g=P,l=P.lat),(h===!1||P.lng>h)&&(m=P,h=P.lng),(c===!1||P.lng<c)&&(_=P,c=P.lng)}l!==a?(x=g,b=p):(x=_,b=m);var E=[].concat(this.buildConvexHull([x,b],s),this.buildConvexHull([b,x],s));return E}}}(),L.MarkerCluster.include({getConvexHull:function(){var s=this.getAllChildMarkers(),a=[],l,h;for(h=s.length-1;h>=0;h--)l=s[h].getLatLng(),a.push(l);return L.QuickHull.getConvexHull(a)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var s=this.getAllChildMarkers(null,!0),a=this._group,l=a._map,h=l.latLngToLayerPoint(this._latlng),c;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?c=this._group.options.spiderfyShapePositions(s.length,h):s.length>=this._circleSpiralSwitchover?c=this._generatePointsSpiral(s.length,h):(h.y+=10,c=this._generatePointsCircle(s.length,h)),this._animationSpiderfy(s,c)}},unspiderfy:function(s){this._group._inZoomAnimation||(this._animationUnspiderfy(s),this._group._spiderfied=null)},_generatePointsCircle:function(s,a){var l=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+s),h=l/this._2PI,c=this._2PI/s,p=[],g,m;for(h=Math.max(h,35),p.length=s,g=0;g<s;g++)m=this._circleStartAngle+g*c,p[g]=new L.Point(a.x+h*Math.cos(m),a.y+h*Math.sin(m))._round();return p},_generatePointsSpiral:function(s,a){var l=this._group.options.spiderfyDistanceMultiplier,h=l*this._spiralLengthStart,c=l*this._spiralFootSeparation,p=l*this._spiralLengthFactor*this._2PI,g=0,m=[],_;for(m.length=s,_=s;_>=0;_--)_<s&&(m[_]=new L.Point(a.x+h*Math.cos(g),a.y+h*Math.sin(g))._round()),g+=c/h+_*5e-4,h+=p/g;return m},_noanimationUnspiderfy:function(){var s=this._group,a=s._map,l=s._featureGroup,h=this.getAllChildMarkers(null,!0),c,p;for(s._ignoreMove=!0,this.setOpacity(1),p=h.length-1;p>=0;p--)c=h[p],l.removeLayer(c),c._preSpiderfyLatlng&&(c.setLatLng(c._preSpiderfyLatlng),delete c._preSpiderfyLatlng),c.setZIndexOffset&&c.setZIndexOffset(0),c._spiderLeg&&(a.removeLayer(c._spiderLeg),delete c._spiderLeg);s.fire("unspiderfied",{cluster:this,markers:h}),s._ignoreMove=!1,s._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(s,a){var l=this._group,h=l._map,c=l._featureGroup,p=this._group.options.spiderLegPolylineOptions,g,m,_,b;for(l._ignoreMove=!0,g=0;g<s.length;g++)b=h.layerPointToLatLng(a[g]),m=s[g],_=new L.Polyline([this._latlng,b],p),h.addLayer(_),m._spiderLeg=_,m._preSpiderfyLatlng=m._latlng,m.setLatLng(b),m.setZIndexOffset&&m.setZIndexOffset(1e6),c.addLayer(m);this.setOpacity(.3),l._ignoreMove=!1,l.fire("spiderfied",{cluster:this,markers:s})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(s,a){var l=this,h=this._group,c=h._map,p=h._featureGroup,g=this._latlng,m=c.latLngToLayerPoint(g),_=L.Path.SVG,b=L.extend({},this._group.options.spiderLegPolylineOptions),x=b.opacity,w,P,E,k,C,O;for(x===void 0&&(x=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),_?(b.opacity=0,b.className=(b.className||"")+" leaflet-cluster-spider-leg"):b.opacity=x,h._ignoreMove=!0,w=0;w<s.length;w++)P=s[w],O=c.layerPointToLatLng(a[w]),E=new L.Polyline([g,O],b),c.addLayer(E),P._spiderLeg=E,_&&(k=E._path,C=k.getTotalLength()+.1,k.style.strokeDasharray=C,k.style.strokeDashoffset=C),P.setZIndexOffset&&P.setZIndexOffset(1e6),P.clusterHide&&P.clusterHide(),p.addLayer(P),P._setPos&&P._setPos(m);for(h._forceLayout(),h._animationStart(),w=s.length-1;w>=0;w--)O=c.layerPointToLatLng(a[w]),P=s[w],P._preSpiderfyLatlng=P._latlng,P.setLatLng(O),P.clusterShow&&P.clusterShow(),_&&(E=P._spiderLeg,k=E._path,k.style.strokeDashoffset=0,E.setStyle({opacity:x}));this.setOpacity(.3),h._ignoreMove=!1,setTimeout(function(){h._animationEnd(),h.fire("spiderfied",{cluster:l,markers:s})},200)},_animationUnspiderfy:function(s){var a=this,l=this._group,h=l._map,c=l._featureGroup,p=s?h._latLngToNewLayerPoint(this._latlng,s.zoom,s.center):h.latLngToLayerPoint(this._latlng),g=this.getAllChildMarkers(null,!0),m=L.Path.SVG,_,b,x,w,P,E;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),b=g.length-1;b>=0;b--)_=g[b],_._preSpiderfyLatlng&&(_.closePopup(),_.setLatLng(_._preSpiderfyLatlng),delete _._preSpiderfyLatlng,E=!0,_._setPos&&(_._setPos(p),E=!1),_.clusterHide&&(_.clusterHide(),E=!1),E&&c.removeLayer(_),m&&(x=_._spiderLeg,w=x._path,P=w.getTotalLength()+.1,w.style.strokeDashoffset=P,x.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout(function(){var k=0;for(b=g.length-1;b>=0;b--)_=g[b],_._spiderLeg&&k++;for(b=g.length-1;b>=0;b--)_=g[b],_._spiderLeg&&(_.clusterShow&&_.clusterShow(),_.setZIndexOffset&&_.setZIndexOffset(0),k>1&&c.removeLayer(_),h.removeLayer(_._spiderLeg),delete _._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:a,markers:g})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(s){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(s))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(s){this._spiderfied&&this._spiderfied.unspiderfy(s)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(s){s._spiderLeg&&(this._featureGroup.removeLayer(s),s.clusterShow&&s.clusterShow(),s.setZIndexOffset&&s.setZIndexOffset(0),this._map.removeLayer(s._spiderLeg),delete s._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(s){return s?s instanceof L.MarkerClusterGroup?s=s._topClusterLevel.getAllChildMarkers():s instanceof L.LayerGroup?s=s._layers:s instanceof L.MarkerCluster?s=s.getAllChildMarkers():s instanceof L.Marker&&(s=[s]):s=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(s),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(s),this},_flagParentsIconsNeedUpdate:function(s){var a,l;for(a in s)for(l=s[a].__parent;l;)l._iconNeedsUpdate=!0,l=l.__parent},_refreshSingleMarkerModeMarkers:function(s){var a,l;for(a in s)l=s[a],this.hasLayer(l)&&l.setIcon(this._overrideMarkerIcon(l))}}),L.Marker.include({refreshIconOptions:function(s,a){var l=this.options.icon;return L.setOptions(l,s),this.setIcon(l),a&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),t.MarkerClusterGroup=i,t.MarkerCluster=n,Object.defineProperty(t,"__esModule",{value:!0})})})(x_,x_.exports);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xm=1252,fk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ed={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ad=function(r){fk.indexOf(r)!=-1&&(Xm=Ed[0]=r)};function dk(){Ad(1252)}var zn=function(r){Ad(r)};function Gm(){zn(1200),dk()}function v_(r){for(var e=[],t=0,i=r.length;t<i;++t)e[t]=r.charCodeAt(t);return e}function pk(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Ym(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var tu=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?pk(r.slice(2)):e==254&&t==255?Ym(r.slice(2)):e==65279?r.slice(1):r},Vh=function(e){return String.fromCharCode(e)},y_=function(e){return String.fromCharCode(e)},ca,da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b_(r){for(var e="",t=0,i=0,n=0,s=0,a=0,l=0,h=0,c=0;c<r.length;)t=r.charCodeAt(c++),s=t>>2,i=r.charCodeAt(c++),a=(t&3)<<4|i>>4,n=r.charCodeAt(c++),l=(i&15)<<2|n>>6,h=n&63,isNaN(i)?l=h=64:isNaN(n)&&(h=64),e+=da.charAt(s)+da.charAt(a)+da.charAt(l)+da.charAt(h);return e}function un(r){var e="",t=0,i=0,n=0,s=0,a=0,l=0,h=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<r.length;)s=da.indexOf(r.charAt(c++)),a=da.indexOf(r.charAt(c++)),t=s<<2|a>>4,e+=String.fromCharCode(t),l=da.indexOf(r.charAt(c++)),i=(a&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(i)),h=da.indexOf(r.charAt(c++)),n=(l&3)<<6|h,h!==64&&(e+=String.fromCharCode(n));return e}var Ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),go=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function _a(r){return Ct?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function w_(r){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Hn=function(e){return Ct?go(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function _o(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function Cd(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return Cd(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var fa=Ct?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:go(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var i=new Uint8Array(t),n=0;for(e=0,t=0;e<r.length;t+=n,++e)if(n=r[e].length,r[e]instanceof Uint8Array)i.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";i.set(new Uint8Array(r[e]),t)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function gk(r){for(var e=[],t=0,i=r.length+250,n=_a(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=r.charCodeAt(++s)&1023;n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|l>>6&15|(a&3)<<4,n[t++]=128|l&63}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|a&63;t>i&&(e.push(n.slice(0,t)),t=0,n=_a(65535),i=65530)}return e.push(n.slice(0,t)),fa(e)}var Sr=/\u0000/g,iu=/[\u0001-\u0006]/g;function nl(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Un(r,e){var t=""+r;return t.length>=e?t:ci("0",e-t.length)+t}function Sd(r,e){var t=""+r;return t.length>=e?t:ci(" ",e-t.length)+t}function fc(r,e){var t=""+r;return t.length>=e?t:t+ci(" ",e-t.length)}function _k(r,e){var t=""+Math.round(r);return t.length>=e?t:ci("0",e-t.length)+t}function mk(r,e){var t=""+r;return t.length>=e?t:ci("0",e-t.length)+t}var T_=Math.pow(2,32);function Jo(r,e){if(r>T_||r<-T_)return _k(r,e);var t=Math.round(r);return mk(t,e)}function dc(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var k_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ff=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function xk(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var dt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},P_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pc(r,e,t){for(var i=r<0?-1:1,n=r*i,s=0,a=1,l=0,h=1,c=0,p=0,g=Math.floor(n);c<e&&(g=Math.floor(n),l=g*a+s,p=g*c+h,!(n-g<5e-8));)n=1/(n-g),s=a,a=l,h=c,c=p;if(p>e&&(c>e?(p=h,l=s):(p=c,l=a)),!t)return[0,i*l,p];var m=Math.floor(i*l/p);return[m,i*l-m*p,p]}function Qa(r,e,t){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],l={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++i,++l.D)),i===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),a=[h.getFullYear(),h.getMonth()+1,h.getDate()],s=h.getDay(),i<60&&(s=(s+6)%7),t&&(s=Pk(h,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=s,l}var Vm=new Date(1899,11,31,0,0,0),yk=Vm.getTime(),bk=new Date(1900,2,1,0,0,0);function Zm(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=bk&&(t+=24*60*60*1e3),(t-(yk+(r.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dd(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wk(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Tk(r){var e=r<0?12:11,t=Dd(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function kk(r){var e=Dd(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function bu(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Tk(r):e===10?t=r.toFixed(10).substr(0,12):t=kk(r),Dd(wk(t.toUpperCase()))}function ro(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):bu(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return wn(14,Zm(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function Pk(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function Ek(r,e,t,i){var n="",s=0,a=0,l=t.y,h,c=0;switch(r){case 98:l=t.y+543;case 121:switch(e.length){case 1:case 2:h=l%100,c=2;break;default:h=l%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:h=t.m,c=e.length;break;case 3:return Ff[t.m-1][1];case 5:return Ff[t.m-1][0];default:return Ff[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=t.d,c=e.length;break;case 3:return k_[t.q][0];default:return k_[t.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(t.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=t.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=t.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Un(t.S,e.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(n=Un(s,2+i),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:h=l,c=1;break}var p=c>0?Un(h,c):"";return p}function pa(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,i=r.substr(0,t);t!=r.length;t+=e)i+=(i.length>0?",":"")+r.substr(t,e);return i}var Km=/%/g;function Ak(r,e,t){var i=e.replace(Km,""),n=e.length-i.length;return Is(r,i,t*Math.pow(10,2*n))+ci("%",n)}function Ck(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Is(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function $m(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+$m(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,c,p){return h+c+p.substr(0,(n+s)%n)+"."+p.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var qm=/# (\?+)( ?)\/( ?)(\d+)/;function Sk(r,e,t){var i=parseInt(r[4],10),n=Math.round(e*i),s=Math.floor(n/i),a=n-s*i,l=i;return t+(s===0?"":""+s)+" "+(a===0?ci(" ",r[1].length+1+r[4].length):Sd(a,r[1].length)+r[2]+"/"+r[3]+Un(l,r[4].length))}function Dk(r,e,t){return t+(e===0?"":""+e)+ci(" ",r[1].length+2+r[4].length)}var Jm=/^#*0*\.([0#]+)/,Qm=/\).*[0#]/,ex=/\(###\) ###\\?-####/;function Pr(r){for(var e="",t,i=0;i!=r.length;++i)switch(t=r.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function E_(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function A_(r,e){var t=r-Math.floor(r),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function Lk(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function Ok(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function xn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Qm)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?xn("n",i,t):"("+xn("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Ck(r,e,t);if(e.indexOf("%")!==-1)return Ak(r,e,t);if(e.indexOf("E")!==-1)return $m(e,t);if(e.charCodeAt(0)===36)return"$"+xn(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,l,h=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Jo(h,e.length);if(e.match(/^[#?]+$/))return n=Jo(t,0),n==="0"&&(n=""),n.length>e.length?n:Pr(e.substr(0,e.length-n.length))+n;if(s=e.match(qm))return Sk(s,h,c);if(e.match(/^#+0+$/))return c+Jo(h,e.length-e.indexOf("0"));if(s=e.match(Jm))return n=E_(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])).replace(/\.(\d*)$/,function(b,x){return"."+x+ci("0",Pr(s[1]).length-x.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+E_(h,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+pa(Jo(h,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+xn(r,e,-t):pa(""+(Math.floor(t)+Lk(t,s[1].length)))+"."+Un(A_(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return xn(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=nl(xn(r,e.replace(/[\\-]/g,""),t)),a=0,nl(nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return a<n.length?n.charAt(a++):b==="0"?"0":""}));if(e.match(ex))return n=xn(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=pc(h,Math.pow(10,a)-1,!1),n=""+c,p=Is("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+s[2]+"/"+s[3],p=fc(l[2],a),p.length<s[4].length&&(p=Pr(s[4].substr(s[4].length-p.length))+p),n+=p,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=pc(h,Math.pow(10,a)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sd(l[1],a)+s[2]+"/"+s[3]+fc(l[2],a):ci(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Jo(t,0),e.length<=n.length?n:Pr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var g=e.indexOf(".")-a,m=e.length-n.length-g;return Pr(e.substr(0,g)+n+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=A_(t,s[1].length),t<0?"-"+xn(r,e,-t):pa(Ok(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Un(0,3-b.length):"")+b})+"."+Un(a,s[1].length);switch(e){case"###,##0.00":return xn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var _=pa(Jo(h,0));return _!=="0"?c+_:"";case"###,###.00":return xn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return xn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Mk(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Is(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function Fk(r,e,t){var i=e.replace(Km,""),n=e.length-i.length;return Is(r,i,t*Math.pow(10,2*n))+ci("%",n)}function tx(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+tx(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,c,p){return h+c+p.substr(0,(n+s)%n)+"."+p.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function us(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Qm)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?us("n",i,t):"("+us("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Mk(r,e,t);if(e.indexOf("%")!==-1)return Fk(r,e,t);if(e.indexOf("E")!==-1)return tx(e,t);if(e.charCodeAt(0)===36)return"$"+us(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,l,h=Math.abs(t),c=t<0?"-":"";if(e.match(/^00+$/))return c+Un(h,e.length);if(e.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>e.length?n:Pr(e.substr(0,e.length-n.length))+n;if(s=e.match(qm))return Dk(s,h,c);if(e.match(/^#+0+$/))return c+Un(h,e.length-e.indexOf("0"));if(s=e.match(Jm))return n=(""+t).replace(/^([^\.]+)$/,"$1."+Pr(s[1])).replace(/\.$/,"."+Pr(s[1])),n=n.replace(/\.(\d*)$/,function(b,x){return"."+x+ci("0",Pr(s[1]).length-x.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+pa(""+h);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+us(r,e,-t):pa(""+t)+"."+ci("0",s[1].length);if(s=e.match(/^#,#*,#0/))return us(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=nl(us(r,e.replace(/[\\-]/g,""),t)),a=0,nl(nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return a<n.length?n.charAt(a++):b==="0"?"0":""}));if(e.match(ex))return n=us(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=pc(h,Math.pow(10,a)-1,!1),n=""+c,p=Is("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+s[2]+"/"+s[3],p=fc(l[2],a),p.length<s[4].length&&(p=Pr(s[4].substr(s[4].length-p.length))+p),n+=p,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=pc(h,Math.pow(10,a)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sd(l[1],a)+s[2]+"/"+s[3]+fc(l[2],a):ci(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+t,e.length<=n.length?n:Pr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var g=e.indexOf(".")-a,m=e.length-n.length-g;return Pr(e.substr(0,g)+n+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+us(r,e,-t):pa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Un(0,3-b.length):"")+b})+"."+Un(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=pa(""+h);return _!=="0"?c+_:"";default:if(e.match(/\.[0#?]*$/))return us(r,e.slice(0,e.lastIndexOf(".")),t)+Pr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Is(r,e,t){return(t|0)===t?us(r,e,t):xn(r,e,t)}function Rk(r){for(var e=[],t=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=r.substr(n,i-n),n=i+1}if(e[e.length]=r.substr(n),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var ix=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vl(r){for(var e=0,t="",i="";e<r.length;)switch(t=r.charAt(e)){case"G":dc(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(i=t;r.charAt(e++)!=="]"&&e<r.length;)i+=r.charAt(e);if(i.match(ix))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Ik(r,e,t,i){for(var n=[],s="",a=0,l="",h="t",c,p,g,m="H";a<r.length;)switch(l=r.charAt(a)){case"G":if(!dc(r,a))throw new Error("unrecognized character "+l+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(g);n[n.length]={t:"t",v:s},++a;break;case"\\":var _=r.charAt(++a),b=_==="("||_===")"?_:"t";n[n.length]={t:b,v:_},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(c==null&&(c=Qa(e,t,r.charAt(a+1)==="2"),c==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},h=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Qa(e,t),c==null))return"";for(s=l;++a<r.length&&r.charAt(a).toLowerCase()===l;)s+=l;l==="m"&&h.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),n[n.length]={t:l,v:s},h=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(c==null&&(c=Qa(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):r.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(x.v=c.H>=12?"下午":"上午"),x.t="T",a+=5,m="h"):(x.t="t",++a),c==null&&x.t==="T")return"";n[n.length]=x,h=l;break;case"[":for(s=l;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ix)){if(c==null&&(c=Qa(e,t),c==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",vl(r)||(n[n.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=l;++a<r.length&&(l=r.charAt(a))==="0";)s+=l;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++a<r.length&&"0#?.,E+-%".indexOf(l=r.charAt(a))>-1;)s+=l;n[n.length]={t:"n",v:s};break;case"?":for(s=l;r.charAt(++a)===l;)s+=l;n[n.length]={t:l,v:s},h=l;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:l,v:l},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+r);n[n.length]={t:"t",v:l},++a;break}var w=0,P=0,E;for(a=n.length-1,h="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=m,h="h",w<1&&(w=1);break;case"s":(E=n[a].v.match(/\.0+$/))&&(P=Math.max(P,E[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":h=n[a].t;break;case"m":h==="s"&&(n[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[a].v.match(/[Hh]/)&&(w=1),w<2&&n[a].v.match(/[Mm]/)&&(w=2),w<3&&n[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var k="",C;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=Ek(n[a].t.charCodeAt(0),n[a].v,c,P),n[a].t="t";break;case"n":case"?":for(C=a+1;n[C]!=null&&((l=n[C].t)==="?"||l==="D"||(l===" "||l==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[a].v+=n[C].v,n[C]={v:"",t:";"},++C;k+=n[a].v,a=C-1;break;case"G":n[a].t="t",n[a].v=ro(e,t);break}var O="",F,D;if(k.length>0){k.charCodeAt(0)==40?(F=e<0&&k.charCodeAt(0)===45?-e:e,D=Is("n",k,F)):(F=e<0&&i>1?-e:e,D=Is("n",k,F),F<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),C=D.length-1;var N=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){N=a;break}var X=n.length;if(N===n.length&&D.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(C>=n[a].v.length-1?(C-=n[a].v.length,n[a].v=D.substr(C+1,n[a].v.length)):C<0?n[a].v="":(n[a].v=D.substr(0,C+1),C=-1),n[a].t="t",X=a);C>=0&&X<n.length&&(n[X].v=D.substr(0,C+1)+n[X].v)}else if(N!==n.length&&D.indexOf("E")===-1){for(C=D.indexOf(".")-1,a=N;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(p=n[a].v.indexOf(".")>-1&&a===N?n[a].v.indexOf(".")-1:n[a].v.length-1,O=n[a].v.substr(p+1);p>=0;--p)C>=0&&(n[a].v.charAt(p)==="0"||n[a].v.charAt(p)==="#")&&(O=D.charAt(C--)+O);n[a].v=O,n[a].t="t",X=a}for(C>=0&&X<n.length&&(n[X].v=D.substr(0,C+1)+n[X].v),C=D.indexOf(".")+1,a=N;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==N)){for(p=n[a].v.indexOf(".")>-1&&a===N?n[a].v.indexOf(".")+1:0,O=n[a].v.substr(0,p);p<n[a].v.length;++p)C<D.length&&(O+=D.charAt(C++));n[a].v=O,n[a].t="t",X=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(F=i>1&&e<0&&a>0&&n[a-1].v==="-"?-e:e,n[a].v=Is(n[a].t,n[a].v,F),n[a].t="t");var z="";for(a=0;a!==n.length;++a)n[a]!=null&&(z+=n[a].v);return z}var C_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function S_(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function Bk(r,e){var t=Rk(r),i=t.length,n=t[i-1].indexOf("@");if(i<4&&n>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(C_),l=t[1].match(C_);return S_(e,a)?[i,t[0]]:S_(e,l)?[i,t[1]]:[i,t[a!=null&&l!=null?2:1]]}return[i,s]}function wn(r,e,t){t==null&&(t={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?i=t.dateNF:i=r;break;case"number":r==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:dt)[r],i==null&&(i=t.table&&t.table[P_[r]]||dt[P_[r]]),i==null&&(i=vk[r]||"General");break}if(dc(i,0))return ro(e,t);e instanceof Date&&(e=Zm(e,t.date1904));var n=Bk(i,e);if(dc(n[1]))return ro(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Ik(n[1],e,t,n[0])}function eo(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(dt[t]==null){e<0&&(e=t);continue}if(dt[t]==r){e=t;break}}e<0&&(e=391)}return dt[e]=r,e}function rx(){dt=xk()}var Nk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hk(r){var e=typeof r=="number"?dt[r]:r;return e=e.replace(nx,"(\\d+)"),new RegExp("^"+e+"$")}function zk(r,e,t){var i=-1,n=-1,s=-1,a=-1,l=-1,h=-1;(e.match(nx)||[]).forEach(function(g,m){var _=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":i=_;break;case"d":s=_;break;case"h":a=_;break;case"s":h=_;break;case"m":a>=0?l=_:n=_;break}}),h>=0&&l==-1&&n>=0&&(l=n,n=-1);var c=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var p=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return a==-1&&l==-1&&h==-1?c:i==-1&&n==-1&&s==-1?p:c+"T"+p}var Uk=function(){var r={};r.version="1.2.0";function e(){for(var D=0,N=new Array(256),X=0;X!=256;++X)D=X,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,N[X]=D;return typeof Int32Array<"u"?new Int32Array(N):N}var t=e();function i(D){var N=0,X=0,z=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)U[z]=D[z];for(z=0;z!=256;++z)for(X=D[z],N=256+z;N<4096;N+=256)X=U[N]=X>>>8^D[X&255];var j=[];for(z=1;z!=16;++z)j[z-1]=typeof Int32Array<"u"?U.subarray(z*256,z*256+256):U.slice(z*256,z*256+256);return j}var n=i(t),s=n[0],a=n[1],l=n[2],h=n[3],c=n[4],p=n[5],g=n[6],m=n[7],_=n[8],b=n[9],x=n[10],w=n[11],P=n[12],E=n[13],k=n[14];function C(D,N){for(var X=N^-1,z=0,U=D.length;z<U;)X=X>>>8^t[(X^D.charCodeAt(z++))&255];return~X}function O(D,N){for(var X=N^-1,z=D.length-15,U=0;U<z;)X=k[D[U++]^X&255]^E[D[U++]^X>>8&255]^P[D[U++]^X>>16&255]^w[D[U++]^X>>>24]^x[D[U++]]^b[D[U++]]^_[D[U++]]^m[D[U++]]^g[D[U++]]^p[D[U++]]^c[D[U++]]^h[D[U++]]^l[D[U++]]^a[D[U++]]^s[D[U++]]^t[D[U++]];for(z+=15;U<z;)X=X>>>8^t[(X^D[U++])&255];return~X}function F(D,N){for(var X=N^-1,z=0,U=D.length,j=0,q=0;z<U;)j=D.charCodeAt(z++),j<128?X=X>>>8^t[(X^j)&255]:j<2048?(X=X>>>8^t[(X^(192|j>>6&31))&255],X=X>>>8^t[(X^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,q=D.charCodeAt(z++)&1023,X=X>>>8^t[(X^(240|j>>8&7))&255],X=X>>>8^t[(X^(128|j>>2&63))&255],X=X>>>8^t[(X^(128|q>>6&15|(j&3)<<4))&255],X=X>>>8^t[(X^(128|q&63))&255]):(X=X>>>8^t[(X^(224|j>>12&15))&255],X=X>>>8^t[(X^(128|j>>6&63))&255],X=X>>>8^t[(X^(128|j&63))&255]);return~X}return r.table=t,r.bstr=C,r.buf=O,r.str=F,r}(),Dt=function(){var e={};e.version="1.2.1";function t(I,Z){for(var G=I.split("/"),V=Z.split("/"),K=0,Q=0,_e=Math.min(G.length,V.length);K<_e;++K){if(Q=G[K].length-V[K].length)return Q;if(G[K]!=V[K])return G[K]<V[K]?-1:1}return G.length-V.length}function i(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:i(I.slice(0,-1));var Z=I.lastIndexOf("/");return Z===-1?I:I.slice(0,Z+1)}function n(I){if(I.charAt(I.length-1)=="/")return n(I.slice(0,-1));var Z=I.lastIndexOf("/");return Z===-1?I:I.slice(Z+1)}function s(I,Z){typeof Z=="string"&&(Z=new Date(Z));var G=Z.getHours();G=G<<6|Z.getMinutes(),G=G<<5|Z.getSeconds()>>>1,I.write_shift(2,G);var V=Z.getFullYear()-1980;V=V<<4|Z.getMonth()+1,V=V<<5|Z.getDate(),I.write_shift(2,V)}function a(I){var Z=I.read_shift(2)&65535,G=I.read_shift(2)&65535,V=new Date,K=G&31;G>>>=5;var Q=G&15;G>>>=4,V.setMilliseconds(0),V.setFullYear(G+1980),V.setMonth(Q-1),V.setDate(K);var _e=Z&31;Z>>>=5;var Te=Z&63;return Z>>>=6,V.setHours(Z),V.setMinutes(Te),V.setSeconds(_e<<1),V}function l(I){$i(I,0);for(var Z={},G=0;I.l<=I.length-4;){var V=I.read_shift(2),K=I.read_shift(2),Q=I.l+K,_e={};switch(V){case 21589:G=I.read_shift(1),G&1&&(_e.mtime=I.read_shift(4)),K>5&&(G&2&&(_e.atime=I.read_shift(4)),G&4&&(_e.ctime=I.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}I.l=Q,Z[V]=_e}return Z}var h;function c(){return h||(h={})}function p(I,Z){if(I[0]==80&&I[1]==75)return gs(I,Z);if((I[0]|32)==109&&(I[1]|32)==105)return Pn(I,Z);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var G=3,V=512,K=0,Q=0,_e=0,Te=0,ge=0,me=[],xe=I.slice(0,512);$i(xe,0);var Re=g(xe);switch(G=Re[0],G){case 3:V=512;break;case 4:V=4096;break;case 0:if(Re[1]==0)return gs(I,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}V!==512&&(xe=I.slice(0,V),$i(xe,28));var Ne=I.slice(0,V);m(xe,G);var We=xe.read_shift(4,"i");if(G===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);xe.l+=4,_e=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),Te=xe.read_shift(4,"i"),K=xe.read_shift(4,"i"),ge=xe.read_shift(4,"i"),Q=xe.read_shift(4,"i");for(var Ie=-1,He=0;He<109&&(Ie=xe.read_shift(4,"i"),!(Ie<0));++He)me[He]=Ie;var $e=_(I,V);w(ge,Q,$e,V,me);var Gt=E($e,_e,me,V);Gt[_e].name="!Directory",K>0&&Te!==q&&(Gt[Te].name="!MiniFAT"),Gt[me[0]].name="!FAT",Gt.fat_addrs=me,Gt.ssz=V;var Yt={},ri=[],Mr=[],En=[];k(_e,Gt,$e,ri,K,Yt,Mr,Te),b(Mr,En,ri),ri.shift();var Zn={FileIndex:Mr,FullPaths:En};return Z&&Z.raw&&(Zn.raw={header:Ne,sectors:$e}),Zn}function g(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(pe,"Header Signature: "),I.l+=16;var Z=I.read_shift(2,"u");return[I.read_shift(2,"u"),Z]}function m(I,Z){var G=9;switch(I.l+=2,G=I.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function _(I,Z){for(var G=Math.ceil(I.length/Z)-1,V=[],K=1;K<G;++K)V[K-1]=I.slice(K*Z,(K+1)*Z);return V[G-1]=I.slice(G*Z),V}function b(I,Z,G){for(var V=0,K=0,Q=0,_e=0,Te=0,ge=G.length,me=[],xe=[];V<ge;++V)me[V]=xe[V]=V,Z[V]=G[V];for(;Te<xe.length;++Te)V=xe[Te],K=I[V].L,Q=I[V].R,_e=I[V].C,me[V]===V&&(K!==-1&&me[K]!==K&&(me[V]=me[K]),Q!==-1&&me[Q]!==Q&&(me[V]=me[Q])),_e!==-1&&(me[_e]=V),K!==-1&&V!=me[V]&&(me[K]=me[V],xe.lastIndexOf(K)<Te&&xe.push(K)),Q!==-1&&V!=me[V]&&(me[Q]=me[V],xe.lastIndexOf(Q)<Te&&xe.push(Q));for(V=1;V<ge;++V)me[V]===V&&(Q!==-1&&me[Q]!==Q?me[V]=me[Q]:K!==-1&&me[K]!==K&&(me[V]=me[K]));for(V=1;V<ge;++V)if(I[V].type!==0){if(Te=V,Te!=me[Te])do Te=me[Te],Z[V]=Z[Te]+"/"+Z[V];while(Te!==0&&me[Te]!==-1&&Te!=me[Te]);me[V]=-1}for(Z[0]+="/",V=1;V<ge;++V)I[V].type!==2&&(Z[V]+="/")}function x(I,Z,G){for(var V=I.start,K=I.size,Q=[],_e=V;G&&K>0&&_e>=0;)Q.push(Z.slice(_e*j,_e*j+j)),K-=j,_e=Ja(G,_e*4);return Q.length===0?Bi(0):fa(Q).slice(0,I.size)}function w(I,Z,G,V,K){var Q=q;if(I===q){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var _e=G[I],Te=(V>>>2)-1;if(!_e)return;for(var ge=0;ge<Te&&(Q=Ja(_e,ge*4))!==q;++ge)K.push(Q);w(Ja(_e,V-4),Z-1,G,V,K)}}function P(I,Z,G,V,K){var Q=[],_e=[];K||(K=[]);var Te=V-1,ge=0,me=0;for(ge=Z;ge>=0;){K[ge]=!0,Q[Q.length]=ge,_e.push(I[ge]);var xe=G[Math.floor(ge*4/V)];if(me=ge*4&Te,V<4+me)throw new Error("FAT boundary crossed: "+ge+" 4 "+V);if(!I[xe])break;ge=Ja(I[xe],me)}return{nodes:Q,data:H_([_e])}}function E(I,Z,G,V){var K=I.length,Q=[],_e=[],Te=[],ge=[],me=V-1,xe=0,Re=0,Ne=0,We=0;for(xe=0;xe<K;++xe)if(Te=[],Ne=xe+Z,Ne>=K&&(Ne-=K),!_e[Ne]){ge=[];var Ie=[];for(Re=Ne;Re>=0;){Ie[Re]=!0,_e[Re]=!0,Te[Te.length]=Re,ge.push(I[Re]);var He=G[Math.floor(Re*4/V)];if(We=Re*4&me,V<4+We)throw new Error("FAT boundary crossed: "+Re+" 4 "+V);if(!I[He]||(Re=Ja(I[He],We),Ie[Re]))break}Q[Ne]={nodes:Te,data:H_([ge])}}return Q}function k(I,Z,G,V,K,Q,_e,Te){for(var ge=0,me=V.length?2:0,xe=Z[I].data,Re=0,Ne=0,We;Re<xe.length;Re+=128){var Ie=xe.slice(Re,Re+128);$i(Ie,64),Ne=Ie.read_shift(2),We=Rd(Ie,0,Ne-me),V.push(We);var He={name:We,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},$e=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);$e!==0&&(He.ct=C(Ie,Ie.l-8));var Gt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Gt!==0&&(He.mt=C(Ie,Ie.l-8)),He.start=Ie.read_shift(4,"i"),He.size=Ie.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=q,He.name=""),He.type===5?(ge=He.start,K>0&&ge!==q&&(Z[ge].name="!StreamData")):He.size>=4096?(He.storage="fat",Z[He.start]===void 0&&(Z[He.start]=P(G,He.start,Z.fat_addrs,Z.ssz)),Z[He.start].name=He.name,He.content=Z[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:ge!==q&&He.start!==q&&Z[ge]&&(He.content=x(He,Z[ge].data,(Z[Te]||{}).data))),He.content&&$i(He.content,0),Q[We]=He,_e.push(He)}}function C(I,Z){return new Date((on(I,Z+4)/1e7*Math.pow(2,32)+on(I,Z)/1e7-11644473600)*1e3)}function O(I,Z){return c(),p(h.readFileSync(I),Z)}function F(I,Z){var G=Z&&Z.type;switch(G||Ct&&Buffer.isBuffer(I)&&(G="buffer"),G||"base64"){case"file":return O(I,Z);case"base64":return p(Hn(un(I)),Z);case"binary":return p(Hn(I),Z)}return p(I,Z)}function D(I,Z){var G=Z||{},V=G.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=V+"/",I.FileIndex[0]={name:V,type:5}),G.CLSID&&(I.FileIndex[0].clsid=G.CLSID),N(I)}function N(I){var Z="Sh33tJ5";if(!Dt.find(I,"/"+Z)){var G=Bi(4);G[0]=55,G[1]=G[3]=50,G[2]=54,I.FileIndex.push({name:Z,type:2,content:G,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+Z),X(I)}}function X(I,Z){D(I);for(var G=!1,V=!1,K=I.FullPaths.length-1;K>=0;--K){var Q=I.FileIndex[K];switch(Q.type){case 0:V?G=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(Q.R*Q.L*Q.C)&&(G=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!Z)){var _e=new Date(1987,1,19),Te=0,ge=Object.create?Object.create(null):{},me=[];for(K=0;K<I.FullPaths.length;++K)ge[I.FullPaths[K]]=!0,I.FileIndex[K].type!==0&&me.push([I.FullPaths[K],I.FileIndex[K]]);for(K=0;K<me.length;++K){var xe=i(me[K][0]);V=ge[xe],V||(me.push([xe,{name:n(xe).replace("/",""),type:1,clsid:Ee,ct:_e,mt:_e,content:null}]),ge[xe]=!0)}for(me.sort(function(We,Ie){return t(We[0],Ie[0])}),I.FullPaths=[],I.FileIndex=[],K=0;K<me.length;++K)I.FullPaths[K]=me[K][0],I.FileIndex[K]=me[K][1];for(K=0;K<me.length;++K){var Re=I.FileIndex[K],Ne=I.FullPaths[K];if(Re.name=n(Ne).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||Ee,K===0)Re.C=me.length>1?1:-1,Re.size=0,Re.type=5;else if(Ne.slice(-1)=="/"){for(Te=K+1;Te<me.length&&i(I.FullPaths[Te])!=Ne;++Te);for(Re.C=Te>=me.length?-1:Te,Te=K+1;Te<me.length&&i(I.FullPaths[Te])!=i(Ne);++Te);Re.R=Te>=me.length?-1:Te,Re.type=1}else i(I.FullPaths[K+1]||"")==i(Ne)&&(Re.R=K+1),Re.type=2}}}function z(I,Z){var G=Z||{};if(G.fileType=="mad")return Yn(I,G);switch(X(I),G.fileType){case"zip":return Mi(I,G)}var V=function(We){for(var Ie=0,He=0,$e=0;$e<We.FileIndex.length;++$e){var Gt=We.FileIndex[$e];if(Gt.content){var Yt=Gt.content.length;Yt>0&&(Yt<4096?Ie+=Yt+63>>6:He+=Yt+511>>9)}}for(var ri=We.FullPaths.length+3>>2,Mr=Ie+7>>3,En=Ie+127>>7,Zn=Mr+He+ri+En,_r=Zn+127>>7,wt=_r<=109?0:Math.ceil((_r-109)/127);Zn+_r+wt+127>>7>_r;)wt=++_r<=109?0:Math.ceil((_r-109)/127);var Et=[1,wt,_r,En,ri,He,Ie,0];return We.FileIndex[0].size=Ie<<6,Et[7]=(We.FileIndex[0].start=Et[0]+Et[1]+Et[2]+Et[3]+Et[4]+Et[5])+(Et[6]+7>>3),Et}(I),K=Bi(V[7]<<9),Q=0,_e=0;{for(Q=0;Q<8;++Q)K.write_shift(1,fe[Q]);for(Q=0;Q<8;++Q)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),Q=0;Q<3;++Q)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,V[2]),K.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:q),K.write_shift(4,V[3]),K.write_shift(-4,V[1]?V[0]-1:q),K.write_shift(4,V[1]),Q=0;Q<109;++Q)K.write_shift(-4,Q<V[2]?V[1]+Q:-1)}if(V[1])for(_e=0;_e<V[1];++_e){for(;Q<236+_e*127;++Q)K.write_shift(-4,Q<V[2]?V[1]+Q:-1);K.write_shift(-4,_e===V[1]-1?q:_e+1)}var Te=function(We){for(_e+=We;Q<_e-1;++Q)K.write_shift(-4,Q+1);We&&(++Q,K.write_shift(-4,q))};for(_e=Q=0,_e+=V[1];Q<_e;++Q)K.write_shift(-4,de.DIFSECT);for(_e+=V[2];Q<_e;++Q)K.write_shift(-4,de.FATSECT);Te(V[3]),Te(V[4]);for(var ge=0,me=0,xe=I.FileIndex[0];ge<I.FileIndex.length;++ge)xe=I.FileIndex[ge],xe.content&&(me=xe.content.length,!(me<4096)&&(xe.start=_e,Te(me+511>>9)));for(Te(V[6]+7>>3);K.l&511;)K.write_shift(-4,de.ENDOFCHAIN);for(_e=Q=0,ge=0;ge<I.FileIndex.length;++ge)xe=I.FileIndex[ge],xe.content&&(me=xe.content.length,!(!me||me>=4096)&&(xe.start=_e,Te(me+63>>6)));for(;K.l&511;)K.write_shift(-4,de.ENDOFCHAIN);for(Q=0;Q<V[4]<<2;++Q){var Re=I.FullPaths[Q];if(!Re||Re.length===0){for(ge=0;ge<17;++ge)K.write_shift(4,0);for(ge=0;ge<3;++ge)K.write_shift(4,-1);for(ge=0;ge<12;++ge)K.write_shift(4,0);continue}xe=I.FileIndex[Q],Q===0&&(xe.start=xe.size?xe.start-1:q);var Ne=Q===0&&G.root||xe.name;if(me=2*(Ne.length+1),K.write_shift(64,Ne,"utf16le"),K.write_shift(2,me),K.write_shift(1,xe.type),K.write_shift(1,xe.color),K.write_shift(-4,xe.L),K.write_shift(-4,xe.R),K.write_shift(-4,xe.C),xe.clsid)K.write_shift(16,xe.clsid,"hex");else for(ge=0;ge<4;++ge)K.write_shift(4,0);K.write_shift(4,xe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,xe.start),K.write_shift(4,xe.size),K.write_shift(4,0)}for(Q=1;Q<I.FileIndex.length;++Q)if(xe=I.FileIndex[Q],xe.size>=4096)if(K.l=xe.start+1<<9,Ct&&Buffer.isBuffer(xe.content))xe.content.copy(K,K.l,0,xe.size),K.l+=xe.size+511&-512;else{for(ge=0;ge<xe.size;++ge)K.write_shift(1,xe.content[ge]);for(;ge&511;++ge)K.write_shift(1,0)}for(Q=1;Q<I.FileIndex.length;++Q)if(xe=I.FileIndex[Q],xe.size>0&&xe.size<4096)if(Ct&&Buffer.isBuffer(xe.content))xe.content.copy(K,K.l,0,xe.size),K.l+=xe.size+63&-64;else{for(ge=0;ge<xe.size;++ge)K.write_shift(1,xe.content[ge]);for(;ge&63;++ge)K.write_shift(1,0)}if(Ct)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function U(I,Z){var G=I.FullPaths.map(function(ge){return ge.toUpperCase()}),V=G.map(function(ge){var me=ge.split("/");return me[me.length-(ge.slice(-1)=="/"?2:1)]}),K=!1;Z.charCodeAt(0)===47?(K=!0,Z=G[0].slice(0,-1)+Z):K=Z.indexOf("/")!==-1;var Q=Z.toUpperCase(),_e=K===!0?G.indexOf(Q):V.indexOf(Q);if(_e!==-1)return I.FileIndex[_e];var Te=!Q.match(iu);for(Q=Q.replace(Sr,""),Te&&(Q=Q.replace(iu,"!")),_e=0;_e<G.length;++_e)if((Te?G[_e].replace(iu,"!"):G[_e]).replace(Sr,"")==Q||(Te?V[_e].replace(iu,"!"):V[_e]).replace(Sr,"")==Q)return I.FileIndex[_e];return null}var j=64,q=-2,pe="d0cf11e0a1b11ae1",fe=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function De(I,Z,G){c();var V=z(I,G);h.writeFileSync(Z,V)}function ee(I){for(var Z=new Array(I.length),G=0;G<I.length;++G)Z[G]=String.fromCharCode(I[G]);return Z.join("")}function Fe(I,Z){var G=z(I,Z);switch(Z&&Z.type||"buffer"){case"file":return c(),h.writeFileSync(Z.filename,G),G;case"binary":return typeof G=="string"?G:ee(G);case"base64":return b_(typeof G=="string"?G:ee(G));case"buffer":if(Ct)return Buffer.isBuffer(G)?G:go(G);case"array":return typeof G=="string"?Hn(G):G}return G}var se;function R(I){try{var Z=I.InflateRaw,G=new Z;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)se=I;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function J(I,Z){if(!se)return Lr(I,Z);var G=se.InflateRaw,V=new G,K=V._processChunk(I.slice(I.l),V._finishFlushFlag);return I.l+=V.bytesRead,K}function Y(I){return se?se.deflateRawSync(I):nt(I)}var ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(I){var Z=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Oe=typeof Uint8Array<"u",Le=Oe?new Uint8Array(256):[],it=0;it<256;++it)Le[it]=we(it);function te(I,Z){var G=Le[I&255];return Z<=8?G>>>8-Z:(G=G<<8|Le[I>>8&255],Z<=16?G>>>16-Z:(G=G<<8|Le[I>>16&255],G>>>24-Z))}function ft(I,Z){var G=Z&7,V=Z>>>3;return(I[V]|(G<=6?0:I[V+1]<<8))>>>G&3}function Ge(I,Z){var G=Z&7,V=Z>>>3;return(I[V]|(G<=5?0:I[V+1]<<8))>>>G&7}function _t(I,Z){var G=Z&7,V=Z>>>3;return(I[V]|(G<=4?0:I[V+1]<<8))>>>G&15}function rt(I,Z){var G=Z&7,V=Z>>>3;return(I[V]|(G<=3?0:I[V+1]<<8))>>>G&31}function Be(I,Z){var G=Z&7,V=Z>>>3;return(I[V]|(G<=1?0:I[V+1]<<8))>>>G&127}function St(I,Z,G){var V=Z&7,K=Z>>>3,Q=(1<<G)-1,_e=I[K]>>>V;return G<8-V||(_e|=I[K+1]<<8-V,G<16-V)||(_e|=I[K+2]<<16-V,G<24-V)||(_e|=I[K+3]<<24-V),_e&Q}function ii(I,Z,G){var V=Z&7,K=Z>>>3;return V<=5?I[K]|=(G&7)<<V:(I[K]|=G<<V&255,I[K+1]=(G&7)>>8-V),Z+3}function Ht(I,Z,G){var V=Z&7,K=Z>>>3;return G=(G&1)<<V,I[K]|=G,Z+1}function vt(I,Z,G){var V=Z&7,K=Z>>>3;return G<<=V,I[K]|=G&255,G>>>=8,I[K+1]=G,Z+8}function zt(I,Z,G){var V=Z&7,K=Z>>>3;return G<<=V,I[K]|=G&255,G>>>=8,I[K+1]=G&255,I[K+2]=G>>>8,Z+16}function Ut(I,Z){var G=I.length,V=2*G>Z?2*G:Z+5,K=0;if(G>=Z)return I;if(Ct){var Q=w_(V);if(I.copy)I.copy(Q);else for(;K<I.length;++K)Q[K]=I[K];return Q}else if(Oe){var _e=new Uint8Array(V);if(_e.set)_e.set(I);else for(;K<G;++K)_e[K]=I[K];return _e}return I.length=V,I}function Kt(I){for(var Z=new Array(I),G=0;G<I;++G)Z[G]=0;return Z}function Ti(I,Z,G){var V=1,K=0,Q=0,_e=0,Te=0,ge=I.length,me=Oe?new Uint16Array(32):Kt(32);for(Q=0;Q<32;++Q)me[Q]=0;for(Q=ge;Q<G;++Q)I[Q]=0;ge=I.length;var xe=Oe?new Uint16Array(ge):Kt(ge);for(Q=0;Q<ge;++Q)me[K=I[Q]]++,V<K&&(V=K),xe[Q]=0;for(me[0]=0,Q=1;Q<=V;++Q)me[Q+16]=Te=Te+me[Q-1]<<1;for(Q=0;Q<ge;++Q)Te=I[Q],Te!=0&&(xe[Q]=me[Te+16]++);var Re=0;for(Q=0;Q<ge;++Q)if(Re=I[Q],Re!=0)for(Te=te(xe[Q],V)>>V-Re,_e=(1<<V+4-Re)-1;_e>=0;--_e)Z[Te|_e<<Re]=Re&15|Q<<4;return V}var ki=Oe?new Uint16Array(512):Kt(512),pi=Oe?new Uint16Array(32):Kt(32);if(!Oe){for(var Bt=0;Bt<512;++Bt)ki[Bt]=0;for(Bt=0;Bt<32;++Bt)pi[Bt]=0}(function(){for(var I=[],Z=0;Z<32;Z++)I.push(5);Ti(I,pi,32);var G=[];for(Z=0;Z<=143;Z++)G.push(8);for(;Z<=255;Z++)G.push(9);for(;Z<=279;Z++)G.push(7);for(;Z<=287;Z++)G.push(8);Ti(G,ki,288)})();var gi=function(){for(var Z=Oe?new Uint8Array(32768):[],G=0,V=0;G<Pe.length-1;++G)for(;V<Pe[G+1];++V)Z[V]=G;for(;V<32768;++V)Z[V]=29;var K=Oe?new Uint8Array(259):[];for(G=0,V=0;G<he.length-1;++G)for(;V<he[G+1];++V)K[V]=G;function Q(Te,ge){for(var me=0;me<Te.length;){var xe=Math.min(65535,Te.length-me),Re=me+xe==Te.length;for(ge.write_shift(1,+Re),ge.write_shift(2,xe),ge.write_shift(2,~xe&65535);xe-- >0;)ge[ge.l++]=Te[me++]}return ge.l}function _e(Te,ge){for(var me=0,xe=0,Re=Oe?new Uint16Array(32768):[];xe<Te.length;){var Ne=Math.min(65535,Te.length-xe);if(Ne<10){for(me=ii(ge,me,+(xe+Ne==Te.length)),me&7&&(me+=8-(me&7)),ge.l=me/8|0,ge.write_shift(2,Ne),ge.write_shift(2,~Ne&65535);Ne-- >0;)ge[ge.l++]=Te[xe++];me=ge.l*8;continue}me=ii(ge,me,+(xe+Ne==Te.length)+2);for(var We=0;Ne-- >0;){var Ie=Te[xe];We=(We<<5^Ie)&32767;var He=-1,$e=0;if((He=Re[We])&&(He|=xe&-32768,He>xe&&(He-=32768),He<xe))for(;Te[He+$e]==Te[xe+$e]&&$e<250;)++$e;if($e>2){Ie=K[$e],Ie<=22?me=vt(ge,me,Le[Ie+1]>>1)-1:(vt(ge,me,3),me+=5,vt(ge,me,Le[Ie-23]>>5),me+=3);var Gt=Ie<8?0:Ie-4>>2;Gt>0&&(zt(ge,me,$e-he[Ie]),me+=Gt),Ie=Z[xe-He],me=vt(ge,me,Le[Ie]>>3),me-=3;var Yt=Ie<4?0:Ie-2>>1;Yt>0&&(zt(ge,me,xe-He-Pe[Ie]),me+=Yt);for(var ri=0;ri<$e;++ri)Re[We]=xe&32767,We=(We<<5^Te[xe])&32767,++xe;Ne-=$e-1}else Ie<=143?Ie=Ie+48:me=Ht(ge,me,1),me=vt(ge,me,Le[Ie]),Re[We]=xe&32767,++xe}me=vt(ge,me,0)-1}return ge.l=(me+7)/8|0,ge.l}return function(ge,me){return ge.length<8?Q(ge,me):_e(ge,me)}}();function nt(I){var Z=Bi(50+Math.floor(I.length*1.1)),G=gi(I,Z);return Z.slice(0,G)}var Pt=Oe?new Uint16Array(32768):Kt(32768),Jt=Oe?new Uint16Array(32768):Kt(32768),Xt=Oe?new Uint16Array(128):Kt(128),ji=1,qr=1;function Gn(I,Z){var G=rt(I,Z)+257;Z+=5;var V=rt(I,Z)+1;Z+=5;var K=_t(I,Z)+4;Z+=4;for(var Q=0,_e=Oe?new Uint8Array(19):Kt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,me=Oe?new Uint8Array(8):Kt(8),xe=Oe?new Uint8Array(8):Kt(8),Re=_e.length,Ne=0;Ne<K;++Ne)_e[ie[Ne]]=Q=Ge(I,Z),ge<Q&&(ge=Q),me[Q]++,Z+=3;var We=0;for(me[0]=0,Ne=1;Ne<=ge;++Ne)xe[Ne]=We=We+me[Ne-1]<<1;for(Ne=0;Ne<Re;++Ne)(We=_e[Ne])!=0&&(Te[Ne]=xe[We]++);var Ie=0;for(Ne=0;Ne<Re;++Ne)if(Ie=_e[Ne],Ie!=0){We=Le[Te[Ne]]>>8-Ie;for(var He=(1<<7-Ie)-1;He>=0;--He)Xt[We|He<<Ie]=Ie&7|Ne<<3}var $e=[];for(ge=1;$e.length<G+V;)switch(We=Xt[Be(I,Z)],Z+=We&7,We>>>=3){case 16:for(Q=3+ft(I,Z),Z+=2,We=$e[$e.length-1];Q-- >0;)$e.push(We);break;case 17:for(Q=3+Ge(I,Z),Z+=3;Q-- >0;)$e.push(0);break;case 18:for(Q=11+Be(I,Z),Z+=7;Q-- >0;)$e.push(0);break;default:$e.push(We),ge<We&&(ge=We);break}var Gt=$e.slice(0,G),Yt=$e.slice(G);for(Ne=G;Ne<286;++Ne)Gt[Ne]=0;for(Ne=V;Ne<30;++Ne)Yt[Ne]=0;return ji=Ti(Gt,Pt,286),qr=Ti(Yt,Jt,30),Z}function Pi(I,Z){if(I[0]==3&&!(I[1]&3))return[_a(Z),2];for(var G=0,V=0,K=w_(Z||1<<18),Q=0,_e=K.length>>>0,Te=0,ge=0;!(V&1);){if(V=Ge(I,G),G+=3,V>>>1)V>>1==1?(Te=9,ge=5):(G=Gn(I,G),Te=ji,ge=qr);else{G&7&&(G+=8-(G&7));var me=I[G>>>3]|I[(G>>>3)+1]<<8;if(G+=32,me>0)for(!Z&&_e<Q+me&&(K=Ut(K,Q+me),_e=K.length);me-- >0;)K[Q++]=I[G>>>3],G+=8;continue}for(;;){!Z&&_e<Q+32767&&(K=Ut(K,Q+32767),_e=K.length);var xe=St(I,G,Te),Re=V>>>1==1?ki[xe]:Pt[xe];if(G+=Re&15,Re>>>=4,!(Re>>>8&255))K[Q++]=Re;else{if(Re==256)break;Re-=257;var Ne=Re<8?0:Re-4>>2;Ne>5&&(Ne=0);var We=Q+he[Re];Ne>0&&(We+=St(I,G,Ne),G+=Ne),xe=St(I,G,ge),Re=V>>>1==1?pi[xe]:Jt[xe],G+=Re&15,Re>>>=4;var Ie=Re<4?0:Re-2>>1,He=Pe[Re];for(Ie>0&&(He+=St(I,G,Ie),G+=Ie),!Z&&_e<We&&(K=Ut(K,We+100),_e=K.length);Q<We;)K[Q]=K[Q-He],++Q}}}return Z?[K,G+7>>>3]:[K.slice(0,Q),G+7>>>3]}function Lr(I,Z){var G=I.slice(I.l||0),V=Pi(G,Z);return I.l+=V[1],V[0]}function Gs(I,Z){if(I)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function gs(I,Z){var G=I;$i(G,0);var V=[],K=[],Q={FileIndex:V,FullPaths:K};D(Q,{root:Z.root});for(var _e=G.length-4;(G[_e]!=80||G[_e+1]!=75||G[_e+2]!=5||G[_e+3]!=6)&&_e>=0;)--_e;G.l=_e+4,G.l+=4;var Te=G.read_shift(2);G.l+=6;var ge=G.read_shift(4);for(G.l=ge,_e=0;_e<Te;++_e){G.l+=20;var me=G.read_shift(4),xe=G.read_shift(4),Re=G.read_shift(2),Ne=G.read_shift(2),We=G.read_shift(2);G.l+=8;var Ie=G.read_shift(4),He=l(G.slice(G.l+Re,G.l+Re+Ne));G.l+=Re+Ne+We;var $e=G.l;G.l=Ie+4,pr(G,me,xe,Q,He),G.l=$e}return Q}function pr(I,Z,G,V,K){I.l+=2;var Q=I.read_shift(2),_e=I.read_shift(2),Te=a(I);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var ge=I.read_shift(4),me=I.read_shift(4),xe=I.read_shift(4),Re=I.read_shift(2),Ne=I.read_shift(2),We="",Ie=0;Ie<Re;++Ie)We+=String.fromCharCode(I[I.l++]);if(Ne){var He=l(I.slice(I.l,I.l+Ne));(He[21589]||{}).mt&&(Te=He[21589].mt),((K||{})[21589]||{}).mt&&(Te=K[21589].mt)}I.l+=Ne;var $e=I.slice(I.l,I.l+me);switch(_e){case 8:$e=J(I,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var Gt=!1;Q&8&&(ge=I.read_shift(4),ge==134695760&&(ge=I.read_shift(4),Gt=!0),me=I.read_shift(4),xe=I.read_shift(4)),me!=Z&&Gs(Gt,"Bad compressed size: "+Z+" != "+me),xe!=G&&Gs(Gt,"Bad uncompressed size: "+G+" != "+xe),_i(V,We,$e,{unsafe:!0,mt:Te})}function Mi(I,Z){var G=Z||{},V=[],K=[],Q=Bi(1),_e=G.compression?8:0,Te=0,ge=0,me=0,xe=0,Re=0,Ne=I.FullPaths[0],We=Ne,Ie=I.FileIndex[0],He=[],$e=0;for(ge=1;ge<I.FullPaths.length;++ge)if(We=I.FullPaths[ge].slice(Ne.length),Ie=I.FileIndex[ge],!(!Ie.size||!Ie.content||We=="Sh33tJ5")){var Gt=xe,Yt=Bi(We.length);for(me=0;me<We.length;++me)Yt.write_shift(1,We.charCodeAt(me)&127);Yt=Yt.slice(0,Yt.l),He[Re]=Uk.buf(Ie.content,0);var ri=Ie.content;_e==8&&(ri=Y(ri)),Q=Bi(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Te),Q.write_shift(2,_e),Ie.mt?s(Q,Ie.mt):Q.write_shift(4,0),Q.write_shift(-4,He[Re]),Q.write_shift(4,ri.length),Q.write_shift(4,Ie.content.length),Q.write_shift(2,Yt.length),Q.write_shift(2,0),xe+=Q.length,V.push(Q),xe+=Yt.length,V.push(Yt),xe+=ri.length,V.push(ri),Q=Bi(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Te),Q.write_shift(2,_e),Q.write_shift(4,0),Q.write_shift(-4,He[Re]),Q.write_shift(4,ri.length),Q.write_shift(4,Ie.content.length),Q.write_shift(2,Yt.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Gt),$e+=Q.l,K.push(Q),$e+=Yt.length,K.push(Yt),++Re}return Q=Bi(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Re),Q.write_shift(2,Re),Q.write_shift(4,$e),Q.write_shift(4,xe),Q.write_shift(2,0),fa([fa(V),fa(K),Q])}var Fi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ys(I,Z){if(I.ctype)return I.ctype;var G=I.name||"",V=G.match(/\.([^\.]+)$/);return V&&Fi[V[1]]||Z&&(V=(G=Z).match(/[\.\\]([^\.\\])+$/),V&&Fi[V[1]])?Fi[V[1]]:"application/octet-stream"}function Ta(I){for(var Z=b_(I),G=[],V=0;V<Z.length;V+=76)G.push(Z.slice(V,V+76));return G.join(`\r
`)+`\r
`}function gr(I){var Z=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var xe=me.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],V=Z.split(`\r
`),K=0;K<V.length;++K){var Q=V[K];if(Q.length==0){G.push("");continue}for(var _e=0;_e<Q.length;){var Te=76,ge=Q.slice(_e,_e+Te);ge.charAt(Te-1)=="="?Te--:ge.charAt(Te-2)=="="?Te-=2:ge.charAt(Te-3)=="="&&(Te-=3),ge=Q.slice(_e,_e+Te),_e+=Te,_e<Q.length&&(ge+="="),G.push(ge)}}return G.join(`\r
`)}function Or(I){for(var Z=[],G=0;G<I.length;++G){for(var V=I[G];G<=I.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+I[++G];Z.push(V)}for(var K=0;K<Z.length;++K)Z[K]=Z[K].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return Hn(Z.join(`\r
`))}function Vs(I,Z,G){for(var V="",K="",Q="",_e,Te=0;Te<10;++Te){var ge=Z[Te];if(!ge||ge.match(/^\s*$/))break;var me=ge.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":V=me[2].trim();break;case"content-type":Q=me[2].trim();break;case"content-transfer-encoding":K=me[2].trim();break}}switch(++Te,K.toLowerCase()){case"base64":_e=Hn(un(Z.slice(Te).join("")));break;case"quoted-printable":_e=Or(Z.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var xe=_i(I,V.slice(G.length),_e,{unsafe:!0});Q&&(xe.ctype=Q)}function Pn(I,Z){if(ee(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=Z&&Z.root||"",V=(Ct&&Buffer.isBuffer(I)?I.toString("binary"):ee(I)).split(`\r
`),K=0,Q="";for(K=0;K<V.length;++K)if(Q=V[K],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),G||(G=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),Q.slice(0,G.length)!=G););var _e=(V[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Te="--"+(_e[1]||""),ge=[],me=[],xe={FileIndex:ge,FullPaths:me};D(xe);var Re,Ne=0;for(K=0;K<V.length;++K){var We=V[K];We!==Te&&We!==Te+"--"||(Ne++&&Vs(xe,V.slice(Re,K),G),Re=K)}return xe}function Yn(I,Z){var G=Z||{},V=G.boundary||"SheetJS";V="------="+V;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],Q=I.FullPaths[0],_e=Q,Te=I.FileIndex[0],ge=1;ge<I.FullPaths.length;++ge)if(_e=I.FullPaths[ge].slice(Q.length),Te=I.FileIndex[ge],!(!Te.size||!Te.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var me=Te.content,xe=Ct&&Buffer.isBuffer(me)?me.toString("binary"):ee(me),Re=0,Ne=Math.min(1024,xe.length),We=0,Ie=0;Ie<=Ne;++Ie)(We=xe.charCodeAt(Ie))>=32&&We<128&&++Re;var He=Re>=Ne*4/5;K.push(V),K.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+_e),K.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),K.push("Content-Type: "+Ys(Te,_e)),K.push(""),K.push(He?gr(xe):Ta(xe))}return K.push(V+`--\r
`),K.join(`\r
`)}function Ri(I){var Z={};return D(Z,I),Z}function _i(I,Z,G,V){var K=V&&V.unsafe;K||D(I);var Q=!K&&Dt.find(I,Z);if(!Q){var _e=I.FullPaths[0];Z.slice(0,_e.length)==_e?_e=Z:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+Z).replace("//","/")),Q={name:n(Z),type:2},I.FileIndex.push(Q),I.FullPaths.push(_e),K||Dt.utils.cfb_gc(I)}return Q.content=G,Q.size=G?G.length:0,V&&(V.CLSID&&(Q.clsid=V.CLSID),V.mt&&(Q.mt=V.mt),V.ct&&(Q.ct=V.ct)),Q}function Xi(I,Z){D(I);var G=Dt.find(I,Z);if(G){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==G)return I.FileIndex.splice(V,1),I.FullPaths.splice(V,1),!0}return!1}function Vn(I,Z,G){D(I);var V=Dt.find(I,Z);if(V){for(var K=0;K<I.FileIndex.length;++K)if(I.FileIndex[K]==V)return I.FileIndex[K].name=n(G),I.FullPaths[K]=G,!0}return!1}function _s(I){X(I,!0)}return e.find=U,e.read=F,e.parse=p,e.write=Fe,e.writeFile=De,e.utils={cfb_new:Ri,cfb_add:_i,cfb_del:Xi,cfb_mov:Vn,cfb_gc:_s,ReadShift:uu,CheckField:Ax,prep_blob:$i,bconcat:fa,use_zlib:R,_deflateRaw:nt,_inflateRaw:Lr,consts:de},e}();function Wk(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+r)}function fs(r){for(var e=Object.keys(r),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(r,e[i])&&t.push(e[i]);return t}function Ld(r){for(var e=[],t=fs(r),i=0;i!==t.length;++i)e[r[t[i]]]=t[i];return e}var gc=new Date(1899,11,30,0,0,0);function Dr(r,e){var t=r.getTime();e&&(t-=1462*24*60*60*1e3);var i=gc.getTime()+(r.getTimezoneOffset()-gc.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var sx=new Date,jk=gc.getTime()+(sx.getTimezoneOffset()-gc.getTimezoneOffset())*6e4,D_=sx.getTimezoneOffset();function zc(r){var e=new Date;return e.setTime(r*24*60*60*1e3+jk),e.getTimezoneOffset()!==D_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-D_)*6e4),e}function Xk(r){var e=0,t=0,i=!1,n=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(i=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(n[s],10)}return e}var L_=new Date("2017-02-19T19:06:09.000Z"),ax=isNaN(L_.getFullYear())?new Date("2/19/17"):L_,Gk=ax.getFullYear()==2017;function Zi(r,e){var t=new Date(r);if(Gk)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(ax.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return r.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function no(r,e){if(Ct&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return nu(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return nu(Ym(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return nu(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return nu(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function qi(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=qi(r[t]));return e}function ci(r,e){for(var t="";t.length<e;)t+=r;return t}function Wn(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(e=Number(i)))?e/t:e}var Yk=["january","february","march","april","may","june","july","august","september","october","november","december"];function ul(r){var e=new Date(r),t=new Date(NaN),i=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Yk.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return i<0||i>8099?t:(n>0||s>1)&&i!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var Vk=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,i,n){if(r||typeof i=="string")return t.split(i);for(var s=t.split(i),a=[s[0]],l=1;l<s.length;++l)a.push(n),a.push(s[l]);return a}}();function ox(r){return r?r.content&&r.type?no(r.content,!0):r.data?tu(r.data):r.asNodeBuffer&&Ct?tu(r.asNodeBuffer().toString("binary")):r.asBinary?tu(r.asBinary()):r._data&&r._data.getContent?tu(no(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function lx(r){if(!r)return null;if(r.data)return v_(r.data);if(r.asNodeBuffer&&Ct)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?v_(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function Zk(r){return r&&r.name.slice(-4)===".bin"?lx(r):ox(r)}function vn(r,e){for(var t=r.FullPaths||fs(r.files),i=e.toLowerCase().replace(/[\/]/g,"\\"),n=i.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==a||n==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function Od(r,e){var t=vn(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Ci(r,e,t){if(!t)return Zk(Od(r,e));if(!e)return null;try{return Ci(r,e)}catch{return null}}function ln(r,e,t){if(!t)return ox(Od(r,e));if(!e)return null;try{return ln(r,e)}catch{return null}}function ux(r,e,t){if(!t)return lx(Od(r,e));if(!e)return null;try{return ux(r,e)}catch{return null}}function O_(r){for(var e=r.FullPaths||fs(r.files),t=[],i=0;i<e.length;++i)e[i].slice(-1)!="/"&&t.push(e[i].replace(/^Root Entry[\/]/,""));return t.sort()}function Kk(r,e,t){if(r.FullPaths){if(typeof t=="string"){var i;return Ct?i=go(t):i=gk(t),Dt.utils.cfb_add(r,e,i)}Dt.utils.cfb_add(r,e,t)}else r.file(e,t)}function hx(r,e){switch(e.type){case"base64":return Dt.read(r,{type:"base64"});case"binary":return Dt.read(r,{type:"binary"});case"buffer":case"array":return Dt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ru(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var i=r.split("/");i.length!==0;){var n=i.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var cx=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$k=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,M_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qk=/<[^>]*>/g,fr=cx.match(M_)?M_:qk,Jk=/<\w*:/,Qk=/<(\/?)\w+:/;function st(r,e,t){for(var i={},n=0,s=0;n!==r.length&&!((s=r.charCodeAt(n))===32||s===10||s===13);++n);if(e||(i[0]=r.slice(0,n)),n===r.length)return i;var a=r.match($k),l=0,h="",c=0,p="",g="",m=1;if(a)for(c=0;c!=a.length;++c){for(g=a[c],s=0;s!=g.length&&g.charCodeAt(s)!==61;++s);for(p=g.slice(0,s).trim();g.charCodeAt(s+1)==32;)++s;for(m=(n=g.charCodeAt(s+1))==34||n==39?1:0,h=g.slice(s+1+m,g.length-m),l=0;l!=p.length&&p.charCodeAt(l)!==58;++l);if(l===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),i[p]=h,t||(i[p.toLowerCase()]=h);else{var _=(l===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(l+1);if(i[_]&&p.slice(l-3,l)=="ext")continue;i[_]=h,t||(i[_.toLowerCase()]=h)}}return i}function ds(r){return r.replace(Qk,"<$1")}var fx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},eP=Ld(fx),Mt=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(i){var n=i+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(r,function(l,h){return fx[l]||String.fromCharCode(parseInt(h,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,h){return String.fromCharCode(parseInt(h,16))});var a=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,a)+t(n.slice(a+3))}}(),tP=/[&<>'"]/g,iP=/[\u0000-\u001f]/g;function Md(r){var e=r+"";return e.replace(tP,function(t){return eP[t]}).replace(/\n/g,"<br/>").replace(iP,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var F_=function(){var r=/&#(\d+);/g;function e(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(r,e)}}();function ti(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rf(r){for(var e="",t=0,i=0,n=0,s=0,a=0,l=0;t<r.length;){if(i=r.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(n=r.charCodeAt(t++),i>191&&i<224){a=(i&31)<<6,a|=n&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(t++),l=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function R_(r){var e=_a(2*r.length),t,i,n=1,s=0,a=0,l;for(i=0;i<r.length;i+=n)n=1,(l=r.charCodeAt(i))<128?t=l:l<224?(t=(l&31)*64+(r.charCodeAt(i+1)&63),n=2):l<240?(t=(l&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,t=(l&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function I_(r){return go(r,"binary").toString("utf8")}var Zh="foo bar bazâð£",qt=Ct&&(I_(Zh)==Rf(Zh)&&I_||R_(Zh)==Rf(Zh)&&R_)||Rf,nu=Ct?function(r){return go(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,i=0,n=0;t<r.length;)switch(i=r.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},wu=function(){var r={};return function(t,i){var n=t+"|"+(i||"");return r[n]?r[n]:r[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}}(),dx=function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}(),rP=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),nP=/<\/?(?:vt:)?variant>/g,sP=/<(?:vt:)([^>]*)>([\s\S]*)</;function B_(r,e){var t=st(r),i=r.match(rP(t.baseType))||[],n=[];if(i.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return n}return i.forEach(function(s){var a=s.replace(nP,"").match(sP);a&&n.push({v:qt(a[2]),t:a[1]})}),n}var aP=/(^\s|\s$|\n)/;function oP(r){return fs(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function lP(r,e,t){return"<"+r+(t!=null?oP(t):"")+(e!=null?(e.match(aP)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Fd(r){if(Ct&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return qt(_o(Cd(r)));throw new Error("Bad input format: expected Buffer or string")}var Tu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,uP={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hP=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function cP(r,e){for(var t=1-2*(r[e+7]>>>7),i=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),n=r[e+6]&15,s=5;s>=0;--s)n=n*256+r[e+s];return i==2047?n==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),t*Math.pow(2,i-52)*n)}function fP(r,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,a=i?-e:e;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)r[t+l]=s&255;r[t+6]=(n&15)<<4|s&15,r[t+7]=n>>4|i}var N_=function(r){for(var e=[],t=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=t)e.push.apply(e,r[0][i].slice(n,n+t));return e},H_=Ct?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:go(e)})):N_(r)}:N_,z_=function(r,e,t){for(var i=[],n=e;n<t;n+=2)i.push(String.fromCharCode(Rs(r,n)));return i.join("").replace(Sr,"")},Rd=Ct?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Sr,""):z_(r,e,t)}:z_,U_=function(r,e,t){for(var i=[],n=e;n<e+t;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},px=Ct?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):U_(r,e,t)}:U_,W_=function(r,e,t){for(var i=[],n=e;n<t;n++)i.push(String.fromCharCode(Qo(r,n)));return i.join("")},Ku=Ct?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):W_(e,t,i)}:W_,gx=function(r,e){var t=on(r,e);return t>0?Ku(r,e+4,e+4+t-1):""},_x=gx,mx=function(r,e){var t=on(r,e);return t>0?Ku(r,e+4,e+4+t-1):""},xx=mx,vx=function(r,e){var t=2*on(r,e);return t>0?Ku(r,e+4,e+4+t-1):""},yx=vx,bx=function(e,t){var i=on(e,t);return i>0?Rd(e,t+4,t+4+i):""},wx=bx,Tx=function(r,e){var t=on(r,e);return t>0?Ku(r,e+4,e+4+t):""},kx=Tx,Px=function(r,e){return cP(r,e)},_c=Px,Ex=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ct&&(_x=function(e,t){if(!Buffer.isBuffer(e))return gx(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},xx=function(e,t){if(!Buffer.isBuffer(e))return mx(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},yx=function(e,t){if(!Buffer.isBuffer(e))return vx(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},wx=function(e,t){if(!Buffer.isBuffer(e))return bx(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},kx=function(e,t){if(!Buffer.isBuffer(e))return Tx(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},_c=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Px(e,t)},Ex=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Qo=function(r,e){return r[e]},Rs=function(r,e){return r[e+1]*256+r[e]},dP=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},on=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Ja=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},pP=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function uu(r,e){var t="",i,n,s=[],a,l,h,c;switch(e){case"dbcs":if(c=this.l,Ct&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(h=0;h<r;++h)t+=String.fromCharCode(Rs(this,c)),c+=2;r*=2;break;case"utf8":t=Ku(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Rd(this,this.l,this.l+r);break;case"wstr":return uu.call(this,r,"dbcs");case"lpstr-ansi":t=_x(this,this.l),r=4+on(this,this.l);break;case"lpstr-cp":t=xx(this,this.l),r=4+on(this,this.l);break;case"lpwstr":t=yx(this,this.l),r=4+2*on(this,this.l);break;case"lpp4":r=4+on(this,this.l),t=wx(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+on(this,this.l),t=kx(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=Qo(this,this.l+r++))!==0;)s.push(Vh(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Rs(this,this.l+r))!==0;)s.push(Vh(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,h=0;h<r;++h){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qo(this,c),this.l=c+1,l=uu.call(this,r-h,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Vh(Rs(this,c))),c+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,h=0;h!=r;++h){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Qo(this,c),this.l=c+1,l=uu.call(this,r-h,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Vh(Qo(this,c))),c+=1}t=s.join("");break;default:switch(r){case 1:return i=Qo(this,this.l),this.l++,i;case 2:return i=(e==="i"?dP:Rs)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(i=(r>0?Ja:pP)(this,this.l),this.l+=4,i):(n=on(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return r==8?n=_c(this,this.l):n=_c([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:t=px(this,this.l,r);break}}return this.l+=r,t}var gP=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},_P=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},mP=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function xP(r,e,t){var i=0,n=0;if(t==="dbcs"){for(n=0;n!=e.length;++n)mP(this,e.charCodeAt(n),this.l+2*n);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;i=e.length}else if(t==="hex"){for(;n<r;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(n=0;n<Math.min(e.length,r);++n){var a=e.charCodeAt(n);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,gP(this,e,this.l);break;case 8:if(i=8,t==="f"){fP(this,e,this.l);break}case 16:break;case-4:i=4,_P(this,e,this.l);break}return this.l+=i,this}function Ax(r,e){var t=px(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function $i(r,e){r.l=e,r.read_shift=uu,r.chk=Ax,r.write_shift=xP}function hr(r,e){r.l+=e}function Bi(r){var e=_a(r);return $i(e,0),e}function Xs(r,e,t){if(r){var i,n,s;$i(r,r.l||0);for(var a=r.length,l=0,h=0;r.l<a;){l=r.read_shift(1),l&128&&(l=(l&127)+((r.read_shift(1)&127)<<7));var c=wc[l]||wc[65535];for(i=r.read_shift(1),s=i&127,n=1;n<4&&i&128;++n)s+=((i=r.read_shift(1))&127)<<7*n;h=r.l+s;var p=c.f&&c.f(r,s,t);if(r.l=h,e(p,c,l))return}}}function ed(){var r=[],e=Ct?256:2048,t=function(c){var p=Bi(c);return $i(p,0),p},i=t(e),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(c){return i&&c<i.length-i.l?i:(n(),i=t(Math.max(c+1,e)))},a=function(){return n(),fa(r)},l=function(c){n(),i=c,i.l==null&&(i.l=i.length),s(e)};return{next:s,push:l,end:a,_bufs:r}}function hu(r,e,t){var i=qi(r);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function j_(r,e,t){var i=qi(r);return i.s=hu(i.s,e.s,t),i.e=hu(i.e,e.s,t),i}function cu(r,e){if(r.cRel&&r.c<0)for(r=qi(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=qi(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=lt(r);return!r.cRel&&r.cRel!=null&&(t=bP(t)),!r.rRel&&r.rRel!=null&&(t=vP(t)),t}function If(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+zi(r.s.c)+":"+(r.e.cRel?"":"$")+zi(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Ji(r.s.r)+":"+(r.e.rRel?"":"$")+Ji(r.e.r):cu(r.s,e.biff)+":"+cu(r.e,e.biff)}function Id(r){return parseInt(yP(r),10)-1}function Ji(r){return""+(r+1)}function vP(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yP(r){return r.replace(/\$(\d+)$/,"$1")}function Bd(r){for(var e=wP(r),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function zi(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function bP(r){return r.replace(/^([A-Z])/,"$$$1")}function wP(r){return r.replace(/^\$([A-Z])/,"$1")}function TP(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ar(r){for(var e=0,t=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:e-1}}function lt(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function yl(r){var e=r.indexOf(":");return e==-1?{s:Ar(r),e:Ar(r)}:{s:Ar(r.slice(0,e)),e:Ar(r.slice(e+1))}}function Lt(r,e){return typeof e>"u"||typeof e=="number"?Lt(r.s,r.e):(typeof r!="string"&&(r=lt(r)),typeof e!="string"&&(e=lt(e)),r==e?r:r+":"+e)}function di(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,n=0,s=r.length;for(t=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.s.c=--t,t=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;if(e.s.r=--t,i===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.e.c=--t,t=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;return e.e.r=--t,e}function X_(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=wn(r.z,t?Dr(e):e)}catch{}try{return r.w=wn((r.XF||{}).numFmtId||(t?14:0),t?Dr(e):e)}catch{return""+e}}function zs(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?vo[r.v]||r.v:e==null?X_(r,r.v):X_(r,e))}function wa(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=r,{SheetNames:[t],Sheets:i}}function Cx(r,e,t){var i=t||{},n=r?Array.isArray(r):i.dense,s=r||(n?[]:{}),a=0,l=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var h=typeof i.origin=="string"?Ar(i.origin):i.origin;a=h.r,l=h.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=di(s["!ref"]);c.s.c=p.s.c,c.s.r=p.s.r,c.e.c=Math.max(c.e.c,p.e.c),c.e.r=Math.max(c.e.r,p.e.r),a==-1&&(c.e.r=a=p.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var _={v:e[g][m]},b=a+g,x=l+m;if(c.s.r>b&&(c.s.r=b),c.s.c>x&&(c.s.c=x),c.e.r<b&&(c.e.r=b),c.e.c<x&&(c.e.c=x),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))_=e[g][m];else if(Array.isArray(_.v)&&(_.f=e[g][m][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(i.nullError)_.t="e",_.v=0;else if(i.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=i.dateNF||dt[14],i.cellDates?(_.t="d",_.w=wn(_.z,Dr(_.v))):(_.t="n",_.v=Dr(_.v),_.w=wn(_.z,_.v))):_.t="s";if(n)s[b]||(s[b]=[]),s[b][x]&&s[b][x].z&&(_.z=s[b][x].z),s[b][x]=_;else{var w=lt({c:x,r:b});s[w]&&s[w].z&&(_.z=s[w].z),s[w]=_}}}return c.s.c<1e7&&(s["!ref"]=Lt(c)),s}function bl(r,e){return Cx(null,r,e)}function kP(r){return r.read_shift(4,"i")}function ur(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function PP(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function Nd(r,e){var t=r.l,i=r.read_shift(1),n=ur(r),s=[],a={t:n,h:n};if(i&1){for(var l=r.read_shift(4),h=0;h!=l;++h)s.push(PP(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}var EP=Nd;function kn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function mo(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}var AP=ur;function Hd(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}var CP=ur,td=Hd;function zd(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,i=e[0]&2;r.l+=4;var n=i===0?_c([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ja(e,0)>>2;return t?n/100:n}function Sx(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}var xo=Sx;function or(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function SP(r){var e={},t=r.read_shift(1),i=t>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),l=r.read_shift(1),h=r.read_shift(1);switch(r.l++,i){case 0:e.auto=1;break;case 1:e.index=n;var c=to[n];c&&(e.rgb=Pu(c));break;case 2:e.rgb=Pu([a,l,h]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function DP(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Dx(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=r.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function LP(r){return Dx(r,1)}function OP(r){return Dx(r,2)}var Ud=2,Zr=3,Kh=11,G_=12,mc=19,$h=64,MP=65,FP=71,RP=4108,IP=4126,Vi=80,Lx=81,BP=[Vi,Lx],NP={1:{n:"CodePage",t:Ud},2:{n:"Category",t:Vi},3:{n:"PresentationFormat",t:Vi},4:{n:"ByteCount",t:Zr},5:{n:"LineCount",t:Zr},6:{n:"ParagraphCount",t:Zr},7:{n:"SlideCount",t:Zr},8:{n:"NoteCount",t:Zr},9:{n:"HiddenCount",t:Zr},10:{n:"MultimediaClipCount",t:Zr},11:{n:"ScaleCrop",t:Kh},12:{n:"HeadingPairs",t:RP},13:{n:"TitlesOfParts",t:IP},14:{n:"Manager",t:Vi},15:{n:"Company",t:Vi},16:{n:"LinksUpToDate",t:Kh},17:{n:"CharacterCount",t:Zr},19:{n:"SharedDoc",t:Kh},22:{n:"HyperlinksChanged",t:Kh},23:{n:"AppVersion",t:Zr,p:"version"},24:{n:"DigSig",t:MP},26:{n:"ContentType",t:Vi},27:{n:"ContentStatus",t:Vi},28:{n:"Language",t:Vi},29:{n:"Version",t:Vi},255:{},2147483648:{n:"Locale",t:mc},2147483651:{n:"Behavior",t:mc},1919054434:{}},HP={1:{n:"CodePage",t:Ud},2:{n:"Title",t:Vi},3:{n:"Subject",t:Vi},4:{n:"Author",t:Vi},5:{n:"Keywords",t:Vi},6:{n:"Comments",t:Vi},7:{n:"Template",t:Vi},8:{n:"LastAuthor",t:Vi},9:{n:"RevNumber",t:Vi},10:{n:"EditTime",t:$h},11:{n:"LastPrinted",t:$h},12:{n:"CreatedDate",t:$h},13:{n:"ModifiedDate",t:$h},14:{n:"PageCount",t:Zr},15:{n:"WordCount",t:Zr},16:{n:"CharCount",t:Zr},17:{n:"Thumbnail",t:FP},18:{n:"Application",t:Vi},19:{n:"DocSecurity",t:Zr},255:{},2147483648:{n:"Locale",t:mc},2147483651:{n:"Behavior",t:mc},1919054434:{}},Y_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UP(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var WP=UP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),to=qi(WP),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ox={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},V_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function jP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function XP(r){var e=jP();if(!r||!r.match)return e;var t={};if((r.match(fr)||[]).forEach(function(i){var n=st(i);switch(n[0].replace(Jk,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":e[V_[n.ContentType]]!==void 0&&e[V_[n.ContentType]].push(n.PartName);break}}),e.xmlns!==uP.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var tl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function id(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function fu(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var i={};return(r.match(fr)||[]).forEach(function(n){var s=st(n);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:ru(s.Target,e);t[l]=a,i[s.Id]=a}}),t["!id"]=i,t}var GP="application/vnd.oasis.opendocument.spreadsheet";function YP(r,e){for(var t=Fd(r),i,n;i=Tu.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(n=st(i[0],!1),n.path=="/"&&n.type!==GP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw i}}var du=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],VP=function(){for(var r=new Array(du.length),e=0;e<du.length;++e){var t=du[e],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return r}();function Mx(r){var e={};r=qt(r);for(var t=0;t<du.length;++t){var i=du[t],n=r.match(VP[t]);n!=null&&n.length>0&&(e[i[1]]=Mt(n[1])),i[2]==="date"&&e[i[1]]&&(e[i[1]]=Zi(e[i[1]]))}return e}var ZP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Fx(r,e,t,i){var n=[];if(typeof r=="string")n=B_(r,i);else for(var s=0;s<r.length;++s)n=n.concat(r[s].map(function(p){return{v:p}}));var a=typeof e=="string"?B_(e,i).map(function(p){return p.v}):e,l=0,h=0;if(a.length>0)for(var c=0;c!==n.length;c+=2){switch(h=+n[c+1].v,n[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=h,t.SheetNames=a.slice(l,l+h);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=h,t.DefinedNames=a.slice(l,l+h);break;case"Charts":case"Diagramme":t.Chartsheets=h,t.ChartNames=a.slice(l,l+h);break}l+=h}}function KP(r,e,t){var i={};return e||(e={}),r=qt(r),ZP.forEach(function(n){var s=(r.match(wu(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=Mt(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(i[n[1]]=a[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&Fx(i.HeadingPairs,i.TitlesOfParts,e,t),e}var $P=/<[^>]+>[^<]*/g;function qP(r,e){var t={},i="",n=r.match($P);if(n)for(var s=0;s!=n.length;++s){var a=n[s],l=st(a);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Mt(l.name);break;case"</property>":i=null;break;default:if(a.indexOf("<vt:")===0){var h=a.split(">"),c=h[0].slice(4),p=h[1];switch(c){case"lpstr":case"bstr":case"lpwstr":t[i]=Mt(p);break;case"bool":t[i]=ti(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(p);break;case"filetime":case"date":t[i]=Zi(p);break;case"cy":case"error":t[i]=Mt(p);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,h)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}var JP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bf;function QP(r,e,t){Bf||(Bf=Ld(JP)),e=Bf[e]||e,r[e]=t}function Wd(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Rx(r,e,t){var i=r.l,n=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-i&3;)++r.l;return n}function Ix(r,e,t){var i=r.read_shift(0,"lpwstr");return t&&(r.l+=4-(i.length+1&3)&3),i}function Bx(r,e,t){return e===31?Ix(r):Rx(r,e,t)}function rd(r,e,t){return Bx(r,e,t===!1?0:4)}function eE(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Bx(r,e,0)}function tE(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i){var n=r.l;t[i]=r.read_shift(0,"lpwstr").replace(Sr,""),r.l-n&2&&(r.l+=2)}return t}function iE(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i)t[i]=r.read_shift(0,"lpstr-cp").replace(Sr,"");return t}function rE(r){var e=r.l,t=xc(r,Lx);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var i=xc(r,Zr);return[t,i]}function nE(r){for(var e=r.read_shift(4),t=[],i=0;i<e/2;++i)t.push(rE(r));return t}function Z_(r,e){for(var t=r.read_shift(4),i={},n=0;n!=t;++n){var s=r.read_shift(4),a=r.read_shift(4);i[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(Sr,"").replace(iu,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>2+1<<2),i}function Nx(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function sE(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function xc(r,e,t){var i=r.read_shift(2),n,s=t||{};if(r.l+=2,e!==G_&&i!==e&&BP.indexOf(e)===-1&&!((e&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+e+" saw "+i);switch(e===G_?i:e){case 2:return n=r.read_shift(2,"i"),s.raw||(r.l+=2),n;case 3:return n=r.read_shift(4,"i"),n;case 11:return r.read_shift(4)!==0;case 19:return n=r.read_shift(4),n;case 30:return Rx(r,i,4).replace(Sr,"");case 31:return Ix(r);case 64:return Wd(r);case 65:return Nx(r);case 71:return sE(r);case 80:return rd(r,i,!s.raw).replace(Sr,"");case 81:return eE(r,i).replace(Sr,"");case 4108:return nE(r);case 4126:case 4127:return i==4127?tE(r):iE(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}}function K_(r,e){var t=r.l,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0,l=0,h=-1,c={};for(a=0;a!=n;++a){var p=r.read_shift(4),g=r.read_shift(4);s[a]=[p,g+t]}s.sort(function(E,k){return E[1]-k[1]});var m={};for(a=0;a!=n;++a){if(r.l!==s[a][1]){var _=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,_=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],_=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],_=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(_=!1,r.l=s[a][1]),_)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var b=e[s[a][0]];if(m[b.n]=xc(r,b.t,{raw:!0}),b.p==="version"&&(m[b.n]=String(m[b.n]>>16)+"."+("0000"+String(m[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(m[b.n]){case 0:m[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zn(l=m[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[b.n])}}else if(s[a][0]===1){if(l=m.CodePage=xc(r,Ud),zn(l),h!==-1){var x=r.l;r.l=s[h][1],c=Z_(r,l),r.l=x}}else if(s[a][0]===0){if(l===0){h=a,r.l=s[a+1][1];continue}c=Z_(r,l)}else{var w=c[s[a][0]],P;switch(r[r.l]){case 65:r.l+=4,P=Nx(r);break;case 30:r.l+=4,P=rd(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,P=rd(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,P=r.read_shift(4,"i");break;case 19:r.l+=4,P=r.read_shift(4);break;case 5:r.l+=4,P=r.read_shift(8,"f");break;case 11:r.l+=4,P=vi(r,4);break;case 64:r.l+=4,P=Zi(Wd(r));break;default:throw new Error("unparsed value: "+r[r.l])}m[w]=P}}return r.l=t+i,m}function $_(r,e,t){var i=r.content;if(!i)return{};$i(i,0);var n,s,a,l,h=0;i.chk("feff","Byte Order: "),i.read_shift(2);var c=i.read_shift(4),p=i.read_shift(16);if(p!==Dt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(n=i.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=i.read_shift(16),l=i.read_shift(4),n===1&&l!==i.l)throw new Error("Length mismatch: "+l+" !== "+i.l);n===2&&(a=i.read_shift(16),h=i.read_shift(4));var g=K_(i,e),m={SystemIdentifier:c};for(var _ in g)m[_]=g[_];if(m.FMTID=s,n===1)return m;if(h-i.l==2&&(i.l+=2),i.l!==h)throw new Error("Length mismatch 2: "+i.l+" !== "+h);var b;try{b=K_(i,null)}catch{}for(_ in b)m[_]=b[_];return m.FMTID=[s,a],m}function la(r,e){return r.read_shift(e),null}function aE(r,e,t){for(var i=[],n=r.l+e;r.l<n;)i.push(t(r,n-r.l));if(n!==r.l)throw new Error("Slurp error");return i}function vi(r,e){return r.read_shift(e)===1}function Si(r){return r.read_shift(2,"u")}function Hx(r,e){return aE(r,e,Si)}function oE(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function $u(r,e,t){var i=r.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var a=i?r.read_shift(i,n):"";return a}function lE(r){var e=r.read_shift(2),t=r.read_shift(1),i=t&4,n=t&8,s=1+(t&1),a=0,l,h={};n&&(a=r.read_shift(2)),i&&(l=r.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",p=e===0?"":r.read_shift(e,c);return n&&(r.l+=4*a),i&&(r.l+=l),h.t=p,n||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function so(r,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(e,"sbcs-cont"):i=r.read_shift(e,"dbcs-cont"),i}function qu(r,e,t){var i=r.read_shift(t&&t.biff==2?1:2);return i===0?(r.l++,""):so(r,i,t)}function yo(r,e,t){if(t.biff>5)return qu(r,e,t);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function uE(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function hE(r){var e=r.read_shift(4),t=r.l,i=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),r.l=t);var n=r.read_shift((i?e-24:e)>>1,"utf16le").replace(Sr,"");return i&&(r.l+=24),n}function cE(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var i=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=r.read_shift(4);if(n===0)return t+i.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(Sr,"");return t+a}function fE(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return hE(r);case"0303000000000000c000000000000046":return cE(r);default:throw new Error("Unsupported Moniker "+t)}}function qh(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Sr,""):"";return t}function dE(r,e){var t=r.l+e,i=r.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var n=r.read_shift(2);r.l+=2;var s,a,l,h,c="",p,g;n&16&&(s=qh(r,t-r.l)),n&128&&(a=qh(r,t-r.l)),(n&257)===257&&(l=qh(r,t-r.l)),(n&257)===1&&(h=fE(r,t-r.l)),n&8&&(c=qh(r,t-r.l)),n&32&&(p=r.read_shift(16)),n&64&&(g=Wd(r)),r.l=t;var m=a||l||h||"";m&&c&&(m+="#"+c),m||(m="#"+c),n&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var _={Target:m};return p&&(_.guid=p),g&&(_.time=g),s&&(_.Tooltip=s),_}function zx(r){var e=r.read_shift(1),t=r.read_shift(1),i=r.read_shift(1),n=r.read_shift(1);return[e,t,i,n]}function Ux(r,e){var t=zx(r);return t[3]=0,t}function ps(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return{r:e,c:t,ixfe:i}}function pE(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function gE(r,e,t){return e===0?"":yo(r,e,t)}function _E(r,e,t){var i=t.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function Wx(r){var e=r.read_shift(2),t=zd(r);return[e,t]}function mE(r,e,t){r.l+=4,e-=4;var i=r.l+e,n=$u(r,e,t),s=r.read_shift(2);if(i-=r.l,s!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+s);return r.l+=s,n}function Uc(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:e},e:{c:n,r:t}}}function jx(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(1),n=r.read_shift(1);return{s:{c:i,r:e},e:{c:n,r:t}}}var xE=jx;function Xx(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return r.l+=12,[t,e,i]}function vE(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function yE(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function rr(r){r.l+=2,r.l+=r.read_shift(2)}var bE={0:rr,4:rr,5:rr,6:rr,7:yE,8:rr,9:rr,10:rr,11:rr,12:rr,13:vE,14:rr,15:rr,16:rr,17:rr,18:rr,19:rr,20:rr,21:Xx};function wE(r,e){for(var t=r.l+e,i=[];r.l<t;){var n=r.read_shift(2);r.l-=2;try{i.push(bE[n](r,t-r.l))}catch{return r.l=t,i}}return r.l!=t&&(r.l=t),i}function Jh(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function TE(r,e){return e===0||r.read_shift(2),1200}function kE(r,e,t){if(t.enc)return r.l+=e,"";var i=r.l,n=yo(r,0,t);return r.read_shift(e+i-r.l),n}function PE(r,e,t){var i=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function EE(r,e,t){var i=r.read_shift(4),n=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=$u(r,0,t);return a.length===0&&(a="Sheet1"),{pos:i,hs:n,dt:s,name:a}}function AE(r,e){for(var t=r.l+e,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0;a!=n&&r.l<t;++a)s.push(lE(r));return s.Count=i,s.Unique=n,s}function CE(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function SE(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var i=r.read_shift(1);return r.l+=3,i&7&&(e.level=i&7),i&32&&(e.hidden=!0),i&64&&(e.hpt=t/20),e}function DE(r){var e=pE(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function LE(r){return r.read_shift(2),r.read_shift(4)}function q_(r,e,t){var i=0;t&&t.biff==2||(i=r.read_shift(2));var n=r.read_shift(2);t&&t.biff==2&&(i=1-(n>>15),n&=32767);var s={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[s,n]}function OE(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),l=r.read_shift(2),h=r.read_shift(2),c=r.read_shift(2);return{Pos:[e,t],Dim:[i,n],Flags:s,CurTab:a,FirstTab:l,Selected:h,TabRatio:c}}function ME(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=r.read_shift(2);return{RTL:i&64}}function FE(){}function RE(r,e,t){var i={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return i.name=$u(r,0,t),i}function IE(r){var e=ps(r);return e.isst=r.read_shift(4),e}function BE(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=r.l+e,n=ps(r);t.biff==2&&r.l++;var s=qu(r,i-r.l,t);return n.val=s,n}function NE(r,e,t){var i=r.read_shift(2),n=yo(r,0,t);return[i,n]}var HE=yo;function J_(r,e,t){var i=r.l+e,n=t.biff==8||!t.biff?4:2,s=r.read_shift(n),a=r.read_shift(n),l=r.read_shift(2),h=r.read_shift(2);return r.l=i,{s:{r:s,c:l},e:{r:a,c:h}}}function zE(r){var e=r.read_shift(2),t=r.read_shift(2),i=Wx(r);return{r:e,c:t,ixfe:i[0],rknum:i[1]}}function UE(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(Wx(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulRK length mismatch");return{r:i,c:n,C:a,rkrec:s}}function WE(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulBlank length mismatch");return{r:i,c:n,C:a,ixfe:s}}function jE(r,e,t,i){var n={},s=r.read_shift(4),a=r.read_shift(4),l=r.read_shift(4),h=r.read_shift(2);return n.patternType=zP[l>>26],i.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=a&15,n.dgRight=a>>4&15,n.dgTop=a>>8&15,n.dgBottom=a>>12&15,n.icvLeft=a>>16&127,n.icvRight=a>>23&127,n.grbitDiag=a>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=h&127,n.icvBack=h>>7&127,n.fsxButton=h>>14&1),n}function XE(r,e,t){var i={};return i.ifnt=r.read_shift(2),i.numFmtId=r.read_shift(2),i.flags=r.read_shift(2),i.fStyle=i.flags>>2&1,e-=6,i.data=jE(r,e,i.fStyle,t),i}function GE(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Q_(r,e,t){var i=ps(r);(t.biff==2||e==9)&&++r.l;var n=oE(r);return i.val=n,i.t=n===!0||n===!1?"b":"e",i}function YE(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=ps(r),n=or(r);return i.val=n,i}var em=gE;function VE(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=so(r,s),l=[];i>r.l;)l.push(qu(r));return[s,n,a,l]}function tm(r,e,t){var i=r.read_shift(2),n,s={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(n=mE(r,e-2,t)),s.body=n||r.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var ZE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function im(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),l=r.read_shift(t&&t.biff==2?1:2),h=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),h=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var c=so(r,a,t);n&32&&(c=ZE[c.charCodeAt(0)]);var p=i-r.l;t&&t.biff==2&&--p;var g=i==r.l||l===0||!(p>0)?[]:S4(r,p,t,l);return{chKey:s,Name:c,itab:h,rgce:g}}function Gx(r,e,t){if(t.biff<8)return KE(r,e,t);for(var i=[],n=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)i.push(_E(r,t.biff>8?12:6,t));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function KE(r,e,t){r[r.l+1]==3&&r[r.l]++;var i=$u(r,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function $E(r,e,t){if(t.biff<8){r.l+=e;return}var i=r.read_shift(2),n=r.read_shift(2),s=so(r,i,t),a=so(r,n,t);return[s,a]}function qE(r,e,t){var i=jx(r);r.l++;var n=r.read_shift(1);return e-=8,[D4(r,e,t),n,i]}function rm(r,e,t){var i=xE(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[i,A4(r,e,t)]}function JE(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,i=r.read_shift(4);return[e,t,i]}function QE(r,e,t){if(!(t.biff<8)){var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),l=yo(r,0,t);return t.biff<8&&r.read_shift(1),[{r:i,c:n},l,a,s]}}function eA(r,e,t){return QE(r,e,t)}function tA(r,e){for(var t=[],i=r.read_shift(2);i--;)t.push(Uc(r));return t}function iA(r,e,t){if(t&&t.biff<8)return nA(r,e,t);var i=Xx(r),n=wE(r,e-22,i[1]);return{cmo:i,ft:n}}var rA={8:function(r,e){var t=r.l+e;r.l+=10;var i=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var n=r.read_shift(1);return r.l+=n,r.l=t,{fmt:i}}};function nA(r,e,t){r.l+=4;var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((rA[i]||hr)(r,e,t)),{cmo:[n,i,s],ft:a}}function sA(r,e,t){var i=r.l,n="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=uE(r,6,t);var l=r.read_shift(2);r.read_shift(2),Si(r,2);var h=r.read_shift(2);r.l+=h;for(var c=1;c<r.lens.length-1;++c){if(r.l-i!=r.lens[c])throw new Error("TxO: bad continue record");var p=r[r.l],g=so(r,r.lens[c+1]-r.lens[c]-1);if(n+=g,n.length>=(p?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return r.l=i+e,{t:n}}catch{return r.l=i+e,{t:n}}}function aA(r,e){var t=Uc(r);r.l+=16;var i=dE(r,e-24);return[t,i]}function oA(r,e){r.read_shift(2);var t=Uc(r),i=r.read_shift((e-10)/2,"dbcs-cont");return i=i.replace(Sr,""),[t,i]}function lA(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=Y_[t]||t,t=r.read_shift(2),e[1]=Y_[t]||t,e}function uA(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Ux(r));return t}function hA(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Ux(r));return t}function cA(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function Yx(r,e,t){if(!t.cellStyles)return hr(r,e);var i=t&&t.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),l=r.read_shift(i),h=r.read_shift(2);i==2&&(r.l+=2);var c={s:n,e:s,w:a,ixfe:l,flags:h};return(t.biff>=5||!t.biff)&&(c.level=h>>8&7),c}function fA(r,e){var t={};return e<32||(r.l+=16,t.header=or(r),t.footer=or(r),r.l+=2),t}function dA(r,e,t){var i={area:!1};if(t.biff!=5)return r.l+=e,i;var n=r.read_shift(1);return r.l+=3,n&16&&(i.area=!0),i}var pA=ps,gA=Hx,_A=qu;function mA(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n={fmt:e,env:t,len:i,data:r.slice(r.l,r.l+i)};return r.l+=i,n}function xA(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=ps(r);++r.l;var n=yo(r,e-7,t);return i.t="str",i.val=n,i}function vA(r){var e=ps(r);++r.l;var t=or(r);return e.t="n",e.val=t,e}function yA(r){var e=ps(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function bA(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function wA(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function TA(r,e,t){var i=r.l+e,n=ps(r),s=r.read_shift(2),a=so(r,s,t);return r.l=i,n.t="str",n.val=a,n}var kA=[2,3,48,49,131,139,140,245],nm=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ld({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(l,h){var c=[],p=_a(1);switch(h.type){case"base64":p=Hn(un(l));break;case"binary":p=Hn(l);break;case"buffer":case"array":p=l;break}$i(p,0);var g=p.read_shift(1),m=!!(g&136),_=!1,b=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,m=!0;break;case 49:_=!0,m=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var x=0,w=521;g==2&&(x=p.read_shift(2)),p.l+=3,g!=2&&(x=p.read_shift(4)),x>1048576&&(x=1e6),g!=2&&(w=p.read_shift(2));var P=p.read_shift(2),E=h.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(E=r[p[p.l]]),p.l+=1,p.l+=2),b&&(p.l+=36);for(var k=[],C={},O=Math.min(p.length,g==2?521:w-10-(_?264:0)),F=b?32:11;p.l<O&&p[p.l]!=13;)switch(C={},C.name=ca.utils.decode(E,p.slice(p.l,p.l+F)).replace(/[\u0000\r\n].*$/g,""),p.l+=F,C.type=String.fromCharCode(p.read_shift(1)),g!=2&&!b&&(C.offset=p.read_shift(4)),C.len=p.read_shift(1),g==2&&(C.offset=p.read_shift(2)),C.dec=p.read_shift(1),C.name.length&&k.push(C),g!=2&&(p.l+=b?13:14),C.type){case"B":(!_||C.len!=8)&&h.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var D=0,N=0;for(c[0]=[],N=0;N!=k.length;++N)c[0][N]=k[N].name;for(;x-- >0;){if(p[p.l]===42){p.l+=P;continue}for(++p.l,c[++D]=[],N=0,N=0;N!=k.length;++N){var X=p.slice(p.l,p.l+k[N].len);p.l+=k[N].len,$i(X,0);var z=ca.utils.decode(E,X);switch(k[N].type){case"C":z.trim().length&&(c[D][N]=z.replace(/\s+$/,""));break;case"D":z.length===8?c[D][N]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):c[D][N]=z;break;case"F":c[D][N]=parseFloat(z.trim());break;case"+":case"I":c[D][N]=b?X.read_shift(-4,"i")^2147483648:X.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":c[D][N]=!0;break;case"N":case"F":c[D][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[D][N]="##MEMO##"+(b?parseInt(z.trim(),10):X.read_shift(4));break;case"N":z=z.replace(/\u0000/g,"").trim(),z&&z!="."&&(c[D][N]=+z||0);break;case"@":c[D][N]=new Date(X.read_shift(-8,"f")-621356832e5);break;case"T":c[D][N]=new Date((X.read_shift(4)-2440588)*864e5+X.read_shift(4));break;case"Y":c[D][N]=X.read_shift(4,"i")/1e4+X.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[D][N]=-X.read_shift(-8,"f");break;case"B":if(_&&k[N].len==8){c[D][N]=X.read_shift(8,"f");break}case"G":case"P":X.l+=k[N].len;break;case"0":if(k[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[N].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(c=c.slice(0,h.sheetRows)),h.DBF=k,c}function i(l,h){var c=h||{};c.dateNF||(c.dateNF="yyyymmdd");var p=bl(t(l,c),c);return p["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,p}function n(l,h){try{return wa(i(l,h),h)}catch(c){if(h&&h.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,h){var c=h||{};if(+c.codepage>=0&&zn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var p=ed(),g=ud(l,{header:1,raw:!0,cellDates:!0}),m=g[0],_=g.slice(1),b=l["!cols"]||[],x=0,w=0,P=0,E=1;for(x=0;x<m.length;++x){if(((b[x]||{}).DBF||{}).name){m[x]=b[x].DBF.name,++P;continue}if(m[x]!=null){if(++P,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var k=di(l["!ref"]),C=[],O=[],F=[];for(x=0;x<=k.e.c-k.s.c;++x){var D="",N="",X=0,z=[];for(w=0;w<_.length;++w)_[w][x]!=null&&z.push(_[w][x]);if(z.length==0||m[x]==null){C[x]="?";continue}for(w=0;w<z.length;++w){switch(typeof z[w]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=z[w]instanceof Date?"D":"C";break;default:N="C"}X=Math.max(X,String(z[w]).length),D=D&&D!=N?"C":N}X>250&&(X=250),N=((b[x]||{}).DBF||{}).type,N=="C"&&b[x].DBF.len>X&&(X=b[x].DBF.len),D=="B"&&N=="N"&&(D="N",F[x]=b[x].DBF.dec,X=b[x].DBF.len),O[x]=D=="C"||N=="N"?X:s[D]||0,E+=O[x],C[x]=D}var U=p.next(32);for(U.write_shift(4,318902576),U.write_shift(4,_.length),U.write_shift(2,296+32*P),U.write_shift(2,E),x=0;x<4;++x)U.write_shift(4,0);for(U.write_shift(4,0|(+e[Xm]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var j=p.next(32),q=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,q,"sbcs"),j.write_shift(1,C[x]=="?"?"C":C[x],"sbcs"),j.write_shift(4,w),j.write_shift(1,O[x]||s[C[x]]||0),j.write_shift(1,F[x]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),w+=O[x]||s[C[x]]||0}var pe=p.next(264);for(pe.write_shift(4,13),x=0;x<65;++x)pe.write_shift(4,0);for(x=0;x<_.length;++x){var fe=p.next(E);for(fe.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(C[w]){case"L":fe.write_shift(1,_[x][w]==null?63:_[x][w]?84:70);break;case"B":fe.write_shift(8,_[x][w]||0,"f");break;case"N":var Ee="0";for(typeof _[x][w]=="number"&&(Ee=_[x][w].toFixed(F[w]||0)),P=0;P<O[w]-Ee.length;++P)fe.write_shift(1,32);fe.write_shift(1,Ee,"sbcs");break;case"D":_[x][w]?(fe.write_shift(4,("0000"+_[x][w].getFullYear()).slice(-4),"sbcs"),fe.write_shift(2,("00"+(_[x][w].getMonth()+1)).slice(-2),"sbcs"),fe.write_shift(2,("00"+_[x][w].getDate()).slice(-2),"sbcs")):fe.write_shift(8,"00000000","sbcs");break;case"C":var de=String(_[x][w]!=null?_[x][w]:"").slice(0,O[w]);for(fe.write_shift(1,de,"sbcs"),P=0;P<O[w]-de.length;++P)fe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),PA=function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fs(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,_){var b=r[_];return typeof b=="number"?y_(b):b},i=function(m,_,b){var x=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return x==59?m:y_(x)};r["|"]=254;function n(m,_){switch(_.type){case"base64":return s(un(m),_);case"binary":return s(m,_);case"buffer":return s(Ct&&Buffer.isBuffer(m)?m.toString("binary"):_o(m),_);case"array":return s(no(m),_)}throw new Error("Unrecognized type "+_.type)}function s(m,_){var b=m.split(/[\n\r]+/),x=-1,w=-1,P=0,E=0,k=[],C=[],O=null,F={},D=[],N=[],X=[],z=0,U;for(+_.codepage>=0&&zn(+_.codepage);P!==b.length;++P){z=0;var j=b[P].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),q=j.replace(/;;/g,"\0").split(";").map(function(ie){return ie.replace(/\u0000/g,";")}),pe=q[0],fe;if(j.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&C.push(j.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,de=!1,De=!1,ee=!1,Fe=-1,se=-1;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"A":break;case"X":w=parseInt(q[E].slice(1))-1,de=!0;break;case"Y":for(x=parseInt(q[E].slice(1))-1,de||(w=0),U=k.length;U<=x;++U)k[U]=[];break;case"K":fe=q[E].slice(1),fe.charAt(0)==='"'?fe=fe.slice(1,fe.length-1):fe==="TRUE"?fe=!0:fe==="FALSE"?fe=!1:isNaN(Wn(fe))?isNaN(ul(fe).getDate())||(fe=Zi(fe)):(fe=Wn(fe),O!==null&&vl(O)&&(fe=zc(fe))),Ee=!0;break;case"E":ee=!0;var R=sl(q[E].slice(1),{r:x,c:w});k[x][w]=[k[x][w],R];break;case"S":De=!0,k[x][w]=[k[x][w],"S5S"];break;case"G":break;case"R":Fe=parseInt(q[E].slice(1))-1;break;case"C":se=parseInt(q[E].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+j)}if(Ee&&(k[x][w]&&k[x][w].length==2?k[x][w][0]=fe:k[x][w]=fe,O=null),De){if(ee)throw new Error("SYLK shared formula cannot have own formula");var J=Fe>-1&&k[Fe][se];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");k[x][w][1]=iv(J[1],{r:x-Fe,c:w-se})}break;case"F":var Y=0;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"X":w=parseInt(q[E].slice(1))-1,++Y;break;case"Y":for(x=parseInt(q[E].slice(1))-1,U=k.length;U<=x;++U)k[U]=[];break;case"M":z=parseInt(q[E].slice(1))/20;break;case"F":break;case"G":break;case"P":O=C[parseInt(q[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(X=q[E].slice(1).split(" "),U=parseInt(X[0],10);U<=parseInt(X[1],10);++U)z=parseInt(X[2],10),N[U-1]=z===0?{hidden:!0}:{wch:z},hl(N[U-1]);break;case"C":w=parseInt(q[E].slice(1))-1,N[w]||(N[w]={});break;case"R":x=parseInt(q[E].slice(1))-1,D[x]||(D[x]={}),z>0?(D[x].hpt=z,D[x].hpx=Eu(z)):z===0&&(D[x].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+j)}Y<1&&(O=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+j)}}return D.length>0&&(F["!rows"]=D),N.length>0&&(F["!cols"]=N),_&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),[k,F]}function a(m,_){var b=n(m,_),x=b[0],w=b[1],P=bl(x,_);return fs(w).forEach(function(E){P[E]=w[E]}),P}function l(m,_){return wa(a(m,_),_)}function h(m,_,b,x){var w="C;Y"+(b+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+cS(m.f,{r:b,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,_){_.forEach(function(b,x){var w="F;W"+(x+1)+" "+(x+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=yc(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=bc(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function p(m,_){_.forEach(function(b,x){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*Qx(b.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function g(m,_){var b=["ID;PWXL;N;E"],x=[],w=di(m["!ref"]),P,E=Array.isArray(m),k=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),m["!cols"]&&c(b,m["!cols"]),m["!rows"]&&p(b,m["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var C=w.s.r;C<=w.e.r;++C)for(var O=w.s.c;O<=w.e.c;++O){var F=lt({r:C,c:O});P=E?(m[C]||[])[O]:m[F],!(!P||P.v==null&&(!P.f||P.F))&&x.push(h(P,m,C,O))}return b.join(k)+k+x.join(k)+k+"E"+k}return{to_workbook:l,to_sheet:a,from_sheet:g}}(),EA=function(){function r(s,a){switch(a.type){case"base64":return e(un(s),a);case"binary":return e(s,a);case"buffer":return e(Ct&&Buffer.isBuffer(s)?s.toString("binary"):_o(s),a);case"array":return e(no(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var l=s.split(`
`),h=-1,c=-1,p=0,g=[];p!==l.length;++p){if(l[p].trim()==="BOT"){g[++h]=[],c=0;continue}if(!(h<0)){var m=l[p].trim().split(","),_=m[0],b=m[1];++p;for(var x=l[p]||"";(x.match(/["]/g)||[]).length&1&&p<l.length-1;)x+=`
`+l[++p];switch(x=x.trim(),+_){case-1:if(x==="BOT"){g[++h]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?g[h][c]=!0:x==="FALSE"?g[h][c]=!1:isNaN(Wn(b))?isNaN(ul(b).getDate())?g[h][c]=b:g[h][c]=Zi(b):g[h][c]=Wn(b),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),g[h][c++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function t(s,a){return bl(r(s,a),a)}function i(s,a){return wa(t(s,a),a)}var n=function(){var s=function(h,c,p,g,m){h.push(c),h.push(p+","+g),h.push('"'+m.replace(/"/g,'""')+'"')},a=function(h,c,p,g){h.push(c+","+p),h.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var c=[],p=di(h["!ref"]),g,m=Array.isArray(h);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,p.e.r-p.s.r+1,""),s(c,"TUPLES",0,p.e.c-p.s.c+1,""),s(c,"DATA",0,0,"");for(var _=p.s.r;_<=p.e.r;++_){a(c,-1,0,"BOT");for(var b=p.s.c;b<=p.e.c;++b){var x=lt({r:_,c:b});if(g=m?(h[_]||[])[b]:h[x],!g){a(c,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=wn(g.z||dt[14],Dr(Zi(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var P=`\r
`,E=c.join(P);return E}}();return{to_workbook:i,to_sheet:t,from_sheet:n}}(),AA=function(){function r(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var _=g.split(`
`),b=-1,x=-1,w=0,P=[];w!==_.length;++w){var E=_[w].trim().split(":");if(E[0]==="cell"){var k=Ar(E[1]);if(P.length<=k.r)for(b=P.length;b<=k.r;++b)P[b]||(P[b]=[]);switch(b=k.r,x=k.c,E[2]){case"t":P[b][x]=r(E[3]);break;case"v":P[b][x]=+E[3];break;case"vtf":var C=E[E.length-1];case"vtc":switch(E[3]){case"nl":P[b][x]=!!+E[4];break;default:P[b][x]=+E[4];break}E[2]=="vtf"&&(P[b][x]=[P[b][x],C])}}}return m&&m.sheetRows&&(P=P.slice(0,m.sheetRows)),P}function i(g,m){return bl(t(g,m),m)}function n(g,m){return wa(i(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],_=[],b,x="",w=yl(g["!ref"]),P=Array.isArray(g),E=w.s.r;E<=w.e.r;++E)for(var k=w.s.c;k<=w.e.c;++k)if(x=lt({r:E,c:k}),b=P?(g[E]||[])[k]:g[x],!(!b||b.v==null||b.t==="z")){switch(_=["cell",x,"t"],b.t){case"s":case"str":_.push(e(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=e(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var C=Dr(Zi(b.v));_[2]="vtc",_[3]="nd",_[4]=""+C,_[5]=b.w||wn(b.z||dt[14],C);break;case"e":continue}m.push(_.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function p(g){return[s,a,l,a,c(g),h].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:p}}(),ku=function(){function r(p,g,m,_,b){b.raw?g[m][_]=p:p===""||(p==="TRUE"?g[m][_]=!0:p==="FALSE"?g[m][_]=!1:isNaN(Wn(p))?isNaN(ul(p).getDate())?g[m][_]=p:g[m][_]=Zi(p):g[m][_]=Wn(p))}function e(p,g){var m=g||{},_=[];if(!p||p.length===0)return _;for(var b=p.split(/[\r\n]/),x=b.length-1;x>=0&&b[x].length===0;)--x;for(var w=10,P=0,E=0;E<=x;++E)P=b[E].indexOf(" "),P==-1?P=b[E].length:P++,w=Math.max(w,P);for(E=0;E<=x;++E){_[E]=[];var k=0;for(r(b[E].slice(0,w).trim(),_,E,k,m),k=1;k<=(b[E].length-w)/10+1;++k)r(b[E].slice(w+(k-1)*10,w+k*10).trim(),_,E,k,m)}return m.sheetRows&&(_=_.slice(0,m.sheetRows)),_}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(p){for(var g={},m=!1,_=0,b=0;_<p.length;++_)(b=p.charCodeAt(_))==34?m=!m:!m&&b in t&&(g[b]=(g[b]||0)+1);b=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&b.push([g[_],_]);if(!b.length){g=i;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&b.push([g[_],_])}return b.sort(function(x,w){return x[0]-w[0]||i[x[1]]-i[w[1]]}),t[b.pop()[1]]||44}function s(p,g){var m=g||{},_="",b=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(_=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(_=p.charAt(4),p=p.slice(6)):_=n(p.slice(0,1024)):m&&m.FS?_=m.FS:_=n(p.slice(0,1024));var w=0,P=0,E=0,k=0,C=0,O=_.charCodeAt(0),F=!1,D=0,N=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var X=m.dateNF!=null?Hk(m.dateNF):null;function z(){var U=p.slice(k,C),j={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)j.t="z";else if(m.raw)j.t="s",j.v=U;else if(U.trim().length===0)j.t="s",j.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(j.t="s",j.v=U.slice(2,-1).replace(/""/g,'"')):dS(U)?(j.t="n",j.f=U.slice(1)):(j.t="s",j.v=U);else if(U=="TRUE")j.t="b",j.v=!0;else if(U=="FALSE")j.t="b",j.v=!1;else if(!isNaN(E=Wn(U)))j.t="n",m.cellText!==!1&&(j.w=U),j.v=E;else if(!isNaN(ul(U).getDate())||X&&U.match(X)){j.z=m.dateNF||dt[14];var q=0;X&&U.match(X)&&(U=zk(U,m.dateNF,U.match(X)||[]),q=1),m.cellDates?(j.t="d",j.v=Zi(U,q)):(j.t="n",j.v=Dr(Zi(U,q))),m.cellText!==!1&&(j.w=wn(j.z,j.v instanceof Date?Dr(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=U;if(j.t=="z"||(m.dense?(b[w]||(b[w]=[]),b[w][P]=j):b[lt({c:P,r:w})]=j),k=C+1,N=p.charCodeAt(k),x.e.c<P&&(x.e.c=P),x.e.r<w&&(x.e.r=w),D==O)++P;else if(P=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;C<p.length;++C)switch(D=p.charCodeAt(C)){case 34:N===34&&(F=!F);break;case O:case 10:case 13:if(!F&&z())break e;break}return C-k>0&&z(),b["!ref"]=Lt(x),b}function a(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,g):bl(e(p,g),g)}function l(p,g){var m="",_=g.type=="string"?[0,0,0,0]:$d(p,g);switch(g.type){case"base64":m=un(p);break;case"binary":m=p;break;case"buffer":g.codepage==65001?m=p.toString("utf8"):g.codepage&&typeof ca<"u"?m=ca.utils.decode(g.codepage,p):m=Ct&&Buffer.isBuffer(p)?p.toString("binary"):_o(p);break;case"array":m=no(p);break;case"string":m=p;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?m=qt(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=qt(m):g.type=="binary"&&typeof ca<"u"&&g.codepage&&(m=ca.utils.decode(g.codepage,ca.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?AA.to_sheet(g.type=="string"?m:qt(m),g):a(m,g)}function h(p,g){return wa(l(p,g),g)}function c(p){for(var g=[],m=di(p["!ref"]),_,b=Array.isArray(p),x=m.s.r;x<=m.e.r;++x){for(var w=[],P=m.s.c;P<=m.e.c;++P){var E=lt({r:x,c:P});if(_=b?(p[x]||[])[P]:p[E],!_||_.v==null){w.push("          ");continue}for(var k=(_.w||(zs(_),_.w)||"").slice(0,10);k.length<10;)k+=" ";w.push(k+(P===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:l,from_sheet:c}}();function CA(r,e){var t=e||{},i=!!t.WTF;t.WTF=!0;try{var n=PA.to_workbook(r,t);return t.WTF=i,n}catch(s){if(t.WTF=i,!s.message.match(/SYLK bad record ID/)&&i)throw s;return ku.to_workbook(r,e)}}var pu=function(){function r(R,J,Y){if(R){$i(R,R.l||0);for(var ie=Y.Enum||Fe;R.l<R.length;){var he=R.read_shift(2),Pe=ie[he]||ie[65535],we=R.read_shift(2),Oe=R.l+we,Le=Pe.f&&Pe.f(R,we,Y);if(R.l=Oe,J(Le,Pe,he))return}}}function e(R,J){switch(J.type){case"base64":return t(Hn(un(R)),J);case"binary":return t(Hn(R),J);case"buffer":case"array":return t(R,J)}throw"Unsupported type "+J.type}function t(R,J){if(!R)return R;var Y=J||{},ie=Y.dense?[]:{},he="Sheet1",Pe="",we=0,Oe={},Le=[],it=[],te={s:{r:0,c:0},e:{r:0,c:0}},ft=Y.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)Y.Enum=Fe,r(R,function(Be,St,ii){switch(ii){case 0:Y.vers=Be,Be>=4096&&(Y.qpro=!0);break;case 6:te=Be;break;case 204:Be&&(Pe=Be);break;case 222:Pe=Be;break;case 15:case 51:Y.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:ii==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=Y.dateNF||dt[14],Y.cellDates&&(Be[1].t="d",Be[1].v=zc(Be[1].v))),Y.qpro&&Be[3]>we&&(ie["!ref"]=Lt(te),Oe[he]=ie,Le.push(he),ie=Y.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},we=Be[3],he=Pe||"Sheet"+(we+1),Pe="");var Ht=Y.dense?(ie[Be[0].r]||[])[Be[0].c]:ie[lt(Be[0])];if(Ht){Ht.t=Be[1].t,Ht.v=Be[1].v,Be[1].z!=null&&(Ht.z=Be[1].z),Be[1].f!=null&&(Ht.f=Be[1].f);break}Y.dense?(ie[Be[0].r]||(ie[Be[0].r]=[]),ie[Be[0].r][Be[0].c]=Be[1]):ie[lt(Be[0])]=Be[1];break}},Y);else if(R[2]==26||R[2]==14)Y.Enum=se,R[2]==14&&(Y.qpro=!0,R.l=0),r(R,function(Be,St,ii){switch(ii){case 204:he=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>we&&(ie["!ref"]=Lt(te),Oe[he]=ie,Le.push(he),ie=Y.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},we=Be[3],he="Sheet"+(we+1)),ft>0&&Be[0].r>=ft)break;Y.dense?(ie[Be[0].r]||(ie[Be[0].r]=[]),ie[Be[0].r][Be[0].c]=Be[1]):ie[lt(Be[0])]=Be[1],te.e.c<Be[0].c&&(te.e.c=Be[0].c),te.e.r<Be[0].r&&(te.e.r=Be[0].r);break;case 27:Be[14e3]&&(it[Be[14e3][0]]=Be[14e3][1]);break;case 1537:it[Be[0]]=Be[1],Be[0]==we&&(he=Be[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(ie["!ref"]=Lt(te),Oe[Pe||he]=ie,Le.push(Pe||he),!it.length)return{SheetNames:Le,Sheets:Oe};for(var Ge={},_t=[],rt=0;rt<it.length;++rt)Oe[Le[rt]]?(_t.push(it[rt]||Le[rt]),Ge[it[rt]]=Oe[it[rt]]||Oe[Le[rt]]):(_t.push(it[rt]),Ge[it[rt]]={"!ref":"A1"});return{SheetNames:_t,Sheets:Ge}}function i(R,J){var Y=J||{};if(+Y.codepage>=0&&zn(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var ie=ed(),he=di(R["!ref"]),Pe=Array.isArray(R),we=[];Nn(ie,0,s(1030)),Nn(ie,6,h(he));for(var Oe=Math.min(he.e.r,8191),Le=he.s.r;Le<=Oe;++Le)for(var it=Ji(Le),te=he.s.c;te<=he.e.c;++te){Le===he.s.r&&(we[te]=zi(te));var ft=we[te]+it,Ge=Pe?(R[Le]||[])[te]:R[ft];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?Nn(ie,13,_(Le,te,Ge.v)):Nn(ie,14,x(Le,te,Ge.v));else{var _t=zs(Ge);Nn(ie,15,g(Le,te,_t.slice(0,239)))}}return Nn(ie,1),ie.end()}function n(R,J){var Y=J||{};if(+Y.codepage>=0&&zn(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var ie=ed();Nn(ie,0,a(R));for(var he=0,Pe=0;he<R.SheetNames.length;++he)(R.Sheets[R.SheetNames[he]]||{})["!ref"]&&Nn(ie,27,ee(R.SheetNames[he],Pe++));var we=0;for(he=0;he<R.SheetNames.length;++he){var Oe=R.Sheets[R.SheetNames[he]];if(!(!Oe||!Oe["!ref"])){for(var Le=di(Oe["!ref"]),it=Array.isArray(Oe),te=[],ft=Math.min(Le.e.r,8191),Ge=Le.s.r;Ge<=ft;++Ge)for(var _t=Ji(Ge),rt=Le.s.c;rt<=Le.e.c;++rt){Ge===Le.s.r&&(te[rt]=zi(rt));var Be=te[rt]+_t,St=it?(Oe[Ge]||[])[rt]:Oe[Be];if(!(!St||St.t=="z"))if(St.t=="n")Nn(ie,23,z(Ge,rt,we,St.v));else{var ii=zs(St);Nn(ie,22,D(Ge,rt,we,ii.slice(0,239)))}}++we}}return Nn(ie,1),ie.end()}function s(R){var J=Bi(2);return J.write_shift(2,R),J}function a(R){var J=Bi(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Y=0,ie=0,he=0,Pe=0;Pe<R.SheetNames.length;++Pe){var we=R.SheetNames[Pe],Oe=R.Sheets[we];if(!(!Oe||!Oe["!ref"])){++he;var Le=yl(Oe["!ref"]);Y<Le.e.r&&(Y=Le.e.r),ie<Le.e.c&&(ie=Le.e.c)}}return Y>8191&&(Y=8191),J.write_shift(2,Y),J.write_shift(1,he),J.write_shift(1,ie),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function l(R,J,Y){var ie={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&Y.qpro?(ie.s.c=R.read_shift(1),R.l++,ie.s.r=R.read_shift(2),ie.e.c=R.read_shift(1),R.l++,ie.e.r=R.read_shift(2),ie):(ie.s.c=R.read_shift(2),ie.s.r=R.read_shift(2),J==12&&Y.qpro&&(R.l+=2),ie.e.c=R.read_shift(2),ie.e.r=R.read_shift(2),J==12&&Y.qpro&&(R.l+=2),ie.s.c==65535&&(ie.s.c=ie.e.c=ie.s.r=ie.e.r=0),ie)}function h(R){var J=Bi(8);return J.write_shift(2,R.s.c),J.write_shift(2,R.s.r),J.write_shift(2,R.e.c),J.write_shift(2,R.e.r),J}function c(R,J,Y){var ie=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(ie[0].c=R.read_shift(1),ie[3]=R.read_shift(1),ie[0].r=R.read_shift(2),R.l+=2):(ie[2]=R.read_shift(1),ie[0].c=R.read_shift(2),ie[0].r=R.read_shift(2)),ie}function p(R,J,Y){var ie=R.l+J,he=c(R,J,Y);if(he[1].t="s",Y.vers==20768){R.l++;var Pe=R.read_shift(1);return he[1].v=R.read_shift(Pe,"utf8"),he}return Y.qpro&&R.l++,he[1].v=R.read_shift(ie-R.l,"cstr"),he}function g(R,J,Y){var ie=Bi(7+Y.length);ie.write_shift(1,255),ie.write_shift(2,J),ie.write_shift(2,R),ie.write_shift(1,39);for(var he=0;he<ie.length;++he){var Pe=Y.charCodeAt(he);ie.write_shift(1,Pe>=128?95:Pe)}return ie.write_shift(1,0),ie}function m(R,J,Y){var ie=c(R,J,Y);return ie[1].v=R.read_shift(2,"i"),ie}function _(R,J,Y){var ie=Bi(7);return ie.write_shift(1,255),ie.write_shift(2,J),ie.write_shift(2,R),ie.write_shift(2,Y,"i"),ie}function b(R,J,Y){var ie=c(R,J,Y);return ie[1].v=R.read_shift(8,"f"),ie}function x(R,J,Y){var ie=Bi(13);return ie.write_shift(1,255),ie.write_shift(2,J),ie.write_shift(2,R),ie.write_shift(8,Y,"f"),ie}function w(R,J,Y){var ie=R.l+J,he=c(R,J,Y);if(he[1].v=R.read_shift(8,"f"),Y.qpro)R.l=ie;else{var Pe=R.read_shift(2);C(R.slice(R.l,R.l+Pe),he),R.l+=Pe}return he}function P(R,J,Y){var ie=J&32768;return J&=-32769,J=(ie?R:0)+(J>=8192?J-16384:J),(ie?"":"$")+(Y?zi(J):Ji(J))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(R,J){$i(R,0);for(var Y=[],ie=0,he="",Pe="",we="",Oe="";R.l<R.length;){var Le=R[R.l++];switch(Le){case 0:Y.push(R.read_shift(8,"f"));break;case 1:Pe=P(J[0].c,R.read_shift(2),!0),he=P(J[0].r,R.read_shift(2),!1),Y.push(Pe+he);break;case 2:{var it=P(J[0].c,R.read_shift(2),!0),te=P(J[0].r,R.read_shift(2),!1);Pe=P(J[0].c,R.read_shift(2),!0),he=P(J[0].r,R.read_shift(2),!1),Y.push(it+te+":"+Pe+he)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(R.read_shift(2));break;case 6:{for(var ft="";Le=R[R.l++];)ft+=String.fromCharCode(Le);Y.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Oe=Y.pop(),we=Y.pop(),Y.push(["AND","OR"][Le-20]+"("+we+","+Oe+")");break;default:if(Le<32&&k[Le])Oe=Y.pop(),we=Y.pop(),Y.push(we+k[Le]+Oe);else if(E[Le]){if(ie=E[Le][1],ie==69&&(ie=R[R.l++]),ie>Y.length){console.error("WK1 bad formula parse 0x"+Le.toString(16)+":|"+Y.join("|")+"|");return}var Ge=Y.slice(-ie);Y.length-=ie,Y.push(E[Le][0]+"("+Ge.join(",")+")")}else return Le<=7?console.error("WK1 invalid opcode "+Le.toString(16)):Le<=24?console.error("WK1 unsupported op "+Le.toString(16)):Le<=30?console.error("WK1 invalid opcode "+Le.toString(16)):Le<=115?console.error("WK1 unsupported function opcode "+Le.toString(16)):console.error("WK1 unrecognized opcode "+Le.toString(16))}}Y.length==1?J[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function O(R){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=R.read_shift(2),J[3]=R[R.l++],J[0].c=R[R.l++],J}function F(R,J){var Y=O(R);return Y[1].t="s",Y[1].v=R.read_shift(J-4,"cstr"),Y}function D(R,J,Y,ie){var he=Bi(6+ie.length);he.write_shift(2,R),he.write_shift(1,Y),he.write_shift(1,J),he.write_shift(1,39);for(var Pe=0;Pe<ie.length;++Pe){var we=ie.charCodeAt(Pe);he.write_shift(1,we>=128?95:we)}return he.write_shift(1,0),he}function N(R,J){var Y=O(R);Y[1].v=R.read_shift(2);var ie=Y[1].v>>1;if(Y[1].v&1)switch(ie&7){case 0:ie=(ie>>3)*5e3;break;case 1:ie=(ie>>3)*500;break;case 2:ie=(ie>>3)/20;break;case 3:ie=(ie>>3)/200;break;case 4:ie=(ie>>3)/2e3;break;case 5:ie=(ie>>3)/2e4;break;case 6:ie=(ie>>3)/16;break;case 7:ie=(ie>>3)/64;break}return Y[1].v=ie,Y}function X(R,J){var Y=O(R),ie=R.read_shift(4),he=R.read_shift(4),Pe=R.read_shift(2);if(Pe==65535)return ie===0&&he===3221225472?(Y[1].t="e",Y[1].v=15):ie===0&&he===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var we=Pe&32768;return Pe=(Pe&32767)-16446,Y[1].v=(1-we*2)*(he*Math.pow(2,Pe+32)+ie*Math.pow(2,Pe)),Y}function z(R,J,Y,ie){var he=Bi(14);if(he.write_shift(2,R),he.write_shift(1,Y),he.write_shift(1,J),ie==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Pe=0,we=0,Oe=0,Le=0;return ie<0&&(Pe=1,ie=-ie),we=Math.log2(ie)|0,ie/=Math.pow(2,we-31),Le=ie>>>0,Le&2147483648||(ie/=2,++we,Le=ie>>>0),ie-=Le,Le|=2147483648,Le>>>=0,ie*=Math.pow(2,32),Oe=ie>>>0,he.write_shift(4,Oe),he.write_shift(4,Le),we+=16383+(Pe?32768:0),he.write_shift(2,we),he}function U(R,J){var Y=X(R);return R.l+=J-14,Y}function j(R,J){var Y=O(R),ie=R.read_shift(4);return Y[1].v=ie>>6,Y}function q(R,J){var Y=O(R),ie=R.read_shift(8,"f");return Y[1].v=ie,Y}function pe(R,J){var Y=q(R);return R.l+=J-10,Y}function fe(R,J){return R[R.l+J-1]==0?R.read_shift(J,"cstr"):""}function Ee(R,J){var Y=R[R.l++];Y>J-1&&(Y=J-1);for(var ie="";ie.length<Y;)ie+=String.fromCharCode(R[R.l++]);return ie}function de(R,J,Y){if(!(!Y.qpro||J<21)){var ie=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var he=R.read_shift(J-21,"cstr");return[ie,he]}}function De(R,J){for(var Y={},ie=R.l+J;R.l<ie;){var he=R.read_shift(2);if(he==14e3){for(Y[he]=[0,""],Y[he][0]=R.read_shift(2);R[R.l];)Y[he][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return Y}function ee(R,J){var Y=Bi(5+R.length);Y.write_shift(2,14e3),Y.write_shift(2,J);for(var ie=0;ie<R.length;++ie){var he=R.charCodeAt(ie);Y[Y.l++]=he>127?95:he}return Y[Y.l++]=0,Y}var Fe={0:{n:"BOF",f:Si},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:fe},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:X},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:De},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:e}}();function SA(r){var e={},t=r.match(fr),i=0,n=!1;if(t)for(;i!=t.length;++i){var s=st(t[i]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Ed[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var DA=function(){var r=wu("t"),e=wu("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var l={t:"s",v:Mt(a[1])},h=s.match(e);return h&&(l.s=SA(h[1])),l}var i=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(a){return a.replace(i,"").split(n).map(t).filter(function(l){return l.v})}}(),LA=function(){var e=/(\r\n|\n)/g;function t(n,s,a){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),n.b&&(s.push("<b>"),a.push("</b>")),n.i&&(s.push("<i>"),a.push("</i>")),n.strike&&(s.push("<s>"),a.push("</s>"));var h=n.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(s.push("<"+h+">"),a.push("</"+h+">")),a.push("</span>"),n}function i(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(i).join("")}}(),OA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,MA=/<(?:\w+:)?r>/,FA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jd(r,e){var t=e?e.cellHTML:!0,i={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Mt(qt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=qt(r),t&&(i.h=Md(i.t))):r.match(MA)&&(i.r=qt(r),i.t=Mt(qt((r.replace(FA,"").match(OA)||[]).join("").replace(fr,""))),t&&(i.h=LA(DA(i.r)))),i):{t:""}}var RA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,IA=/<(?:\w+:)?(?:si|sstItem)>/g,BA=/<\/(?:\w+:)?(?:si|sstItem)>/;function NA(r,e){var t=[],i="";if(!r)return t;var n=r.match(RA);if(n){i=n[2].replace(IA,"").split(BA);for(var s=0;s!=i.length;++s){var a=jd(i[s].trim(),e);a!=null&&(t[t.length]=a)}n=st(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}function HA(r){return[r.read_shift(4),r.read_shift(4)]}function zA(r,e){var t=[],i=!1;return Xs(r,function(s,a,l){switch(l){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T,!i||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}function Vx(r){for(var e=[],t=r.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function Bs(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function UA(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Bs(r,4),e.U=Bs(r,4),e.W=Bs(r,4),e}function WA(r){for(var e=r.read_shift(4),t=r.l+e-4,i={},n=r.read_shift(4),s=[];n-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(i.name=r.read_shift(0,"lpp4"),i.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return i}function jA(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(WA(r));return e}function XA(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function GA(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Bs(r,4),e.U=Bs(r,4),e.W=Bs(r,4),e}function YA(r){var e=GA(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Zx(r,e){var t=r.l+e,i={};i.Flags=r.read_shift(4)&63,r.l+=4,i.AlgID=r.read_shift(4);var n=!1;switch(i.AlgID){case 26126:case 26127:case 26128:n=i.Flags==36;break;case 26625:n=i.Flags==4;break;case 0:n=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=r.read_shift(4),i.KeySize=r.read_shift(4),i.ProviderType=r.read_shift(4),r.l+=8,i.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,i}function Kx(r,e){var t={},i=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,i),r.l=i,t}function VA(r){var e=Bs(r);switch(e.Minor){case 2:return[e.Minor,ZA(r)];case 3:return[e.Minor,KA()];case 4:return[e.Minor,$A(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function ZA(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),i=Zx(r,t),n=Kx(r,r.length-r.l);return{t:"Std",h:i,v:n}}function KA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $A(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),i={};return t.replace(fr,function(s){var a=st(s);switch(ds(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){i[l]=a[l]});break;case"<dataIntegrity":i.encryptedHmacKey=a.encryptedHmacKey,i.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(a);break;default:throw a[0]}}),i}function qA(r,e){var t={},i=t.EncryptionVersionInfo=Bs(r,4);if(e-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=r.read_shift(4),e-=4;var n=r.read_shift(4);return e-=4,t.EncryptionHeader=Zx(r,n),e-=n,t.EncryptionVerifier=Kx(r,e),t}function JA(r){var e={},t=e.EncryptionVersionInfo=Bs(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function QA(r){var e=0,t,i=Vx(r),n=i.length+1,s,a,l,h,c;for(t=_a(n),t[0]=i.length,s=1;s!=n;++s)t[s]=i[s-1];for(s=n-1;s>=0;--s)a=t[s],l=e&16384?1:0,h=e<<1&32767,c=l|h,e=c^a;return e^52811}var $x=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(a){return(a/2|a*128)&255},n=function(a,l){return i(a^l)},s=function(a){for(var l=e[a.length-1],h=104,c=a.length-1;c>=0;--c)for(var p=a[c],g=0;g!=7;++g)p&64&&(l^=t[h]),p*=2,--h;return l};return function(a){for(var l=Vx(a),h=s(l),c=l.length,p=_a(16),g=0;g!=16;++g)p[g]=0;var m,_,b;for((c&1)===1&&(m=h>>8,p[c]=n(r[0],m),--c,m=h&255,_=l[l.length-1],p[c]=n(_,m));c>0;)--c,m=h>>8,p[c]=n(l[c],m),--c,m=h&255,p[c]=n(l[c],m);for(c=15,b=15-l.length;b>0;)m=h>>8,p[c]=n(r[b],m),--c,--b,m=h&255,p[c]=n(l[c],m),--c,--b;return p}}(),eC=function(r,e,t,i,n){n||(n=e),i||(i=$x(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=i[t],a=(a>>5|a<<3)&255,n[s]=a,++t;return[n,t,i]},tC=function(r){var e=0,t=$x(r);return function(i){var n=eC("",i,e,t);return e=n[1],n[0]}};function iC(r,e,t,i){var n={key:Si(r),verificationBytes:Si(r)};return t.password&&(n.verifier=QA(t.password)),i.valid=n.verificationBytes===n.verifier,i.valid&&(i.insitu=tC(t.password)),n}function rC(r,e,t){var i=t||{};return i.Info=r.read_shift(2),r.l-=2,i.Info===1?i.Data=JA(r):i.Data=qA(r,e),i}function nC(r,e,t){var i={Type:t.biff>=8?r.read_shift(2):0};return i.Type?rC(r,e-2,i):iC(r,t.biff>=8?e:e-2,t,i),i}var sC=function(){function r(n,s){switch(s.type){case"base64":return e(un(n),s);case"binary":return e(n,s);case"buffer":return e(Ct&&Buffer.isBuffer(n)?n.toString("binary"):_o(n),s);case"array":return e(no(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var a=s||{},l=a.dense?[]:{},h=n.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,g){Array.isArray(l)&&(l[g]=[]);for(var m=/\\\w+\b/g,_=0,b,x=-1;b=m.exec(p);){switch(b[0]){case"\\cell":var w=p.slice(_,m.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var P={v:w,t:"s"};Array.isArray(l)?l[g][x]=P:l[lt({r:g,c:x})]=P}break}_=m.lastIndex}x>c.e.c&&(c.e.c=x)}),l["!ref"]=Lt(c),l}function t(n,s){return wa(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=di(n["!ref"]),l,h=Array.isArray(n),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var p=a.s.c;p<=a.e.c;++p)s.push("\\cellx"+(p+1));for(s.push("\\pard\\intbl"),p=a.s.c;p<=a.e.c;++p){var g=lt({r:c,c:p});l=h?(n[c]||[])[p]:n[g],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(zs(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:i}}();function aC(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Pu(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function oC(r){var e=r[0]/255,t=r[1]/255,i=r[2]/255,n=Math.max(e,t,i),s=Math.min(e,t,i),a=n-s;if(a===0)return[0,0,e];var l=0,h=0,c=n+s;switch(h=a/(c>1?2-c:c),n){case e:l=((t-i)/a+6)%6;break;case t:l=(i-e)/a+2;break;case i:l=(e-t)/a+4;break}return[l/6,h,c/2]}function lC(r){var e=r[0],t=r[1],i=r[2],n=t*2*(i<.5?i:1-i),s=i-n/2,a=[s,s,s],l=6*e,h;if(t!==0)switch(l|0){case 0:case 6:h=n*l,a[0]+=n,a[1]+=h;break;case 1:h=n*(2-l),a[0]+=h,a[1]+=n;break;case 2:h=n*(l-2),a[1]+=n,a[2]+=h;break;case 3:h=n*(4-l),a[1]+=h,a[2]+=n;break;case 4:h=n*(l-4),a[2]+=n,a[0]+=h;break;case 5:h=n*(6-l),a[2]+=h,a[0]+=n;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function vc(r,e){if(e===0)return r;var t=oC(aC(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Pu(lC(t))}var qx=6,uC=15,hC=1,Er=qx;function yc(r){return Math.floor((r+Math.round(128/Er)/256)*Er)}function bc(r){return Math.floor((r-5)/Er*100+.5)/100}function nd(r){return Math.round((r*Er+5)/Er*256)/256}function Nf(r){return nd(bc(yc(r)))}function Xd(r){var e=Math.abs(r-Nf(r)),t=Er;if(e>.005)for(Er=hC;Er<uC;++Er)Math.abs(r-Nf(r))<=e&&(e=Math.abs(r-Nf(r)),t=Er);Er=t}function hl(r){r.width?(r.wpx=yc(r.width),r.wch=bc(r.wpx),r.MDW=Er):r.wpx?(r.wch=bc(r.wpx),r.width=nd(r.wch),r.MDW=Er):typeof r.wch=="number"&&(r.width=nd(r.wch),r.wpx=yc(r.width),r.MDW=Er),r.customWidth&&delete r.customWidth}var cC=96,Jx=cC;function Qx(r){return r*96/Jx}function Eu(r){return r*Jx/96}var fC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function dC(r,e,t,i){e.Borders=[];var n={},s=!1;(r[0].match(fr)||[]).forEach(function(a){var l=st(a);switch(ds(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=ti(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=ti(l.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function pC(r,e,t,i){e.Fills=[];var n={},s=!1;(r[0].match(fr)||[]).forEach(function(a){var l=st(a);switch(ds(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function gC(r,e,t,i){e.Fonts=[];var n={},s=!1;(r[0].match(fr)||[]).forEach(function(a){var l=st(a);switch(ds(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=qt(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?ti(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?ti(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?ti(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?ti(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?ti(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?ti(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?ti(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Ed[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=ti(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var h=to[n.color.index];n.color.index==81&&(h=to[1]),h||(h=to[1]),n.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=vc(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function _C(r,e,t){e.NumberFmt=[];for(var i=fs(dt),n=0;n<i.length;++n)e.NumberFmt[i[n]]=dt[i[n]];var s=r[0].match(fr);if(s)for(n=0;n<s.length;++n){var a=st(s[n]);switch(ds(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Mt(qt(a.formatCode)),h=parseInt(a.numFmtId,10);if(e.NumberFmt[h]=l,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=l}eo(l,h)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Qh=["numFmtId","fillId","fontId","borderId","xfId"],ec=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mC(r,e,t){e.CellXf=[];var i,n=!1;(r[0].match(fr)||[]).forEach(function(s){var a=st(s),l=0;switch(ds(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=a,delete i[0],l=0;l<Qh.length;++l)i[Qh[l]]&&(i[Qh[l]]=parseInt(i[Qh[l]],10));for(l=0;l<ec.length;++l)i[ec[l]]&&(i[ec[l]]=ti(i[ec[l]]));if(e.NumberFmt&&i.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[i.numFmtId]==e.NumberFmt[l]){i.numFmtId=l;break}}e.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};a.vertical&&(h.vertical=a.vertical),a.horizontal&&(h.horizontal=a.horizontal),a.textRotation!=null&&(h.textRotation=a.textRotation),a.indent&&(h.indent=a.indent),a.wrapText&&(h.wrapText=ti(a.wrapText)),i.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var xC=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,h,c){var p={};if(!l)return p;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=l.match(e))&&_C(g,p,c),(g=l.match(n))&&gC(g,p,h,c),(g=l.match(i))&&pC(g,p,h,c),(g=l.match(s))&&dC(g,p,h,c),(g=l.match(t))&&mC(g,p,c),p}}();function vC(r,e){var t=r.read_shift(2),i=ur(r);return[t,i]}function yC(r,e,t){var i={};i.sz=r.read_shift(2)/20;var n=DP(r);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var l=r.read_shift(1);l>0&&(i.family=l);var h=r.read_shift(1);switch(h>0&&(i.charset=h),r.l++,i.color=SP(r),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=ur(r),i}var bC=hr;function wC(r,e){var t=r.l+e,i=r.read_shift(2),n=r.read_shift(2);return r.l=t,{ixfe:i,numFmtId:n}}var TC=hr;function kC(r,e,t){var i={};i.NumberFmt=[];for(var n in dt)i.NumberFmt[n]=dt[n];i.CellXf=[],i.Fonts=[];var s=[],a=!1;return Xs(r,function(h,c,p){switch(p){case 44:i.NumberFmt[h[0]]=h[1],eo(h[1],h[0]);break;case 43:i.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=vc(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&i.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(p),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(p);else if(c.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),i}var PC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function EC(r,e,t){e.themeElements.clrScheme=[];var i={};(r[0].match(fr)||[]).forEach(function(n){var s=st(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=s.val;break;case"<a:sysClr":i.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[PC.indexOf(s[0])]=i,i={}):i.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function AC(){}function CC(){}var SC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,DC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,LC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function OC(r,e,t){e.themeElements={};var i;[["clrScheme",SC,EC],["fontScheme",DC,AC],["fmtScheme",LC,CC]].forEach(function(n){if(!(i=r.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](i,e,t)})}var MC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ev(r,e){(!r||r.length===0)&&(r=FC());var t,i={};if(!(t=r.match(MC)))throw new Error("themeElements not found in theme");return OC(t[0],i,e),i.raw=r,i}function FC(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[cx];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function RC(r,e,t){var i=r.l+e,n=r.read_shift(4);if(n!==124226){if(!t.cellStyles){r.l=i;return}var s=r.slice(r.l);r.l=i;var a;try{a=hx(s,{type:"array"})}catch{return}var l=ln(a,"theme/theme/theme1.xml",!0);if(l)return ev(l,t)}}function IC(r){return r.read_shift(4)}function BC(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=NC(r,4);break;case 2:e.xclrValue=zx(r);break;case 3:e.xclrValue=IC(r);break;case 4:r.l+=4;break}return r.l+=8,e}function NC(r,e){return hr(r,e)}function HC(r,e){return hr(r,e)}function zC(r){var e=r.read_shift(2),t=r.read_shift(2)-4,i=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=BC(r);break;case 6:i[1]=HC(r,t);break;case 14:case 15:i[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return i}function UC(r,e){var t=r.l+e;r.l+=2;var i=r.read_shift(2);r.l+=2;for(var n=r.read_shift(2),s=[];n-- >0;)s.push(zC(r,t-r.l));return{ixfe:i,ext:s}}function WC(r,e){e.forEach(function(t){switch(t[0]){}})}function jC(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:ur(r)}}function XC(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function GC(r){return r.l+=4,r.read_shift(4)!=0}function YC(r,e,t){var i={Types:[],Cell:[],Value:[]},n=t||{},s=[],a=!1,l=2;return Xs(r,function(h,c,p){switch(p){case 335:i.Types.push({name:h.name});break;case 51:h.forEach(function(g){l==1?i.Cell.push({type:i.Types[g[0]-1].name,index:g[1]}):l==0&&i.Value.push({type:i.Types[g[0]-1].name,index:g[1]})});break;case 337:l=h?1:0;break;case 338:l=2;break;case 35:s.push(p),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),i}function VC(r,e,t){var i={Types:[],Cell:[],Value:[]};if(!r)return i;var n=!1,s=2,a;return r.replace(fr,function(l){var h=st(l);switch(ds(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<i.Types.length;++c)i.Types[c].name==h.name&&(a=i.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?i.Cell.push({type:i.Types[h.t-1].name,index:+h.v}):s==0&&i.Value.push({type:i.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+h.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return l}),i}function ZC(r){var e=[];if(!r)return e;var t=1;return(r.match(fr)||[]).forEach(function(i){var n=st(i);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,e.push(n);break}}),e}function KC(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=lt(t);var i=r.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}function $C(r,e,t){var i=[];return Xs(r,function(s,a,l){switch(l){case 63:i.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),i}function qC(r,e,t,i){if(!r)return r;var n=i||{},s=!1;Xs(r,function(l,h,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!h.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},n)}function JC(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}function sm(r,e,t,i){var n=Array.isArray(r),s;e.forEach(function(a){var l=Ar(a.ref);if(n?(r[l.r]||(r[l.r]=[]),s=r[l.r][l.c]):s=r[a.ref],!s){s={t:"z"},n?r[l.r][l.c]=s:r[a.ref]=s;var h=di(r["!ref"]||"BDWGO1000001:A1");h.s.r>l.r&&(h.s.r=l.r),h.e.r<l.r&&(h.e.r=l.r),h.s.c>l.c&&(h.s.c=l.c),h.e.c<l.c&&(h.e.c=l.c);var c=Lt(h);c!==r["!ref"]&&(r["!ref"]=c)}s.c||(s.c=[]);var p={a:a.author,t:a.t,r:a.r,T:t};a.h&&(p.h=a.h);for(var g=s.c.length-1;g>=0;--g){if(!t&&s.c[g].T)return;t&&!s.c[g].T&&s.c.splice(g,1)}if(t&&i){for(g=0;g<i.length;++g)if(p.a==i[g].id){p.a=i[g].name||p.a;break}}s.c.push(p)})}function QC(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],n=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var l=a.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&t.push(l[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var l=a.match(/<(?:\w+:)?comment[^>]*>/);if(l){var h=st(l[0]),c={author:h.authorId&&t[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Ar(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var g=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!g&&!!g[1]&&jd(g[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=m.h),i.push(c)}}}}),i}function eS(r,e){var t=[],i=!1,n={},s=0;return r.replace(fr,function(l,h){var c=st(l);switch(ds(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=h+l.length;break;case"</text>":n.t=r.slice(s,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function tS(r,e){var t=[],i=!1;return r.replace(fr,function(s){var a=st(s);switch(ds(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function iS(r){var e={};e.iauthor=r.read_shift(4);var t=xo(r);return e.rfx=t.s,e.ref=lt(t.s),r.l+=16,e}var rS=ur;function nS(r,e){var t=[],i=[],n={},s=!1;return Xs(r,function(l,h,c){switch(c){case 632:i.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=i[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),t}var sS="application/vnd.ms-office.vbaProject";function aS(r){var e=Dt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,n,r.FileIndex[i].content)}}),Dt.write(e)}function oS(){return{"!type":"dialog"}}function lS(){return{"!type":"dialog"}}function uS(){return{"!type":"macro"}}function hS(){return{"!type":"macro"}}var sl=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,n,s,a){var l=!1,h=!1;s.length==0?h=!0:s.charAt(0)=="["&&(h=!0,s=s.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,p=a.length>0?parseInt(a,10)|0:0;return l?p+=e.c:--p,h?c+=e.r:--c,n+(l?"":"$")+zi(p)+(h?"":"$")+Ji(c)}return function(n,s){return e=s,n.replace(r,t)}}(),tv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,cS=function(){return function(e,t){return e.replace(tv,function(i,n,s,a,l,h){var c=Bd(a)-(s?0:t.c),p=Id(h)-(l?0:t.r),g=p==0?"":l?p+1:"["+p+"]",m=c==0?"":s?c+1:"["+c+"]";return n+"R"+g+"C"+m})}}();function iv(r,e){return r.replace(tv,function(t,i,n,s,a,l){return i+(n=="$"?n+s:zi(Bd(s)+e.c))+(a=="$"?a+l:Ji(Id(l)+e.r))})}function fS(r,e,t){var i=yl(e),n=i.s,s=Ar(t),a={r:s.r-n.r,c:s.c-n.c};return iv(r,a)}function dS(r){return r.length!=1}function am(r){return r.replace(/_xlfn\./g,"")}function Ai(r){r.l+=1}function ma(r,e){var t=r.read_shift(e==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function rv(r,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return nv(r);t.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=ma(r,2),l=ma(r,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function nv(r){var e=ma(r,2),t=ma(r,2),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function pS(r,e,t){if(t.biff<8)return nv(r);var i=r.read_shift(t.biff==12?4:2),n=r.read_shift(t.biff==12?4:2),s=ma(r,2),a=ma(r,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function sv(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return gS(r);var i=r.read_shift(t&&t.biff==12?4:2),n=ma(r,2);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function gS(r){var e=ma(r,2),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function _S(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function mS(r,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return xS(r);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:l}}function xS(r){var e=r.read_shift(2),t=r.read_shift(1),i=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),n==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:n,rRel:i}}function vS(r,e,t){var i=(r[r.l++]&96)>>5,n=rv(r,t.biff>=2&&t.biff<=5?6:8,t);return[i,n]}function yS(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=rv(r,s,t);return[i,n,a]}function bS(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function wS(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function TS(r,e,t){var i=(r[r.l++]&96)>>5,n=pS(r,e-1,t);return[i,n]}function kS(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[i]}function om(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function PS(r,e,t){r.l+=2;for(var i=r.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(t&&t.biff==2?1:2));return n}function ES(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function AS(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function CS(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function SS(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[i]}function av(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function DS(r){return r.read_shift(2),av(r)}function LS(r){return r.read_shift(2),av(r)}function OS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=sv(r,0,t);return[i,n]}function MS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=mS(r,0,t);return[i,n]}function FS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=sv(r,0,t);return[i,n,s]}function RS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(t&&t.biff<=3?1:2);return[I4[n],uv[n],i]}function IS(r,e,t){var i=r[r.l++],n=r.read_shift(1),s=t&&t.biff<=3?[i==88?-1:0,r.read_shift(1)]:BS(r);return[n,(s[0]===0?uv:R4)[s[1]]]}function BS(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function NS(r,e,t){r.l+=t&&t.biff==2?3:4}function HS(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function zS(r){return r.l++,vo[r.read_shift(1)]}function US(r){return r.l++,r.read_shift(2)}function WS(r){return r.l++,r.read_shift(1)!==0}function jS(r){return r.l++,or(r)}function XS(r,e,t){return r.l++,$u(r,e-1,t)}function GS(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=vi(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=vo[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=or(r);break;case 2:t[1]=yo(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function YS(r,e,t){for(var i=r.read_shift(t.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((t.biff==12?xo:Uc)(r));return n}function VS(r,e,t){var i=0,n=0;t.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var l=0;l!=n;++l)a[s][l]=GS(r,t.biff);return a}function ZS(r,e,t){var i=r.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=r.read_shift(n);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function KS(r,e,t){if(t.biff==5)return $S(r);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function $S(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[e,t,i]}function qS(r,e,t){var i=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function JS(r,e,t){var i=r.read_shift(1)>>>5&3,n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function QS(r,e,t){var i=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[i]}function e4(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var t4=hr,i4=hr,r4=hr;function Ju(r,e,t){return r.l+=2,[_S(r)]}function Gd(r){return r.l+=6,[]}var n4=Ju,s4=Gd,a4=Gd,o4=Ju;function ov(r){return r.l+=2,[Si(r),r.read_shift(2)&1]}var l4=Ju,u4=ov,h4=Gd,c4=Ju,f4=Ju,d4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function p4(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=d4[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:i,c:n,C:s}}function g4(r){return r.l+=2,[r.read_shift(4)]}function _4(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function m4(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function x4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function v4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function y4(r){return r.l+=4,[0,0]}var lm={1:{n:"PtgExp",f:HS},2:{n:"PtgTbl",f:r4},3:{n:"PtgAdd",f:Ai},4:{n:"PtgSub",f:Ai},5:{n:"PtgMul",f:Ai},6:{n:"PtgDiv",f:Ai},7:{n:"PtgPower",f:Ai},8:{n:"PtgConcat",f:Ai},9:{n:"PtgLt",f:Ai},10:{n:"PtgLe",f:Ai},11:{n:"PtgEq",f:Ai},12:{n:"PtgGe",f:Ai},13:{n:"PtgGt",f:Ai},14:{n:"PtgNe",f:Ai},15:{n:"PtgIsect",f:Ai},16:{n:"PtgUnion",f:Ai},17:{n:"PtgRange",f:Ai},18:{n:"PtgUplus",f:Ai},19:{n:"PtgUminus",f:Ai},20:{n:"PtgPercent",f:Ai},21:{n:"PtgParen",f:Ai},22:{n:"PtgMissArg",f:Ai},23:{n:"PtgStr",f:XS},26:{n:"PtgSheet",f:_4},27:{n:"PtgEndSheet",f:m4},28:{n:"PtgErr",f:zS},29:{n:"PtgBool",f:WS},30:{n:"PtgInt",f:US},31:{n:"PtgNum",f:jS},32:{n:"PtgArray",f:kS},33:{n:"PtgFunc",f:RS},34:{n:"PtgFuncVar",f:IS},35:{n:"PtgName",f:ZS},36:{n:"PtgRef",f:OS},37:{n:"PtgArea",f:vS},38:{n:"PtgMemArea",f:qS},39:{n:"PtgMemErr",f:t4},40:{n:"PtgMemNoMem",f:i4},41:{n:"PtgMemFunc",f:JS},42:{n:"PtgRefErr",f:QS},43:{n:"PtgAreaErr",f:bS},44:{n:"PtgRefN",f:MS},45:{n:"PtgAreaN",f:TS},46:{n:"PtgMemAreaN",f:x4},47:{n:"PtgMemNoMemN",f:v4},57:{n:"PtgNameX",f:KS},58:{n:"PtgRef3d",f:FS},59:{n:"PtgArea3d",f:yS},60:{n:"PtgRefErr3d",f:e4},61:{n:"PtgAreaErr3d",f:wS},255:{}},b4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},w4={1:{n:"PtgElfLel",f:ov},2:{n:"PtgElfRw",f:c4},3:{n:"PtgElfCol",f:n4},6:{n:"PtgElfRwV",f:f4},7:{n:"PtgElfColV",f:o4},10:{n:"PtgElfRadical",f:l4},11:{n:"PtgElfRadicalS",f:h4},13:{n:"PtgElfColS",f:s4},15:{n:"PtgElfColSV",f:a4},16:{n:"PtgElfRadicalLel",f:u4},25:{n:"PtgList",f:p4},29:{n:"PtgSxName",f:g4},255:{}},T4={0:{n:"PtgAttrNoop",f:y4},1:{n:"PtgAttrSemi",f:SS},2:{n:"PtgAttrIf",f:AS},4:{n:"PtgAttrChoose",f:PS},8:{n:"PtgAttrGoto",f:ES},16:{n:"PtgAttrSum",f:NS},32:{n:"PtgAttrBaxcel",f:om},33:{n:"PtgAttrBaxcel",f:om},64:{n:"PtgAttrSpace",f:DS},65:{n:"PtgAttrSpaceSemi",f:LS},128:{n:"PtgAttrIfError",f:CS},255:{}};function Qu(r,e,t,i){if(i.biff<8)return hr(r,e);for(var n=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=VS(r,0,i),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=YS(r,t[a][1],i),s.push(t[a][2]);break;case"PtgExp":i&&i.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=n-r.l,e!==0&&s.push(hr(r,e)),s}function eh(r,e,t){for(var i=r.l+e,n,s,a=[];i!=r.l;)e=i-r.l,s=r[r.l],n=lm[s]||lm[b4[s]],(s===24||s===25)&&(n=(s===24?w4:T4)[r[r.l+1]]),!n||!n.f?hr(r,e):a.push([n.n,n.f(r,e,t)]);return a}function k4(r){for(var e=[],t=0;t<r.length;++t){for(var i=r[t],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var P4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function E4(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function lv(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!i)return"SH33TJSERR1";var n="";if(t.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function um(r,e,t){var i=lv(r,e,t);return i=="#REF"?i:E4(i,t)}function sr(r,e,t,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},l=[],h,c,p,g=0,m=0,_,b="";if(!r[0]||!r[0][0])return"";for(var x=-1,w="",P=0,E=r[0].length;P<E;++P){var k=r[0][P];switch(k[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=l.pop(),c=l.pop(),x>=0){switch(r[0][x][1][0]){case 0:w=ci(" ",r[0][x][1][1]);break;case 1:w=ci("\r",r[0][x][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][x][1][0])}c=c+w,x=-1}l.push(c+P4[k[0]]+h);break;case"PtgIsect":h=l.pop(),c=l.pop(),l.push(c+" "+h);break;case"PtgUnion":h=l.pop(),c=l.pop(),l.push(c+","+h);break;case"PtgRange":h=l.pop(),c=l.pop(),l.push(c+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=hu(k[1][1],a,n),l.push(cu(p,s));break;case"PtgRefN":p=t?hu(k[1][1],t,n):k[1][1],l.push(cu(p,s));break;case"PtgRef3d":g=k[1][1],p=hu(k[1][2],a,n),b=um(i,g,n),l.push(b+"!"+cu(p,s));break;case"PtgFunc":case"PtgFuncVar":var C=k[1][0],O=k[1][1];C||(C=0),C&=127;var F=C==0?[]:l.slice(-C);l.length-=C,O==="User"&&(O=F.shift()),l.push(O+"("+F.join(",")+")");break;case"PtgBool":l.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(k[1]);break;case"PtgNum":l.push(String(k[1]));break;case"PtgStr":l.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(k[1]);break;case"PtgAreaN":_=j_(k[1][1],t?{s:t}:a,n),l.push(If(_,n));break;case"PtgArea":_=j_(k[1][1],a,n),l.push(If(_,n));break;case"PtgArea3d":g=k[1][1],_=k[1][2],b=um(i,g,n),l.push(b+"!"+If(_,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=k[1][2];var D=(i.names||[])[m-1]||(i[0]||[])[m],N=D?D.Name:"SH33TJSNAME"+String(m);N&&N.slice(0,6)=="_xlfn."&&!n.xlfn&&(N=N.slice(6)),l.push(N);break;case"PtgNameX":var X=k[1][1];m=k[1][2];var z;if(n.biff<=5)X<0&&(X=-X),i[X]&&(z=i[X][m]);else{var U="";if(((i[X]||[])[0]||[])[0]==14849||(((i[X]||[])[0]||[])[0]==1025?i[X][m]&&i[X][m].itab>0&&(U=i.SheetNames[i[X][m].itab-1]+"!"):U=i.SheetNames[m-1]+"!"),i[X]&&i[X][m])U+=i[X][m].Name;else if(i[0]&&i[0][m])U+=i[0][m].Name;else{var j=(lv(i,X,n)||"").split(";;");j[m-1]?U=j[m-1]:U+="SH33TJSERRX"}l.push(U);break}z||(z={Name:"SH33TJSERRY"}),l.push(z.Name);break;case"PtgParen":var q="(",pe=")";if(x>=0){switch(w="",r[0][x][1][0]){case 2:q=ci(" ",r[0][x][1][1])+q;break;case 3:q=ci("\r",r[0][x][1][1])+q;break;case 4:pe=ci(" ",r[0][x][1][1])+pe;break;case 5:pe=ci("\r",r[0][x][1][1])+pe;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][x][1][0])}x=-1}l.push(q+l.pop()+pe);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":p={c:k[1][1],r:k[1][0]};var fe={c:t.c,r:t.r};if(i.sharedf[lt(p)]){var Ee=i.sharedf[lt(p)];l.push(sr(Ee,a,fe,i,n))}else{var de=!1;for(h=0;h!=i.arrayf.length;++h)if(c=i.arrayf[h],!(p.c<c[0].s.c||p.c>c[0].e.c)&&!(p.r<c[0].s.r||p.r>c[0].e.r)){l.push(sr(c[1],a,fe,i,n)),de=!0;break}de||l.push(k[1])}break;case"PtgArray":l.push("{"+k4(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=P;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var De=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&De.indexOf(r[0][P][0])==-1){k=r[0][x];var ee=!0;switch(k[1][0]){case 4:ee=!1;case 0:w=ci(" ",k[1][1]);break;case 5:ee=!1;case 1:w=ci("\r",k[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}l.push((ee?w:"")+l.pop()+(ee?"":w)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function A4(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],hr(r,e-2)];var l=eh(r,a,t);return e!==a+n&&(s=Qu(r,e-a-n,l,t)),r.l=i,[l,s]}function C4(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],hr(r,e-2)];var l=eh(r,a,t);return e!==a+n&&(s=Qu(r,e-a-n,l,t)),r.l=i,[l,s]}function S4(r,e,t,i){var n=r.l+e,s=eh(r,i,t),a;return n!==r.l&&(a=Qu(r,n-r.l,s,t)),[s,a]}function D4(r,e,t){var i=r.l+e,n,s=r.read_shift(2),a=eh(r,s,t);return s==65535?[[],hr(r,e-2)]:(e!==s+2&&(n=Qu(r,i-s-2,a,t)),[a,n])}function L4(r){var e;if(Rs(r,r.l+6)!==65535)return[or(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function Hf(r,e,t){var i=r.l+e,n=ps(r);t.biff==2&&++r.l;var s=L4(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var l=C4(r,i-r.l,t);return{cell:n,val:s[0],formula:l,shared:a>>3&1,tt:s[1]}}function Wc(r,e,t){var i=r.read_shift(4),n=eh(r,i,t),s=r.read_shift(4),a=s>0?Qu(r,s,n,t):null;return[n,a]}var O4=Wc,jc=Wc,M4=Wc,F4=Wc,R4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},uv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},I4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hm(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function zf(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var gu={},al={};function _u(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function hv(r,e,t,i,n,s){try{i.cellNF&&(r.z=dt[e])}catch(l){if(i.WTF)throw l}if(!(r.t==="z"&&!i.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Zi(r.v)),(!i||i.cellText!==!1)&&r.t!=="z")try{if(dt[e]==null&&eo(Nk[e]||"General",e),r.t==="e")r.w=r.w||vo[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=bu(r.v);else if(r.t==="d"){var a=Dr(r.v);(a|0)===a?r.w=a.toString(10):r.w=bu(a)}else{if(r.v===void 0)return"";r.w=ro(r.v,al)}else r.t==="d"?r.w=wn(e,Dr(r.v),al):r.w=wn(e,r.v,al)}catch(l){if(i.WTF)throw l}if(i.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=vc(n.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),i.WTF&&(r.s.fgColor.raw_rgb=n.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=vc(n.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),i.WTF&&(r.s.bgColor.raw_rgb=n.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(l){if(i.WTF&&s.Fills)throw l}}}function B4(r,e){var t=di(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=Lt(t))}var N4=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,H4=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,z4=/<(?:\w:)?hyperlink [^>]*>/mg,U4=/"(\w*:\w*)"/,W4=/<(?:\w:)?col\b[^>]*[\/]?>/g,j4=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,X4=/<(?:\w:)?pageMargins[^>]*\/>/g,cv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,G4=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Y4=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function V4(r,e,t,i,n,s,a){if(!r)return r;i||(i={"!id":{}});var l=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",p="",g=r.match(H4);g?(c=r.slice(0,g.index),p=r.slice(g.index+g[0].length)):c=p=r;var m=c.match(cv);m?Yd(m[0],l,n,t):(m=c.match(G4))&&Z4(m[0],m[1]||"",l,n,t);var _=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=c.slice(_,_+50).match(U4);b&&B4(l,b[1])}var x=c.match(Y4);x&&x[1]&&eD(x[1],n);var w=[];if(e.cellStyles){var P=c.match(W4);P&&q4(w,P)}g&&tD(g[1],l,e,h,s,a);var E=p.match(j4);E&&(l["!autofilter"]=J4(E[0]));var k=[],C=p.match(N4);if(C)for(_=0;_!=C.length;++_)k[_]=di(C[_].slice(C[_].indexOf('"')+1));var O=p.match(z4);O&&K4(l,O,i);var F=p.match(X4);if(F&&(l["!margins"]=$4(st(F[0]))),!l["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(l["!ref"]=Lt(h)),e.sheetRows>0&&l["!ref"]){var D=di(l["!ref"]);e.sheetRows<=+D.e.r&&(D.e.r=e.sheetRows-1,D.e.r>h.e.r&&(D.e.r=h.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>h.e.c&&(D.e.c=h.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Lt(D))}return w.length>0&&(l["!cols"]=w),k.length>0&&(l["!merges"]=k),l}function Yd(r,e,t,i){var n=st(r);t.Sheets[i]||(t.Sheets[i]={}),n.codeName&&(t.Sheets[i].CodeName=Mt(qt(n.codeName)))}function Z4(r,e,t,i,n){Yd(r.slice(0,r.indexOf(">")),t,i,n)}function K4(r,e,t){for(var i=Array.isArray(r),n=0;n!=e.length;++n){var s=st(qt(e[n]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Mt(s.location))):(s.Target="#"+Mt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=di(s.ref),h=l.s.r;h<=l.e.r;++h)for(var c=l.s.c;c<=l.e.c;++c){var p=lt({c,r:h});i?(r[h]||(r[h]=[]),r[h][c]||(r[h][c]={t:"z",v:void 0}),r[h][c].l=s):(r[p]||(r[p]={t:"z",v:void 0}),r[p].l=s)}}}function $4(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function q4(r,e){for(var t=!1,i=0;i!=e.length;++i){var n=st(e[i],!0);n.hidden&&(n.hidden=ti(n.hidden));var s=parseInt(n.min,10)-1,a=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,Xd(n.width)),hl(n);s<=a;)r[s++]=qi(n)}}function J4(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}var Q4=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eD(r,e){e.Views||(e.Views=[{}]),(r.match(Q4)||[]).forEach(function(t,i){var n=st(t);e.Views[i]||(e.Views[i]={}),+n.zoomScale&&(e.Views[i].zoom=+n.zoomScale),ti(n.rightToLeft)&&(e.Views[i].RTL=!0)})}var tD=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=wu("v"),a=wu("f");return function(h,c,p,g,m,_){for(var b=0,x="",w=[],P=[],E=0,k=0,C=0,O="",F,D,N=0,X=0,z,U,j=0,q=0,pe=Array.isArray(_.CellXf),fe,Ee=[],de=[],De=Array.isArray(c),ee=[],Fe={},se=!1,R=!!p.sheetStubs,J=h.split(e),Y=0,ie=J.length;Y!=ie;++Y){x=J[Y].trim();var he=x.length;if(he!==0){var Pe=0;e:for(b=0;b<he;++b)switch(x[b]){case">":if(x[b-1]!="/"){++b;break e}if(p&&p.cellStyles){if(D=st(x.slice(Pe,b),!0),N=D.r!=null?parseInt(D.r,10):N+1,X=-1,p.sheetRows&&p.sheetRows<N)continue;Fe={},se=!1,D.ht&&(se=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=Eu(Fe.hpt)),D.hidden=="1"&&(se=!0,Fe.hidden=!0),D.outlineLevel!=null&&(se=!0,Fe.level=+D.outlineLevel),se&&(ee[N-1]=Fe)}break;case"<":Pe=b;break}if(Pe>=b)break;if(D=st(x.slice(Pe,b),!0),N=D.r!=null?parseInt(D.r,10):N+1,X=-1,!(p.sheetRows&&p.sheetRows<N)){g.s.r>N-1&&(g.s.r=N-1),g.e.r<N-1&&(g.e.r=N-1),p&&p.cellStyles&&(Fe={},se=!1,D.ht&&(se=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=Eu(Fe.hpt)),D.hidden=="1"&&(se=!0,Fe.hidden=!0),D.outlineLevel!=null&&(se=!0,Fe.level=+D.outlineLevel),se&&(ee[N-1]=Fe)),w=x.slice(b).split(r);for(var we=0;we!=w.length&&w[we].trim().charAt(0)=="<";++we);for(w=w.slice(we),b=0;b!=w.length;++b)if(x=w[b].trim(),x.length!==0){if(P=x.match(t),E=b,k=0,C=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,P!=null&&P.length===2){for(E=0,O=P[1],k=0;k!=O.length&&!((C=O.charCodeAt(k)-64)<1||C>26);++k)E=26*E+C;--E,X=E}else++X;for(k=0;k!=x.length&&x.charCodeAt(k)!==62;++k);if(++k,D=st(x.slice(0,k),!0),D.r||(D.r=lt({r:N-1,c:X})),O=x.slice(k),F={t:""},(P=O.match(s))!=null&&P[1]!==""&&(F.v=Mt(P[1])),p.cellFormula){if((P=O.match(a))!=null&&P[1]!==""){if(F.f=Mt(qt(P[1])).replace(/\r\n/g,`
`),p.xlfn||(F.f=am(F.f)),P[0].indexOf('t="array"')>-1)F.F=(O.match(n)||[])[1],F.F.indexOf(":")>-1&&Ee.push([di(F.F),F.F]);else if(P[0].indexOf('t="shared"')>-1){U=st(P[0]);var Oe=Mt(qt(P[1]));p.xlfn||(Oe=am(Oe)),de[parseInt(U.si,10)]=[U,Oe,D.r]}}else(P=O.match(/<f[^>]*\/>/))&&(U=st(P[0]),de[U.si]&&(F.f=fS(de[U.si][1],de[U.si][2],D.r)));var Le=Ar(D.r);for(k=0;k<Ee.length;++k)Le.r>=Ee[k][0].s.r&&Le.r<=Ee[k][0].e.r&&Le.c>=Ee[k][0].s.c&&Le.c<=Ee[k][0].e.c&&(F.F=Ee[k][1])}if(D.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(R)F.t="z";else continue;else F.t=D.t||"n";switch(g.s.c>X&&(g.s.c=X),g.e.c<X&&(g.e.c=X),F.t){case"n":if(F.v==""||F.v==null){if(!R)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!R)continue;F.t="z"}else z=gu[parseInt(F.v,10)],F.v=z.t,F.r=z.r,p.cellHTML&&(F.h=z.h);break;case"str":F.t="s",F.v=F.v!=null?qt(F.v):"",p.cellHTML&&(F.h=Md(F.v));break;case"inlineStr":P=O.match(i),F.t="s",P!=null&&(z=jd(P[1]))?(F.v=z.t,p.cellHTML&&(F.h=z.h)):F.v="";break;case"b":F.v=ti(F.v);break;case"d":p.cellDates?F.v=Zi(F.v,1):(F.v=Dr(Zi(F.v,1)),F.t="n");break;case"e":(!p||p.cellText!==!1)&&(F.w=F.v),F.v=Ox[F.v];break}if(j=q=0,fe=null,pe&&D.s!==void 0&&(fe=_.CellXf[D.s],fe!=null&&(fe.numFmtId!=null&&(j=fe.numFmtId),p.cellStyles&&fe.fillId!=null&&(q=fe.fillId))),hv(F,j,q,p,m,_),p.cellDates&&pe&&F.t=="n"&&vl(dt[j])&&(F.t="d",F.v=zc(F.v)),D.cm&&p.xlmeta){var it=(p.xlmeta.Cell||[])[+D.cm-1];it&&it.type=="XLDAPR"&&(F.D=!0)}if(De){var te=Ar(D.r);c[te.r]||(c[te.r]=[]),c[te.r][te.c]=F}else c[D.r]=F}}}}ee.length>0&&(c["!rows"]=ee)}}();function iD(r,e){var t={},i=r.l+e;t.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}var rD=xo;function nD(){}function sD(r,e){var t={},i=r[r.l];return++r.l,t.above=!(i&64),t.left=!(i&128),r.l+=18,t.name=AP(r),t}function aD(r){var e=kn(r);return[e]}function oD(r){var e=mo(r);return[e]}function lD(r){var e=kn(r),t=r.read_shift(1);return[e,t,"b"]}function uD(r){var e=mo(r),t=r.read_shift(1);return[e,t,"b"]}function hD(r){var e=kn(r),t=r.read_shift(1);return[e,t,"e"]}function cD(r){var e=mo(r),t=r.read_shift(1);return[e,t,"e"]}function fD(r){var e=kn(r),t=r.read_shift(4);return[e,t,"s"]}function dD(r){var e=mo(r),t=r.read_shift(4);return[e,t,"s"]}function pD(r){var e=kn(r),t=or(r);return[e,t,"n"]}function fv(r){var e=mo(r),t=or(r);return[e,t,"n"]}function gD(r){var e=kn(r),t=zd(r);return[e,t,"n"]}function _D(r){var e=mo(r),t=zd(r);return[e,t,"n"]}function mD(r){var e=kn(r),t=Nd(r);return[e,t,"is"]}function xD(r){var e=kn(r),t=ur(r);return[e,t,"str"]}function vD(r){var e=mo(r),t=ur(r);return[e,t,"str"]}function yD(r,e,t){var i=r.l+e,n=kn(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(t.cellFormula){r.l+=2;var l=jc(r,i-r.l,t);a[3]=sr(l,null,n,t.supbooks,t)}else r.l=i;return a}function bD(r,e,t){var i=r.l+e,n=kn(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(t.cellFormula){r.l+=2;var l=jc(r,i-r.l,t);a[3]=sr(l,null,n,t.supbooks,t)}else r.l=i;return a}function wD(r,e,t){var i=r.l+e,n=kn(r);n.r=t["!row"];var s=or(r),a=[n,s,"n"];if(t.cellFormula){r.l+=2;var l=jc(r,i-r.l,t);a[3]=sr(l,null,n,t.supbooks,t)}else r.l=i;return a}function TD(r,e,t){var i=r.l+e,n=kn(r);n.r=t["!row"];var s=ur(r),a=[n,s,"str"];if(t.cellFormula){r.l+=2;var l=jc(r,i-r.l,t);a[3]=sr(l,null,n,t.supbooks,t)}else r.l=i;return a}var kD=xo;function PD(r,e){var t=r.l+e,i=xo(r),n=Hd(r),s=ur(r),a=ur(r),l=ur(r);r.l=t;var h={rfx:i,relId:n,loc:s,display:l};return a&&(h.Tooltip=a),h}function ED(){}function AD(r,e,t){var i=r.l+e,n=Sx(r),s=r.read_shift(1),a=[n];if(a[2]=s,t.cellFormula){var l=O4(r,i-r.l,t);a[1]=l}else r.l=i;return a}function CD(r,e,t){var i=r.l+e,n=xo(r),s=[n];if(t.cellFormula){var a=F4(r,i-r.l,t);s[1]=a,r.l=i}else r.l=i;return s}var SD=["left","right","top","bottom","header","footer"];function DD(r){var e={};return SD.forEach(function(t){e[t]=or(r)}),e}function LD(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function OD(){}function MD(){}function FD(r,e,t,i,n,s,a){if(!r)return r;var l=e||{};i||(i={"!id":{}});var h=l.dense?[]:{},c,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,m=!1,_,b,x,w,P,E,k,C,O,F=[];l.biff=12,l["!row"]=0;var D=0,N=!1,X=[],z={},U=l.supbooks||n.supbooks||[[]];if(U.sharedf=z,U.arrayf=X,U.SheetNames=n.SheetNames||n.Sheets.map(function(De){return De.name}),!l.supbooks&&(l.supbooks=U,n.Names))for(var j=0;j<n.Names.length;++j)U[0][j+1]=n.Names[j];var q=[],pe=[],fe=!1;wc[16]={n:"BrtShortReal",f:fv};var Ee;if(Xs(r,function(ee,Fe,se){if(!m)switch(se){case 148:c=ee;break;case 0:_=ee,l.sheetRows&&l.sheetRows<=_.r&&(m=!0),C=Ji(w=_.r),l["!row"]=_.r,(ee.hidden||ee.hpt||ee.level!=null)&&(ee.hpt&&(ee.hpx=Eu(ee.hpt)),pe[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:ee[2]},ee[2]){case"n":b.v=ee[1];break;case"s":k=gu[ee[1]],b.v=k.t,b.r=k.r;break;case"b":b.v=!!ee[1];break;case"e":b.v=ee[1],l.cellText!==!1&&(b.w=vo[b.v]);break;case"str":b.t="s",b.v=ee[1];break;case"is":b.t="s",b.v=ee[1].t;break}if((x=a.CellXf[ee[0].iStyleRef])&&hv(b,x.numFmtId,null,l,s,a),P=ee[0].c==-1?P+1:ee[0].c,l.dense?(h[w]||(h[w]=[]),h[w][P]=b):h[zi(P)+C]=b,l.cellFormula){for(N=!1,D=0;D<X.length;++D){var R=X[D];_.r>=R[0].s.r&&_.r<=R[0].e.r&&P>=R[0].s.c&&P<=R[0].e.c&&(b.F=Lt(R[0]),N=!0)}!N&&ee.length>3&&(b.f=ee[3])}if(p.s.r>_.r&&(p.s.r=_.r),p.s.c>P&&(p.s.c=P),p.e.r<_.r&&(p.e.r=_.r),p.e.c<P&&(p.e.c=P),l.cellDates&&x&&b.t=="n"&&vl(dt[x.numFmtId])){var J=Qa(b.v);J&&(b.t="d",b.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Ee&&(Ee.type=="XLDAPR"&&(b.D=!0),Ee=void 0);break;case 1:case 12:if(!l.sheetStubs||g)break;b={t:"z",v:void 0},P=ee[0].c==-1?P+1:ee[0].c,l.dense?(h[w]||(h[w]=[]),h[w][P]=b):h[zi(P)+C]=b,p.s.r>_.r&&(p.s.r=_.r),p.s.c>P&&(p.s.c=P),p.e.r<_.r&&(p.e.r=_.r),p.e.c<P&&(p.e.c=P),Ee&&(Ee.type=="XLDAPR"&&(b.D=!0),Ee=void 0);break;case 176:F.push(ee);break;case 49:Ee=((l.xlmeta||{}).Cell||[])[ee-1];break;case 494:var Y=i["!id"][ee.relId];for(Y?(ee.Target=Y.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=Y):ee.relId==""&&(ee.Target="#"+ee.loc),w=ee.rfx.s.r;w<=ee.rfx.e.r;++w)for(P=ee.rfx.s.c;P<=ee.rfx.e.c;++P)l.dense?(h[w]||(h[w]=[]),h[w][P]||(h[w][P]={t:"z",v:void 0}),h[w][P].l=ee):(E=lt({c:P,r:w}),h[E]||(h[E]={t:"z",v:void 0}),h[E].l=ee);break;case 426:if(!l.cellFormula)break;X.push(ee),O=l.dense?h[w][P]:h[zi(P)+C],O.f=sr(ee[1],p,{r:_.r,c:P},U,l),O.F=Lt(ee[0]);break;case 427:if(!l.cellFormula)break;z[lt(ee[0].s)]=ee[1],O=l.dense?h[w][P]:h[zi(P)+C],O.f=sr(ee[1],p,{r:_.r,c:P},U,l);break;case 60:if(!l.cellStyles)break;for(;ee.e>=ee.s;)q[ee.e--]={width:ee.w/256,hidden:!!(ee.flags&1),level:ee.level},fe||(fe=!0,Xd(ee.w/256)),hl(q[ee.e+1]);break;case 161:h["!autofilter"]={ref:Lt(ee)};break;case 476:h["!margins"]=ee;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),ee.name&&(n.Sheets[t].CodeName=ee.name),(ee.above||ee.left)&&(h["!outline"]={above:ee.above,left:ee.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),ee.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Fe.T){if(!g||l.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},l),delete l.supbooks,delete l["!row"],!h["!ref"]&&(p.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(h["!ref"]=Lt(c||p)),l.sheetRows&&h["!ref"]){var de=di(h["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>p.e.r&&(de.e.r=p.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>p.e.c&&(de.e.c=p.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Lt(de))}return F.length>0&&(h["!merges"]=F),q.length>0&&(h["!cols"]=q),pe.length>0&&(h["!rows"]=pe),h}function RD(r){var e=[],t=r.match(/^<c:numCache>/),i;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var n=Mt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){i=s.replace(/<.*?>/g,"")}),[e,n,i]}function ID(r,e,t,i,n,s){var a=s||{"!type":"chart"};if(!r)return s;var l=0,h=0,c="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var m=RD(g);p.s.r=p.s.c=0,p.e.c=l,c=zi(l),m[0].forEach(function(_,b){a[c+Ji(b)]={t:"n",v:_,z:m[1]},h=b}),p.e.r<h&&(p.e.r=h),++l}),l>0&&(a["!ref"]=Lt(p)),a}function BD(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,l=r.match(cv);return l&&Yd(l[0],s,n,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}function ND(r,e){r.l+=10;var t=ur(r);return{name:t}}function HD(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Xs(r,function(h,c,p){switch(p){case 550:s["!rel"]=h;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),h.name&&(n.Sheets[t].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}var dv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],UD=[],WD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function cm(r,e){for(var t=0;t!=r.length;++t)for(var i=r[t],n=0;n!=e.length;++n){var s=e[n];if(i[s[0]]==null)i[s[0]]=s[1];else switch(s[2]){case"bool":typeof i[s[0]]=="string"&&(i[s[0]]=ti(i[s[0]]));break;case"int":typeof i[s[0]]=="string"&&(i[s[0]]=parseInt(i[s[0]],10));break}}}function fm(r,e){for(var t=0;t!=e.length;++t){var i=e[t];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=ti(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function pv(r){fm(r.WBProps,dv),fm(r.CalcPr,WD),cm(r.WBView,zD),cm(r.Sheets,UD),al.date1904=ti(r.WBProps.date1904)}var jD="][*?/\\".split("");function XD(r,e){if(r.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return jD.forEach(function(i){if(r.indexOf(i)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var GD=/<\w+:workbook/;function YD(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,n="xmlns",s={},a=0;if(r.replace(fr,function(h,c){var p=st(h);switch(ds(p[0])){case"<?xml":break;case"<workbook":h.match(GD)&&(n="xmlns"+h.match(/<(\w+):/)[1]),t.xmlns=p[n];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dv.forEach(function(g){if(p[g[0]]!=null)switch(g[2]){case"bool":t.WBProps[g[0]]=ti(p[g[0]]);break;case"int":t.WBProps[g[0]]=parseInt(p[g[0]],10);break;default:t.WBProps[g[0]]=p[g[0]]}}),p.codeName&&(t.WBProps.CodeName=qt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Mt(qt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":s={},s.Name=qt(p.name),p.comment&&(s.Comment=p.comment),p.localSheetId&&(s.Sheet=+p.localSheetId),ti(p.hidden||"0")&&(s.Hidden=!0),a=c+h.length;break;case"</definedName>":s.Ref=Mt(qt(r.slice(a,c))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),hP.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return pv(t),t}function VD(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=td(r),t.name=ur(r),t}function ZD(r,e){var t={},i=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var n=e>8?ur(r):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function KD(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function $D(r,e,t){var i=r.l+e;r.l+=4,r.l+=1;var n=r.read_shift(4),s=CP(r),a=M4(r,0,t),l=Hd(r);r.l=i;var h={Name:s,Ptg:a};return n<268435455&&(h.Sheet=n),l&&(h.Comment=l),h}function qD(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],n=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],wc[16]={n:"BrtFRTArchID$",f:KD},Xs(r,function(h,c,p){switch(p){case 156:a.SheetNames.push(h.name),t.Sheets.push(h);break;case 153:t.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=sr(h.Ptg,null,null,a,e),delete e.SID,delete h.Ptg,s.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([p,h]):a[0]=[p,h],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(h),a.XTI=a.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(p),n=!0;break;case 36:i.pop(),n=!1;break;case 37:i.push(p),n=!0;break;case 38:i.pop(),n=!1;break;case 16:break;default:if(!c.T){if(!n||e.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),pv(t),t.Names=s,t.supbooks=a,t}function JD(r,e,t){return e.slice(-4)===".bin"?qD(r,t):YD(r,t)}function QD(r,e,t,i,n,s,a,l){return e.slice(-4)===".bin"?FD(r,i,t,n,s,a,l):V4(r,i,t,n,s,a,l)}function eL(r,e,t,i,n,s,a,l){return e.slice(-4)===".bin"?HD(r,i,t,n,s):BD(r,i,t,n,s)}function tL(r,e,t,i,n,s,a,l){return e.slice(-4)===".bin"?uS():hS()}function iL(r,e,t,i,n,s,a,l){return e.slice(-4)===".bin"?oS():lS()}function rL(r,e,t,i){return e.slice(-4)===".bin"?kC(r,t,i):xC(r,t,i)}function nL(r,e,t){return ev(r,t)}function sL(r,e,t){return e.slice(-4)===".bin"?zA(r,t):NA(r,t)}function aL(r,e,t){return e.slice(-4)===".bin"?nS(r,t):QC(r,t)}function oL(r,e,t){return e.slice(-4)===".bin"?$C(r):ZC(r)}function lL(r,e,t,i){return t.slice(-4)===".bin"?qC(r,e,t,i):void 0}function uL(r,e,t){return e.slice(-4)===".bin"?YC(r,e,t):VC(r,e,t)}var gv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,_v=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bn(r,e){var t=r.split(/\s+/),i=[];if(e||(i[0]=t[0]),t.length===1)return i;var n=r.match(gv),s,a,l,h;if(n)for(h=0;h!=n.length;++h)s=n[h].match(_v),(a=s[1].indexOf(":"))===-1?i[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(a+1),i[l]=s[2].slice(1,s[2].length-1));return i}function hL(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var i=r.match(gv),n,s,a,l;if(i)for(l=0;l!=i.length;++l)n=i[l].match(_v),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(s+1),t[a]=n[2].slice(1,n[2].length-1));return t}var mu;function cL(r,e){var t=mu[r]||Mt(r);return t==="General"?ro(e):wn(t,e)}function fL(r,e,t,i){var n=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=ti(i);break;case"i2":case"int":n=parseInt(i,10);break;case"r4":case"float":n=parseFloat(i);break;case"date":case"dateTime.tz":n=Zi(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Mt(e)]=n}function dL(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||vo[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=bu(r.v):r.w=ro(r.v):r.w=cL(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var i=mu[e]||e||"General";if(t.cellNF&&(r.z=i),t.cellDates&&r.t=="n"&&vl(i)){var n=Qa(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function pL(r,e,t){if(t.cellStyles&&e.Interior){var i=e.Interior;i.Pattern&&(i.patternType=fC[i.Pattern]||i.Pattern)}r[e.ID]=e}function gL(r,e,t,i,n,s,a,l,h,c){var p="General",g=i.StyleID,m={};c=c||{};var _=[],b=0;for(g===void 0&&l&&(g=l.StyleID),g===void 0&&a&&(g=a.StyleID);s[g]!==void 0&&(s[g].nf&&(p=s[g].nf),s[g].Interior&&_.push(s[g].Interior),!!s[g].Parent);)g=s[g].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=ti(r);break;case"String":i.t="s",i.r=F_(Mt(r)),i.v=r.indexOf("<")>-1?Mt(e||r).replace(/<.*?>/g,""):i.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),i.v=(Zi(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),i.v!==i.v?i.v=Mt(r):i.v<60&&(i.v=i.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+r),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Ox[r],c.cellText!==!1&&(i.w=r);break;default:r==""&&e==""?i.t="z":(i.t="s",i.v=F_(e||r));break}if(dL(i,p,c),c.cellFormula!==!1)if(i.Formula){var x=Mt(i.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),i.f=sl(x,n),delete i.Formula,i.ArrayRange=="RC"?i.F=sl("RC:RC",n):i.ArrayRange&&(i.F=sl(i.ArrayRange,n),h.push([di(i.F),i.F]))}else for(b=0;b<h.length;++b)n.r>=h[b][0].s.r&&n.r<=h[b][0].e.r&&n.c>=h[b][0].s.c&&n.c<=h[b][0].e.c&&(i.F=h[b][1]);c.cellStyles&&(_.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),i.s=m),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function _L(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Uf(r,e){var t=e||{};rx();var i=tu(Fd(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=qt(i));var n=i.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var a=qi(t);return a.type="string",ku.to_workbook(i,a)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(St){n.indexOf("<"+St)>=0&&(s=!0)}),s)return PL(i,t);mu={"General Number":"General","General Date":dt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":dt[15],"Short Date":dt[14],"Long Time":dt[19],"Medium Time":dt[18],"Short Time":dt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:dt[2],Standard:dt[4],Percent:dt[10],Scientific:dt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,h=[],c,p={},g=[],m=t.dense?[]:{},_="",b={},x={},w=Bn('<Data ss:Type="String">'),P=0,E=0,k=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},F={},D="",N=0,X=[],z={},U={},j=0,q=[],pe=[],fe={},Ee=[],de,De=!1,ee=[],Fe=[],se={},R=0,J=0,Y={Sheets:[],WBProps:{date1904:!1}},ie={};Tu.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";l=Tu.exec(i);)switch(l[3]=(he=l[3]).toLowerCase()){case"data":if(he=="data"){if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&h.push([l[3],!0]);break}if(h[h.length-1][1])break;l[1]==="/"?gL(i.slice(P,l.index),D,w,h[h.length-1][0]=="comment"?fe:b,{c:E,r:k},O,Ee[E],x,ee,t):(D="",w=Bn(l[0]),P=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(pe.length>0&&(b.c=pe),(!t.sheetRows||t.sheetRows>k)&&b.v!==void 0&&(t.dense?(m[k]||(m[k]=[]),m[k][E]=b):m[zi(E)+Ji(k)]=b),b.HRef&&(b.l={Target:Mt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(R=E+(parseInt(b.MergeAcross,10)|0),J=k+(parseInt(b.MergeDown,10)|0),X.push({s:{c:E,r:k},e:{c:R,r:J}})),!t.sheetStubs)b.MergeAcross?E=R+1:++E;else if(b.MergeAcross||b.MergeDown){for(var Pe=E;Pe<=R;++Pe)for(var we=k;we<=J;++we)(Pe>E||we>k)&&(t.dense?(m[we]||(m[we]=[]),m[we][Pe]={t:"z"}):m[zi(Pe)+Ji(we)]={t:"z"});E=R+1}else++E;else b=hL(l[0]),b.Index&&(E=+b.Index-1),E<C.s.c&&(C.s.c=E),E>C.e.c&&(C.e.c=E),l[0].slice(-2)==="/>"&&++E,pe=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(k<C.s.r&&(C.s.r=k),k>C.e.r&&(C.e.r=k),l[0].slice(-2)==="/>"&&(x=Bn(l[0]),x.Index&&(k=+x.Index-1)),E=0,++k):(x=Bn(l[0]),x.Index&&(k=+x.Index-1),se={},(x.AutoFitHeight=="0"||x.Height)&&(se.hpx=parseInt(x.Height,10),se.hpt=Qx(se.hpx),Fe[k]=se),x.Hidden=="1"&&(se.hidden=!0,Fe[k]=se));break;case"worksheet":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"));g.push(_),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(m["!ref"]=Lt(C),t.sheetRows&&t.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=t.sheetRows-1,m["!ref"]=Lt(C))),X.length&&(m["!merges"]=X),Ee.length>0&&(m["!cols"]=Ee),Fe.length>0&&(m["!rows"]=Fe),p[_]=m}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=E=0,h.push([l[3],!1]),c=Bn(l[0]),_=Mt(c.Name),m=t.dense?[]:{},X=[],ee=[],Fe=[],ie={name:_,Hidden:0},Y.Sheets.push(ie);break;case"table":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else{if(l[0].slice(-2)=="/>")break;h.push([l[3],!1]),Ee=[],De=!1}break;case"style":l[1]==="/"?pL(O,F,t):F=Bn(l[0]);break;case"numberformat":F.nf=Mt(Bn(l[0]).Format||"General"),mu[F.nf]&&(F.nf=mu[F.nf]);for(var Oe=0;Oe!=392&&dt[Oe]!=F.nf;++Oe);if(Oe==392){for(Oe=57;Oe!=392;++Oe)if(dt[Oe]==null){eo(F.nf,Oe);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(de=Bn(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!De&&de.wpx>10){De=!0,Er=qx;for(var Le=0;Le<Ee.length;++Le)Ee[Le]&&hl(Ee[Le])}De&&hl(de),Ee[de.Index-1||Ee.length]=de;for(var it=0;it<+de.Span;++it)Ee[Ee.length]=qi(de);break;case"namedrange":if(l[1]==="/")break;Y.Names||(Y.Names=[]);var te=st(l[0]),ft={Name:te.Name,Ref:sl(te.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(ft.Sheet=Y.Sheets.length-1),Y.Names.push(ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?D+=i.slice(N,l.index):N=l.index+l[0].length;break;case"interior":if(!t.cellStyles)break;F.Interior=Bn(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?QP(z,he,i.slice(j,l.index)):j=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else h.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"));_L(fe),pe.push(fe)}else h.push([l[3],!1]),c=Bn(l[0]),fe={a:c.Author};break;case"autofilter":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ge=Bn(l[0]);m["!autofilter"]={ref:sl(Ge.Range).replace(/\$/g,"")},h.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&h.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((c=h.pop())[0]!==l[3])throw new Error("Bad state: "+c.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&h.push([l[3],!0]);break;case"null":break;default:if(h.length==0&&l[3]=="document"||h.length==0&&l[3]=="uof")return xm(i,t);var _t=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_t=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_t=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_t=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:_t=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(i.slice(j,l.index)){case"SheetHidden":ie.Hidden=1;break;case"SheetVeryHidden":ie.Hidden=2;break}else j=l.index+l[0].length;break;case"header":m["!margins"]||_u(m["!margins"]={},"xlml"),isNaN(+st(l[0]).Margin)||(m["!margins"].header=+st(l[0]).Margin);break;case"footer":m["!margins"]||_u(m["!margins"]={},"xlml"),isNaN(+st(l[0]).Margin)||(m["!margins"].footer=+st(l[0]).Margin);break;case"pagemargins":var rt=st(l[0]);m["!margins"]||_u(m["!margins"]={},"xlml"),isNaN(+rt.Top)||(m["!margins"].top=+rt.Top),isNaN(+rt.Left)||(m["!margins"].left=+rt.Left),isNaN(+rt.Right)||(m["!margins"].right=+rt.Right),isNaN(+rt.Bottom)||(m["!margins"].bottom=+rt.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_t=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_t=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_t=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_t=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_t=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_t=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_t=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_t=!1}break;case"smarttags":break;default:_t=!1;break}if(_t||l[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?fL(U,he,q,i.slice(j,l.index)):(q=l,j=l.index+l[0].length);break}if(t.WTF)throw"Unrecognized tag: "+l[3]+"|"+h.join("|")}var Be={};return!t.bookSheets&&!t.bookProps&&(Be.Sheets=p),Be.SheetNames=g,Be.Workbook=Y,Be.SSF=qi(dt),Be.Props=z,Be.Custprops=U,Be}function sd(r,e){switch(Kd(e=e||{}),e.type||"base64"){case"base64":return Uf(un(r),e);case"binary":case"buffer":case"file":return Uf(r,e);case"array":return Uf(_o(r),e)}}function mL(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=LP(t),t.length-t.l<=4)return e;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(e.UnicodeClipboardFormat=OP(t),i=t.read_shift(4),i==0||i>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var xL=[60,1084,2066,2165,2175];function vL(r,e,t,i,n){var s=i,a=[],l=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}a.push(l),t.l+=s;for(var h=Rs(t,t.l),c=ad[h],p=0;c!=null&&xL.indexOf(h)>-1;)s=Rs(t,t.l+2),p=t.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),l=t.slice(p,t.l+4+s),a.push(l),t.l+=4+s,c=ad[h=Rs(t,t.l)];var g=fa(a);$i(g,0);var m=0;g.lens=[];for(var _=0;_<a.length;++_)g.lens.push(m),m+=a[_].length;if(g.length<i)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+g.length+" < "+i;return e.f(g,g.length,n)}function os(r,e,t){if(r.t!=="z"&&r.XF){var i=0;try{i=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=dt[i])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||vo[r.v]:i===0||i=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=bu(r.v):r.w=ro(r.v):r.w=wn(i,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&i&&r.t=="n"&&vl(dt[i]||String(i))){var n=Qa(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function tc(r,e,t){return{v:r,ixfe:e,t}}function yL(r,e){var t={opts:{}},i={},n=e.dense?[]:{},s={},a={},l=null,h=[],c="",p={},g,m="",_,b,x,w,P={},E=[],k,C,O=[],F=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},X=function(nt){return nt<8?to[nt]:nt<64&&F[nt-8]||to[nt]},z=function(nt,Pt,Jt){var Xt=Pt.XF.data;if(!(!Xt||!Xt.patternType||!Jt||!Jt.cellStyles)){Pt.s={},Pt.s.patternType=Xt.patternType;var ji;(ji=Pu(X(Xt.icvFore)))&&(Pt.s.fgColor={rgb:ji}),(ji=Pu(X(Xt.icvBack)))&&(Pt.s.bgColor={rgb:ji})}},U=function(nt,Pt,Jt){if(!(se>1)&&!(Jt.sheetRows&&nt.r>=Jt.sheetRows)){if(Jt.cellStyles&&Pt.XF&&Pt.XF.data&&z(nt,Pt,Jt),delete Pt.ixfe,delete Pt.XF,g=nt,m=lt(nt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<a.s.r&&(a.s.r=nt.r),nt.c<a.s.c&&(a.s.c=nt.c),nt.r+1>a.e.r&&(a.e.r=nt.r+1),nt.c+1>a.e.c&&(a.e.c=nt.c+1),Jt.cellFormula&&Pt.f){for(var Xt=0;Xt<E.length;++Xt)if(!(E[Xt][0].s.c>nt.c||E[Xt][0].s.r>nt.r)&&!(E[Xt][0].e.c<nt.c||E[Xt][0].e.r<nt.r)){Pt.F=Lt(E[Xt][0]),(E[Xt][0].s.c!=nt.c||E[Xt][0].s.r!=nt.r)&&delete Pt.f,Pt.f&&(Pt.f=""+sr(E[Xt][1],a,nt,ee,j));break}}Jt.dense?(n[nt.r]||(n[nt.r]=[]),n[nt.r][nt.c]=Pt):n[m]=Pt}},j={enc:!1,sbcch:0,snames:[],sharedf:P,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(j.password=e.password);var q,pe=[],fe=[],Ee=[],de=[],De=!1,ee=[];ee.SheetNames=j.snames,ee.sharedf=j.sharedf,ee.arrayf=j.arrayf,ee.names=[],ee.XTI=[];var Fe=0,se=0,R=0,J=[],Y=[],ie;j.codepage=1200,zn(1200);for(var he=!1;r.l<r.length-1;){var Pe=r.l,we=r.read_shift(2);if(we===0&&Fe===10)break;var Oe=r.l===r.length?0:r.read_shift(2),Le=ad[we];if(Le&&Le.f){if(e.bookSheets&&Fe===133&&we!==133)break;if(Fe=we,Le.r===2||Le.r==12){var it=r.read_shift(2);if(Oe-=2,!j.enc&&it!==we&&((it&255)<<8|it>>8)!==we)throw new Error("rt mismatch: "+it+"!="+we);Le.r==12&&(r.l+=10,Oe-=10)}var te={};if(we===10?te=Le.f(r,Oe,j):te=vL(we,Le,r,Oe,j),se==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(we){case 34:t.opts.Date1904=D.WBProps.date1904=te;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(j.enc||(r.l=0),j.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=te;break;case 66:var ft=Number(te);switch(ft){case 21010:ft=1200;break;case 32768:ft=1e4;break;case 32769:ft=1252;break}zn(j.codepage=ft),he=!0;break;case 317:j.rrtabid=te;break;case 25:j.winlocked=te;break;case 439:t.opts.RefreshAll=te;break;case 12:t.opts.CalcCount=te;break;case 16:t.opts.CalcDelta=te;break;case 17:t.opts.CalcIter=te;break;case 13:t.opts.CalcMode=te;break;case 14:t.opts.CalcPrecision=te;break;case 95:t.opts.CalcSaveRecalc=te;break;case 15:j.CalcRefMode=te;break;case 2211:t.opts.FullCalc=te;break;case 129:te.fDialog&&(n["!type"]="dialog"),te.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),te.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:O.push(te);break;case 430:ee.push([te]),ee[ee.length-1].XTI=[];break;case 35:case 547:ee[ee.length-1].push(te);break;case 24:case 536:ie={Name:te.Name,Ref:sr(te.rgce,a,null,ee,j)},te.itab>0&&(ie.Sheet=te.itab-1),ee.names.push(ie),ee[0]||(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(Y[te.itab-1]={ref:Lt(te.rgce[0][0][1][2])});break;case 22:j.ExternCount=te;break;case 23:ee.length==0&&(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].XTI=ee[ee.length-1].XTI.concat(te),ee.XTI=ee.XTI.concat(te);break;case 2196:if(j.biff<8)break;ie!=null&&(ie.Comment=te[1]);break;case 18:n["!protect"]=te;break;case 19:te!==0&&j.WTF&&console.error("Password verifier: "+te);break;case 133:s[te.pos]=te,j.snames.push(te.name);break;case 10:{if(--se)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,n["!ref"]=Lt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ge=a.e.r;a.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Lt(a),a.e.r=Ge}a.e.r++,a.e.c++}pe.length>0&&(n["!merges"]=pe),fe.length>0&&(n["!objects"]=fe),Ee.length>0&&(n["!cols"]=Ee),de.length>0&&(n["!rows"]=de),D.Sheets.push(N)}c===""?p=n:i[c]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),j.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(j.biff=5,he=!0,zn(j.codepage=28591)),j.biff==8&&te.BIFFVer==0&&te.dt==16&&(j.biff=2),se++)break;if(n=e.dense?[]:{},j.biff<8&&!he&&(he=!0,zn(j.codepage=e.codepage||1252)),j.biff<5||te.BIFFVer==0&&te.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var _t={pos:r.l-Oe,name:c};s[_t.pos]=_t,j.snames.push(c)}else c=(s[Pe]||{name:""}).name;te.dt==32&&(n["!type"]="chart"),te.dt==64&&(n["!type"]="macro"),pe=[],fe=[],j.arrayf=E=[],Ee=[],de=[],De=!1,N={Hidden:(s[Pe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[te.r]||[])[te.c]:n[lt({c:te.c,r:te.r})])&&++te.c,k={ixfe:te.ixfe,XF:O[te.ixfe]||{},v:te.val,t:"n"},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e);break;case 5:case 517:k={ixfe:te.ixfe,XF:O[te.ixfe],v:te.val,t:te.t},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e);break;case 638:k={ixfe:te.ixfe,XF:O[te.ixfe],v:te.rknum,t:"n"},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e);break;case 189:for(var rt=te.c;rt<=te.C;++rt){var Be=te.rkrec[rt-te.c][0];k={ixfe:Be,XF:O[Be],v:te.rkrec[rt-te.c][1],t:"n"},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:rt,r:te.r},k,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){l=te;break}if(k=tc(te.val,te.cell.ixfe,te.tt),k.XF=O[k.ixfe],e.cellFormula){var St=te.formula;if(St&&St[0]&&St[0][0]&&St[0][0][0]=="PtgExp"){var ii=St[0][0][1][0],Ht=St[0][0][1][1],vt=lt({r:ii,c:Ht});P[vt]?k.f=""+sr(te.formula,a,te.cell,ee,j):k.F=((e.dense?(n[ii]||[])[Ht]:n[vt])||{}).F}else k.f=""+sr(te.formula,a,te.cell,ee,j)}R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U(te.cell,k,e),l=te}break;case 7:case 519:if(l)l.val=te,k=tc(te,l.cell.ixfe,"s"),k.XF=O[k.ixfe],e.cellFormula&&(k.f=""+sr(l.formula,a,l.cell,ee,j)),R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U(l.cell,k,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(te);var zt=lt(te[0].s);if(_=e.dense?(n[te[0].s.r]||[])[te[0].s.c]:n[zt],e.cellFormula&&_){if(!l||!zt||!_)break;_.f=""+sr(te[1],a,te[0],ee,j),_.F=Lt(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!l)break;P[lt(l.cell)]=te[0],_=e.dense?(n[l.cell.r]||[])[l.cell.c]:n[lt(l.cell)],(_||{}).f=""+sr(te[0],a,g,ee,j)}}break;case 253:k=tc(h[te.isst].t,te.ixfe,"s"),h[te.isst].h&&(k.h=h[te.isst].h),k.XF=O[k.ixfe],R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e);break;case 513:e.sheetStubs&&(k={ixfe:te.ixfe,XF:O[te.ixfe],t:"z"},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e));break;case 190:if(e.sheetStubs)for(var Ut=te.c;Ut<=te.C;++Ut){var Kt=te.ixfe[Ut-te.c];k={ixfe:Kt,XF:O[Kt],t:"z"},R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:Ut,r:te.r},k,e)}break;case 214:case 516:case 4:k=tc(te.val,te.ixfe,"s"),k.XF=O[k.ixfe],R>0&&(k.z=J[k.ixfe>>8&63]),os(k,e,t.opts.Date1904),U({c:te.c,r:te.r},k,e);break;case 0:case 512:se===1&&(a=te);break;case 252:h=te;break;case 1054:if(j.biff==4){J[R++]=te[1];for(var Ti=0;Ti<R+163&&dt[Ti]!=te[1];++Ti);Ti>=163&&eo(te[1],R+163)}else eo(te[1],te[0]);break;case 30:{J[R++]=te;for(var ki=0;ki<R+163&&dt[ki]!=te;++ki);ki>=163&&eo(te,R+163)}break;case 229:pe=pe.concat(te);break;case 93:fe[te.cmo[0]]=j.lastobj=te;break;case 438:j.lastobj.TxO=te;break;case 127:j.lastobj.ImData=te;break;case 440:for(w=te[0].s.r;w<=te[0].e.r;++w)for(x=te[0].s.c;x<=te[0].e.c;++x)_=e.dense?(n[w]||[])[x]:n[lt({c:x,r:w})],_&&(_.l=te[1]);break;case 2048:for(w=te[0].s.r;w<=te[0].e.r;++w)for(x=te[0].s.c;x<=te[0].e.c;++x)_=e.dense?(n[w]||[])[x]:n[lt({c:x,r:w})],_&&_.l&&(_.l.Tooltip=te[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;_=e.dense?(n[te[0].r]||[])[te[0].c]:n[lt(te[0])];var pi=fe[te[2]];_||(e.dense?(n[te[0].r]||(n[te[0].r]=[]),_=n[te[0].r][te[0].c]={t:"z"}):_=n[lt(te[0])]={t:"z"},a.e.r=Math.max(a.e.r,te[0].r),a.s.r=Math.min(a.s.r,te[0].r),a.e.c=Math.max(a.e.c,te[0].c),a.s.c=Math.min(a.s.c,te[0].c)),_.c||(_.c=[]),b={a:te[1],t:pi.TxO.t},_.c.push(b)}break;case 2173:WC(O[te.ixfe],te.ext);break;case 125:{if(!j.cellStyles)break;for(;te.e>=te.s;)Ee[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},De||(De=!0,Xd(te.w/256)),hl(Ee[te.e+1])}break;case 520:{var Bt={};te.level!=null&&(de[te.r]=Bt,Bt.level=te.level),te.hidden&&(de[te.r]=Bt,Bt.hidden=!0),te.hpt&&(de[te.r]=Bt,Bt.hpt=te.hpt,Bt.hpx=Eu(te.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||_u(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=te;break;case 161:n["!margins"]||_u(n["!margins"]={}),n["!margins"].header=te.header,n["!margins"].footer=te.footer;break;case 574:te.RTL&&(D.Views[0].RTL=!0);break;case 146:F=te;break;case 2198:q=te;break;case 140:C=te;break;case 442:c?N.CodeName=te||N.name:D.WBProps.CodeName=te||"ThisWorkbook";break}}else Le||console.error("Missing Info for XLS Record 0x"+we.toString(16)),r.l+=Oe}return t.SheetNames=fs(s).sort(function(gi,nt){return Number(gi)-Number(nt)}).map(function(gi){return s[gi].name}),e.bookSheets||(t.Sheets=i),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&Y.forEach(function(gi,nt){t.Sheets[t.SheetNames[nt]]["!autofilter"]=gi}),t.Strings=h,t.SSF=qi(dt),j.enc&&(t.Encryption=j.enc),q&&(t.Themes=q),t.Metadata={},C!==void 0&&(t.Metadata.Country=C),ee.names.length>0&&(D.Names=ee.names),t.Workbook=D,t}var dm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bL(r,e,t){var i=Dt.find(r,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var n=$_(i,NP,dm.DSI);for(var s in n)e[s]=n[s]}catch(c){if(t.WTF)throw c}var a=Dt.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var l=$_(a,HP,dm.SI);for(var h in l)e[h]==null&&(e[h]=l[h])}catch(c){if(t.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(Fx(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function mv(r,e){e||(e={}),Kd(e),Gm(),e.codepage&&Ad(e.codepage);var t,i;if(r.FullPaths){if(Dt.find(r,"/encryption"))throw new Error("File is password-protected");t=Dt.find(r,"!CompObj"),i=Dt.find(r,"/Workbook")||Dt.find(r,"/Book")}else{switch(e.type){case"base64":r=Hn(un(r));break;case"binary":r=Hn(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}$i(r,0),i={content:r}}var n,s;if(t&&mL(t),e.bookProps&&!e.bookSheets)n={};else{var a=Ct?"buffer":"array";if(i&&i.content)n=yL(i.content,e);else if((s=Dt.find(r,"PerfectOffice_MAIN"))&&s.content)n=pu.to_workbook(s.content,(e.type=a,e));else if((s=Dt.find(r,"NativeContent_MAIN"))&&s.content)n=pu.to_workbook(s.content,(e.type=a,e));else throw(s=Dt.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Dt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=aS(r))}var l={};return r.FullPaths&&bL(r,l,e),n.Props=n.Custprops=l,e.bookFiles&&(n.cfb=r),n}var wc={0:{f:iD},1:{f:aD},2:{f:gD},3:{f:hD},4:{f:lD},5:{f:pD},6:{f:xD},7:{f:fD},8:{f:TD},9:{f:wD},10:{f:yD},11:{f:bD},12:{f:oD},13:{f:_D},14:{f:cD},15:{f:uD},16:{f:fv},17:{f:vD},18:{f:dD},19:{f:Nd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$D},40:{},42:{},43:{f:yC},44:{f:vC},45:{f:bC},46:{f:TC},47:{f:wC},48:{},49:{f:kP},50:{},51:{f:XC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Yx},62:{f:mD},63:{f:KC},64:{f:OD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:LD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sD},148:{f:rD,p:16},151:{f:ED},152:{},153:{f:ZD},154:{},155:{},156:{f:VD},157:{},158:{},159:{T:1,f:HA},160:{T:-1},161:{T:1,f:xo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:kD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:jC},336:{T:-1},337:{f:GC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:td},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Gx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:AD},427:{f:CD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:nD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:td},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rS},633:{T:1},634:{T:-1},635:{T:1,f:iS},636:{T:-1},637:{f:EP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ND},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:MD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ad={6:{f:Hf},10:{f:la},12:{f:Si},13:{f:Si},14:{f:vi},15:{f:vi},16:{f:or},17:{f:vi},18:{f:vi},19:{f:Si},20:{f:em},21:{f:em},23:{f:Gx},24:{f:im},25:{f:vi},26:{},27:{},28:{f:eA},29:{},34:{f:vi},35:{f:tm},38:{f:or},39:{f:or},40:{f:or},41:{f:or},42:{f:vi},43:{f:vi},47:{f:nC},49:{f:RE},51:{f:Si},60:{},61:{f:OE},64:{f:vi},65:{f:FE},66:{f:Si},77:{},80:{},81:{},82:{},85:{f:Si},89:{},90:{},91:{},92:{f:kE},93:{f:iA},94:{},95:{f:vi},96:{},97:{},99:{f:vi},125:{f:Yx},128:{f:GE},129:{f:PE},130:{f:Si},131:{f:vi},132:{f:vi},133:{f:EE},134:{},140:{f:lA},141:{f:Si},144:{},146:{f:hA},151:{},152:{},153:{},154:{},155:{},156:{f:Si},157:{},158:{},160:{f:gA},161:{f:fA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UE},190:{f:WE},193:{f:la},197:{},198:{},199:{},200:{},201:{},202:{f:vi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Si},220:{},221:{f:vi},222:{},224:{f:XE},225:{f:TE},226:{f:la},227:{},229:{f:tA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:AE},253:{f:IE},255:{f:CE},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Hx},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vi},353:{f:la},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VE},431:{f:vi},432:{},433:{},434:{},437:{},438:{f:sA},439:{f:vi},440:{f:aA},441:{},442:{f:qu},443:{},444:{f:Si},445:{},446:{},448:{f:la},449:{f:LE,r:2},450:{f:la},512:{f:J_},513:{f:pA},515:{f:YE},516:{f:BE},517:{f:Q_},519:{f:_A},520:{f:SE},523:{},545:{f:rm},549:{f:q_},566:{},574:{f:ME},638:{f:zE},659:{},1048:{},1054:{f:NE},1084:{},1212:{f:qE},2048:{f:oA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:la},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:cA,r:12},2173:{f:UC,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$E,r:12},2197:{},2198:{f:RC,r:12},2199:{},2200:{},2201:{},2202:{f:JE,r:12},2203:{f:la},2204:{},2205:{},2206:{},2207:{},2211:{f:DE},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Si},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:J_},1:{},2:{f:yA},3:{f:vA},4:{f:xA},5:{f:Q_},7:{f:bA},8:{},9:{f:Jh},11:{},22:{f:Si},30:{f:HE},31:{},32:{},33:{f:rm},36:{},37:{f:q_},50:{f:wA},62:{},52:{},67:{},68:{f:Si},69:{},86:{},126:{},127:{f:mA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:TA},223:{},234:{},354:{},421:{},518:{f:Hf},521:{f:Jh},536:{f:im},547:{f:tm},561:{},579:{},1030:{f:Hf},1033:{f:Jh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Nn(r,e,t,i){var n=e;if(!isNaN(n)){var s=i||(t||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Ex(t)&&r.push(t)}}function pm(r,e){var t=e||{},i=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var n=r.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=n.index,l=s&&s.index||r.length,h=Vk(r.slice(a,l),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,p=0,g=0,m=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(a=0;a<h.length;++a){var x=h[a].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}p=0;continue}if(!(w!="<td"&&w!="<th")){var P=x.split(/<\/t[dh]>/i);for(l=0;l<P.length;++l){var E=P[l].trim();if(E.match(/<t[dh]/i)){for(var k=E,C=0;k.charAt(0)=="<"&&(C=k.indexOf(">"))>-1;)k=k.slice(C+1);for(var O=0;O<b.length;++O){var F=b[O];F.s.c==p&&F.s.r<c&&c<=F.e.r&&(p=F.e.c+1,O=-1)}var D=st(E.slice(0,E.indexOf(">")));m=D.colspan?+D.colspan:1,((g=+D.rowspan)>1||m>1)&&b.push({s:{r:c,c:p},e:{r:c+(g||1)-1,c:p+m-1}});var N=D.t||D["data-t"]||"";if(!k.length){p+=m;continue}if(k=dx(k),_.s.r>c&&(_.s.r=c),_.e.r<c&&(_.e.r=c),_.s.c>p&&(_.s.c=p),_.e.c<p&&(_.e.c=p),!k.length){p+=m;continue}var X={t:"s",v:k};t.raw||!k.trim().length||N=="s"||(k==="TRUE"?X={t:"b",v:!0}:k==="FALSE"?X={t:"b",v:!1}:isNaN(Wn(k))?isNaN(ul(k).getDate())||(X={t:"d",v:Zi(k)},t.cellDates||(X={t:"n",v:Dr(X.v)}),X.z=t.dateNF||dt[14]):X={t:"n",v:Wn(k)}),t.dense?(i[c]||(i[c]=[]),i[c][p]=X):i[lt({r:c,c:p})]=X,p+=m}}}}return i["!ref"]=Lt(_),b.length&&(i["!merges"]=b),i}function wL(r,e,t,i){for(var n=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var l=0,h=0,c=0;c<n.length;++c)if(!(n[c].s.r>t||n[c].s.c>a)&&!(n[c].e.r<t||n[c].e.c<a)){if(n[c].s.r<t||n[c].s.c<a){l=-1;break}l=n[c].e.r-n[c].s.r+1,h=n[c].e.c-n[c].s.c+1;break}if(!(l<0)){var p=lt({r:t,c:a}),g=i.dense?(r[t]||[])[a]:r[p],m=g&&g.v!=null&&(g.h||Md(g.w||(zs(g),g.w)||""))||"",_={};l>1&&(_.rowspan=l),h>1&&(_.colspan=h),i.editable?m='<span contenteditable="true">'+m+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),_.id=(i.id||"sjs")+"-"+p,s.push(lP("td",m,_))}}var b="<tr>";return b+s.join("")+"</tr>"}var TL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kL="</body></html>";function PL(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return wa(pm(t[0],e),e);var i=qd();return t.forEach(function(n,s){Jd(i,pm(n,e),"Sheet"+(s+1))}),i}function EL(r,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function AL(r,e){var t=e||{},i=t.header!=null?t.header:TL,n=t.footer!=null?t.footer:kL,s=[i],a=yl(r["!ref"]);t.dense=Array.isArray(r),s.push(EL(r,a,t));for(var l=a.s.r;l<=a.e.r;++l)s.push(wL(r,a,l,t));return s.push("</table>"+n),s.join("")}function xv(r,e,t){var i=t||{},n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?Ar(i.origin):i.origin;n=a.r,s=a.c}var l=e.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var p=yl(r["!ref"]);c.s.r=Math.min(c.s.r,p.s.r),c.s.c=Math.min(c.s.c,p.s.c),c.e.r=Math.max(c.e.r,p.e.r),c.e.c=Math.max(c.e.c,p.e.c),n==-1&&(c.e.r=n=p.e.r+1)}var g=[],m=0,_=r["!rows"]||(r["!rows"]=[]),b=0,x=0,w=0,P=0,E=0,k=0;for(r["!cols"]||(r["!cols"]=[]);b<l.length&&x<h;++b){var C=l[b];if(gm(C)){if(i.display)continue;_[x]={hidden:!0}}var O=C.children;for(w=P=0;w<O.length;++w){var F=O[w];if(!(i.display&&gm(F))){var D=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):dx(F.innerHTML),N=F.getAttribute("data-z")||F.getAttribute("z");for(m=0;m<g.length;++m){var X=g[m];X.s.c==P+s&&X.s.r<x+n&&x+n<=X.e.r&&(P=X.e.c+1-s,m=-1)}k=+F.getAttribute("colspan")||1,((E=+F.getAttribute("rowspan")||1)>1||k>1)&&g.push({s:{r:x+n,c:P+s},e:{r:x+n+(E||1)-1,c:P+s+(k||1)-1}});var z={t:"s",v:D},U=F.getAttribute("data-t")||F.getAttribute("t")||"";D!=null&&(D.length==0?z.t=U||"z":i.raw||D.trim().length==0||U=="s"||(D==="TRUE"?z={t:"b",v:!0}:D==="FALSE"?z={t:"b",v:!1}:isNaN(Wn(D))?isNaN(ul(D).getDate())||(z={t:"d",v:Zi(D)},i.cellDates||(z={t:"n",v:Dr(z.v)}),z.z=i.dateNF||dt[14]):z={t:"n",v:Wn(D)})),z.z===void 0&&N!=null&&(z.z=N);var j="",q=F.getElementsByTagName("A");if(q&&q.length)for(var pe=0;pe<q.length&&!(q[pe].hasAttribute("href")&&(j=q[pe].getAttribute("href"),j.charAt(0)!="#"));++pe);j&&j.charAt(0)!="#"&&(z.l={Target:j}),i.dense?(r[x+n]||(r[x+n]=[]),r[x+n][P+s]=z):r[lt({c:P+s,r:x+n})]=z,c.e.c<P+s&&(c.e.c=P+s),P+=k}}++x}return g.length&&(r["!merges"]=(r["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,x-1+n),r["!ref"]=Lt(c),x>=h&&(r["!fullref"]=Lt((c.e.r=l.length-b+x-1+n,c))),r}function vv(r,e){var t=e||{},i=t.dense?[]:{};return xv(i,r,e)}function CL(r,e){return wa(vv(r,e),e)}function gm(r){var e="",t=SL(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function SL(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function DL(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Mt(e.replace(/<[^>]*>/g,""));return[t]}var _m={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yv(r,e){var t=e||{},i=Fd(r),n=[],s,a,l={name:""},h="",c=0,p,g,m={},_=[],b=t.dense?[]:{},x,w,P={value:""},E="",k=0,C=[],O=-1,F=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,X={},z=[],U={},j=0,q=0,pe=[],fe=1,Ee=1,de=[],De={Names:[]},ee={},Fe=["",""],se=[],R={},J="",Y=0,ie=!1,he=!1,Pe=0;for(Tu.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Tu.exec(i);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"工作表":x[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?b["!ref"]=Lt(D):b["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(b["!fullref"]=b["!ref"],D.e.r=t.sheetRows-1,b["!ref"]=Lt(D)),z.length&&(b["!merges"]=z),pe.length&&(b["!rows"]=pe),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),_.push(p.name),m[p.name]=b,he=!1):x[0].charAt(x[0].length-2)!=="/"&&(p=st(x[0],!1),O=F=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,b=t.dense?[]:{},z=[],pe=[],he=!0);break;case"table-row-group":x[1]==="/"?--N:++N;break;case"table-row":case"行":if(x[1]==="/"){O+=fe,fe=1;break}if(g=st(x[0],!1),g.行号?O=g.行号-1:O==-1&&(O=0),fe=+g["number-rows-repeated"]||1,fe<10)for(Pe=0;Pe<fe;++Pe)N>0&&(pe[O+Pe]={level:N});F=-1;break;case"covered-table-cell":x[1]!=="/"&&++F,t.sheetStubs&&(t.dense?(b[O]||(b[O]=[]),b[O][F]={t:"z"}):b[lt({r:O,c:F})]={t:"z"}),E="",C=[];break;case"table-cell":case"数据":if(x[0].charAt(x[0].length-2)==="/")++F,P=st(x[0],!1),Ee=parseInt(P["number-columns-repeated"]||"1",10),w={t:"z",v:null},P.formula&&t.cellFormula!=!1&&(w.f=hm(Mt(P.formula))),(P.数据类型||P["value-type"])=="string"&&(w.t="s",w.v=Mt(P["string-value"]||""),t.dense?(b[O]||(b[O]=[]),b[O][F]=w):b[lt({r:O,c:F})]=w),F+=Ee-1;else if(x[1]!=="/"){++F,E="",k=0,C=[],Ee=1;var we=fe?O+fe-1:O;if(F>D.e.c&&(D.e.c=F),F<D.s.c&&(D.s.c=F),O<D.s.r&&(D.s.r=O),we>D.e.r&&(D.e.r=we),P=st(x[0],!1),se=[],R={},w={t:P.数据类型||P["value-type"],v:null},t.cellFormula)if(P.formula&&(P.formula=Mt(P.formula)),P["number-matrix-columns-spanned"]&&P["number-matrix-rows-spanned"]&&(j=parseInt(P["number-matrix-rows-spanned"],10)||0,q=parseInt(P["number-matrix-columns-spanned"],10)||0,U={s:{r:O,c:F},e:{r:O+j-1,c:F+q-1}},w.F=Lt(U),de.push([U,w.F])),P.formula)w.f=hm(P.formula);else for(Pe=0;Pe<de.length;++Pe)O>=de[Pe][0].s.r&&O<=de[Pe][0].e.r&&F>=de[Pe][0].s.c&&F<=de[Pe][0].e.c&&(w.F=de[Pe][1]);switch((P["number-columns-spanned"]||P["number-rows-spanned"])&&(j=parseInt(P["number-rows-spanned"],10)||0,q=parseInt(P["number-columns-spanned"],10)||0,U={s:{r:O,c:F},e:{r:O+j-1,c:F+q-1}},z.push(U)),P["number-columns-repeated"]&&(Ee=parseInt(P["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=ti(P["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(P.value);break;case"percentage":w.t="n",w.v=parseFloat(P.value);break;case"currency":w.t="n",w.v=parseFloat(P.value);break;case"date":w.t="d",w.v=Zi(P["date-value"]),t.cellDates||(w.t="n",w.v=Dr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Xk(P["time-value"])/86400,t.cellDates&&(w.t="d",w.v=zc(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(P.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",P["string-value"]!=null&&(E=Mt(P["string-value"]),C=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(ie=!1,w.t==="s"&&(w.v=E||"",C.length&&(w.R=C),ie=k==0),ee.Target&&(w.l=ee),se.length>0&&(w.c=se,se=[]),E&&t.cellText!==!1&&(w.w=E),ie&&(w.t="z",delete w.v),(!ie||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=O))for(var Oe=0;Oe<fe;++Oe){if(Ee=parseInt(P["number-columns-repeated"]||"1",10),t.dense)for(b[O+Oe]||(b[O+Oe]=[]),b[O+Oe][F]=Oe==0?w:qi(w);--Ee>0;)b[O+Oe][F+Ee]=qi(w);else for(b[lt({r:O+Oe,c:F})]=w;--Ee>0;)b[lt({r:O+Oe,c:F+Ee})]=qi(w);D.e.c<=F&&(D.e.c=F)}Ee=parseInt(P["number-columns-repeated"]||"1",10),F+=Ee-1,Ee=0,w={},E="",C=[]}ee={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s;R.t=E,C.length&&(R.R=C),R.a=J,se.push(R)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);J="",Y=0,E="",k=0,C=[];break;case"creator":x[1]==="/"?J=i.slice(Y,x.index):Y=x.index+x[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);E="",k=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(X[l.name]=h,(s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(h="",l=st(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":a=st(x[0],!1),h+=_m[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":a=st(x[0],!1),h+=_m[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":h+=i.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":a=st(x[0],!1),Fe=zf(a["cell-range-address"]);var Le={Name:a.name,Ref:Fe[0]+"!"+Fe[1]};he&&(Le.Sheet=_.length),De.Names.push(Le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!P||!P["string-value"])){var it=DL(i.slice(k,x.index));E=(E.length>0?E+`
`:"")+it[0]}else st(x[0],!1),k=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Fe=zf(st(x[0])["target-range-address"]),m[Fe[0]]["!autofilter"]={ref:Fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(ee=st(x[0],!1),!ee.href)break;ee.Target=Mt(ee.href),delete ee.href,ee.Target.charAt(0)=="#"&&ee.Target.indexOf(".")>-1?(Fe=zf(ee.Target.slice(1)),ee.Target="#"+Fe[0]+"!"+Fe[1]):ee.Target.match(/^\.\.[\\\/]/)&&(ee.Target=ee.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(x)}}var te={Sheets:m,SheetNames:_,Workbook:De};return t.bookSheets&&delete te.Sheets,te}function mm(r,e){e=e||{},vn(r,"META-INF/manifest.xml")&&YP(Ci(r,"META-INF/manifest.xml"),e);var t=ln(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=yv(qt(t),e);return vn(r,"meta.xml")&&(i.Props=Mx(Ci(r,"meta.xml"))),i}function xm(r,e){return yv(r,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vd(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function od(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):qt(_o(r))}function ld(r){var e=r.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(e),i=0;return r.forEach(function(n){t.set(n,i),i+=n.length}),t}function vm(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function LL(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,i=r[e+14]&1,n=e+13;n>=e;--n)i=i*256+r[n];return(r[e+15]&128?-i:i)*Math.pow(10,t-6176)}function Au(r,e){var t=e?e[0]:0,i=r[t]&127;e:if(r[t++]>=128&&(i|=(r[t]&127)<<7,r[t++]<128||(i|=(r[t]&127)<<14,r[t++]<128)||(i|=(r[t]&127)<<21,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),i}function Ui(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function lr(r){for(var e=[],t=[0];t[0]<r.length;){var i=t[0],n=Au(r,t),s=n&7;n=Math.floor(n/8);var a=0,l;if(n==0)break;switch(s){case 0:{for(var h=t[0];r[t[0]++]>=128;);l=r.slice(h,t[0])}break;case 5:a=4,l=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,l=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Au(r,t),l=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var c={data:l,type:s};e[n]==null?e[n]=[c]:e[n].push(c)}return e}function Zd(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function OL(r){for(var e,t=[],i=[0];i[0]<r.length;){var n=Au(r,i),s=lr(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:Ui(s[1][0].data),messages:[]};s[2].forEach(function(l){var h=lr(l.data),c=Ui(h[3][0].data);a.messages.push({meta:h,data:r.slice(i[0],i[0]+c)}),i[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Ui(s[3][0].data)>>>0>0),t.push(a)}return t}function ML(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],i=Au(e,t),n=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var l=a-59;a=e[t[0]],l>1&&(a|=e[t[0]+1]<<8),l>2&&(a|=e[t[0]+2]<<16),l>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=l}n.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var h=0,c=0;if(s==1?(c=(e[t[0]]>>2&7)+4,h=(e[t[0]++]&224)<<3,h|=e[t[0]++]):(c=(e[t[0]++]>>2)+1,s==2?(h=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(h=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),n=[ld(n)],h==0)throw new Error("Invalid offset 0");if(h>n[0].length)throw new Error("Invalid offset beyond length");if(c>=h)for(n.push(n[0].slice(-h)),c-=h;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-h,-h+c))}}var p=ld(n);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function FL(r){for(var e=[],t=0;t<r.length;){var i=r[t++],n=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(ML(i,r.slice(t,t+n))),t+=n}if(t!==r.length)throw new Error("data is not a valid framed stream!");return ld(e)}function RL(r,e,t,i){var n=Vd(r),s=n.getUint32(4,!0),a=(i>1?12:8)+vm(s&(i>1?3470:398))*4,l=-1,h=-1,c=NaN,p=new Date(2001,0,1);s&512&&(l=n.getUint32(a,!0),a+=4),a+=vm(s&(i>1?12288:4096))*4,s&16&&(h=n.getUint32(a,!0),a+=4),s&32&&(c=n.getFloat64(a,!0),a+=8),s&64&&(p.setTime(p.getTime()+n.getFloat64(a,!0)*1e3),a+=8);var g;switch(r[2]){case 0:break;case 2:g={t:"n",v:c};break;case 3:g={t:"s",v:e[h]};break;case 5:g={t:"d",v:p};break;case 6:g={t:"b",v:c>0};break;case 7:g={t:"n",v:c/86400};break;case 8:g={t:"e",v:0};break;case 9:if(l>-1)g={t:"s",v:t[l]};else if(h>-1)g={t:"s",v:e[h]};else if(!isNaN(c))g={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return g}function IL(r,e,t){var i=Vd(r),n=i.getUint32(8,!0),s=12,a=-1,l=-1,h=NaN,c=NaN,p=new Date(2001,0,1);n&1&&(h=LL(r,s),s+=16),n&2&&(c=i.getFloat64(s,!0),s+=8),n&4&&(p.setTime(p.getTime()+i.getFloat64(s,!0)*1e3),s+=8),n&8&&(l=i.getUint32(s,!0),s+=4),n&16&&(a=i.getUint32(s,!0),s+=4);var g;switch(r[1]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[l]};break;case 5:g={t:"d",v:p};break;case 6:g={t:"b",v:c>0};break;case 7:g={t:"n",v:c/86400};break;case 8:g={t:"e",v:0};break;case 9:if(a>-1)g={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)));break;case 10:g={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)))}return g}function BL(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return RL(r,e,t,r[0]);case 5:return IL(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function ga(r){var e=lr(r);return Au(e[1][0].data)}function ym(r,e){var t=lr(e.data),i=Ui(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(a){var l=lr(a.data),h=Ui(l[1][0].data)>>>0;switch(i){case 1:s[h]=od(l[3][0].data);break;case 8:{var c=r[ga(l[9][0].data)][0],p=lr(c.data),g=r[ga(p[1][0].data)][0],m=Ui(g.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var _=lr(g.data);s[h]=_[3].map(function(b){return od(b.data)}).join("")}break}}),s}function NL(r,e){var t,i,n,s,a,l,h,c,p,g,m,_,b,x,w=lr(r),P=Ui(w[1][0].data)>>>0,E=Ui(w[2][0].data)>>>0,k=((i=(t=w[8])==null?void 0:t[0])==null?void 0:i.data)&&Ui(w[8][0].data)>0||!1,C,O;if((s=(n=w[7])==null?void 0:n[0])!=null&&s.data&&e!=0)C=(l=(a=w[7])==null?void 0:a[0])==null?void 0:l.data,O=(c=(h=w[6])==null?void 0:h[0])==null?void 0:c.data;else if((g=(p=w[4])==null?void 0:p[0])!=null&&g.data&&e!=1)C=(_=(m=w[4])==null?void 0:m[0])==null?void 0:_.data,O=(x=(b=w[3])==null?void 0:b[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var F=k?4:1,D=Vd(C),N=[],X=0;X<C.length/2;++X){var z=D.getUint16(X*2,!0);z<65535&&N.push([X,z])}if(N.length!=E)throw"Expected ".concat(E," cells, found ").concat(N.length);var U=[];for(X=0;X<N.length-1;++X)U[N[X][0]]=O.subarray(N[X][1]*F,N[X+1][1]*F);return N.length>=1&&(U[N[N.length-1][0]]=O.subarray(N[N.length-1][1]*F)),{R:P,cells:U}}function HL(r,e){var t,i=lr(e.data),n=(t=i==null?void 0:i[7])!=null&&t[0]?Ui(i[7][0].data)>>>0>0?1:0:-1,s=Zd(i[5],function(a){return NL(a,n)});return{nrows:Ui(i[4][0].data)>>>0,data:s.reduce(function(a,l){return a[l.R]||(a[l.R]=[]),l.cells.forEach(function(h,c){if(a[l.R][c])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(c));a[l.R][c]=h}),a},[])}}function zL(r,e,t){var i,n=lr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ui(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Ui(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Lt(s);var a=lr(n[4][0].data),l=ym(r,r[ga(a[4][0].data)][0]),h=(i=a[17])!=null&&i[0]?ym(r,r[ga(a[17][0].data)][0]):[],c=lr(a[3][0].data),p=0;c[1].forEach(function(g){var m=lr(g.data),_=r[ga(m[2][0].data)][0],b=Ui(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var x=HL(r,_);x.data.forEach(function(w,P){w.forEach(function(E,k){var C=lt({r:p+P,c:k}),O=BL(E,l,h);O&&(t[C]=O)})}),p+=x.nrows})}function UL(r,e){var t=lr(e.data),i={"!ref":"A1"},n=r[ga(t[2][0].data)],s=Ui(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return zL(r,n[0],i),i}function WL(r,e){var t,i=lr(e.data),n={name:(t=i[1])!=null&&t[0]?od(i[1][0].data):"",sheets:[]},s=Zd(i[2],ga);return s.forEach(function(a){r[a].forEach(function(l){var h=Ui(l.meta[1][0].data);h==6e3&&n.sheets.push(UL(r,l))})}),n}function jL(r,e){var t=qd(),i=lr(e.data),n=Zd(i[1],ga);if(n.forEach(function(s){r[s].forEach(function(a){var l=Ui(a.meta[1][0].data);if(l==2){var h=WL(r,a);h.sheets.forEach(function(c,p){Jd(t,c,p==0?h.name:h.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Wf(r){var e,t,i,n,s={},a=[];if(r.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var c;try{c=FL(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var p;try{p=OL(c)}catch(g){return console.log("## "+(g.message||g))}p.forEach(function(g){s[g.id]=g.messages,a.push(g.id)})}}),!a.length)throw new Error("File has no messages");var l=((n=(i=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:n[0].data)&&Ui(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||a.forEach(function(h){s[h].forEach(function(c){var p=Ui(c.meta[1][0].data)>>>0;if(p==1)if(!l)l=c;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return jL(s,l)}function XL(r){return function(t){for(var i=0;i!=r.length;++i){var n=r[i];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Kd(r){XL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function GL(r){return tl.WS.indexOf(r)>-1?"sheet":r==tl.CS?"chart":r==tl.DS?"dialog":r==tl.MS?"macro":r&&r.length?r:"sheet"}function YL(r,e){if(!r)return 0;try{r=e.map(function(i){return i.id||(i.id=i.strRelID),[i.name,r["!id"][i.id].Target,GL(r["!id"][i.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function VL(r,e,t,i,n,s,a,l,h,c,p,g){try{s[i]=fu(ln(r,t,!0),e);var m=Ci(r,e),_;switch(l){case"sheet":_=QD(m,e,n,h,s[i],c,p,g);break;case"chart":if(_=eL(m,e,n,h,s[i],c,p,g),!_||!_["!drawel"])break;var b=ru(_["!drawel"].Target,e),x=id(b),w=JC(ln(r,b,!0),fu(ln(r,x,!0),b)),P=ru(w,b),E=id(P);_=ID(ln(r,P,!0),P,h,fu(ln(r,E,!0),P),c,_);break;case"macro":_=tL(m,e,n,h,s[i],c,p,g);break;case"dialog":_=iL(m,e,n,h,s[i],c,p,g);break;default:throw new Error("Unrecognized sheet type "+l)}a[i]=_;var k=[];s&&s[i]&&fs(s[i]).forEach(function(C){var O="";if(s[i][C].Type==tl.CMNT){O=ru(s[i][C].Target,e);var F=aL(Ci(r,O,!0),O,h);if(!F||!F.length)return;sm(_,F,!1)}s[i][C].Type==tl.TCMNT&&(O=ru(s[i][C].Target,e),k=k.concat(eS(Ci(r,O,!0),h)))}),k&&k.length&&sm(_,k,!0,h.people||[])}catch(C){if(h.WTF)throw C}}function mn(r){return r.charAt(0)=="/"?r.slice(1):r}function ZL(r,e){if(rx(),e=e||{},Kd(e),vn(r,"META-INF/manifest.xml")||vn(r,"objectdata.xml"))return mm(r,e);if(vn(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Wf<"u"){if(r.FileIndex)return Wf(r);var t=Dt.utils.cfb_new();return O_(r).forEach(function(pe){Kk(t,pe,ux(r,pe))}),Wf(t)}throw new Error("Unsupported NUMBERS file")}if(!vn(r,"[Content_Types].xml"))throw vn(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vn(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=O_(r),n=XP(ln(r,"[Content_Types].xml")),s=!1,a,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",Ci(r,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!Ci(r,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var h={},c={};if(!e.bookSheets&&!e.bookProps){if(gu=[],n.sst)try{gu=sL(Ci(r,mn(n.sst)),n.sst,e)}catch(pe){if(e.WTF)throw pe}e.cellStyles&&n.themes.length&&(h=nL(ln(r,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(c=rL(Ci(r,mn(n.style)),n.style,h,e))}n.links.map(function(pe){try{var fe=fu(ln(r,id(mn(pe))),pe);return lL(Ci(r,mn(pe)),fe,pe,e)}catch{}});var p=JD(Ci(r,mn(n.workbooks[0])),n.workbooks[0],e),g={},m="";n.coreprops.length&&(m=Ci(r,mn(n.coreprops[0]),!0),m&&(g=Mx(m)),n.extprops.length!==0&&(m=Ci(r,mn(n.extprops[0]),!0),m&&KP(m,g,e)));var _={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(m=ln(r,mn(n.custprops[0]),!0),m&&(_=qP(m,e)));var b={};if((e.bookSheets||e.bookProps)&&(p.Sheets?a=p.Sheets.map(function(fe){return fe.name}):g.Worksheets&&g.SheetNames.length>0&&(a=g.SheetNames),e.bookProps&&(b.Props=g,b.Custprops=_),e.bookSheets&&typeof a<"u"&&(b.SheetNames=a),e.bookSheets?b.SheetNames:e.bookProps))return b;a={};var x={};e.bookDeps&&n.calcchain&&(x=oL(Ci(r,mn(n.calcchain)),n.calcchain));var w=0,P={},E,k;{var C=p.Sheets;g.Worksheets=C.length,g.SheetNames=[];for(var O=0;O!=C.length;++O)g.SheetNames[O]=C[O].name}var F=s?"bin":"xml",D=n.workbooks[0].lastIndexOf("/"),N=(n.workbooks[0].slice(0,D+1)+"_rels/"+n.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");vn(r,N)||(N="xl/_rels/workbook."+F+".rels");var X=fu(ln(r,N,!0),N.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=uL(Ci(r,mn(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=tS(Ci(r,mn(n.people[0])),e)),X&&(X=YL(X,p.Sheets));var z=Ci(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var U="sheet";if(X&&X[w]?(E="xl/"+X[w][1].replace(/[\/]?xl\//,""),vn(r,E)||(E=X[w][1]),vn(r,E)||(E=N.replace(/_rels\/.*$/,"")+X[w][1]),U=X[w][2]):(E="xl/worksheets/sheet"+(w+1-z)+"."+F,E=E.replace(/sheet0\./,"sheet.")),k=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var j=!1,q=0;q!=e.sheets.length;++q)typeof e.sheets[q]=="number"&&e.sheets[q]==w&&(j=1),typeof e.sheets[q]=="string"&&e.sheets[q].toLowerCase()==g.SheetNames[w].toLowerCase()&&(j=1);if(!j)continue e}}VL(r,E,k,g.SheetNames[w],w,P,a,U,e,p,h,c)}return b={Directory:n,Workbook:p,Props:g,Custprops:_,Deps:x,Sheets:a,SheetNames:g.SheetNames,Strings:gu,Styles:c,Themes:h,SSF:qi(dt)},e&&e.bookFiles&&(r.files?(b.keys=i,b.files=r.files):(b.keys=[],b.files={},r.FullPaths.forEach(function(pe,fe){pe=pe.replace(/^Root Entry[\/]/,""),b.keys.push(pe),b.files[pe]=r.FileIndex[fe]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Ci(r,mn(n.vba[0]),!0):n.defaults&&n.defaults.bin===sS&&(b.vbaraw=Ci(r,"xl/vbaProject.bin",!0))),b}function KL(r,e){var t=e||{},i="Workbook",n=Dt.find(r,i);try{if(i="/!DataSpaces/Version",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(UA(n.content),i="/!DataSpaces/DataSpaceMap",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=jA(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=XA(n.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);YA(n.content)}catch{}if(i="/EncryptionInfo",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=VA(n.content);if(i="/EncryptedPackage",n=Dt.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,t.password||"",t);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function $d(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=un(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function $L(r,e){return Dt.find(r,"EncryptedPackage")?KL(r,e):mv(r,e)}function qL(r,e){var t,i=r,n=e||{};return n.type||(n.type=Ct&&Buffer.isBuffer(r)?"buffer":"base64"),t=hx(i,n),ZL(t,n)}function bv(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return sd(r.slice(t),e);default:break e}return ku.to_workbook(r,e)}function JL(r,e){var t="",i=$d(r,e);switch(e.type){case"base64":t=un(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=no(r);break;default:throw new Error("Unrecognized type "+e.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=qt(t)),e.type="binary",bv(t,e)}function QL(r,e){var t=r;return e.type=="base64"&&(t=un(t)),t=ca.utils.decode(1200,t.slice(2),"str"),e.type="binary",bv(t,e)}function eO(r){return r.match(/[^\x00-\x7F]/)?nu(r):r}function jf(r,e,t,i){return i?(t.type="string",ku.to_workbook(r,t)):ku.to_workbook(e,t)}function Tc(r,e){Gm();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Tc(new Uint8Array(r),(t=qi(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=r,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),al={},t.dateNF&&(al.dateNF=t.dateNF),t.type||(t.type=Ct&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Ct?"buffer":"binary",i=Wk(r),typeof Uint8Array<"u"&&!Ct&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,i=eO(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),l=new Uint8Array(a);if(l.foo="bar",!l.foo)return t=qi(t),t.type="array",Tc(Cd(i),t)}switch((n=$d(i,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return $L(Dt.read(i,t),t);break;case 9:if(n[1]<=8)return mv(i,t);break;case 60:return sd(i,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return CA(i,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return EA.to_workbook(i,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?qL(i,t):jf(r,i,t,s);case 239:return n[3]===60?sd(i,t):jf(r,i,t,s);case 255:if(n[1]===254)return QL(i,t);if(n[1]===0&&n[2]===2&&n[3]===0)return pu.to_workbook(i,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return pu.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return nm.to_workbook(i,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return sC.to_workbook(i,t);break;case 10:case 13:case 32:return JL(i,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kA.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?nm.to_workbook(i,t):jf(r,i,t,s)}function tO(r,e,t,i,n,s,a,l){var h=Ji(t),c=l.defval,p=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),g=!0,m=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!a||r[t])for(var _=e.s.c;_<=e.e.c;++_){var b=a?r[t][_]:r[i[_]+h];if(b===void 0||b.t===void 0){if(c===void 0)continue;s[_]!=null&&(m[s[_]]=c);continue}var x=b.v;switch(b.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[_]!=null){if(x==null)if(b.t=="e"&&x===null)m[s[_]]=null;else if(c!==void 0)m[s[_]]=c;else if(p&&x===null)m[s[_]]=null;else continue;else m[s[_]]=p&&(b.t!=="n"||b.t==="n"&&l.rawNumbers!==!1)?x:zs(b,x,l);x!=null&&(g=!1)}}return{row:m,isempty:g}}function ud(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},i=0,n=1,s=[],a=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},p=c.range!=null?c.range:r["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)?i=3:c.header==null&&(i=0),typeof p){case"string":h=di(p);break;case"number":h=di(r["!ref"]),h.s.r=p;break;default:h=p}i>0&&(n=0);var g=Ji(h.s.r),m=[],_=[],b=0,x=0,w=Array.isArray(r),P=h.s.r,E=0,k={};w&&!r[P]&&(r[P]=[]);var C=c.skipHidden&&r["!cols"]||[],O=c.skipHidden&&r["!rows"]||[];for(E=h.s.c;E<=h.e.c;++E)if(!(C[E]||{}).hidden)switch(m[E]=zi(E),t=w?r[P][E]:r[m[E]+g],i){case 1:s[E]=E-h.s.c;break;case 2:s[E]=m[E];break;case 3:s[E]=c.header[E-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),l=a=zs(t,null,c),x=k[a]||0,!x)k[a]=1;else{do l=a+"_"+x++;while(k[l]);k[a]=x,k[l]=1}s[E]=l}for(P=h.s.r+n;P<=h.e.r;++P)if(!(O[P]||{}).hidden){var F=tO(r,h,P,m,i,s,w,c);(F.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows))&&(_[b++]=F.row)}return _.length=b,_}var bm=/"/g;function iO(r,e,t,i,n,s,a,l){for(var h=!0,c=[],p="",g=Ji(t),m=e.s.c;m<=e.e.c;++m)if(i[m]){var _=l.dense?(r[t]||[])[m]:r[i[m]+g];if(_==null)p="";else if(_.v!=null){h=!1,p=""+(l.rawNumbers&&_.t=="n"?_.v:zs(_,null,l));for(var b=0,x=0;b!==p.length;++b)if((x=p.charCodeAt(b))===n||x===s||x===34||l.forceQuotes){p='"'+p.replace(bm,'""')+'"';break}p=="ID"&&(p='"ID"')}else _.f!=null&&!_.F?(h=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(bm,'""')+'"')):p="";c.push(p)}return l.blankrows===!1&&h?null:c.join(a)}function wv(r,e){var t=[],i=e??{};if(r==null||r["!ref"]==null)return"";var n=di(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,h=l.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),p="",g=[];i.dense=Array.isArray(r);for(var m=i.skipHidden&&r["!cols"]||[],_=i.skipHidden&&r["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(m[b]||{}).hidden||(g[b]=zi(b));for(var x=0,w=n.s.r;w<=n.e.r;++w)(_[w]||{}).hidden||(p=iO(r,n,w,g,a,h,s,i),p!=null&&(i.strip&&(p=p.replace(c,"")),(p||i.blankrows!==!1)&&t.push((x++?l:"")+p)));return delete i.dense,t.join("")}function rO(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=wv(r,e);return t}function nO(r){var e="",t,i="";if(r==null||r["!ref"]==null)return[];var n=di(r["!ref"]),s="",a=[],l,h=[],c=Array.isArray(r);for(l=n.s.c;l<=n.e.c;++l)a[l]=zi(l);for(var p=n.s.r;p<=n.e.r;++p)for(s=Ji(p),l=n.s.c;l<=n.e.c;++l)if(e=a[l]+s,t=c?(r[p]||[])[l]:r[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}h[h.length]=e+"="+i}return h}function Tv(r,e,t){var i=t||{},n=+!i.skipHeader,s=r||{},a=0,l=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var h=typeof i.origin=="string"?Ar(i.origin):i.origin;a=h.r,l=h.c}var c,p={s:{c:0,r:0},e:{c:l,r:a+e.length-1+n}};if(s["!ref"]){var g=di(s["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),a==-1&&(a=g.e.r+1,p.e.r=a+e.length-1+n)}else a==-1&&(a=0,p.e.r=e.length-1+n);var m=i.header||[],_=0;e.forEach(function(x,w){fs(x).forEach(function(P){(_=m.indexOf(P))==-1&&(m[_=m.length]=P);var E=x[P],k="z",C="",O=lt({c:l+_,r:a+w+n});c=Cu(s,O),E&&typeof E=="object"&&!(E instanceof Date)?s[O]=E:(typeof E=="number"?k="n":typeof E=="boolean"?k="b":typeof E=="string"?k="s":E instanceof Date?(k="d",i.cellDates||(k="n",E=Dr(E)),C=i.dateNF||dt[14]):E===null&&i.nullError&&(k="e",E=0),c?(c.t=k,c.v=E,delete c.w,delete c.R,C&&(c.z=C)):s[O]=c={t:k,v:E},C&&(c.z=C))})}),p.e.c=Math.max(p.e.c,l+m.length-1);var b=Ji(a);if(n)for(_=0;_<m.length;++_)s[zi(_+l)+b]={t:"s",v:m[_]};return s["!ref"]=Lt(p),s}function sO(r,e){return Tv(null,r,e)}function Cu(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var i=Ar(e);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Cu(r,lt(e)):Cu(r,lt({r:e,c:t||0}))}function aO(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function qd(){return{SheetNames:[],Sheets:{}}}function Jd(r,e,t,i){var n=1;if(!t)for(;n<=65535&&r.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||t;for(++n;n<=65535&&r.SheetNames.indexOf(t=a+n)!=-1;++n);}if(XD(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function oO(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=aO(r,e);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[i].Hidden=t}function lO(r,e){return r.z=e,r}function kv(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function uO(r,e,t){return kv(r,"#"+e,t)}function hO(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function cO(r,e,t,i){for(var n=typeof e!="string"?e:di(e),s=typeof e=="string"?e:Lt(e),a=n.s.r;a<=n.e.r;++a)for(var l=n.s.c;l<=n.e.c;++l){var h=Cu(r,a,l);h.t="n",h.F=s,delete h.v,a==n.s.r&&l==n.s.c&&(h.f=t,i&&(h.D=!0))}return r}var Pv={encode_col:zi,encode_row:Ji,encode_cell:lt,encode_range:Lt,decode_col:Bd,decode_row:Id,split_cell:TP,decode_cell:Ar,decode_range:yl,format_cell:zs,sheet_add_aoa:Cx,sheet_add_json:Tv,sheet_add_dom:xv,aoa_to_sheet:bl,json_to_sheet:sO,table_to_sheet:vv,table_to_book:CL,sheet_to_csv:wv,sheet_to_txt:rO,sheet_to_json:ud,sheet_to_html:AL,sheet_to_formulae:nO,sheet_to_row_object_array:ud,sheet_get_cell:Cu,book_new:qd,book_append_sheet:Jd,book_set_sheet_visibility:oO,cell_set_number_format:lO,cell_set_hyperlink:kv,cell_set_internal_link:uO,cell_add_comment:hO,sheet_set_array_formula:cO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},kc={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */kc.exports;(function(r,e){(function(){var t,i="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",c=500,p="__lodash_placeholder__",g=1,m=2,_=4,b=1,x=2,w=1,P=2,E=4,k=8,C=16,O=32,F=64,D=128,N=256,X=512,z=30,U="...",j=800,q=16,pe=1,fe=2,Ee=3,de=1/0,De=9007199254740991,ee=17976931348623157e292,Fe=0/0,se=4294967295,R=se-1,J=se>>>1,Y=[["ary",D],["bind",w],["bindKey",P],["curry",k],["curryRight",C],["flip",X],["partial",O],["partialRight",F],["rearg",N]],ie="[object Arguments]",he="[object Array]",Pe="[object AsyncFunction]",we="[object Boolean]",Oe="[object Date]",Le="[object DOMException]",it="[object Error]",te="[object Function]",ft="[object GeneratorFunction]",Ge="[object Map]",_t="[object Number]",rt="[object Null]",Be="[object Object]",St="[object Promise]",ii="[object Proxy]",Ht="[object RegExp]",vt="[object Set]",zt="[object String]",Ut="[object Symbol]",Kt="[object Undefined]",Ti="[object WeakMap]",ki="[object WeakSet]",pi="[object ArrayBuffer]",Bt="[object DataView]",gi="[object Float32Array]",nt="[object Float64Array]",Pt="[object Int8Array]",Jt="[object Int16Array]",Xt="[object Int32Array]",ji="[object Uint8Array]",qr="[object Uint8ClampedArray]",Gn="[object Uint16Array]",Pi="[object Uint32Array]",Lr=/\b__p \+= '';/g,Gs=/\b(__p \+=) '' \+/g,gs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,pr=/&(?:amp|lt|gt|quot|#39);/g,Mi=/[&<>"']/g,Fi=RegExp(pr.source),Ys=RegExp(Mi.source),Ta=/<%-([\s\S]+?)%>/g,gr=/<%([\s\S]+?)%>/g,Or=/<%=([\s\S]+?)%>/g,Vs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pn=/^\w*$/,Yn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ri=/[\\^$.*+?()[\]{}|]/g,_i=RegExp(Ri.source),Xi=/^\s+/,Vn=/\s/,_s=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,I=/\{\n\/\* \[wrapped with (.+)\] \*/,Z=/,? & /,G=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,V=/[()=,{}\[\]\/\s]/,K=/\\(\\)?/g,Q=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_e=/\w*$/,Te=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,xe=/^0o[0-7]+$/i,Re=/^(?:0|[1-9]\d*)$/,Ne=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,We=/($^)/,Ie=/['\n\r\u2028\u2029\\]/g,He="\\ud800-\\udfff",$e="\\u0300-\\u036f",Gt="\\ufe20-\\ufe2f",Yt="\\u20d0-\\u20ff",ri=$e+Gt+Yt,Mr="\\u2700-\\u27bf",En="a-z\\xdf-\\xf6\\xf8-\\xff",Zn="\\xac\\xb1\\xd7\\xf7",_r="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wt="\\u2000-\\u206f",Et=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ka="A-Z\\xc0-\\xd6\\xd8-\\xde",ms="\\ufe0e\\ufe0f",xs=Zn+_r+wt+Et,Pa="['’]",ht="["+He+"]",Qt="["+xs+"]",Zs="["+ri+"]",Ea="\\d+",Fr="["+Mr+"]",ih="["+En+"]",Aa="[^"+He+xs+Ea+Mr+En+ka+"]",An="\\ud83c[\\udffb-\\udfff]",oi="(?:"+Zs+"|"+An+")",Cn="[^"+He+"]",vs="(?:\\ud83c[\\udde6-\\uddff]){2}",ys="[\\ud800-\\udbff][\\udc00-\\udfff]",Kn="["+ka+"]",Ks="\\u200d",bo="(?:"+ih+"|"+Aa+")",kl="(?:"+Kn+"|"+Aa+")",Ca="(?:"+Pa+"(?:d|ll|m|re|s|t|ve))?",wo="(?:"+Pa+"(?:D|LL|M|RE|S|T|VE))?",To=oi+"?",Sa="["+ms+"]?",rh="(?:"+Ks+"(?:"+[Cn,vs,ys].join("|")+")"+Sa+To+")*",Pl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$c="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",mt=Sa+To+rh,Jr="(?:"+[Fr,vs,ys].join("|")+")"+mt,ni="(?:"+[Cn+Zs+"?",Zs,vs,ys,ht].join("|")+")",ko=RegExp(Pa,"g"),El=RegExp(Zs,"g"),Sn=RegExp(An+"(?="+An+")|"+ni+mt,"g"),Al=RegExp([Kn+"?"+ih+"+"+Ca+"(?="+[Qt,Kn,"$"].join("|")+")",kl+"+"+wo+"(?="+[Qt,Kn+bo,"$"].join("|")+")",Kn+"?"+bo+"+"+Ca,Kn+"+"+wo,$c,Pl,Ea,Jr].join("|"),"g"),Da=RegExp("["+Ks+He+ri+ms+"]"),Rr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],nh=-1,Vt={};Vt[gi]=Vt[nt]=Vt[Pt]=Vt[Jt]=Vt[Xt]=Vt[ji]=Vt[qr]=Vt[Gn]=Vt[Pi]=!0,Vt[ie]=Vt[he]=Vt[pi]=Vt[we]=Vt[Bt]=Vt[Oe]=Vt[it]=Vt[te]=Vt[Ge]=Vt[_t]=Vt[Be]=Vt[Ht]=Vt[vt]=Vt[zt]=Vt[Ti]=!1;var Wt={};Wt[ie]=Wt[he]=Wt[pi]=Wt[Bt]=Wt[we]=Wt[Oe]=Wt[gi]=Wt[nt]=Wt[Pt]=Wt[Jt]=Wt[Xt]=Wt[Ge]=Wt[_t]=Wt[Be]=Wt[Ht]=Wt[vt]=Wt[zt]=Wt[Ut]=Wt[ji]=Wt[qr]=Wt[Gn]=Wt[Pi]=!0,Wt[it]=Wt[te]=Wt[Ti]=!1;var Cl={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Sl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Dl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Po={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ll=parseFloat,qc=parseInt,sh=typeof ut=="object"&&ut&&ut.Object===Object&&ut,ah=typeof self=="object"&&self&&self.Object===Object&&self,qe=sh||ah||Function("return this")(),Ol=e&&!e.nodeType&&e,Ii=Ol&&!0&&r&&!r.nodeType&&r,$s=Ii&&Ii.exports===Ol,Eo=$s&&sh.process,Ir=function(){try{var oe=Ii&&Ii.require&&Ii.require("util").types;return oe||Eo&&Eo.binding&&Eo.binding("util")}catch{}}(),Ao=Ir&&Ir.isArrayBuffer,oh=Ir&&Ir.isDate,Ml=Ir&&Ir.isMap,lh=Ir&&Ir.isRegExp,Co=Ir&&Ir.isSet,uh=Ir&&Ir.isTypedArray;function ei(oe,ke,ye){switch(ye.length){case 0:return oe.call(ke);case 1:return oe.call(ke,ye[0]);case 2:return oe.call(ke,ye[0],ye[1]);case 3:return oe.call(ke,ye[0],ye[1],ye[2])}return oe.apply(ke,ye)}function Jc(oe,ke,ye,Xe){for(var at=-1,Ot=oe==null?0:oe.length;++at<Ot;){var li=oe[at];ke(Xe,li,ye(li),oe)}return Xe}function mr(oe,ke){for(var ye=-1,Xe=oe==null?0:oe.length;++ye<Xe&&ke(oe[ye],ye,oe)!==!1;);return oe}function hh(oe,ke){for(var ye=oe==null?0:oe.length;ye--&&ke(oe[ye],ye,oe)!==!1;);return oe}function So(oe,ke){for(var ye=-1,Xe=oe==null?0:oe.length;++ye<Xe;)if(!ke(oe[ye],ye,oe))return!1;return!0}function er(oe,ke){for(var ye=-1,Xe=oe==null?0:oe.length,at=0,Ot=[];++ye<Xe;){var li=oe[ye];ke(li,ye,oe)&&(Ot[at++]=li)}return Ot}function La(oe,ke){var ye=oe==null?0:oe.length;return!!ye&&tr(oe,ke,0)>-1}function Do(oe,ke,ye){for(var Xe=-1,at=oe==null?0:oe.length;++Xe<at;)if(ye(ke,oe[Xe]))return!0;return!1}function $t(oe,ke){for(var ye=-1,Xe=oe==null?0:oe.length,at=Array(Xe);++ye<Xe;)at[ye]=ke(oe[ye],ye,oe);return at}function $n(oe,ke){for(var ye=-1,Xe=ke.length,at=oe.length;++ye<Xe;)oe[at+ye]=ke[ye];return oe}function Oa(oe,ke,ye,Xe){var at=-1,Ot=oe==null?0:oe.length;for(Xe&&Ot&&(ye=oe[++at]);++at<Ot;)ye=ke(ye,oe[at],at,oe);return ye}function Qc(oe,ke,ye,Xe){var at=oe==null?0:oe.length;for(Xe&&at&&(ye=oe[--at]);at--;)ye=ke(ye,oe[at],at,oe);return ye}function Lo(oe,ke){for(var ye=-1,Xe=oe==null?0:oe.length;++ye<Xe;)if(ke(oe[ye],ye,oe))return!0;return!1}var ch=Rl("length");function Oo(oe){return oe.split("")}function bs(oe){return oe.match(G)||[]}function fh(oe,ke,ye){var Xe;return ye(oe,function(at,Ot,li){if(ke(at,Ot,li))return Xe=Ot,!1}),Xe}function qn(oe,ke,ye,Xe){for(var at=oe.length,Ot=ye+(Xe?1:-1);Xe?Ot--:++Ot<at;)if(ke(oe[Ot],Ot,oe))return Ot;return-1}function tr(oe,ke,ye){return ke===ke?s0(oe,ke,ye):qn(oe,ph,ye)}function dh(oe,ke,ye,Xe){for(var at=ye-1,Ot=oe.length;++at<Ot;)if(Xe(oe[at],ke))return at;return-1}function ph(oe){return oe!==oe}function Fl(oe,ke){var ye=oe==null?0:oe.length;return ye?Il(oe,ke)/ye:Fe}function Rl(oe){return function(ke){return ke==null?t:ke[oe]}}function Ma(oe){return function(ke){return oe==null?t:oe[ke]}}function Mo(oe,ke,ye,Xe,at){return at(oe,function(Ot,li,jt){ye=Xe?(Xe=!1,Ot):ke(ye,Ot,li,jt)}),ye}function e0(oe,ke){var ye=oe.length;for(oe.sort(ke);ye--;)oe[ye]=oe[ye].value;return oe}function Il(oe,ke){for(var ye,Xe=-1,at=oe.length;++Xe<at;){var Ot=ke(oe[Xe]);Ot!==t&&(ye=ye===t?Ot:ye+Ot)}return ye}function Fo(oe,ke){for(var ye=-1,Xe=Array(oe);++ye<oe;)Xe[ye]=ke(ye);return Xe}function t0(oe,ke){return $t(ke,function(ye){return[ye,oe[ye]]})}function Br(oe){return oe&&oe.slice(0,No(oe)+1).replace(Xi,"")}function Ei(oe){return function(ke){return oe(ke)}}function Bl(oe,ke){return $t(ke,function(ye){return oe[ye]})}function cn(oe,ke){return oe.has(ke)}function gh(oe,ke){for(var ye=-1,Xe=oe.length;++ye<Xe&&tr(ke,oe[ye],0)>-1;);return ye}function ws(oe,ke){for(var ye=oe.length;ye--&&tr(ke,oe[ye],0)>-1;);return ye}function i0(oe,ke){for(var ye=oe.length,Xe=0;ye--;)oe[ye]===ke&&++Xe;return Xe}var Fa=Ma(Cl),_h=Ma(Sl);function Ro(oe){return"\\"+Po[oe]}function r0(oe,ke){return oe==null?t:oe[ke]}function xr(oe){return Da.test(oe)}function Io(oe){return Rr.test(oe)}function n0(oe){for(var ke,ye=[];!(ke=oe.next()).done;)ye.push(ke.value);return ye}function Ra(oe){var ke=-1,ye=Array(oe.size);return oe.forEach(function(Xe,at){ye[++ke]=[at,Xe]}),ye}function mh(oe,ke){return function(ye){return oe(ke(ye))}}function Gi(oe,ke){for(var ye=-1,Xe=oe.length,at=0,Ot=[];++ye<Xe;){var li=oe[ye];(li===ke||li===p)&&(oe[ye]=p,Ot[at++]=ye)}return Ot}function Bo(oe){var ke=-1,ye=Array(oe.size);return oe.forEach(function(Xe){ye[++ke]=Xe}),ye}function qs(oe){var ke=-1,ye=Array(oe.size);return oe.forEach(function(Xe){ye[++ke]=[Xe,Xe]}),ye}function s0(oe,ke,ye){for(var Xe=ye-1,at=oe.length;++Xe<at;)if(oe[Xe]===ke)return Xe;return-1}function Dn(oe,ke,ye){for(var Xe=ye+1;Xe--;)if(oe[Xe]===ke)return Xe;return Xe}function Jn(oe){return xr(oe)?Nl(oe):ch(oe)}function Nr(oe){return xr(oe)?zo(oe):Oo(oe)}function No(oe){for(var ke=oe.length;ke--&&Vn.test(oe.charAt(ke)););return ke}var Ho=Ma(Dl);function Nl(oe){for(var ke=Sn.lastIndex=0;Sn.test(oe);)++ke;return ke}function zo(oe){return oe.match(Sn)||[]}function Js(oe){return oe.match(Al)||[]}var Uo=function oe(ke){ke=ke==null?qe:Qn.defaults(qe.Object(),ke,Qn.pick(qe,hn));var ye=ke.Array,Xe=ke.Date,at=ke.Error,Ot=ke.Function,li=ke.Math,jt=ke.Object,Qr=ke.RegExp,Qs=ke.String,Hr=ke.TypeError,Ln=ye.prototype,a0=Ot.prototype,Ts=jt.prototype,Wo=ke["__core-js_shared__"],es=a0.toString,Rt=Ts.hasOwnProperty,ea=0,Hl=function(){var u=/[^.]+$/.exec(Wo&&Wo.keys&&Wo.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Ia=Ts.toString,o0=es.call(jt),fn=qe._,xh=Qr("^"+es.call(Rt).replace(Ri,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ba=$s?ke.Buffer:t,zr=ke.Symbol,jo=ke.Uint8Array,Na=Ba?Ba.allocUnsafe:t,ts=mh(jt.getPrototypeOf,jt),zl=jt.create,Ul=Ts.propertyIsEnumerable,Xo=Ln.splice,Wl=zr?zr.isConcatSpreadable:t,ta=zr?zr.iterator:t,is=zr?zr.toStringTag:t,Ha=function(){try{var u=Ya(jt,"defineProperty");return u({},"",{}),u}catch{}}(),vh=ke.clearTimeout!==qe.clearTimeout&&ke.clearTimeout,yh=Xe&&Xe.now!==qe.Date.now&&Xe.now,bh=ke.setTimeout!==qe.setTimeout&&ke.setTimeout,Go=li.ceil,o=li.floor,f=jt.getOwnPropertySymbols,v=Ba?Ba.isBuffer:t,T=ke.isFinite,S=Ln.join,B=mh(jt.keys,jt),re=li.max,ue=li.min,be=Xe.now,Se=ke.parseInt,je=li.random,Ke=Ln.reverse,yt=Ya(ke,"DataView"),vr=Ya(ke,"Map"),On=Ya(ke,"Promise"),Mn=Ya(ke,"Set"),Ur=Ya(ke,"WeakMap"),ks=Ya(jt,"create"),Yo=Ur&&new Ur,ia={},l0=Va(yt),wh=Va(vr),u0=Va(On),Th=Va(Mn),ui=Va(Ur),Ps=zr?zr.prototype:t,za=Ps?Ps.valueOf:t,kh=Ps?Ps.toString:t;function H(u){if(hi(u)&&!ct(u)&&!(u instanceof kt)){if(u instanceof Wr)return u;if(Rt.call(u,"__wrapped__"))return ng(u)}return new Wr(u)}var rs=function(){function u(){}return function(d){if(!si(d))return{};if(zl)return zl(d);u.prototype=d;var y=new u;return u.prototype=t,y}}();function Ua(){}function Wr(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}H.templateSettings={escape:Ta,evaluate:gr,interpolate:Or,variable:"",imports:{_:H}},H.prototype=Ua.prototype,H.prototype.constructor=H,Wr.prototype=rs(Ua.prototype),Wr.prototype.constructor=Wr;function kt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function Vv(){var u=new kt(this.__wrapped__);return u.__actions__=jr(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=jr(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=jr(this.__views__),u}function Zv(){if(this.__filtered__){var u=new kt(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Kv(){var u=this.__wrapped__.value(),d=this.__dir__,y=ct(u),A=d<0,M=y?u.length:0,W=oy(0,M,this.__views__),ne=W.start,ae=W.end,le=ae-ne,Ae=A?ae:ne-1,Ce=this.__iteratees__,Me=Ce.length,Ue=0,Ye=ue(le,this.__takeCount__);if(!y||!A&&M==le&&Ye==le)return Ap(u,this.__actions__);var et=[];e:for(;le--&&Ue<Ye;){Ae+=d;for(var xt=-1,tt=u[Ae];++xt<Me;){var Tt=Ce[xt],At=Tt.iteratee,rn=Tt.type,wr=At(tt);if(rn==fe)tt=wr;else if(!wr){if(rn==pe)continue e;break e}}et[Ue++]=tt}return et}kt.prototype=rs(Ua.prototype),kt.prototype.constructor=kt;function Wa(u){var d=-1,y=u==null?0:u.length;for(this.clear();++d<y;){var A=u[d];this.set(A[0],A[1])}}function $v(){this.__data__=ks?ks(null):{},this.size=0}function qv(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function Jv(u){var d=this.__data__;if(ks){var y=d[u];return y===h?t:y}return Rt.call(d,u)?d[u]:t}function Qv(u){var d=this.__data__;return ks?d[u]!==t:Rt.call(d,u)}function e1(u,d){var y=this.__data__;return this.size+=this.has(u)?0:1,y[u]=ks&&d===t?h:d,this}Wa.prototype.clear=$v,Wa.prototype.delete=qv,Wa.prototype.get=Jv,Wa.prototype.has=Qv,Wa.prototype.set=e1;function Es(u){var d=-1,y=u==null?0:u.length;for(this.clear();++d<y;){var A=u[d];this.set(A[0],A[1])}}function t1(){this.__data__=[],this.size=0}function i1(u){var d=this.__data__,y=Ph(d,u);if(y<0)return!1;var A=d.length-1;return y==A?d.pop():Xo.call(d,y,1),--this.size,!0}function r1(u){var d=this.__data__,y=Ph(d,u);return y<0?t:d[y][1]}function n1(u){return Ph(this.__data__,u)>-1}function s1(u,d){var y=this.__data__,A=Ph(y,u);return A<0?(++this.size,y.push([u,d])):y[A][1]=d,this}Es.prototype.clear=t1,Es.prototype.delete=i1,Es.prototype.get=r1,Es.prototype.has=n1,Es.prototype.set=s1;function As(u){var d=-1,y=u==null?0:u.length;for(this.clear();++d<y;){var A=u[d];this.set(A[0],A[1])}}function a1(){this.size=0,this.__data__={hash:new Wa,map:new(vr||Es),string:new Wa}}function o1(u){var d=Bh(this,u).delete(u);return this.size-=d?1:0,d}function l1(u){return Bh(this,u).get(u)}function u1(u){return Bh(this,u).has(u)}function h1(u,d){var y=Bh(this,u),A=y.size;return y.set(u,d),this.size+=y.size==A?0:1,this}As.prototype.clear=a1,As.prototype.delete=o1,As.prototype.get=l1,As.prototype.has=u1,As.prototype.set=h1;function ja(u){var d=-1,y=u==null?0:u.length;for(this.__data__=new As;++d<y;)this.add(u[d])}function c1(u){return this.__data__.set(u,h),this}function f1(u){return this.__data__.has(u)}ja.prototype.add=ja.prototype.push=c1,ja.prototype.has=f1;function Fn(u){var d=this.__data__=new Es(u);this.size=d.size}function d1(){this.__data__=new Es,this.size=0}function p1(u){var d=this.__data__,y=d.delete(u);return this.size=d.size,y}function g1(u){return this.__data__.get(u)}function _1(u){return this.__data__.has(u)}function m1(u,d){var y=this.__data__;if(y instanceof Es){var A=y.__data__;if(!vr||A.length<n-1)return A.push([u,d]),this.size=++y.size,this;y=this.__data__=new As(A)}return y.set(u,d),this.size=y.size,this}Fn.prototype.clear=d1,Fn.prototype.delete=p1,Fn.prototype.get=g1,Fn.prototype.has=_1,Fn.prototype.set=m1;function np(u,d){var y=ct(u),A=!y&&Za(u),M=!y&&!A&&oa(u),W=!y&&!A&&!M&&$o(u),ne=y||A||M||W,ae=ne?Fo(u.length,Qs):[],le=ae.length;for(var Ae in u)(d||Rt.call(u,Ae))&&!(ne&&(Ae=="length"||M&&(Ae=="offset"||Ae=="parent")||W&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||Ls(Ae,le)))&&ae.push(Ae);return ae}function sp(u){var d=u.length;return d?u[y0(0,d-1)]:t}function x1(u,d){return Nh(jr(u),Xa(d,0,u.length))}function v1(u){return Nh(jr(u))}function h0(u,d,y){(y!==t&&!Rn(u[d],y)||y===t&&!(d in u))&&Cs(u,d,y)}function jl(u,d,y){var A=u[d];(!(Rt.call(u,d)&&Rn(A,y))||y===t&&!(d in u))&&Cs(u,d,y)}function Ph(u,d){for(var y=u.length;y--;)if(Rn(u[y][0],d))return y;return-1}function y1(u,d,y,A){return ra(u,function(M,W,ne){d(A,M,y(M),ne)}),A}function ap(u,d){return u&&ss(d,Yi(d),u)}function b1(u,d){return u&&ss(d,Gr(d),u)}function Cs(u,d,y){d=="__proto__"&&Ha?Ha(u,d,{configurable:!0,enumerable:!0,value:y,writable:!0}):u[d]=y}function c0(u,d){for(var y=-1,A=d.length,M=ye(A),W=u==null;++y<A;)M[y]=W?t:G0(u,d[y]);return M}function Xa(u,d,y){return u===u&&(y!==t&&(u=u<=y?u:y),d!==t&&(u=u>=d?u:d)),u}function dn(u,d,y,A,M,W){var ne,ae=d&g,le=d&m,Ae=d&_;if(y&&(ne=M?y(u,A,M,W):y(u)),ne!==t)return ne;if(!si(u))return u;var Ce=ct(u);if(Ce){if(ne=uy(u),!ae)return jr(u,ne)}else{var Me=ir(u),Ue=Me==te||Me==ft;if(oa(u))return Dp(u,ae);if(Me==Be||Me==ie||Ue&&!M){if(ne=le||Ue?{}:Kp(u),!ae)return le?J1(u,b1(ne,u)):q1(u,ap(ne,u))}else{if(!Wt[Me])return M?u:{};ne=hy(u,Me,ae)}}W||(W=new Fn);var Ye=W.get(u);if(Ye)return Ye;W.set(u,ne),kg(u)?u.forEach(function(tt){ne.add(dn(tt,d,y,tt,u,W))}):wg(u)&&u.forEach(function(tt,Tt){ne.set(Tt,dn(tt,d,y,Tt,u,W))});var et=Ae?le?L0:D0:le?Gr:Yi,xt=Ce?t:et(u);return mr(xt||u,function(tt,Tt){xt&&(Tt=tt,tt=u[Tt]),jl(ne,Tt,dn(tt,d,y,Tt,u,W))}),ne}function w1(u){var d=Yi(u);return function(y){return op(y,u,d)}}function op(u,d,y){var A=y.length;if(u==null)return!A;for(u=jt(u);A--;){var M=y[A],W=d[M],ne=u[M];if(ne===t&&!(M in u)||!W(ne))return!1}return!0}function lp(u,d,y){if(typeof u!="function")throw new Hr(a);return $l(function(){u.apply(t,y)},d)}function Xl(u,d,y,A){var M=-1,W=La,ne=!0,ae=u.length,le=[],Ae=d.length;if(!ae)return le;y&&(d=$t(d,Ei(y))),A?(W=Do,ne=!1):d.length>=n&&(W=cn,ne=!1,d=new ja(d));e:for(;++M<ae;){var Ce=u[M],Me=y==null?Ce:y(Ce);if(Ce=A||Ce!==0?Ce:0,ne&&Me===Me){for(var Ue=Ae;Ue--;)if(d[Ue]===Me)continue e;le.push(Ce)}else W(d,Me,A)||le.push(Ce)}return le}var ra=Rp(ns),up=Rp(d0,!0);function T1(u,d){var y=!0;return ra(u,function(A,M,W){return y=!!d(A,M,W),y}),y}function Eh(u,d,y){for(var A=-1,M=u.length;++A<M;){var W=u[A],ne=d(W);if(ne!=null&&(ae===t?ne===ne&&!tn(ne):y(ne,ae)))var ae=ne,le=W}return le}function k1(u,d,y,A){var M=u.length;for(y=pt(y),y<0&&(y=-y>M?0:M+y),A=A===t||A>M?M:pt(A),A<0&&(A+=M),A=y>A?0:Eg(A);y<A;)u[y++]=d;return u}function hp(u,d){var y=[];return ra(u,function(A,M,W){d(A,M,W)&&y.push(A)}),y}function Ki(u,d,y,A,M){var W=-1,ne=u.length;for(y||(y=fy),M||(M=[]);++W<ne;){var ae=u[W];d>0&&y(ae)?d>1?Ki(ae,d-1,y,A,M):$n(M,ae):A||(M[M.length]=ae)}return M}var f0=Ip(),cp=Ip(!0);function ns(u,d){return u&&f0(u,d,Yi)}function d0(u,d){return u&&cp(u,d,Yi)}function Ah(u,d){return er(d,function(y){return Os(u[y])})}function Ga(u,d){d=sa(d,u);for(var y=0,A=d.length;u!=null&&y<A;)u=u[as(d[y++])];return y&&y==A?u:t}function fp(u,d,y){var A=d(u);return ct(u)?A:$n(A,y(u))}function yr(u){return u==null?u===t?Kt:rt:is&&is in jt(u)?ay(u):vy(u)}function p0(u,d){return u>d}function P1(u,d){return u!=null&&Rt.call(u,d)}function E1(u,d){return u!=null&&d in jt(u)}function A1(u,d,y){return u>=ue(d,y)&&u<re(d,y)}function g0(u,d,y){for(var A=y?Do:La,M=u[0].length,W=u.length,ne=W,ae=ye(W),le=1/0,Ae=[];ne--;){var Ce=u[ne];ne&&d&&(Ce=$t(Ce,Ei(d))),le=ue(Ce.length,le),ae[ne]=!y&&(d||M>=120&&Ce.length>=120)?new ja(ne&&Ce):t}Ce=u[0];var Me=-1,Ue=ae[0];e:for(;++Me<M&&Ae.length<le;){var Ye=Ce[Me],et=d?d(Ye):Ye;if(Ye=y||Ye!==0?Ye:0,!(Ue?cn(Ue,et):A(Ae,et,y))){for(ne=W;--ne;){var xt=ae[ne];if(!(xt?cn(xt,et):A(u[ne],et,y)))continue e}Ue&&Ue.push(et),Ae.push(Ye)}}return Ae}function C1(u,d,y,A){return ns(u,function(M,W,ne){d(A,y(M),W,ne)}),A}function Gl(u,d,y){d=sa(d,u),u=Qp(u,d);var A=u==null?u:u[as(gn(d))];return A==null?t:ei(A,u,y)}function dp(u){return hi(u)&&yr(u)==ie}function S1(u){return hi(u)&&yr(u)==pi}function D1(u){return hi(u)&&yr(u)==Oe}function Yl(u,d,y,A,M){return u===d?!0:u==null||d==null||!hi(u)&&!hi(d)?u!==u&&d!==d:L1(u,d,y,A,Yl,M)}function L1(u,d,y,A,M,W){var ne=ct(u),ae=ct(d),le=ne?he:ir(u),Ae=ae?he:ir(d);le=le==ie?Be:le,Ae=Ae==ie?Be:Ae;var Ce=le==Be,Me=Ae==Be,Ue=le==Ae;if(Ue&&oa(u)){if(!oa(d))return!1;ne=!0,Ce=!1}if(Ue&&!Ce)return W||(W=new Fn),ne||$o(u)?Yp(u,d,y,A,M,W):ny(u,d,le,y,A,M,W);if(!(y&b)){var Ye=Ce&&Rt.call(u,"__wrapped__"),et=Me&&Rt.call(d,"__wrapped__");if(Ye||et){var xt=Ye?u.value():u,tt=et?d.value():d;return W||(W=new Fn),M(xt,tt,y,A,W)}}return Ue?(W||(W=new Fn),sy(u,d,y,A,M,W)):!1}function O1(u){return hi(u)&&ir(u)==Ge}function _0(u,d,y,A){var M=y.length,W=M,ne=!A;if(u==null)return!W;for(u=jt(u);M--;){var ae=y[M];if(ne&&ae[2]?ae[1]!==u[ae[0]]:!(ae[0]in u))return!1}for(;++M<W;){ae=y[M];var le=ae[0],Ae=u[le],Ce=ae[1];if(ne&&ae[2]){if(Ae===t&&!(le in u))return!1}else{var Me=new Fn;if(A)var Ue=A(Ae,Ce,le,u,d,Me);if(!(Ue===t?Yl(Ce,Ae,b|x,A,Me):Ue))return!1}}return!0}function pp(u){if(!si(u)||py(u))return!1;var d=Os(u)?xh:me;return d.test(Va(u))}function M1(u){return hi(u)&&yr(u)==Ht}function F1(u){return hi(u)&&ir(u)==vt}function R1(u){return hi(u)&&Xh(u.length)&&!!Vt[yr(u)]}function gp(u){return typeof u=="function"?u:u==null?Yr:typeof u=="object"?ct(u)?xp(u[0],u[1]):mp(u):Bg(u)}function m0(u){if(!Kl(u))return B(u);var d=[];for(var y in jt(u))Rt.call(u,y)&&y!="constructor"&&d.push(y);return d}function I1(u){if(!si(u))return xy(u);var d=Kl(u),y=[];for(var A in u)A=="constructor"&&(d||!Rt.call(u,A))||y.push(A);return y}function x0(u,d){return u<d}function _p(u,d){var y=-1,A=Xr(u)?ye(u.length):[];return ra(u,function(M,W,ne){A[++y]=d(M,W,ne)}),A}function mp(u){var d=M0(u);return d.length==1&&d[0][2]?qp(d[0][0],d[0][1]):function(y){return y===u||_0(y,u,d)}}function xp(u,d){return R0(u)&&$p(d)?qp(as(u),d):function(y){var A=G0(y,u);return A===t&&A===d?Y0(y,u):Yl(d,A,b|x)}}function Ch(u,d,y,A,M){u!==d&&f0(d,function(W,ne){if(M||(M=new Fn),si(W))B1(u,d,ne,y,Ch,A,M);else{var ae=A?A(B0(u,ne),W,ne+"",u,d,M):t;ae===t&&(ae=W),h0(u,ne,ae)}},Gr)}function B1(u,d,y,A,M,W,ne){var ae=B0(u,y),le=B0(d,y),Ae=ne.get(le);if(Ae){h0(u,y,Ae);return}var Ce=W?W(ae,le,y+"",u,d,ne):t,Me=Ce===t;if(Me){var Ue=ct(le),Ye=!Ue&&oa(le),et=!Ue&&!Ye&&$o(le);Ce=le,Ue||Ye||et?ct(ae)?Ce=ae:mi(ae)?Ce=jr(ae):Ye?(Me=!1,Ce=Dp(le,!0)):et?(Me=!1,Ce=Lp(le,!0)):Ce=[]:ql(le)||Za(le)?(Ce=ae,Za(ae)?Ce=Ag(ae):(!si(ae)||Os(ae))&&(Ce=Kp(le))):Me=!1}Me&&(ne.set(le,Ce),M(Ce,le,A,W,ne),ne.delete(le)),h0(u,y,Ce)}function vp(u,d){var y=u.length;if(y)return d+=d<0?y:0,Ls(d,y)?u[d]:t}function yp(u,d,y){d.length?d=$t(d,function(W){return ct(W)?function(ne){return Ga(ne,W.length===1?W[0]:W)}:W}):d=[Yr];var A=-1;d=$t(d,Ei(Je()));var M=_p(u,function(W,ne,ae){var le=$t(d,function(Ae){return Ae(W)});return{criteria:le,index:++A,value:W}});return e0(M,function(W,ne){return $1(W,ne,y)})}function N1(u,d){return bp(u,d,function(y,A){return Y0(u,A)})}function bp(u,d,y){for(var A=-1,M=d.length,W={};++A<M;){var ne=d[A],ae=Ga(u,ne);y(ae,ne)&&Vl(W,sa(ne,u),ae)}return W}function H1(u){return function(d){return Ga(d,u)}}function v0(u,d,y,A){var M=A?dh:tr,W=-1,ne=d.length,ae=u;for(u===d&&(d=jr(d)),y&&(ae=$t(u,Ei(y)));++W<ne;)for(var le=0,Ae=d[W],Ce=y?y(Ae):Ae;(le=M(ae,Ce,le,A))>-1;)ae!==u&&Xo.call(ae,le,1),Xo.call(u,le,1);return u}function wp(u,d){for(var y=u?d.length:0,A=y-1;y--;){var M=d[y];if(y==A||M!==W){var W=M;Ls(M)?Xo.call(u,M,1):T0(u,M)}}return u}function y0(u,d){return u+o(je()*(d-u+1))}function z1(u,d,y,A){for(var M=-1,W=re(Go((d-u)/(y||1)),0),ne=ye(W);W--;)ne[A?W:++M]=u,u+=y;return ne}function b0(u,d){var y="";if(!u||d<1||d>De)return y;do d%2&&(y+=u),d=o(d/2),d&&(u+=u);while(d);return y}function bt(u,d){return N0(Jp(u,d,Yr),u+"")}function U1(u){return sp(qo(u))}function W1(u,d){var y=qo(u);return Nh(y,Xa(d,0,y.length))}function Vl(u,d,y,A){if(!si(u))return u;d=sa(d,u);for(var M=-1,W=d.length,ne=W-1,ae=u;ae!=null&&++M<W;){var le=as(d[M]),Ae=y;if(le==="__proto__"||le==="constructor"||le==="prototype")return u;if(M!=ne){var Ce=ae[le];Ae=A?A(Ce,le,ae):t,Ae===t&&(Ae=si(Ce)?Ce:Ls(d[M+1])?[]:{})}jl(ae,le,Ae),ae=ae[le]}return u}var Tp=Yo?function(u,d){return Yo.set(u,d),u}:Yr,j1=Ha?function(u,d){return Ha(u,"toString",{configurable:!0,enumerable:!1,value:Z0(d),writable:!0})}:Yr;function X1(u){return Nh(qo(u))}function pn(u,d,y){var A=-1,M=u.length;d<0&&(d=-d>M?0:M+d),y=y>M?M:y,y<0&&(y+=M),M=d>y?0:y-d>>>0,d>>>=0;for(var W=ye(M);++A<M;)W[A]=u[A+d];return W}function G1(u,d){var y;return ra(u,function(A,M,W){return y=d(A,M,W),!y}),!!y}function Sh(u,d,y){var A=0,M=u==null?A:u.length;if(typeof d=="number"&&d===d&&M<=J){for(;A<M;){var W=A+M>>>1,ne=u[W];ne!==null&&!tn(ne)&&(y?ne<=d:ne<d)?A=W+1:M=W}return M}return w0(u,d,Yr,y)}function w0(u,d,y,A){var M=0,W=u==null?0:u.length;if(W===0)return 0;d=y(d);for(var ne=d!==d,ae=d===null,le=tn(d),Ae=d===t;M<W;){var Ce=o((M+W)/2),Me=y(u[Ce]),Ue=Me!==t,Ye=Me===null,et=Me===Me,xt=tn(Me);if(ne)var tt=A||et;else Ae?tt=et&&(A||Ue):ae?tt=et&&Ue&&(A||!Ye):le?tt=et&&Ue&&!Ye&&(A||!xt):Ye||xt?tt=!1:tt=A?Me<=d:Me<d;tt?M=Ce+1:W=Ce}return ue(W,R)}function kp(u,d){for(var y=-1,A=u.length,M=0,W=[];++y<A;){var ne=u[y],ae=d?d(ne):ne;if(!y||!Rn(ae,le)){var le=ae;W[M++]=ne===0?0:ne}}return W}function Pp(u){return typeof u=="number"?u:tn(u)?Fe:+u}function en(u){if(typeof u=="string")return u;if(ct(u))return $t(u,en)+"";if(tn(u))return kh?kh.call(u):"";var d=u+"";return d=="0"&&1/u==-de?"-0":d}function na(u,d,y){var A=-1,M=La,W=u.length,ne=!0,ae=[],le=ae;if(y)ne=!1,M=Do;else if(W>=n){var Ae=d?null:iy(u);if(Ae)return Bo(Ae);ne=!1,M=cn,le=new ja}else le=d?[]:ae;e:for(;++A<W;){var Ce=u[A],Me=d?d(Ce):Ce;if(Ce=y||Ce!==0?Ce:0,ne&&Me===Me){for(var Ue=le.length;Ue--;)if(le[Ue]===Me)continue e;d&&le.push(Me),ae.push(Ce)}else M(le,Me,y)||(le!==ae&&le.push(Me),ae.push(Ce))}return ae}function T0(u,d){return d=sa(d,u),u=Qp(u,d),u==null||delete u[as(gn(d))]}function Ep(u,d,y,A){return Vl(u,d,y(Ga(u,d)),A)}function Dh(u,d,y,A){for(var M=u.length,W=A?M:-1;(A?W--:++W<M)&&d(u[W],W,u););return y?pn(u,A?0:W,A?W+1:M):pn(u,A?W+1:0,A?M:W)}function Ap(u,d){var y=u;return y instanceof kt&&(y=y.value()),Oa(d,function(A,M){return M.func.apply(M.thisArg,$n([A],M.args))},y)}function k0(u,d,y){var A=u.length;if(A<2)return A?na(u[0]):[];for(var M=-1,W=ye(A);++M<A;)for(var ne=u[M],ae=-1;++ae<A;)ae!=M&&(W[M]=Xl(W[M]||ne,u[ae],d,y));return na(Ki(W,1),d,y)}function Cp(u,d,y){for(var A=-1,M=u.length,W=d.length,ne={};++A<M;){var ae=A<W?d[A]:t;y(ne,u[A],ae)}return ne}function P0(u){return mi(u)?u:[]}function E0(u){return typeof u=="function"?u:Yr}function sa(u,d){return ct(u)?u:R0(u,d)?[u]:rg(Nt(u))}var Y1=bt;function aa(u,d,y){var A=u.length;return y=y===t?A:y,!d&&y>=A?u:pn(u,d,y)}var Sp=vh||function(u){return qe.clearTimeout(u)};function Dp(u,d){if(d)return u.slice();var y=u.length,A=Na?Na(y):new u.constructor(y);return u.copy(A),A}function A0(u){var d=new u.constructor(u.byteLength);return new jo(d).set(new jo(u)),d}function V1(u,d){var y=d?A0(u.buffer):u.buffer;return new u.constructor(y,u.byteOffset,u.byteLength)}function Z1(u){var d=new u.constructor(u.source,_e.exec(u));return d.lastIndex=u.lastIndex,d}function K1(u){return za?jt(za.call(u)):{}}function Lp(u,d){var y=d?A0(u.buffer):u.buffer;return new u.constructor(y,u.byteOffset,u.length)}function Op(u,d){if(u!==d){var y=u!==t,A=u===null,M=u===u,W=tn(u),ne=d!==t,ae=d===null,le=d===d,Ae=tn(d);if(!ae&&!Ae&&!W&&u>d||W&&ne&&le&&!ae&&!Ae||A&&ne&&le||!y&&le||!M)return 1;if(!A&&!W&&!Ae&&u<d||Ae&&y&&M&&!A&&!W||ae&&y&&M||!ne&&M||!le)return-1}return 0}function $1(u,d,y){for(var A=-1,M=u.criteria,W=d.criteria,ne=M.length,ae=y.length;++A<ne;){var le=Op(M[A],W[A]);if(le){if(A>=ae)return le;var Ae=y[A];return le*(Ae=="desc"?-1:1)}}return u.index-d.index}function Mp(u,d,y,A){for(var M=-1,W=u.length,ne=y.length,ae=-1,le=d.length,Ae=re(W-ne,0),Ce=ye(le+Ae),Me=!A;++ae<le;)Ce[ae]=d[ae];for(;++M<ne;)(Me||M<W)&&(Ce[y[M]]=u[M]);for(;Ae--;)Ce[ae++]=u[M++];return Ce}function Fp(u,d,y,A){for(var M=-1,W=u.length,ne=-1,ae=y.length,le=-1,Ae=d.length,Ce=re(W-ae,0),Me=ye(Ce+Ae),Ue=!A;++M<Ce;)Me[M]=u[M];for(var Ye=M;++le<Ae;)Me[Ye+le]=d[le];for(;++ne<ae;)(Ue||M<W)&&(Me[Ye+y[ne]]=u[M++]);return Me}function jr(u,d){var y=-1,A=u.length;for(d||(d=ye(A));++y<A;)d[y]=u[y];return d}function ss(u,d,y,A){var M=!y;y||(y={});for(var W=-1,ne=d.length;++W<ne;){var ae=d[W],le=A?A(y[ae],u[ae],ae,y,u):t;le===t&&(le=u[ae]),M?Cs(y,ae,le):jl(y,ae,le)}return y}function q1(u,d){return ss(u,F0(u),d)}function J1(u,d){return ss(u,Vp(u),d)}function Lh(u,d){return function(y,A){var M=ct(y)?Jc:y1,W=d?d():{};return M(y,u,Je(A,2),W)}}function Vo(u){return bt(function(d,y){var A=-1,M=y.length,W=M>1?y[M-1]:t,ne=M>2?y[2]:t;for(W=u.length>3&&typeof W=="function"?(M--,W):t,ne&&br(y[0],y[1],ne)&&(W=M<3?t:W,M=1),d=jt(d);++A<M;){var ae=y[A];ae&&u(d,ae,A,W)}return d})}function Rp(u,d){return function(y,A){if(y==null)return y;if(!Xr(y))return u(y,A);for(var M=y.length,W=d?M:-1,ne=jt(y);(d?W--:++W<M)&&A(ne[W],W,ne)!==!1;);return y}}function Ip(u){return function(d,y,A){for(var M=-1,W=jt(d),ne=A(d),ae=ne.length;ae--;){var le=ne[u?ae:++M];if(y(W[le],le,W)===!1)break}return d}}function Q1(u,d,y){var A=d&w,M=Zl(u);function W(){var ne=this&&this!==qe&&this instanceof W?M:u;return ne.apply(A?y:this,arguments)}return W}function Bp(u){return function(d){d=Nt(d);var y=xr(d)?Nr(d):t,A=y?y[0]:d.charAt(0),M=y?aa(y,1).join(""):d.slice(1);return A[u]()+M}}function Zo(u){return function(d){return Oa(Rg(Fg(d).replace(ko,"")),u,"")}}function Zl(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var y=rs(u.prototype),A=u.apply(y,d);return si(A)?A:y}}function ey(u,d,y){var A=Zl(u);function M(){for(var W=arguments.length,ne=ye(W),ae=W,le=Ko(M);ae--;)ne[ae]=arguments[ae];var Ae=W<3&&ne[0]!==le&&ne[W-1]!==le?[]:Gi(ne,le);if(W-=Ae.length,W<y)return Wp(u,d,Oh,M.placeholder,t,ne,Ae,t,t,y-W);var Ce=this&&this!==qe&&this instanceof M?A:u;return ei(Ce,this,ne)}return M}function Np(u){return function(d,y,A){var M=jt(d);if(!Xr(d)){var W=Je(y,3);d=Yi(d),y=function(ae){return W(M[ae],ae,M)}}var ne=u(d,y,A);return ne>-1?M[W?d[ne]:ne]:t}}function Hp(u){return Ds(function(d){var y=d.length,A=y,M=Wr.prototype.thru;for(u&&d.reverse();A--;){var W=d[A];if(typeof W!="function")throw new Hr(a);if(M&&!ne&&Ih(W)=="wrapper")var ne=new Wr([],!0)}for(A=ne?A:y;++A<y;){W=d[A];var ae=Ih(W),le=ae=="wrapper"?O0(W):t;le&&I0(le[0])&&le[1]==(D|k|O|N)&&!le[4].length&&le[9]==1?ne=ne[Ih(le[0])].apply(ne,le[3]):ne=W.length==1&&I0(W)?ne[ae]():ne.thru(W)}return function(){var Ae=arguments,Ce=Ae[0];if(ne&&Ae.length==1&&ct(Ce))return ne.plant(Ce).value();for(var Me=0,Ue=y?d[Me].apply(this,Ae):Ce;++Me<y;)Ue=d[Me].call(this,Ue);return Ue}})}function Oh(u,d,y,A,M,W,ne,ae,le,Ae){var Ce=d&D,Me=d&w,Ue=d&P,Ye=d&(k|C),et=d&X,xt=Ue?t:Zl(u);function tt(){for(var Tt=arguments.length,At=ye(Tt),rn=Tt;rn--;)At[rn]=arguments[rn];if(Ye)var wr=Ko(tt),nn=i0(At,wr);if(A&&(At=Mp(At,A,M,Ye)),W&&(At=Fp(At,W,ne,Ye)),Tt-=nn,Ye&&Tt<Ae){var xi=Gi(At,wr);return Wp(u,d,Oh,tt.placeholder,y,At,xi,ae,le,Ae-Tt)}var In=Me?y:this,Fs=Ue?In[u]:u;return Tt=At.length,ae?At=yy(At,ae):et&&Tt>1&&At.reverse(),Ce&&le<Tt&&(At.length=le),this&&this!==qe&&this instanceof tt&&(Fs=xt||Zl(Fs)),Fs.apply(In,At)}return tt}function zp(u,d){return function(y,A){return C1(y,u,d(A),{})}}function Mh(u,d){return function(y,A){var M;if(y===t&&A===t)return d;if(y!==t&&(M=y),A!==t){if(M===t)return A;typeof y=="string"||typeof A=="string"?(y=en(y),A=en(A)):(y=Pp(y),A=Pp(A)),M=u(y,A)}return M}}function C0(u){return Ds(function(d){return d=$t(d,Ei(Je())),bt(function(y){var A=this;return u(d,function(M){return ei(M,A,y)})})})}function Fh(u,d){d=d===t?" ":en(d);var y=d.length;if(y<2)return y?b0(d,u):d;var A=b0(d,Go(u/Jn(d)));return xr(d)?aa(Nr(A),0,u).join(""):A.slice(0,u)}function ty(u,d,y,A){var M=d&w,W=Zl(u);function ne(){for(var ae=-1,le=arguments.length,Ae=-1,Ce=A.length,Me=ye(Ce+le),Ue=this&&this!==qe&&this instanceof ne?W:u;++Ae<Ce;)Me[Ae]=A[Ae];for(;le--;)Me[Ae++]=arguments[++ae];return ei(Ue,M?y:this,Me)}return ne}function Up(u){return function(d,y,A){return A&&typeof A!="number"&&br(d,y,A)&&(y=A=t),d=Ms(d),y===t?(y=d,d=0):y=Ms(y),A=A===t?d<y?1:-1:Ms(A),z1(d,y,A,u)}}function Rh(u){return function(d,y){return typeof d=="string"&&typeof y=="string"||(d=_n(d),y=_n(y)),u(d,y)}}function Wp(u,d,y,A,M,W,ne,ae,le,Ae){var Ce=d&k,Me=Ce?ne:t,Ue=Ce?t:ne,Ye=Ce?W:t,et=Ce?t:W;d|=Ce?O:F,d&=~(Ce?F:O),d&E||(d&=~(w|P));var xt=[u,d,M,Ye,Me,et,Ue,ae,le,Ae],tt=y.apply(t,xt);return I0(u)&&eg(tt,xt),tt.placeholder=A,tg(tt,u,d)}function S0(u){var d=li[u];return function(y,A){if(y=_n(y),A=A==null?0:ue(pt(A),292),A&&T(y)){var M=(Nt(y)+"e").split("e"),W=d(M[0]+"e"+(+M[1]+A));return M=(Nt(W)+"e").split("e"),+(M[0]+"e"+(+M[1]-A))}return d(y)}}var iy=Mn&&1/Bo(new Mn([,-0]))[1]==de?function(u){return new Mn(u)}:q0;function jp(u){return function(d){var y=ir(d);return y==Ge?Ra(d):y==vt?qs(d):t0(d,u(d))}}function Ss(u,d,y,A,M,W,ne,ae){var le=d&P;if(!le&&typeof u!="function")throw new Hr(a);var Ae=A?A.length:0;if(Ae||(d&=~(O|F),A=M=t),ne=ne===t?ne:re(pt(ne),0),ae=ae===t?ae:pt(ae),Ae-=M?M.length:0,d&F){var Ce=A,Me=M;A=M=t}var Ue=le?t:O0(u),Ye=[u,d,y,A,M,Ce,Me,W,ne,ae];if(Ue&&my(Ye,Ue),u=Ye[0],d=Ye[1],y=Ye[2],A=Ye[3],M=Ye[4],ae=Ye[9]=Ye[9]===t?le?0:u.length:re(Ye[9]-Ae,0),!ae&&d&(k|C)&&(d&=~(k|C)),!d||d==w)var et=Q1(u,d,y);else d==k||d==C?et=ey(u,d,ae):(d==O||d==(w|O))&&!M.length?et=ty(u,d,y,A):et=Oh.apply(t,Ye);var xt=Ue?Tp:eg;return tg(xt(et,Ye),u,d)}function Xp(u,d,y,A){return u===t||Rn(u,Ts[y])&&!Rt.call(A,y)?d:u}function Gp(u,d,y,A,M,W){return si(u)&&si(d)&&(W.set(d,u),Ch(u,d,t,Gp,W),W.delete(d)),u}function ry(u){return ql(u)?t:u}function Yp(u,d,y,A,M,W){var ne=y&b,ae=u.length,le=d.length;if(ae!=le&&!(ne&&le>ae))return!1;var Ae=W.get(u),Ce=W.get(d);if(Ae&&Ce)return Ae==d&&Ce==u;var Me=-1,Ue=!0,Ye=y&x?new ja:t;for(W.set(u,d),W.set(d,u);++Me<ae;){var et=u[Me],xt=d[Me];if(A)var tt=ne?A(xt,et,Me,d,u,W):A(et,xt,Me,u,d,W);if(tt!==t){if(tt)continue;Ue=!1;break}if(Ye){if(!Lo(d,function(Tt,At){if(!cn(Ye,At)&&(et===Tt||M(et,Tt,y,A,W)))return Ye.push(At)})){Ue=!1;break}}else if(!(et===xt||M(et,xt,y,A,W))){Ue=!1;break}}return W.delete(u),W.delete(d),Ue}function ny(u,d,y,A,M,W,ne){switch(y){case Bt:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case pi:return!(u.byteLength!=d.byteLength||!W(new jo(u),new jo(d)));case we:case Oe:case _t:return Rn(+u,+d);case it:return u.name==d.name&&u.message==d.message;case Ht:case zt:return u==d+"";case Ge:var ae=Ra;case vt:var le=A&b;if(ae||(ae=Bo),u.size!=d.size&&!le)return!1;var Ae=ne.get(u);if(Ae)return Ae==d;A|=x,ne.set(u,d);var Ce=Yp(ae(u),ae(d),A,M,W,ne);return ne.delete(u),Ce;case Ut:if(za)return za.call(u)==za.call(d)}return!1}function sy(u,d,y,A,M,W){var ne=y&b,ae=D0(u),le=ae.length,Ae=D0(d),Ce=Ae.length;if(le!=Ce&&!ne)return!1;for(var Me=le;Me--;){var Ue=ae[Me];if(!(ne?Ue in d:Rt.call(d,Ue)))return!1}var Ye=W.get(u),et=W.get(d);if(Ye&&et)return Ye==d&&et==u;var xt=!0;W.set(u,d),W.set(d,u);for(var tt=ne;++Me<le;){Ue=ae[Me];var Tt=u[Ue],At=d[Ue];if(A)var rn=ne?A(At,Tt,Ue,d,u,W):A(Tt,At,Ue,u,d,W);if(!(rn===t?Tt===At||M(Tt,At,y,A,W):rn)){xt=!1;break}tt||(tt=Ue=="constructor")}if(xt&&!tt){var wr=u.constructor,nn=d.constructor;wr!=nn&&"constructor"in u&&"constructor"in d&&!(typeof wr=="function"&&wr instanceof wr&&typeof nn=="function"&&nn instanceof nn)&&(xt=!1)}return W.delete(u),W.delete(d),xt}function Ds(u){return N0(Jp(u,t,og),u+"")}function D0(u){return fp(u,Yi,F0)}function L0(u){return fp(u,Gr,Vp)}var O0=Yo?function(u){return Yo.get(u)}:q0;function Ih(u){for(var d=u.name+"",y=ia[d],A=Rt.call(ia,d)?y.length:0;A--;){var M=y[A],W=M.func;if(W==null||W==u)return M.name}return d}function Ko(u){var d=Rt.call(H,"placeholder")?H:u;return d.placeholder}function Je(){var u=H.iteratee||K0;return u=u===K0?gp:u,arguments.length?u(arguments[0],arguments[1]):u}function Bh(u,d){var y=u.__data__;return dy(d)?y[typeof d=="string"?"string":"hash"]:y.map}function M0(u){for(var d=Yi(u),y=d.length;y--;){var A=d[y],M=u[A];d[y]=[A,M,$p(M)]}return d}function Ya(u,d){var y=r0(u,d);return pp(y)?y:t}function ay(u){var d=Rt.call(u,is),y=u[is];try{u[is]=t;var A=!0}catch{}var M=Ia.call(u);return A&&(d?u[is]=y:delete u[is]),M}var F0=f?function(u){return u==null?[]:(u=jt(u),er(f(u),function(d){return Ul.call(u,d)}))}:J0,Vp=f?function(u){for(var d=[];u;)$n(d,F0(u)),u=ts(u);return d}:J0,ir=yr;(yt&&ir(new yt(new ArrayBuffer(1)))!=Bt||vr&&ir(new vr)!=Ge||On&&ir(On.resolve())!=St||Mn&&ir(new Mn)!=vt||Ur&&ir(new Ur)!=Ti)&&(ir=function(u){var d=yr(u),y=d==Be?u.constructor:t,A=y?Va(y):"";if(A)switch(A){case l0:return Bt;case wh:return Ge;case u0:return St;case Th:return vt;case ui:return Ti}return d});function oy(u,d,y){for(var A=-1,M=y.length;++A<M;){var W=y[A],ne=W.size;switch(W.type){case"drop":u+=ne;break;case"dropRight":d-=ne;break;case"take":d=ue(d,u+ne);break;case"takeRight":u=re(u,d-ne);break}}return{start:u,end:d}}function ly(u){var d=u.match(I);return d?d[1].split(Z):[]}function Zp(u,d,y){d=sa(d,u);for(var A=-1,M=d.length,W=!1;++A<M;){var ne=as(d[A]);if(!(W=u!=null&&y(u,ne)))break;u=u[ne]}return W||++A!=M?W:(M=u==null?0:u.length,!!M&&Xh(M)&&Ls(ne,M)&&(ct(u)||Za(u)))}function uy(u){var d=u.length,y=new u.constructor(d);return d&&typeof u[0]=="string"&&Rt.call(u,"index")&&(y.index=u.index,y.input=u.input),y}function Kp(u){return typeof u.constructor=="function"&&!Kl(u)?rs(ts(u)):{}}function hy(u,d,y){var A=u.constructor;switch(d){case pi:return A0(u);case we:case Oe:return new A(+u);case Bt:return V1(u,y);case gi:case nt:case Pt:case Jt:case Xt:case ji:case qr:case Gn:case Pi:return Lp(u,y);case Ge:return new A;case _t:case zt:return new A(u);case Ht:return Z1(u);case vt:return new A;case Ut:return K1(u)}}function cy(u,d){var y=d.length;if(!y)return u;var A=y-1;return d[A]=(y>1?"& ":"")+d[A],d=d.join(y>2?", ":" "),u.replace(_s,`{
/* [wrapped with `+d+`] */
`)}function fy(u){return ct(u)||Za(u)||!!(Wl&&u&&u[Wl])}function Ls(u,d){var y=typeof u;return d=d??De,!!d&&(y=="number"||y!="symbol"&&Re.test(u))&&u>-1&&u%1==0&&u<d}function br(u,d,y){if(!si(y))return!1;var A=typeof d;return(A=="number"?Xr(y)&&Ls(d,y.length):A=="string"&&d in y)?Rn(y[d],u):!1}function R0(u,d){if(ct(u))return!1;var y=typeof u;return y=="number"||y=="symbol"||y=="boolean"||u==null||tn(u)?!0:Pn.test(u)||!Vs.test(u)||d!=null&&u in jt(d)}function dy(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function I0(u){var d=Ih(u),y=H[d];if(typeof y!="function"||!(d in kt.prototype))return!1;if(u===y)return!0;var A=O0(y);return!!A&&u===A[0]}function py(u){return!!Hl&&Hl in u}var gy=Wo?Os:Q0;function Kl(u){var d=u&&u.constructor,y=typeof d=="function"&&d.prototype||Ts;return u===y}function $p(u){return u===u&&!si(u)}function qp(u,d){return function(y){return y==null?!1:y[u]===d&&(d!==t||u in jt(y))}}function _y(u){var d=Wh(u,function(A){return y.size===c&&y.clear(),A}),y=d.cache;return d}function my(u,d){var y=u[1],A=d[1],M=y|A,W=M<(w|P|D),ne=A==D&&y==k||A==D&&y==N&&u[7].length<=d[8]||A==(D|N)&&d[7].length<=d[8]&&y==k;if(!(W||ne))return u;A&w&&(u[2]=d[2],M|=y&w?0:E);var ae=d[3];if(ae){var le=u[3];u[3]=le?Mp(le,ae,d[4]):ae,u[4]=le?Gi(u[3],p):d[4]}return ae=d[5],ae&&(le=u[5],u[5]=le?Fp(le,ae,d[6]):ae,u[6]=le?Gi(u[5],p):d[6]),ae=d[7],ae&&(u[7]=ae),A&D&&(u[8]=u[8]==null?d[8]:ue(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=M,u}function xy(u){var d=[];if(u!=null)for(var y in jt(u))d.push(y);return d}function vy(u){return Ia.call(u)}function Jp(u,d,y){return d=re(d===t?u.length-1:d,0),function(){for(var A=arguments,M=-1,W=re(A.length-d,0),ne=ye(W);++M<W;)ne[M]=A[d+M];M=-1;for(var ae=ye(d+1);++M<d;)ae[M]=A[M];return ae[d]=y(ne),ei(u,this,ae)}}function Qp(u,d){return d.length<2?u:Ga(u,pn(d,0,-1))}function yy(u,d){for(var y=u.length,A=ue(d.length,y),M=jr(u);A--;){var W=d[A];u[A]=Ls(W,y)?M[W]:t}return u}function B0(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var eg=ig(Tp),$l=bh||function(u,d){return qe.setTimeout(u,d)},N0=ig(j1);function tg(u,d,y){var A=d+"";return N0(u,cy(A,by(ly(A),y)))}function ig(u){var d=0,y=0;return function(){var A=be(),M=q-(A-y);if(y=A,M>0){if(++d>=j)return arguments[0]}else d=0;return u.apply(t,arguments)}}function Nh(u,d){var y=-1,A=u.length,M=A-1;for(d=d===t?A:d;++y<d;){var W=y0(y,M),ne=u[W];u[W]=u[y],u[y]=ne}return u.length=d,u}var rg=_y(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(Yn,function(y,A,M,W){d.push(M?W.replace(K,"$1"):A||y)}),d});function as(u){if(typeof u=="string"||tn(u))return u;var d=u+"";return d=="0"&&1/u==-de?"-0":d}function Va(u){if(u!=null){try{return es.call(u)}catch{}try{return u+""}catch{}}return""}function by(u,d){return mr(Y,function(y){var A="_."+y[0];d&y[1]&&!La(u,A)&&u.push(A)}),u.sort()}function ng(u){if(u instanceof kt)return u.clone();var d=new Wr(u.__wrapped__,u.__chain__);return d.__actions__=jr(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function wy(u,d,y){(y?br(u,d,y):d===t)?d=1:d=re(pt(d),0);var A=u==null?0:u.length;if(!A||d<1)return[];for(var M=0,W=0,ne=ye(Go(A/d));M<A;)ne[W++]=pn(u,M,M+=d);return ne}function Ty(u){for(var d=-1,y=u==null?0:u.length,A=0,M=[];++d<y;){var W=u[d];W&&(M[A++]=W)}return M}function ky(){var u=arguments.length;if(!u)return[];for(var d=ye(u-1),y=arguments[0],A=u;A--;)d[A-1]=arguments[A];return $n(ct(y)?jr(y):[y],Ki(d,1))}var Py=bt(function(u,d){return mi(u)?Xl(u,Ki(d,1,mi,!0)):[]}),Ey=bt(function(u,d){var y=gn(d);return mi(y)&&(y=t),mi(u)?Xl(u,Ki(d,1,mi,!0),Je(y,2)):[]}),Ay=bt(function(u,d){var y=gn(d);return mi(y)&&(y=t),mi(u)?Xl(u,Ki(d,1,mi,!0),t,y):[]});function Cy(u,d,y){var A=u==null?0:u.length;return A?(d=y||d===t?1:pt(d),pn(u,d<0?0:d,A)):[]}function Sy(u,d,y){var A=u==null?0:u.length;return A?(d=y||d===t?1:pt(d),d=A-d,pn(u,0,d<0?0:d)):[]}function Dy(u,d){return u&&u.length?Dh(u,Je(d,3),!0,!0):[]}function Ly(u,d){return u&&u.length?Dh(u,Je(d,3),!0):[]}function Oy(u,d,y,A){var M=u==null?0:u.length;return M?(y&&typeof y!="number"&&br(u,d,y)&&(y=0,A=M),k1(u,d,y,A)):[]}function sg(u,d,y){var A=u==null?0:u.length;if(!A)return-1;var M=y==null?0:pt(y);return M<0&&(M=re(A+M,0)),qn(u,Je(d,3),M)}function ag(u,d,y){var A=u==null?0:u.length;if(!A)return-1;var M=A-1;return y!==t&&(M=pt(y),M=y<0?re(A+M,0):ue(M,A-1)),qn(u,Je(d,3),M,!0)}function og(u){var d=u==null?0:u.length;return d?Ki(u,1):[]}function My(u){var d=u==null?0:u.length;return d?Ki(u,de):[]}function Fy(u,d){var y=u==null?0:u.length;return y?(d=d===t?1:pt(d),Ki(u,d)):[]}function Ry(u){for(var d=-1,y=u==null?0:u.length,A={};++d<y;){var M=u[d];A[M[0]]=M[1]}return A}function lg(u){return u&&u.length?u[0]:t}function Iy(u,d,y){var A=u==null?0:u.length;if(!A)return-1;var M=y==null?0:pt(y);return M<0&&(M=re(A+M,0)),tr(u,d,M)}function By(u){var d=u==null?0:u.length;return d?pn(u,0,-1):[]}var Ny=bt(function(u){var d=$t(u,P0);return d.length&&d[0]===u[0]?g0(d):[]}),Hy=bt(function(u){var d=gn(u),y=$t(u,P0);return d===gn(y)?d=t:y.pop(),y.length&&y[0]===u[0]?g0(y,Je(d,2)):[]}),zy=bt(function(u){var d=gn(u),y=$t(u,P0);return d=typeof d=="function"?d:t,d&&y.pop(),y.length&&y[0]===u[0]?g0(y,t,d):[]});function Uy(u,d){return u==null?"":S.call(u,d)}function gn(u){var d=u==null?0:u.length;return d?u[d-1]:t}function Wy(u,d,y){var A=u==null?0:u.length;if(!A)return-1;var M=A;return y!==t&&(M=pt(y),M=M<0?re(A+M,0):ue(M,A-1)),d===d?Dn(u,d,M):qn(u,ph,M,!0)}function jy(u,d){return u&&u.length?vp(u,pt(d)):t}var Xy=bt(ug);function ug(u,d){return u&&u.length&&d&&d.length?v0(u,d):u}function Gy(u,d,y){return u&&u.length&&d&&d.length?v0(u,d,Je(y,2)):u}function Yy(u,d,y){return u&&u.length&&d&&d.length?v0(u,d,t,y):u}var Vy=Ds(function(u,d){var y=u==null?0:u.length,A=c0(u,d);return wp(u,$t(d,function(M){return Ls(M,y)?+M:M}).sort(Op)),A});function Zy(u,d){var y=[];if(!(u&&u.length))return y;var A=-1,M=[],W=u.length;for(d=Je(d,3);++A<W;){var ne=u[A];d(ne,A,u)&&(y.push(ne),M.push(A))}return wp(u,M),y}function H0(u){return u==null?u:Ke.call(u)}function Ky(u,d,y){var A=u==null?0:u.length;return A?(y&&typeof y!="number"&&br(u,d,y)?(d=0,y=A):(d=d==null?0:pt(d),y=y===t?A:pt(y)),pn(u,d,y)):[]}function $y(u,d){return Sh(u,d)}function qy(u,d,y){return w0(u,d,Je(y,2))}function Jy(u,d){var y=u==null?0:u.length;if(y){var A=Sh(u,d);if(A<y&&Rn(u[A],d))return A}return-1}function Qy(u,d){return Sh(u,d,!0)}function eb(u,d,y){return w0(u,d,Je(y,2),!0)}function tb(u,d){var y=u==null?0:u.length;if(y){var A=Sh(u,d,!0)-1;if(Rn(u[A],d))return A}return-1}function ib(u){return u&&u.length?kp(u):[]}function rb(u,d){return u&&u.length?kp(u,Je(d,2)):[]}function nb(u){var d=u==null?0:u.length;return d?pn(u,1,d):[]}function sb(u,d,y){return u&&u.length?(d=y||d===t?1:pt(d),pn(u,0,d<0?0:d)):[]}function ab(u,d,y){var A=u==null?0:u.length;return A?(d=y||d===t?1:pt(d),d=A-d,pn(u,d<0?0:d,A)):[]}function ob(u,d){return u&&u.length?Dh(u,Je(d,3),!1,!0):[]}function lb(u,d){return u&&u.length?Dh(u,Je(d,3)):[]}var ub=bt(function(u){return na(Ki(u,1,mi,!0))}),hb=bt(function(u){var d=gn(u);return mi(d)&&(d=t),na(Ki(u,1,mi,!0),Je(d,2))}),cb=bt(function(u){var d=gn(u);return d=typeof d=="function"?d:t,na(Ki(u,1,mi,!0),t,d)});function fb(u){return u&&u.length?na(u):[]}function db(u,d){return u&&u.length?na(u,Je(d,2)):[]}function pb(u,d){return d=typeof d=="function"?d:t,u&&u.length?na(u,t,d):[]}function z0(u){if(!(u&&u.length))return[];var d=0;return u=er(u,function(y){if(mi(y))return d=re(y.length,d),!0}),Fo(d,function(y){return $t(u,Rl(y))})}function hg(u,d){if(!(u&&u.length))return[];var y=z0(u);return d==null?y:$t(y,function(A){return ei(d,t,A)})}var gb=bt(function(u,d){return mi(u)?Xl(u,d):[]}),_b=bt(function(u){return k0(er(u,mi))}),mb=bt(function(u){var d=gn(u);return mi(d)&&(d=t),k0(er(u,mi),Je(d,2))}),xb=bt(function(u){var d=gn(u);return d=typeof d=="function"?d:t,k0(er(u,mi),t,d)}),vb=bt(z0);function yb(u,d){return Cp(u||[],d||[],jl)}function bb(u,d){return Cp(u||[],d||[],Vl)}var wb=bt(function(u){var d=u.length,y=d>1?u[d-1]:t;return y=typeof y=="function"?(u.pop(),y):t,hg(u,y)});function cg(u){var d=H(u);return d.__chain__=!0,d}function Tb(u,d){return d(u),u}function Hh(u,d){return d(u)}var kb=Ds(function(u){var d=u.length,y=d?u[0]:0,A=this.__wrapped__,M=function(W){return c0(W,u)};return d>1||this.__actions__.length||!(A instanceof kt)||!Ls(y)?this.thru(M):(A=A.slice(y,+y+(d?1:0)),A.__actions__.push({func:Hh,args:[M],thisArg:t}),new Wr(A,this.__chain__).thru(function(W){return d&&!W.length&&W.push(t),W}))});function Pb(){return cg(this)}function Eb(){return new Wr(this.value(),this.__chain__)}function Ab(){this.__values__===t&&(this.__values__=Pg(this.value()));var u=this.__index__>=this.__values__.length,d=u?t:this.__values__[this.__index__++];return{done:u,value:d}}function Cb(){return this}function Sb(u){for(var d,y=this;y instanceof Ua;){var A=ng(y);A.__index__=0,A.__values__=t,d?M.__wrapped__=A:d=A;var M=A;y=y.__wrapped__}return M.__wrapped__=u,d}function Db(){var u=this.__wrapped__;if(u instanceof kt){var d=u;return this.__actions__.length&&(d=new kt(this)),d=d.reverse(),d.__actions__.push({func:Hh,args:[H0],thisArg:t}),new Wr(d,this.__chain__)}return this.thru(H0)}function Lb(){return Ap(this.__wrapped__,this.__actions__)}var Ob=Lh(function(u,d,y){Rt.call(u,y)?++u[y]:Cs(u,y,1)});function Mb(u,d,y){var A=ct(u)?So:T1;return y&&br(u,d,y)&&(d=t),A(u,Je(d,3))}function Fb(u,d){var y=ct(u)?er:hp;return y(u,Je(d,3))}var Rb=Np(sg),Ib=Np(ag);function Bb(u,d){return Ki(zh(u,d),1)}function Nb(u,d){return Ki(zh(u,d),de)}function Hb(u,d,y){return y=y===t?1:pt(y),Ki(zh(u,d),y)}function fg(u,d){var y=ct(u)?mr:ra;return y(u,Je(d,3))}function dg(u,d){var y=ct(u)?hh:up;return y(u,Je(d,3))}var zb=Lh(function(u,d,y){Rt.call(u,y)?u[y].push(d):Cs(u,y,[d])});function Ub(u,d,y,A){u=Xr(u)?u:qo(u),y=y&&!A?pt(y):0;var M=u.length;return y<0&&(y=re(M+y,0)),Gh(u)?y<=M&&u.indexOf(d,y)>-1:!!M&&tr(u,d,y)>-1}var Wb=bt(function(u,d,y){var A=-1,M=typeof d=="function",W=Xr(u)?ye(u.length):[];return ra(u,function(ne){W[++A]=M?ei(d,ne,y):Gl(ne,d,y)}),W}),jb=Lh(function(u,d,y){Cs(u,y,d)});function zh(u,d){var y=ct(u)?$t:_p;return y(u,Je(d,3))}function Xb(u,d,y,A){return u==null?[]:(ct(d)||(d=d==null?[]:[d]),y=A?t:y,ct(y)||(y=y==null?[]:[y]),yp(u,d,y))}var Gb=Lh(function(u,d,y){u[y?0:1].push(d)},function(){return[[],[]]});function Yb(u,d,y){var A=ct(u)?Oa:Mo,M=arguments.length<3;return A(u,Je(d,4),y,M,ra)}function Vb(u,d,y){var A=ct(u)?Qc:Mo,M=arguments.length<3;return A(u,Je(d,4),y,M,up)}function Zb(u,d){var y=ct(u)?er:hp;return y(u,jh(Je(d,3)))}function Kb(u){var d=ct(u)?sp:U1;return d(u)}function $b(u,d,y){(y?br(u,d,y):d===t)?d=1:d=pt(d);var A=ct(u)?x1:W1;return A(u,d)}function qb(u){var d=ct(u)?v1:X1;return d(u)}function Jb(u){if(u==null)return 0;if(Xr(u))return Gh(u)?Jn(u):u.length;var d=ir(u);return d==Ge||d==vt?u.size:m0(u).length}function Qb(u,d,y){var A=ct(u)?Lo:G1;return y&&br(u,d,y)&&(d=t),A(u,Je(d,3))}var ew=bt(function(u,d){if(u==null)return[];var y=d.length;return y>1&&br(u,d[0],d[1])?d=[]:y>2&&br(d[0],d[1],d[2])&&(d=[d[0]]),yp(u,Ki(d,1),[])}),Uh=yh||function(){return qe.Date.now()};function tw(u,d){if(typeof d!="function")throw new Hr(a);return u=pt(u),function(){if(--u<1)return d.apply(this,arguments)}}function pg(u,d,y){return d=y?t:d,d=u&&d==null?u.length:d,Ss(u,D,t,t,t,t,d)}function gg(u,d){var y;if(typeof d!="function")throw new Hr(a);return u=pt(u),function(){return--u>0&&(y=d.apply(this,arguments)),u<=1&&(d=t),y}}var U0=bt(function(u,d,y){var A=w;if(y.length){var M=Gi(y,Ko(U0));A|=O}return Ss(u,A,d,y,M)}),_g=bt(function(u,d,y){var A=w|P;if(y.length){var M=Gi(y,Ko(_g));A|=O}return Ss(d,A,u,y,M)});function mg(u,d,y){d=y?t:d;var A=Ss(u,k,t,t,t,t,t,d);return A.placeholder=mg.placeholder,A}function xg(u,d,y){d=y?t:d;var A=Ss(u,C,t,t,t,t,t,d);return A.placeholder=xg.placeholder,A}function vg(u,d,y){var A,M,W,ne,ae,le,Ae=0,Ce=!1,Me=!1,Ue=!0;if(typeof u!="function")throw new Hr(a);d=_n(d)||0,si(y)&&(Ce=!!y.leading,Me="maxWait"in y,W=Me?re(_n(y.maxWait)||0,d):W,Ue="trailing"in y?!!y.trailing:Ue);function Ye(xi){var In=A,Fs=M;return A=M=t,Ae=xi,ne=u.apply(Fs,In),ne}function et(xi){return Ae=xi,ae=$l(Tt,d),Ce?Ye(xi):ne}function xt(xi){var In=xi-le,Fs=xi-Ae,Ng=d-In;return Me?ue(Ng,W-Fs):Ng}function tt(xi){var In=xi-le,Fs=xi-Ae;return le===t||In>=d||In<0||Me&&Fs>=W}function Tt(){var xi=Uh();if(tt(xi))return At(xi);ae=$l(Tt,xt(xi))}function At(xi){return ae=t,Ue&&A?Ye(xi):(A=M=t,ne)}function rn(){ae!==t&&Sp(ae),Ae=0,A=le=M=ae=t}function wr(){return ae===t?ne:At(Uh())}function nn(){var xi=Uh(),In=tt(xi);if(A=arguments,M=this,le=xi,In){if(ae===t)return et(le);if(Me)return Sp(ae),ae=$l(Tt,d),Ye(le)}return ae===t&&(ae=$l(Tt,d)),ne}return nn.cancel=rn,nn.flush=wr,nn}var iw=bt(function(u,d){return lp(u,1,d)}),rw=bt(function(u,d,y){return lp(u,_n(d)||0,y)});function nw(u){return Ss(u,X)}function Wh(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new Hr(a);var y=function(){var A=arguments,M=d?d.apply(this,A):A[0],W=y.cache;if(W.has(M))return W.get(M);var ne=u.apply(this,A);return y.cache=W.set(M,ne)||W,ne};return y.cache=new(Wh.Cache||As),y}Wh.Cache=As;function jh(u){if(typeof u!="function")throw new Hr(a);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function sw(u){return gg(2,u)}var aw=Y1(function(u,d){d=d.length==1&&ct(d[0])?$t(d[0],Ei(Je())):$t(Ki(d,1),Ei(Je()));var y=d.length;return bt(function(A){for(var M=-1,W=ue(A.length,y);++M<W;)A[M]=d[M].call(this,A[M]);return ei(u,this,A)})}),W0=bt(function(u,d){var y=Gi(d,Ko(W0));return Ss(u,O,t,d,y)}),yg=bt(function(u,d){var y=Gi(d,Ko(yg));return Ss(u,F,t,d,y)}),ow=Ds(function(u,d){return Ss(u,N,t,t,t,d)});function lw(u,d){if(typeof u!="function")throw new Hr(a);return d=d===t?d:pt(d),bt(u,d)}function uw(u,d){if(typeof u!="function")throw new Hr(a);return d=d==null?0:re(pt(d),0),bt(function(y){var A=y[d],M=aa(y,0,d);return A&&$n(M,A),ei(u,this,M)})}function hw(u,d,y){var A=!0,M=!0;if(typeof u!="function")throw new Hr(a);return si(y)&&(A="leading"in y?!!y.leading:A,M="trailing"in y?!!y.trailing:M),vg(u,d,{leading:A,maxWait:d,trailing:M})}function cw(u){return pg(u,1)}function fw(u,d){return W0(E0(d),u)}function dw(){if(!arguments.length)return[];var u=arguments[0];return ct(u)?u:[u]}function pw(u){return dn(u,_)}function gw(u,d){return d=typeof d=="function"?d:t,dn(u,_,d)}function _w(u){return dn(u,g|_)}function mw(u,d){return d=typeof d=="function"?d:t,dn(u,g|_,d)}function xw(u,d){return d==null||op(u,d,Yi(d))}function Rn(u,d){return u===d||u!==u&&d!==d}var vw=Rh(p0),yw=Rh(function(u,d){return u>=d}),Za=dp(function(){return arguments}())?dp:function(u){return hi(u)&&Rt.call(u,"callee")&&!Ul.call(u,"callee")},ct=ye.isArray,bw=Ao?Ei(Ao):S1;function Xr(u){return u!=null&&Xh(u.length)&&!Os(u)}function mi(u){return hi(u)&&Xr(u)}function ww(u){return u===!0||u===!1||hi(u)&&yr(u)==we}var oa=v||Q0,Tw=oh?Ei(oh):D1;function kw(u){return hi(u)&&u.nodeType===1&&!ql(u)}function Pw(u){if(u==null)return!0;if(Xr(u)&&(ct(u)||typeof u=="string"||typeof u.splice=="function"||oa(u)||$o(u)||Za(u)))return!u.length;var d=ir(u);if(d==Ge||d==vt)return!u.size;if(Kl(u))return!m0(u).length;for(var y in u)if(Rt.call(u,y))return!1;return!0}function Ew(u,d){return Yl(u,d)}function Aw(u,d,y){y=typeof y=="function"?y:t;var A=y?y(u,d):t;return A===t?Yl(u,d,t,y):!!A}function j0(u){if(!hi(u))return!1;var d=yr(u);return d==it||d==Le||typeof u.message=="string"&&typeof u.name=="string"&&!ql(u)}function Cw(u){return typeof u=="number"&&T(u)}function Os(u){if(!si(u))return!1;var d=yr(u);return d==te||d==ft||d==Pe||d==ii}function bg(u){return typeof u=="number"&&u==pt(u)}function Xh(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=De}function si(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function hi(u){return u!=null&&typeof u=="object"}var wg=Ml?Ei(Ml):O1;function Sw(u,d){return u===d||_0(u,d,M0(d))}function Dw(u,d,y){return y=typeof y=="function"?y:t,_0(u,d,M0(d),y)}function Lw(u){return Tg(u)&&u!=+u}function Ow(u){if(gy(u))throw new at(s);return pp(u)}function Mw(u){return u===null}function Fw(u){return u==null}function Tg(u){return typeof u=="number"||hi(u)&&yr(u)==_t}function ql(u){if(!hi(u)||yr(u)!=Be)return!1;var d=ts(u);if(d===null)return!0;var y=Rt.call(d,"constructor")&&d.constructor;return typeof y=="function"&&y instanceof y&&es.call(y)==o0}var X0=lh?Ei(lh):M1;function Rw(u){return bg(u)&&u>=-De&&u<=De}var kg=Co?Ei(Co):F1;function Gh(u){return typeof u=="string"||!ct(u)&&hi(u)&&yr(u)==zt}function tn(u){return typeof u=="symbol"||hi(u)&&yr(u)==Ut}var $o=uh?Ei(uh):R1;function Iw(u){return u===t}function Bw(u){return hi(u)&&ir(u)==Ti}function Nw(u){return hi(u)&&yr(u)==ki}var Hw=Rh(x0),zw=Rh(function(u,d){return u<=d});function Pg(u){if(!u)return[];if(Xr(u))return Gh(u)?Nr(u):jr(u);if(ta&&u[ta])return n0(u[ta]());var d=ir(u),y=d==Ge?Ra:d==vt?Bo:qo;return y(u)}function Ms(u){if(!u)return u===0?u:0;if(u=_n(u),u===de||u===-de){var d=u<0?-1:1;return d*ee}return u===u?u:0}function pt(u){var d=Ms(u),y=d%1;return d===d?y?d-y:d:0}function Eg(u){return u?Xa(pt(u),0,se):0}function _n(u){if(typeof u=="number")return u;if(tn(u))return Fe;if(si(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=si(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=Br(u);var y=ge.test(u);return y||xe.test(u)?qc(u.slice(2),y?2:8):Te.test(u)?Fe:+u}function Ag(u){return ss(u,Gr(u))}function Uw(u){return u?Xa(pt(u),-De,De):u===0?u:0}function Nt(u){return u==null?"":en(u)}var Ww=Vo(function(u,d){if(Kl(d)||Xr(d)){ss(d,Yi(d),u);return}for(var y in d)Rt.call(d,y)&&jl(u,y,d[y])}),Cg=Vo(function(u,d){ss(d,Gr(d),u)}),Yh=Vo(function(u,d,y,A){ss(d,Gr(d),u,A)}),jw=Vo(function(u,d,y,A){ss(d,Yi(d),u,A)}),Xw=Ds(c0);function Gw(u,d){var y=rs(u);return d==null?y:ap(y,d)}var Yw=bt(function(u,d){u=jt(u);var y=-1,A=d.length,M=A>2?d[2]:t;for(M&&br(d[0],d[1],M)&&(A=1);++y<A;)for(var W=d[y],ne=Gr(W),ae=-1,le=ne.length;++ae<le;){var Ae=ne[ae],Ce=u[Ae];(Ce===t||Rn(Ce,Ts[Ae])&&!Rt.call(u,Ae))&&(u[Ae]=W[Ae])}return u}),Vw=bt(function(u){return u.push(t,Gp),ei(Sg,t,u)});function Zw(u,d){return fh(u,Je(d,3),ns)}function Kw(u,d){return fh(u,Je(d,3),d0)}function $w(u,d){return u==null?u:f0(u,Je(d,3),Gr)}function qw(u,d){return u==null?u:cp(u,Je(d,3),Gr)}function Jw(u,d){return u&&ns(u,Je(d,3))}function Qw(u,d){return u&&d0(u,Je(d,3))}function e2(u){return u==null?[]:Ah(u,Yi(u))}function t2(u){return u==null?[]:Ah(u,Gr(u))}function G0(u,d,y){var A=u==null?t:Ga(u,d);return A===t?y:A}function i2(u,d){return u!=null&&Zp(u,d,P1)}function Y0(u,d){return u!=null&&Zp(u,d,E1)}var r2=zp(function(u,d,y){d!=null&&typeof d.toString!="function"&&(d=Ia.call(d)),u[d]=y},Z0(Yr)),n2=zp(function(u,d,y){d!=null&&typeof d.toString!="function"&&(d=Ia.call(d)),Rt.call(u,d)?u[d].push(y):u[d]=[y]},Je),s2=bt(Gl);function Yi(u){return Xr(u)?np(u):m0(u)}function Gr(u){return Xr(u)?np(u,!0):I1(u)}function a2(u,d){var y={};return d=Je(d,3),ns(u,function(A,M,W){Cs(y,d(A,M,W),A)}),y}function o2(u,d){var y={};return d=Je(d,3),ns(u,function(A,M,W){Cs(y,M,d(A,M,W))}),y}var l2=Vo(function(u,d,y){Ch(u,d,y)}),Sg=Vo(function(u,d,y,A){Ch(u,d,y,A)}),u2=Ds(function(u,d){var y={};if(u==null)return y;var A=!1;d=$t(d,function(W){return W=sa(W,u),A||(A=W.length>1),W}),ss(u,L0(u),y),A&&(y=dn(y,g|m|_,ry));for(var M=d.length;M--;)T0(y,d[M]);return y});function h2(u,d){return Dg(u,jh(Je(d)))}var c2=Ds(function(u,d){return u==null?{}:N1(u,d)});function Dg(u,d){if(u==null)return{};var y=$t(L0(u),function(A){return[A]});return d=Je(d),bp(u,y,function(A,M){return d(A,M[0])})}function f2(u,d,y){d=sa(d,u);var A=-1,M=d.length;for(M||(M=1,u=t);++A<M;){var W=u==null?t:u[as(d[A])];W===t&&(A=M,W=y),u=Os(W)?W.call(u):W}return u}function d2(u,d,y){return u==null?u:Vl(u,d,y)}function p2(u,d,y,A){return A=typeof A=="function"?A:t,u==null?u:Vl(u,d,y,A)}var Lg=jp(Yi),Og=jp(Gr);function g2(u,d,y){var A=ct(u),M=A||oa(u)||$o(u);if(d=Je(d,4),y==null){var W=u&&u.constructor;M?y=A?new W:[]:si(u)?y=Os(W)?rs(ts(u)):{}:y={}}return(M?mr:ns)(u,function(ne,ae,le){return d(y,ne,ae,le)}),y}function _2(u,d){return u==null?!0:T0(u,d)}function m2(u,d,y){return u==null?u:Ep(u,d,E0(y))}function x2(u,d,y,A){return A=typeof A=="function"?A:t,u==null?u:Ep(u,d,E0(y),A)}function qo(u){return u==null?[]:Bl(u,Yi(u))}function v2(u){return u==null?[]:Bl(u,Gr(u))}function y2(u,d,y){return y===t&&(y=d,d=t),y!==t&&(y=_n(y),y=y===y?y:0),d!==t&&(d=_n(d),d=d===d?d:0),Xa(_n(u),d,y)}function b2(u,d,y){return d=Ms(d),y===t?(y=d,d=0):y=Ms(y),u=_n(u),A1(u,d,y)}function w2(u,d,y){if(y&&typeof y!="boolean"&&br(u,d,y)&&(d=y=t),y===t&&(typeof d=="boolean"?(y=d,d=t):typeof u=="boolean"&&(y=u,u=t)),u===t&&d===t?(u=0,d=1):(u=Ms(u),d===t?(d=u,u=0):d=Ms(d)),u>d){var A=u;u=d,d=A}if(y||u%1||d%1){var M=je();return ue(u+M*(d-u+Ll("1e-"+((M+"").length-1))),d)}return y0(u,d)}var T2=Zo(function(u,d,y){return d=d.toLowerCase(),u+(y?Mg(d):d)});function Mg(u){return V0(Nt(u).toLowerCase())}function Fg(u){return u=Nt(u),u&&u.replace(Ne,Fa).replace(El,"")}function k2(u,d,y){u=Nt(u),d=en(d);var A=u.length;y=y===t?A:Xa(pt(y),0,A);var M=y;return y-=d.length,y>=0&&u.slice(y,M)==d}function P2(u){return u=Nt(u),u&&Ys.test(u)?u.replace(Mi,_h):u}function E2(u){return u=Nt(u),u&&_i.test(u)?u.replace(Ri,"\\$&"):u}var A2=Zo(function(u,d,y){return u+(y?"-":"")+d.toLowerCase()}),C2=Zo(function(u,d,y){return u+(y?" ":"")+d.toLowerCase()}),S2=Bp("toLowerCase");function D2(u,d,y){u=Nt(u),d=pt(d);var A=d?Jn(u):0;if(!d||A>=d)return u;var M=(d-A)/2;return Fh(o(M),y)+u+Fh(Go(M),y)}function L2(u,d,y){u=Nt(u),d=pt(d);var A=d?Jn(u):0;return d&&A<d?u+Fh(d-A,y):u}function O2(u,d,y){u=Nt(u),d=pt(d);var A=d?Jn(u):0;return d&&A<d?Fh(d-A,y)+u:u}function M2(u,d,y){return y||d==null?d=0:d&&(d=+d),Se(Nt(u).replace(Xi,""),d||0)}function F2(u,d,y){return(y?br(u,d,y):d===t)?d=1:d=pt(d),b0(Nt(u),d)}function R2(){var u=arguments,d=Nt(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var I2=Zo(function(u,d,y){return u+(y?"_":"")+d.toLowerCase()});function B2(u,d,y){return y&&typeof y!="number"&&br(u,d,y)&&(d=y=t),y=y===t?se:y>>>0,y?(u=Nt(u),u&&(typeof d=="string"||d!=null&&!X0(d))&&(d=en(d),!d&&xr(u))?aa(Nr(u),0,y):u.split(d,y)):[]}var N2=Zo(function(u,d,y){return u+(y?" ":"")+V0(d)});function H2(u,d,y){return u=Nt(u),y=y==null?0:Xa(pt(y),0,u.length),d=en(d),u.slice(y,y+d.length)==d}function z2(u,d,y){var A=H.templateSettings;y&&br(u,d,y)&&(d=t),u=Nt(u),d=Yh({},d,A,Xp);var M=Yh({},d.imports,A.imports,Xp),W=Yi(M),ne=Bl(M,W),ae,le,Ae=0,Ce=d.interpolate||We,Me="__p += '",Ue=Qr((d.escape||We).source+"|"+Ce.source+"|"+(Ce===Or?Q:We).source+"|"+(d.evaluate||We).source+"|$","g"),Ye="//# sourceURL="+(Rt.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++nh+"]")+`
`;u.replace(Ue,function(tt,Tt,At,rn,wr,nn){return At||(At=rn),Me+=u.slice(Ae,nn).replace(Ie,Ro),Tt&&(ae=!0,Me+=`' +
__e(`+Tt+`) +
'`),wr&&(le=!0,Me+=`';
`+wr+`;
__p += '`),At&&(Me+=`' +
((__t = (`+At+`)) == null ? '' : __t) +
'`),Ae=nn+tt.length,tt}),Me+=`';
`;var et=Rt.call(d,"variable")&&d.variable;if(!et)Me=`with (obj) {
`+Me+`
}
`;else if(V.test(et))throw new at(l);Me=(le?Me.replace(Lr,""):Me).replace(Gs,"$1").replace(gs,"$1;"),Me="function("+(et||"obj")+`) {
`+(et?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ae?", __e = _.escape":"")+(le?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Me+`return __p
}`;var xt=Ig(function(){return Ot(W,Ye+"return "+Me).apply(t,ne)});if(xt.source=Me,j0(xt))throw xt;return xt}function U2(u){return Nt(u).toLowerCase()}function W2(u){return Nt(u).toUpperCase()}function j2(u,d,y){if(u=Nt(u),u&&(y||d===t))return Br(u);if(!u||!(d=en(d)))return u;var A=Nr(u),M=Nr(d),W=gh(A,M),ne=ws(A,M)+1;return aa(A,W,ne).join("")}function X2(u,d,y){if(u=Nt(u),u&&(y||d===t))return u.slice(0,No(u)+1);if(!u||!(d=en(d)))return u;var A=Nr(u),M=ws(A,Nr(d))+1;return aa(A,0,M).join("")}function G2(u,d,y){if(u=Nt(u),u&&(y||d===t))return u.replace(Xi,"");if(!u||!(d=en(d)))return u;var A=Nr(u),M=gh(A,Nr(d));return aa(A,M).join("")}function Y2(u,d){var y=z,A=U;if(si(d)){var M="separator"in d?d.separator:M;y="length"in d?pt(d.length):y,A="omission"in d?en(d.omission):A}u=Nt(u);var W=u.length;if(xr(u)){var ne=Nr(u);W=ne.length}if(y>=W)return u;var ae=y-Jn(A);if(ae<1)return A;var le=ne?aa(ne,0,ae).join(""):u.slice(0,ae);if(M===t)return le+A;if(ne&&(ae+=le.length-ae),X0(M)){if(u.slice(ae).search(M)){var Ae,Ce=le;for(M.global||(M=Qr(M.source,Nt(_e.exec(M))+"g")),M.lastIndex=0;Ae=M.exec(Ce);)var Me=Ae.index;le=le.slice(0,Me===t?ae:Me)}}else if(u.indexOf(en(M),ae)!=ae){var Ue=le.lastIndexOf(M);Ue>-1&&(le=le.slice(0,Ue))}return le+A}function V2(u){return u=Nt(u),u&&Fi.test(u)?u.replace(pr,Ho):u}var Z2=Zo(function(u,d,y){return u+(y?" ":"")+d.toUpperCase()}),V0=Bp("toUpperCase");function Rg(u,d,y){return u=Nt(u),d=y?t:d,d===t?Io(u)?Js(u):bs(u):u.match(d)||[]}var Ig=bt(function(u,d){try{return ei(u,t,d)}catch(y){return j0(y)?y:new at(y)}}),K2=Ds(function(u,d){return mr(d,function(y){y=as(y),Cs(u,y,U0(u[y],u))}),u});function $2(u){var d=u==null?0:u.length,y=Je();return u=d?$t(u,function(A){if(typeof A[1]!="function")throw new Hr(a);return[y(A[0]),A[1]]}):[],bt(function(A){for(var M=-1;++M<d;){var W=u[M];if(ei(W[0],this,A))return ei(W[1],this,A)}})}function q2(u){return w1(dn(u,g))}function Z0(u){return function(){return u}}function J2(u,d){return u==null||u!==u?d:u}var Q2=Hp(),eT=Hp(!0);function Yr(u){return u}function K0(u){return gp(typeof u=="function"?u:dn(u,g))}function tT(u){return mp(dn(u,g))}function iT(u,d){return xp(u,dn(d,g))}var rT=bt(function(u,d){return function(y){return Gl(y,u,d)}}),nT=bt(function(u,d){return function(y){return Gl(u,y,d)}});function $0(u,d,y){var A=Yi(d),M=Ah(d,A);y==null&&!(si(d)&&(M.length||!A.length))&&(y=d,d=u,u=this,M=Ah(d,Yi(d)));var W=!(si(y)&&"chain"in y)||!!y.chain,ne=Os(u);return mr(M,function(ae){var le=d[ae];u[ae]=le,ne&&(u.prototype[ae]=function(){var Ae=this.__chain__;if(W||Ae){var Ce=u(this.__wrapped__),Me=Ce.__actions__=jr(this.__actions__);return Me.push({func:le,args:arguments,thisArg:u}),Ce.__chain__=Ae,Ce}return le.apply(u,$n([this.value()],arguments))})}),u}function sT(){return qe._===this&&(qe._=fn),this}function q0(){}function aT(u){return u=pt(u),bt(function(d){return vp(d,u)})}var oT=C0($t),lT=C0(So),uT=C0(Lo);function Bg(u){return R0(u)?Rl(as(u)):H1(u)}function hT(u){return function(d){return u==null?t:Ga(u,d)}}var cT=Up(),fT=Up(!0);function J0(){return[]}function Q0(){return!1}function dT(){return{}}function pT(){return""}function gT(){return!0}function _T(u,d){if(u=pt(u),u<1||u>De)return[];var y=se,A=ue(u,se);d=Je(d),u-=se;for(var M=Fo(A,d);++y<u;)d(y);return M}function mT(u){return ct(u)?$t(u,as):tn(u)?[u]:jr(rg(Nt(u)))}function xT(u){var d=++ea;return Nt(u)+d}var vT=Mh(function(u,d){return u+d},0),yT=S0("ceil"),bT=Mh(function(u,d){return u/d},1),wT=S0("floor");function TT(u){return u&&u.length?Eh(u,Yr,p0):t}function kT(u,d){return u&&u.length?Eh(u,Je(d,2),p0):t}function PT(u){return Fl(u,Yr)}function ET(u,d){return Fl(u,Je(d,2))}function AT(u){return u&&u.length?Eh(u,Yr,x0):t}function CT(u,d){return u&&u.length?Eh(u,Je(d,2),x0):t}var ST=Mh(function(u,d){return u*d},1),DT=S0("round"),LT=Mh(function(u,d){return u-d},0);function OT(u){return u&&u.length?Il(u,Yr):0}function MT(u,d){return u&&u.length?Il(u,Je(d,2)):0}return H.after=tw,H.ary=pg,H.assign=Ww,H.assignIn=Cg,H.assignInWith=Yh,H.assignWith=jw,H.at=Xw,H.before=gg,H.bind=U0,H.bindAll=K2,H.bindKey=_g,H.castArray=dw,H.chain=cg,H.chunk=wy,H.compact=Ty,H.concat=ky,H.cond=$2,H.conforms=q2,H.constant=Z0,H.countBy=Ob,H.create=Gw,H.curry=mg,H.curryRight=xg,H.debounce=vg,H.defaults=Yw,H.defaultsDeep=Vw,H.defer=iw,H.delay=rw,H.difference=Py,H.differenceBy=Ey,H.differenceWith=Ay,H.drop=Cy,H.dropRight=Sy,H.dropRightWhile=Dy,H.dropWhile=Ly,H.fill=Oy,H.filter=Fb,H.flatMap=Bb,H.flatMapDeep=Nb,H.flatMapDepth=Hb,H.flatten=og,H.flattenDeep=My,H.flattenDepth=Fy,H.flip=nw,H.flow=Q2,H.flowRight=eT,H.fromPairs=Ry,H.functions=e2,H.functionsIn=t2,H.groupBy=zb,H.initial=By,H.intersection=Ny,H.intersectionBy=Hy,H.intersectionWith=zy,H.invert=r2,H.invertBy=n2,H.invokeMap=Wb,H.iteratee=K0,H.keyBy=jb,H.keys=Yi,H.keysIn=Gr,H.map=zh,H.mapKeys=a2,H.mapValues=o2,H.matches=tT,H.matchesProperty=iT,H.memoize=Wh,H.merge=l2,H.mergeWith=Sg,H.method=rT,H.methodOf=nT,H.mixin=$0,H.negate=jh,H.nthArg=aT,H.omit=u2,H.omitBy=h2,H.once=sw,H.orderBy=Xb,H.over=oT,H.overArgs=aw,H.overEvery=lT,H.overSome=uT,H.partial=W0,H.partialRight=yg,H.partition=Gb,H.pick=c2,H.pickBy=Dg,H.property=Bg,H.propertyOf=hT,H.pull=Xy,H.pullAll=ug,H.pullAllBy=Gy,H.pullAllWith=Yy,H.pullAt=Vy,H.range=cT,H.rangeRight=fT,H.rearg=ow,H.reject=Zb,H.remove=Zy,H.rest=lw,H.reverse=H0,H.sampleSize=$b,H.set=d2,H.setWith=p2,H.shuffle=qb,H.slice=Ky,H.sortBy=ew,H.sortedUniq=ib,H.sortedUniqBy=rb,H.split=B2,H.spread=uw,H.tail=nb,H.take=sb,H.takeRight=ab,H.takeRightWhile=ob,H.takeWhile=lb,H.tap=Tb,H.throttle=hw,H.thru=Hh,H.toArray=Pg,H.toPairs=Lg,H.toPairsIn=Og,H.toPath=mT,H.toPlainObject=Ag,H.transform=g2,H.unary=cw,H.union=ub,H.unionBy=hb,H.unionWith=cb,H.uniq=fb,H.uniqBy=db,H.uniqWith=pb,H.unset=_2,H.unzip=z0,H.unzipWith=hg,H.update=m2,H.updateWith=x2,H.values=qo,H.valuesIn=v2,H.without=gb,H.words=Rg,H.wrap=fw,H.xor=_b,H.xorBy=mb,H.xorWith=xb,H.zip=vb,H.zipObject=yb,H.zipObjectDeep=bb,H.zipWith=wb,H.entries=Lg,H.entriesIn=Og,H.extend=Cg,H.extendWith=Yh,$0(H,H),H.add=vT,H.attempt=Ig,H.camelCase=T2,H.capitalize=Mg,H.ceil=yT,H.clamp=y2,H.clone=pw,H.cloneDeep=_w,H.cloneDeepWith=mw,H.cloneWith=gw,H.conformsTo=xw,H.deburr=Fg,H.defaultTo=J2,H.divide=bT,H.endsWith=k2,H.eq=Rn,H.escape=P2,H.escapeRegExp=E2,H.every=Mb,H.find=Rb,H.findIndex=sg,H.findKey=Zw,H.findLast=Ib,H.findLastIndex=ag,H.findLastKey=Kw,H.floor=wT,H.forEach=fg,H.forEachRight=dg,H.forIn=$w,H.forInRight=qw,H.forOwn=Jw,H.forOwnRight=Qw,H.get=G0,H.gt=vw,H.gte=yw,H.has=i2,H.hasIn=Y0,H.head=lg,H.identity=Yr,H.includes=Ub,H.indexOf=Iy,H.inRange=b2,H.invoke=s2,H.isArguments=Za,H.isArray=ct,H.isArrayBuffer=bw,H.isArrayLike=Xr,H.isArrayLikeObject=mi,H.isBoolean=ww,H.isBuffer=oa,H.isDate=Tw,H.isElement=kw,H.isEmpty=Pw,H.isEqual=Ew,H.isEqualWith=Aw,H.isError=j0,H.isFinite=Cw,H.isFunction=Os,H.isInteger=bg,H.isLength=Xh,H.isMap=wg,H.isMatch=Sw,H.isMatchWith=Dw,H.isNaN=Lw,H.isNative=Ow,H.isNil=Fw,H.isNull=Mw,H.isNumber=Tg,H.isObject=si,H.isObjectLike=hi,H.isPlainObject=ql,H.isRegExp=X0,H.isSafeInteger=Rw,H.isSet=kg,H.isString=Gh,H.isSymbol=tn,H.isTypedArray=$o,H.isUndefined=Iw,H.isWeakMap=Bw,H.isWeakSet=Nw,H.join=Uy,H.kebabCase=A2,H.last=gn,H.lastIndexOf=Wy,H.lowerCase=C2,H.lowerFirst=S2,H.lt=Hw,H.lte=zw,H.max=TT,H.maxBy=kT,H.mean=PT,H.meanBy=ET,H.min=AT,H.minBy=CT,H.stubArray=J0,H.stubFalse=Q0,H.stubObject=dT,H.stubString=pT,H.stubTrue=gT,H.multiply=ST,H.nth=jy,H.noConflict=sT,H.noop=q0,H.now=Uh,H.pad=D2,H.padEnd=L2,H.padStart=O2,H.parseInt=M2,H.random=w2,H.reduce=Yb,H.reduceRight=Vb,H.repeat=F2,H.replace=R2,H.result=f2,H.round=DT,H.runInContext=oe,H.sample=Kb,H.size=Jb,H.snakeCase=I2,H.some=Qb,H.sortedIndex=$y,H.sortedIndexBy=qy,H.sortedIndexOf=Jy,H.sortedLastIndex=Qy,H.sortedLastIndexBy=eb,H.sortedLastIndexOf=tb,H.startCase=N2,H.startsWith=H2,H.subtract=LT,H.sum=OT,H.sumBy=MT,H.template=z2,H.times=_T,H.toFinite=Ms,H.toInteger=pt,H.toLength=Eg,H.toLower=U2,H.toNumber=_n,H.toSafeInteger=Uw,H.toString=Nt,H.toUpper=W2,H.trim=j2,H.trimEnd=X2,H.trimStart=G2,H.truncate=Y2,H.unescape=V2,H.uniqueId=xT,H.upperCase=Z2,H.upperFirst=V0,H.each=fg,H.eachRight=dg,H.first=lg,$0(H,function(){var u={};return ns(H,function(d,y){Rt.call(H.prototype,y)||(u[y]=d)}),u}(),{chain:!1}),H.VERSION=i,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){H[u].placeholder=H}),mr(["drop","take"],function(u,d){kt.prototype[u]=function(y){y=y===t?1:re(pt(y),0);var A=this.__filtered__&&!d?new kt(this):this.clone();return A.__filtered__?A.__takeCount__=ue(y,A.__takeCount__):A.__views__.push({size:ue(y,se),type:u+(A.__dir__<0?"Right":"")}),A},kt.prototype[u+"Right"]=function(y){return this.reverse()[u](y).reverse()}}),mr(["filter","map","takeWhile"],function(u,d){var y=d+1,A=y==pe||y==Ee;kt.prototype[u]=function(M){var W=this.clone();return W.__iteratees__.push({iteratee:Je(M,3),type:y}),W.__filtered__=W.__filtered__||A,W}}),mr(["head","last"],function(u,d){var y="take"+(d?"Right":"");kt.prototype[u]=function(){return this[y](1).value()[0]}}),mr(["initial","tail"],function(u,d){var y="drop"+(d?"":"Right");kt.prototype[u]=function(){return this.__filtered__?new kt(this):this[y](1)}}),kt.prototype.compact=function(){return this.filter(Yr)},kt.prototype.find=function(u){return this.filter(u).head()},kt.prototype.findLast=function(u){return this.reverse().find(u)},kt.prototype.invokeMap=bt(function(u,d){return typeof u=="function"?new kt(this):this.map(function(y){return Gl(y,u,d)})}),kt.prototype.reject=function(u){return this.filter(jh(Je(u)))},kt.prototype.slice=function(u,d){u=pt(u);var y=this;return y.__filtered__&&(u>0||d<0)?new kt(y):(u<0?y=y.takeRight(-u):u&&(y=y.drop(u)),d!==t&&(d=pt(d),y=d<0?y.dropRight(-d):y.take(d-u)),y)},kt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},kt.prototype.toArray=function(){return this.take(se)},ns(kt.prototype,function(u,d){var y=/^(?:filter|find|map|reject)|While$/.test(d),A=/^(?:head|last)$/.test(d),M=H[A?"take"+(d=="last"?"Right":""):d],W=A||/^find/.test(d);M&&(H.prototype[d]=function(){var ne=this.__wrapped__,ae=A?[1]:arguments,le=ne instanceof kt,Ae=ae[0],Ce=le||ct(ne),Me=function(Tt){var At=M.apply(H,$n([Tt],ae));return A&&Ue?At[0]:At};Ce&&y&&typeof Ae=="function"&&Ae.length!=1&&(le=Ce=!1);var Ue=this.__chain__,Ye=!!this.__actions__.length,et=W&&!Ue,xt=le&&!Ye;if(!W&&Ce){ne=xt?ne:new kt(this);var tt=u.apply(ne,ae);return tt.__actions__.push({func:Hh,args:[Me],thisArg:t}),new Wr(tt,Ue)}return et&&xt?u.apply(this,ae):(tt=this.thru(Me),et?A?tt.value()[0]:tt.value():tt)})}),mr(["pop","push","shift","sort","splice","unshift"],function(u){var d=Ln[u],y=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",A=/^(?:pop|shift)$/.test(u);H.prototype[u]=function(){var M=arguments;if(A&&!this.__chain__){var W=this.value();return d.apply(ct(W)?W:[],M)}return this[y](function(ne){return d.apply(ct(ne)?ne:[],M)})}}),ns(kt.prototype,function(u,d){var y=H[d];if(y){var A=y.name+"";Rt.call(ia,A)||(ia[A]=[]),ia[A].push({name:d,func:y})}}),ia[Oh(t,P).name]=[{name:"wrapper",func:t}],kt.prototype.clone=Vv,kt.prototype.reverse=Zv,kt.prototype.value=Kv,H.prototype.at=kb,H.prototype.chain=Pb,H.prototype.commit=Eb,H.prototype.next=Ab,H.prototype.plant=Sb,H.prototype.reverse=Db,H.prototype.toJSON=H.prototype.valueOf=H.prototype.value=Lb,H.prototype.first=H.prototype.head,ta&&(H.prototype[ta]=Cb),H},Qn=Uo();Ii?((Ii.exports=Qn)._=Qn,Ol._=Qn):qe._=Qn}).call(ut)})(kc,kc.exports);var fO=kc.exports;const dO=Td(fO);function pO(){return`
    <div class="layout">
      <div class="filters filters--open" id="filters">
        <div class="filters__period" id="filters__period">
          <div class="filters__header">
            <img
              class="filters__icon"
              src="./images/calendar.png"
              alt="Иконка календаря"
            />
            <h2 class="filters__big-title section-title">Выберите период</h2>
          </div>
          <div class="filters__columns filters__columns_period">
            <select
              name="filters__year"
              id="filters__year"
              class="filters__select filters__select_period"
            >
              <option value="" hidden>Выберите год</option>
            </select>
            <select
              name="filters__quarter"
              id="filters__quarter"
              class="filters__select filters__select_period disabled"
              placeholder="Выберите квартал"
              disabled
            >
              <option value="" hidden>Выберите квартал</option>
            </select>
          </div>
        </div>
        <div class="filters__file" id="filters__file">
          <div class="filters__header">
            <img
              class="filters__icon"
              src="./images/calendar.png"
              alt="Иконка календаря"
            />
            <h2 class="filters__big-title section-title">Выберите файл</h2>
          </div>
          <label class="filters__file-label">
            <span class="filters__file-text" id="filters__file-text" type="text"
              >Файл не выбран</span
            >
            <input
              type="file"
              name="filters__file-input"
              id="filters__file-input"
              class="filters__file-input"
            />
            <span class="filters__file-btn">Выберите файл</span>
          </label>
        </div>
        <div class="separator"></div>
        <div class="filters__list disabled">
          <div class="filters__item">
            <div class="filters__header">
              <img
                src="./images/search.png"
                alt="Иконка поиска"
                class="filters__icon"
              />
              <h2 class="filters__title section-title">Поиск ВСП</h2>
            </div>
            <input
              type="text"
              name="filters__search"
              id="filters__search"
              class="filters__input"
              placeholder="42_8611_170"
              disabled
            />
          </div>
          <div class="filters__item">
            <div class="filters__header">
              <img
                src="./images/marker.png"
                alt="Иконка карты"
                class="filters__icon"
              />
              <h2 class="filters__title section-title">Адрес</h2>
            </div>
            <input
              type="text"
              name="filters__address"
              id="filters__address"
              class="filters__input"
              placeholder="г.Москва, Кутузовский проспект, 32"
              disabled
            />
          </div>
          <div class="filters__item">
            <div class="filters__header">
              <img
                src="./images/marker-on-map.png"
                alt="Иконка карты"
                class="filters__icon"
              />
              <h2 class="filters__title section-title">ТБ</h2>
            </div>
            <div class="filters__column">
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="18"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Байкальский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="42"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Волго-Вятский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="70"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Дальневосточный банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="38"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Московский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="54"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Поволжский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="55"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Северо-Западный банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="44"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Сибирский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="40"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Среднерусский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="16"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Уральский банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="13"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Центрально-Черноземный банк
              </label>
              <label class="filters__label">
                <input
                  type="checkbox"
                  value="52"
                  class="filters__checkbox filters__checkbox_region"
                  disabled
                />
                Юго-Западный банк
              </label>
            </div>
          </div>
          <div class="filters__columns">
            <div class="filters__item">
              <div class="filters__header">
                <h2 class="filters__title section-title">Тип</h2>
              </div>
              <div class="filters__column">
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="БО"
                    class="filters__checkbox filters__checkbox_type"
                    disabled
                  />
                  БО
                </label>
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="ОО"
                    class="filters__checkbox filters__checkbox_type"
                    disabled
                  />
                  ОО
                </label>
              </div>
            </div>
            <div class="filters__item">
              <div class="filters__header">
                <h2 class="filters__title section-title">ВСП</h2>
              </div>
              <div class="filters__column">
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="1"
                    class="filters__checkbox filters__checkbox_check"
                    disabled
                  />
                  Проверяются
                </label>
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="0"
                    class="filters__checkbox filters__checkbox_check"
                    disabled
                  />
                  Не проверяются
                </label>
              </div>
            </div>
            <div class="filters__item">
              <div class="filters__header">
                <h2 class="filters__title section-title">ХЦК</h2>
              </div>
              <div class="filters__column">
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="1"
                    class="filters__checkbox filters__checkbox_hzk"
                    disabled
                  />
                  Есть
                </label>
                <label class="filters__label">
                  <input
                    type="checkbox"
                    value="0"
                    class="filters__checkbox filters__checkbox_hzk"
                    disabled
                  />
                  Нет
                </label>
              </div>
            </div>
          </div>
          <div class="filters__item">
            <div class="filters__header">
              <img
                src="./images/rub.png"
                alt="Иконка рубля"
                class="filters__icon"
              />
              <h2 class="filters__title section-title">
                Сумма под риском, руб.
              </h2>
            </div>
            <div class="filters__columns">
              <input
                type="number"
                name="filters__min-sum"
                id="filters__min-sum"
                class="filters__input"
                placeholder="от 0"
                disabled
              />
              <input
                type="number"
                name="filters__max-sum"
                id="filters__max-sum"
                class="filters__input"
                placeholder="до 100 000 000"
                disabled
              />
            </div>
          </div>
        </div>
        <div class="filters__btns disabled">
          <button
            id="filters__cancel-btn"
            class="btn filters__cancel-btn"
            type="submit"
            disabled
          >
            Сбросить
          </button>
          <button
            id="filters__access-btn"
            class="btn filters__access-btn"
            type="submit"
            disabled
          >
            Применить
          </button>
        </div>
      </div>
      <div class="analytics" id="analytics">
        <div class="analytics__list">
          <div class="analytics__item" id="analytics__item_commonSum">
            <h2 class="analytics__title section-title">
              Общая сумма под риском, млн. руб.
            </h2>
          </div>
      
          <div class="analytics__item" id="analytics__item_sumAndCount">
            <h2 class="analytics__title section-title">
              Сумма под риском, млрд. руб. и количествo ВСП, ед.
            </h2>
          </div>

          <div class="analytics__item display-none" id="analytics__item_GosbBlock">
            <h2 class="analytics__title section-title">Сумма под риском в ГОСБ, млн. руб.</h2>
          </div>
        </div>
      </div>
      <div class="nav nav--openFilter" id="nav">
        <button
          id="nav__filter-btn"
          class="btn nav__btn nav__filter-btn nav__filter-btn--open"
        >
          <svg
            width="512"
            height="512"
            viewBox="0 0 512 512"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M175 419L338 256L175 93"
              stroke="black"
              stroke-width="24"
              stroke-linecap="round"
            />
          </svg>
        </button>

        <button
          id="nav__analytics-btn"
          class="btn nav__btn nav__analytics-btn disabled"
          disabled="true"
        >
          <img src="./images/analytics.png" alt="analytics" />
        </button>
      </div>
      <div class="info" id="info">
        <div class="info__list">
          <div class="info__item">
            <span class="section-title" id="info__count">0</span> ВСП
          </div>
          <div class="info__item">
            <span class="section-title" id="info__sum">0</span> рублей под
            риском
          </div>
        </div>
      </div>
      <div class="details display-none" id="details">
        <div class="details__list">
          <div class="details__item">
            <span class="section-title" id="details__id">ID</span>
            <span class="section-title" id="details__type">тип</span>
          </div>
          <div class="details__item">
            <span id="details__address">Адрес</span>
          </div>
          <div class="details__item">
            <span class="section-title" id="details__sum">0</span> рублей под
            риском
          </div>
          <div class="details__item display-none" id="details__item-hzk">
            <span>&check; Хранилище ценностей клиентов</span>
          </div>
        </div>
      </div>
      <div class="map" id="map"></div>
    </div>
  `}function xa(r){return Number(r)!==r}function gO(r){return{}.toString.call(r)}function an(r){if(r!=null&&!ve(r)){let e=Number(r);return xa(e)&&cl(r)&&r!=""?an(r.replace(/[^0-9.\-]+/g,"")):e}return r}function _O(r){if(hd(r))return new Date(r);if(ve(r))return new Date(r);{let e=Number(r);return ve(e)?new Date(e):new Date(r)}}function mO(r){if(xa(r))return"NaN";if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(r===0&&1/r===-1/0)return"-0";let e=r<0;r=Math.abs(r);let t=/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+r),i=t[1],n=t[2]||"",s;if(t[3]===void 0)s=n===""?i:i+"."+n;else{let a=+t[3];if(r<1){let l=a-1;s="0."+wm("0",l)+i+n}else{let l=a-n.length;l===0?s=i+n:l<0?s=i+n.slice(0,l)+"."+n.slice(l):s=i+n+wm("0",l)}}return e?"-"+s:s}function wm(r,e){return new Array(e+1).join(r)}function hd(r){return gO(r)==="[object Date]"}function cl(r){return typeof r=="string"}function ve(r){return typeof r=="number"&&Number(r)==r}function Xc(r){return typeof r=="object"&&r!==null}const va="__§§§__",il="__§§§§__";function Su(r,e){const t=r.length;for(let i=0;i<t;++i)if(r[i]===e)return i;return-1}function xO(r,e){const t=r.length;for(let i=0;i<t;++i)if(e(r[i]))return!0;return!1}function cd(r,e){const t=r.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=e(r[n],n);return i}function ce(r,e){const t=r.length;for(let i=0;i<t;++i)e(r[i],i)}function xu(r,e){let t=r.length;for(;t>0;)--t,e(r[t],t)}function Ev(r,e){const t=r.length;for(let i=0;i<t&&e(r[i],i);++i);}function yn(r,e){let t=!1,i=0;for(;;){if(i=r.indexOf(e,i),i===-1)return t;t=!0,r.splice(i,1)}}function Cr(r,e){let t=r.indexOf(e);return t!==-1?(r.splice(t,1),!0):!1}function Tm(r,e,t){let i=Su(r,e);i!==-1&&dd(r,i),t==null?r.push(e):uc(r,t,e)}function Du(r,e){r.indexOf(e)===-1&&r.push(e)}function fd(r){const e=r.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=r[i];return t}function uc(r,e,t){r.splice(e,0,t)}function dd(r,e){r.splice(e,1)}function Av(r,e){const t=r.length;for(let i=0;i<t;++i)if(e(r[i],i))return i;return-1}function vO(r,e){let t=r.length;for(;t>0;)if(--t,e(r[t],t))return t;return-1}function Cv(r,e){const t=Av(r,e);if(t!==-1)return r[t]}function yO(r,e){const t=vO(r,e);if(t!==-1)return r[t]}function bO(r,e){let t=0,i=r.length,n=!1;for(;t<i;){const s=t+i>>1,a=e(r[s]);a<0?t=s+1:a===0?(n=!0,t=s+1):i=s}return{found:n,index:n?t-1:t}}function wO(r,e){let t=0,i=r.length,n=!1;for(;t<i;){const s=t+i>>1,a=e(r[s]);a<0?t=s+1:(a===0&&(n=!0),i=s)}return{found:n,index:t}}function Gc(r,e){let t=r.length;for(;t>0;)--t,e(r[t])||r.splice(t,1)}class Qd{constructor(){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class Ni{constructor(e){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=e}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class TO extends Qd{constructor(){super(...arguments),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_dispose(){ce(this._disposers,e=>{e.dispose()})}}class Kr extends Qd{constructor(e){super(),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposers=e}_dispose(){ce(this._disposers,e=>{e.dispose()})}get disposers(){return this._disposers}}class Sv extends Ni{constructor(){super(...arguments),Object.defineProperty(this,"_counter",{enumerable:!0,configurable:!0,writable:!0,value:0})}increment(){return++this._counter,new Ni(()=>{--this._counter,this._counter===0&&this.dispose()})}}class wl{constructor(){Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}isDisposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;const e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{ce(e,t=>{t.disposer.dispose()})}finally{this._killed=null,this._iterating=null}}}hasListeners(){return this._listeners.length!==0}hasListenersByType(e){return xO(this._listeners,t=>(t.type===null||t.type===e)&&!t.killed)}enable(){this._enabled=!0}disable(){this._enabled=!1}enableType(e){delete this._disabled[e]}disableType(e,t=1/0){this._disabled[e]=t}_removeListener(e){if(this._iterating===0){const t=this._listeners.indexOf(e);if(t===-1)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}_removeExistingListener(e,t,i,n){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener(s=>{s.once===e&&s.type===t&&(i===void 0||s.callback===i)&&s.context===n&&s.disposer.dispose()})}isEnabled(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&this._disabled[e]===void 0}removeType(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener(t=>{t.type===e&&t.disposer.dispose()})}has(e,t,i){return Av(this._listeners,s=>s.once!==!0&&s.type===e&&(t===void 0||s.callback===t)&&s.context===i)!==-1}_shouldDispatch(e){if(this._disposed)throw new Error("EventDispatcher is disposed");const t=this._disabled[e];return ve(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled}_eachListener(e){++this._iterating;try{ce(this._listeners,e)}finally{--this._iterating,this._iterating===0&&this._killed.length!==0&&(ce(this._killed,t=>{this._removeListener(t)}),this._killed.length=0)}}dispatch(e,t){this._shouldDispatch(e)&&this._eachListener(i=>{!i.killed&&(i.type===null||i.type===e)&&i.dispatch(e,t)})}_on(e,t,i,n,s,a){if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,n);const l={type:t,callback:i,context:n,shouldClone:s,dispatch:a,killed:!1,once:e,disposer:new Ni(()=>{l.killed=!0,this._removeListener(l)})};return this._listeners.push(l),l}onAll(e,t,i=!0){return this._on(!1,null,e,t,i,(n,s)=>e.call(t,s)).disposer}on(e,t,i,n=!0){return this._on(!1,e,t,i,n,(s,a)=>t.call(i,a)).disposer}once(e,t,i,n=!0){const s=this._on(!0,e,t,i,n,(a,l)=>{s.disposer.dispose(),t.call(i,l)});return s.disposer}off(e,t,i){this._removeExistingListener(!1,e,t,i)}copyFrom(e){if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");const t=[];return ce(e._listeners,i=>{!i.killed&&i.shouldClone&&(i.type===null?t.push(this.onAll(i.callback,i.context)):i.once?t.push(this.once(i.type,i.callback,i.context)):t.push(this.on(i.type,i.callback,i.context)))}),new Kr(t)}}function Jl(r,e){if(!(r>=0&&r<e))throw new Error("Index out of bounds: "+r)}class Tl{constructor(e=[]){Object.defineProperty(this,"_values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new wl}),this._values=e}get values(){return this._values}contains(e){return this._values.indexOf(e)!==-1}removeValue(e){let t=0,i=this._values.length;for(;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t}indexOf(e){return Su(this._values,e)}get length(){return this._values.length}hasIndex(e){return e>=0&&e<this._values.length}getIndex(e){return this._values[e]}_onPush(e){this.events.isEnabled("push")&&this.events.dispatch("push",{type:"push",target:this,newValue:e})}_onInsertIndex(e,t){this.events.isEnabled("insertIndex")&&this.events.dispatch("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t})}_onSetIndex(e,t,i){this.events.isEnabled("setIndex")&&this.events.dispatch("setIndex",{type:"setIndex",target:this,index:e,oldValue:t,newValue:i})}_onRemoveIndex(e,t){this.events.isEnabled("removeIndex")&&this.events.dispatch("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t})}_onMoveIndex(e,t,i){this.events.isEnabled("moveIndex")&&this.events.dispatch("moveIndex",{type:"moveIndex",target:this,oldIndex:e,newIndex:t,value:i})}_onClear(e){this.events.isEnabled("clear")&&this.events.dispatch("clear",{type:"clear",target:this,oldValues:e})}setIndex(e,t){Jl(e,this._values.length);const i=this._values[e];return i!==t&&(this._values[e]=t,this._onSetIndex(e,i,t)),i}insertIndex(e,t){return Jl(e,this._values.length+1),uc(this._values,e,t),this._onInsertIndex(e,t),t}swap(e,t){const i=this._values.length;if(Jl(e,i),Jl(t,i),e!==t){const n=this._values[e],s=this._values[t];this._values[e]=s,this._onSetIndex(e,n,s),this._values[t]=n,this._onSetIndex(t,s,n)}}removeIndex(e){Jl(e,this._values.length);const t=this._values[e];return dd(this._values,e),this._onRemoveIndex(e,t),t}moveValue(e,t){let i=this.indexOf(e);if(i!==-1)if(dd(this._values,i),t==null){const n=this._values.length;this._values.push(e),this._onMoveIndex(i,n,e)}else uc(this._values,t,e),this._onMoveIndex(i,t,e);else t==null?(this._values.push(e),this._onPush(e)):(uc(this._values,t,e),this._onInsertIndex(t,e));return e}push(e){return this._values.push(e),this._onPush(e),e}unshift(e){return this.insertIndex(0,e),e}pushAll(e){ce(e,t=>{this.push(t)})}copyFrom(e){this.pushAll(e._values)}pop(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)}shift(){return this._values.length?this.removeIndex(0):void 0}setAll(e){const t=this._values;this._values=[],this._onClear(t),ce(e,i=>{this._values.push(i),this._onPush(i)})}clear(){this.setAll([])}*[Symbol.iterator](){const e=this._values.length;for(let t=0;t<e;++t)yield this._values[t]}each(e){ce(this._values,e)}eachReverse(e){xu(this._values,e)}}class Pc extends Tl{constructor(){super(...arguments),Object.defineProperty(this,"autoDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_onSetIndex(e,t,i){this.autoDispose&&t.dispose(),super._onSetIndex(e,t,i)}_onRemoveIndex(e,t){this.autoDispose&&t.dispose(),super._onRemoveIndex(e,t)}_onClear(e){this.autoDispose&&ce(e,t=>{t.dispose()}),super._onClear(e)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.autoDispose&&ce(this._values,e=>{e.dispose()}))}}class $r extends Pc{constructor(e,t){super(),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"make",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e,this.make=t}}class kO extends Tl{constructor(e){super(),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._container=e,this._events=this.events.onAll(t=>{if(t.type==="clear")ce(t.oldValues,i=>{this._onRemoved(i)});else if(t.type==="push")this._onInserted(t.newValue);else if(t.type==="setIndex")this._onRemoved(t.oldValue),this._onInserted(t.newValue,t.index);else if(t.type==="insertIndex")this._onInserted(t.newValue,t.index);else if(t.type==="removeIndex")this._onRemoved(t.oldValue);else if(t.type==="moveIndex")this._onRemoved(t.value),this._onInserted(t.value,t.newIndex);else throw new Error("Unknown IListEvent type")})}_onInserted(e,t){e._setParent(this._container,!0);const i=this._container._childrenDisplay;t===void 0?i.addChild(e._display):i.addChildAt(e._display,t)}_onRemoved(e){this._container._childrenDisplay.removeChild(e._display),this._container.markDirtyBounds(),this._container.markDirty()}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._events.dispose(),ce(this.values,e=>{e.dispose()}))}}class gt{constructor(e){Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=e}get value(){return this._value/100}get percent(){return this._value}toString(){return""+this._value+"%"}interpolate(e,t){return e+this.value*(t-e)}static normalize(e,t,i){return e instanceof gt?e:t===i?new gt(0):new gt(Math.min(Math.max((e-t)*(1/(i-t)),0),1)*100)}}function ar(r){return new gt(r)}ar(0);const ze=ar(100),ot=ar(50);function Oi(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(p){try{c(i.next(p))}catch(g){a(g)}}function h(p){try{c(i.throw(p))}catch(g){a(g)}}function c(p){p.done?s(p.value):n(p.value).then(l,h)}c((i=i.apply(r,e||[])).next())})}function Li(r){return Object.keys(r)}function PO(r,e){return Li(r).sort(e)}function su(r){return Object.assign({},r)}function Zt(r,e){Li(r).forEach(t=>{e(t,r[t])})}function EO(r,e){for(let t in r)if(AO(r,t)&&!e(t,r[t]))break}function AO(r,e){return{}.hasOwnProperty.call(r,e)}function CO(r){r.parentNode&&r.parentNode.removeChild(r)}function fi(r,e,t,i){return r.addEventListener(e,t,i||!1),new Ni(()=>{r.removeEventListener(e,t,i||!1)})}function Dv(r){return fi(window,"resize",e=>{r()})}function Ns(r){switch(r){case"touchevents":return window.hasOwnProperty("TouchEvent");case"pointerevents":return window.hasOwnProperty("PointerEvent");case"mouseevents":return window.hasOwnProperty("MouseEvent");case"wheelevents":return window.hasOwnProperty("WheelEvent");case"keyboardevents":return window.hasOwnProperty("KeyboardEvent")}return!1}function Xf(r){return r.pointerId||0}function SO(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{let r=document.createElement("button");r.style.position="fixed",r.style.top="0px",r.style.left="-10000px",document.body.appendChild(r),r.focus(),r.blur(),document.body.removeChild(r)}}function DO(r){r&&r.focus()}function pd(r){if(Ns("pointerevents"))return r;if(Ns("touchevents"))switch(r){case"pointerover":return"touchstart";case"pointerout":return"touchend";case"pointerleave":return"touchend";case"pointerdown":return"touchstart";case"pointermove":return"touchmove";case"pointerup":return"touchend";case"click":return"click";case"dblclick":return"dblclick"}else if(Ns("mouseevents"))switch(r){case"pointerover":return"mouseover";case"pointerout":return"mouseout";case"pointerleave":return"mouseleave";case"pointerdown":return"mousedown";case"pointermove":return"mousemove";case"pointerup":return"mouseup";case"click":return"click";case"dblclick":return"dblclick"}return r}function gd(r){if(typeof Touch<"u"&&r instanceof Touch)return!0;if(typeof PointerEvent<"u"&&r instanceof PointerEvent&&r.pointerType!=null)switch(r.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(r instanceof MouseEvent)}else if(r.type!=null&&r.type.match(/^mouse/))return!1;return!0}function Gf(r,e,t){r.style[e]=t}function LO(r,e){return r.style[e]}function Lv(r){if(r.composedPath){const e=r.composedPath();return e.length===0?null:e[0]}else return r.target}function OO(r,e){let t=e;for(;;){if(r===t)return!0;if(t.parentNode===null){if(t.host==null)return!1;t=t.host}else t=t.parentNode}}function Ov(r,e){return r.target&&OO(e.root.dom,r.target)}function el(r,e){e?r.style.pointerEvents="auto":r.style.pointerEvents="none"}function MO(){return/apple/i.test(navigator.vendor)&&"ontouchend"in document}function FO(){return MO()?1:void 0}function ai(r,e){return ve(r)?r:r!=null&&ve(r.value)&&ve(e)?e*r.value:0}function RO(r){let e=(""+r).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}function yi(r,e=0,t="0"){return typeof r!="string"&&(r=r.toString()),e>r.length?Array(e-r.length+1).join(t)+r:r}function IO(r){return r.replace(/^[\s]*/,"")}function BO(r){return r.replace(/[\s]*$/,"")}function hc(r){return IO(BO(r))}function NO(r){if(typeof r>"u")return"string";r=r.toLowerCase().replace(/^\[[^\]]*\]/,""),r=r.replace(/\[[^\]]+\]/,""),r=r.trim();let e=r.match(/\/(date|number|duration)$/);return e?e[1]:r==="number"?"number":r==="date"?"date":r==="duration"?"duration":r.match(/[#0]/)?"number":r.match(/[ymwdhnsqaxkzgtei]/)?"date":"string"}function ep(r){return r.replace(/\/(date|number|duration)$/i,"")}function km(r){return r&&r.replace(/<[^>]*>/g,"")}function Pm(r){return r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Em(r,e=!1){const t=new Date(r.getFullYear(),0,0),i=r.getTime()-t.getTime()+(t.getTimezoneOffset()-r.getTimezoneOffset())*60*1e3,n=1e3*60*60*24;return Math.floor(i/n)}function Ec(r,e=!1){const t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}function HO(r,e=!1){const t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),i=t.getUTCDay()||7;return t.setUTCDate(t.getUTCDate()+4-i),new Date(Date.UTC(t.getUTCFullYear(),0,1)).getFullYear()}function zO(r,e=!1){const t=Ec(new Date(r.getFullYear(),r.getMonth(),1),e);let i=Ec(r,e);return i==1&&(i=53),i-t+1}function UO(r,e,t=1,i=!1){let n=new Date(e,0,4,0,0,0,0);return i&&n.setUTCFullYear(e),r*7+t-((n.getDay()||7)+3)}function ic(r,e){return r>12?r-=12:r===0&&(r=12),e!=null?r+(e-1):r}function rc(r,e=!1,t=!1,i=!1){if(i)return e?"Coordinated Universal Time":"UTC";let n=r.toLocaleString("UTC"),s=r.toLocaleString("UTC",{timeZoneName:e?"long":"short"}).substr(n.length);return t===!1&&(s=s.replace(/ (standard|daylight|summer|winter) /i," ")),s}function WO(r){const e=new Date(Date.UTC(2012,0,1,0,0,0,0)),t=new Date(e.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(e.toLocaleString("en-US",{timeZone:r})).getTime()-t.getTime())/6e4*-1}function Am(r){return r.charAt(0).toUpperCase()+r.slice(1)}function Mv(r){let e,t,i,n=r.h,s=r.s,a=r.l;if(s==0)e=t=i=a;else{let l=function(g,m,_){return _<0&&(_+=1),_>1&&(_-=1),_<.16666666666666666?g+(m-g)*6*_:_<.5?m:_<.6666666666666666?g+(m-g)*(.6666666666666666-_)*6:g},h=a<.5?a*(1+s):a+s-a*s,c=2*a-h;e=l(c,h,n+1/3),t=l(c,h,n),i=l(c,h,n-1/3)}return{r:Math.round(e*255),g:Math.round(t*255),b:Math.round(i*255)}}function Fv(r){let e=r.r/255,t=r.g/255,i=r.b/255,n=Math.max(e,t,i),s=Math.min(e,t,i),a=0,l=0,h=(n+s)/2;if(n===s)a=l=0;else{let c=n-s;switch(l=h>.5?c/(2-n-s):c/(n+s),n){case e:a=(t-i)/c+(t<i?6:0);break;case t:a=(i-e)/c+2;break;case i:a=(e-t)/c+4;break}a/=6}return{h:a,s:l,l:h}}function jO(r,e){return r&&{r:Math.max(0,Math.min(255,r.r+cc(r.r,e))),g:Math.max(0,Math.min(255,r.g+cc(r.g,e))),b:Math.max(0,Math.min(255,r.b+cc(r.b,e))),a:r.a}}function cc(r,e){let t=e>0?255-r:r;return Math.round(t*e)}function XO(r,e){if(r){let t=Math.min(Math.max(r.r,r.g,r.b),230),i=cc(t,e);return{r:Math.max(0,Math.min(255,Math.round(r.r+i))),g:Math.max(0,Math.min(255,Math.round(r.g+i))),b:Math.max(0,Math.min(255,Math.round(r.b+i))),a:r.a}}else return r}function Cm(r){return(r.r*299+r.g*587+r.b*114)/1e3>=128}function GO(r,e){if(r===void 0||e==1)return r;let t=Fv(r);return t.s=e,Mv(t)}function YO(r,e={r:255,g:255,b:255},t={r:255,g:255,b:255}){let i=e,n=t;return Cm(t)&&(i=t,n=e),Cm(r)?n:i}function It(r,e){return r||(r=[]),[...r,...e].filter((t,i,n)=>n.indexOf(t)===i)}function Rv(r,e){return!(!e||r.left!=e.left||r.right!=e.right||r.top!=e.top||r.bottom!=e.bottom)}function Iv(r){return r[0]==="#"&&(r=r.substr(1)),r.length==3&&(r=r[0].repeat(2)+r[1].repeat(2)+r[2].repeat(2)),parseInt(r,16)}function VO(r){r=r.replace(/[ ]/g,"");let e=r.match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(e)e.push("1");else if(e=r.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i),!e)return 0;let t="";for(let i=1;i<=3;i++){let n=parseInt(e[i]).toString(16);n.length==1&&(n="0"+n),t+=n}return Iv(t)}function Ql(r){return Ve.fromAny(r)}class Ve{constructor(e){Object.defineProperty(this,"_hex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hex=e|0}get hex(){return this._hex}get r(){return this._hex>>>16}get g(){return this._hex>>8&255}get b(){return this._hex&255}toCSS(e=1){return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"}toCSSHex(){return"#"+yi(this.r.toString(16),2)+yi(this.g.toString(16),2)+yi(this.b.toString(16),2)}toHSL(e=1){return Fv({r:this.r,g:this.g,b:this.b,a:e})}static fromHSL(e,t,i){const n=Mv({h:e,s:t,l:i});return this.fromRGB(n.r,n.g,n.b)}toString(){return this.toCSSHex()}static fromHex(e){return new Ve(e)}static fromRGB(e,t,i){return new Ve((i|0)+(t<<8)+(e<<16))}static fromString(e){return new Ve(Iv(e))}static fromCSS(e){return new Ve(VO(e))}static fromAny(e){if(cl(e)){if(e[0]=="#")return Ve.fromString(e);if(e.substr(0,3)=="rgb")return Ve.fromCSS(e)}else{if(ve(e))return Ve.fromHex(e);if(e instanceof Ve)return Ve.fromHex(e.hex)}throw new Error("Unknown color syntax: "+e)}static alternative(e,t,i){const n=YO({r:e.r,g:e.g,b:e.b},t?{r:t.r,g:t.g,b:t.b}:void 0,i?{r:i.r,g:i.g,b:i.b}:void 0);return this.fromRGB(n.r,n.g,n.b)}static interpolate(e,t,i,n="rgb"){if(n=="hsl"){const s=t.toHSL(),a=i.toHSL();return Ve.fromHSL(ha(e,s.h,a.h),ha(e,s.s,a.s),ha(e,s.l,a.l))}else return Ve.fromRGB(ha(e,t.r,i.r),ha(e,t.g,i.g),ha(e,t.b,i.b))}static lighten(e,t){const i=jO({r:e.r,g:e.g,b:e.b},t);return Ve.fromRGB(i.r,i.g,i.b)}static brighten(e,t){const i=XO({r:e.r,g:e.g,b:e.b},t);return Ve.fromRGB(i.r,i.g,i.b)}static saturate(e,t){const i=GO({r:e.r,g:e.g,b:e.b},t);return Ve.fromRGB(i.r,i.g,i.b)}}function Sm(r){return Oi(this,void 0,void 0,function*(){if(r!==void 0){const e=[];Zt(r,(t,i)=>{e.push(i.waitForStop())}),yield Promise.all(e)}})}function ha(r,e,t){return e+r*(t-e)}function ZO(r,e,t){return r>=1?t:e}function Bv(r,e,t){return new gt(ha(r,e.percent,t.percent))}function KO(r,e,t){return Ve.interpolate(r,e,t)}function $O(r,e){return typeof r=="number"&&typeof e=="number"?ha:r instanceof gt&&e instanceof gt?Bv:r instanceof Ve&&e instanceof Ve?KO:ZO}const Nv=Math.PI,Lu=Nv/180,vu=180/Nv;function kr(r,e,t){if(!ve(e)||e<=0){let i=Math.round(r);return t&&i-r==.5&&i--,i}else{let i=Math.pow(10,e);return Math.round(r*i)/i}}function qO(r,e){if(!ve(e)||e<=0)return Math.ceil(r);{let t=Math.pow(10,e);return Math.ceil(r*t)/t}}function Di(r,e,t){return Math.min(Math.max(r,e),t)}function bn(r){return Math.sin(Lu*r)}function cs(r){return Math.cos(Lu*r)}function tp(r){return r=r%360,r<0&&(r+=360),r}function _d(r,e,t,i,n){let s=Number.MAX_VALUE,a=Number.MAX_VALUE,l=-Number.MAX_VALUE,h=-Number.MAX_VALUE,c=[];c.push(Yf(n,t)),c.push(Yf(n,i));let p=Math.min(Math.floor(t/90)*90,Math.floor(i/90)*90),g=Math.max(Math.ceil(t/90)*90,Math.ceil(i/90)*90);for(let m=p;m<=g;m+=90)m>=t&&m<=i&&c.push(Yf(n,m));for(let m=0;m<c.length;m++){let _=c[m];_.x<s&&(s=_.x),_.y<a&&(a=_.y),_.x>l&&(l=_.x),_.y>h&&(h=_.y)}return{left:r+s,top:e+a,right:r+l,bottom:e+h}}function Yf(r,e){return{x:r*cs(e),y:r*bn(e)}}function JO(r){const e=r.length;if(e>0){let t=r[0],i=t.left,n=t.top,s=t.right,a=t.bottom;if(e>1)for(let l=1;l<e;l++)t=r[l],i=Math.min(t.left,i),s=Math.max(t.right,s),n=Math.min(t.top,n),a=Math.max(t.bottom,a);return{left:i,right:s,top:n,bottom:a}}return{left:0,right:0,top:0,bottom:0}}function Dm(r){return r}function au(r){return r*r*r}function nc(r){return function(e){return 1-r(1-e)}}class QO{constructor(e,t){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e,this._settings=t,Zt(t,i=>{this._userSettings[i]=!0})}get(e,t){const i=this._settings[e];return i!==void 0?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._userSettings[e]=!0,this.setRaw(e,t)}remove(e){delete this._userSettings[e],delete this._settings[e]}setAll(e){Li(e).forEach(t=>{this.set(t,e[t])})}_eachSetting(e){Zt(this._settings,e)}apply(){const e={};e.stateAnimationEasing=!0,e.stateAnimationDuration=!0;const t=this._entity.states.lookup("default");this._eachSetting((i,n)=>{e[i]||(e[i]=!0,this!==t&&(i in t._settings||(t._settings[i]=this._entity.get(i))),this._entity.set(i,n))})}applyAnimate(e){e==null&&(e=this._settings.stateAnimationDuration),e==null&&(e=this.get("stateAnimationDuration",this._entity.get("stateAnimationDuration",0)));let t=this._settings.stateAnimationEasing;t==null&&(t=this.get("stateAnimationEasing",this._entity.get("stateAnimationEasing",au)));const i=this._entity.states.lookup("default"),n={};n.stateAnimationEasing=!0,n.stateAnimationDuration=!0;const s={};return this._eachSetting((a,l)=>{if(!n[a]){n[a]=!0,this!=i&&(a in i._settings||(i._settings[a]=this._entity.get(a)));const h=this._entity.animate({key:a,to:l,duration:e,easing:t});h&&(s[a]=h)}}),s}}class e8{constructor(e){Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._entity=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const n=new QO(this._entity,t);return this._states[e]=n,n}}remove(e){delete this._states[e]}apply(e){const t=this._states[e];t&&t.apply(),this._entity._applyState(e)}applyAnimate(e,t){let i;const n=this._states[e];return n&&(i=n.applyAnimate(t)),this._entity._applyStateAnimated(e,t),i}}class t8{constructor(){Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.3.16"}),Object.defineProperty(this,"licenses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"rootElements",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}const hs=new t8;function io(r,e){return r===e?0:r<e?-1:1}function Hv(r,e,t){const i=r.length,n=e.length,s=Math.min(i,n);for(let a=0;a<s;++a){const l=t(r[a],e[a]);if(l!==0)return l}return io(i,n)}function Lm(r,e){return r===e?0:r<e?-1:1}class i8{constructor(e){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e}add(e,t){let i=this._callbacks[e];return i===void 0&&(i=this._callbacks[e]=[]),i.push(t),this._entity._markDirtyKey(e),new Ni(()=>{Cr(i,t)&&this._entity._markDirtyKey(e)})}remove(e){const t=this._callbacks[e];t!==void 0&&(delete this._callbacks[e],t.length!==0&&this._entity._markDirtyKey(e))}enable(e){this._disabled[e]&&(delete this._disabled[e],this._entity._markDirtyKey(e))}disable(e){this._disabled[e]||(this._disabled[e]=!0,this._entity._markDirtyKey(e))}fold(e,t){if(!this._disabled[e]){const i=this._callbacks[e];if(i!==void 0)for(let n=0,s=i.length;n<s;++n)t=i[n](t,this._entity,e)}return t}}class sc{constructor(e,t,i,n,s,a,l){Object.defineProperty(this,"_animation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_from",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_to",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interpolate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_oldTime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_stopped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_playing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new wl}),this._animation=e,this._from=t,this._to=i,this._duration=n,this._easing=s,this._loops=a,this._interpolate=$O(t,i),this._oldTime=l}get to(){return this._to}get from(){return this._from}get playing(){return this._playing}get stopped(){return this._stopped}stop(){this._stopped||(this._stopped=!0,this._playing=!1,this.events.isEnabled("stopped")&&this.events.dispatch("stopped",{type:"stopped",target:this}))}pause(){this._playing=!1,this._oldTime=null}play(){!this._stopped&&!this._playing&&(this._playing=!0,this._animation._startAnimation())}get percentage(){return this._time/this._duration}waitForStop(){return new Promise((e,t)=>{if(this._stopped)e();else{const i=()=>{n.dispose(),e()},n=this.events.on("stopped",i)}})}_checkEnded(){return this._loops>1?(--this._loops,!1):!0}_run(e){this._oldTime!==null&&(this._time+=e-this._oldTime,this._time>this._duration&&(this._time=this._duration)),this._oldTime=e}_reset(e){this._oldTime=e,this._time=0}_value(e){return this._interpolate(this._easing(e),this._from,this._to)}}let r8=0;class zv{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:++r8}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_userProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._settings=e}_checkDirty(){Li(this._settings).forEach(e=>{this._userProperties[e]=!0,this._markDirtyKey(e)})}resetUserSettings(){this._userProperties={}}_runAnimation(e){if(this.isDisposed())return!1;{let t=!1;return Zt(this._animatingSettings,(i,n)=>{if(n._stopped)this._stopAnimation(i);else if(n._playing){n._run(e);const s=n.percentage;s>=1?n._checkEnded()?this.set(i,n._value(1)):(t=!0,n._reset(e),this._set(i,n._value(1))):(t=!0,this._set(i,n._value(s)))}}),Zt(this._animatingPrivateSettings,(i,n)=>{if(n._stopped)this._stopAnimationPrivate(i);else if(n._playing){n._run(e);const s=n.percentage;s>=1?n._checkEnded()?this.setPrivate(i,n._value(1)):(t=!0,n._reset(e),this._setPrivate(i,n._value(1))):(t=!0,this._setPrivate(i,n._value(s)))}}),t}}_markDirtyKey(e){this.markDirty()}_markDirtyPrivateKey(e){this.markDirty()}on(e,t){let i=this._settingEvents[e];return i===void 0&&(i=this._settingEvents[e]=[]),i.push(t),new Ni(()=>{Cr(i,t),i.length===0&&delete this._settingEvents[e]})}onPrivate(e,t){let i=this._privateSettingEvents[e];return i===void 0&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ni(()=>{Cr(i,t),i.length===0&&delete this._privateSettingEvents[e]})}getRaw(e,t){const i=this._settings[e];return i!==void 0?i:t}get(e,t){return this.getRaw(e,t)}_sendKeyEvent(e,t){const i=this._settingEvents[e];i!==void 0&&ce(i,n=>{n(t,this,e)})}_sendPrivateKeyEvent(e,t){const i=this._privateSettingEvents[e];i!==void 0&&ce(i,n=>{n(t,this,e)})}_setRaw(e,t,i){this._prevSettings[e]=t,this._sendKeyEvent(e,i)}setRaw(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&this._setRaw(e,i,t)}_set(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&(this._setRaw(e,i,t),this._markDirtyKey(e))}_stopAnimation(e){const t=this._animatingSettings[e];t&&(delete this._animatingSettings[e],t.stop())}set(e,t){return this._set(e,t),this._stopAnimation(e),t}remove(e){e in this._settings&&(this._prevSettings[e]=this._settings[e],delete this._settings[e],this._sendKeyEvent(e,void 0),this._markDirtyKey(e)),this._stopAnimation(e)}removeAll(){ce(Li(this._settings),e=>{this.remove(e)})}getPrivate(e,t){const i=this._privateSettings[e];return i!==void 0?i:t}_setPrivateRaw(e,t,i){this._prevPrivateSettings[e]=t,this._sendPrivateKeyEvent(e,i)}setPrivateRaw(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&this._setPrivateRaw(e,i,t)}_setPrivate(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&(this._setPrivateRaw(e,i,t),this._markDirtyPrivateKey(e))}_stopAnimationPrivate(e){const t=this._animatingPrivateSettings[e];t&&(t.stop(),delete this._animatingPrivateSettings[e])}setPrivate(e,t){return this._setPrivate(e,t),this._stopAnimationPrivate(e),t}removePrivate(e){e in this._privateSettings&&(this._prevPrivateSettings[e]=this._privateSettings[e],delete this._privateSettings[e],this._markDirtyPrivateKey(e)),this._stopAnimationPrivate(e)}setAll(e){Zt(e,(t,i)=>{this.set(t,i)})}animate(e){const t=e.key,i=e.to,n=e.duration||0,s=e.loops||1,a=e.from===void 0?this.get(t):e.from,l=e.easing===void 0?Dm:e.easing;if(n===0)this.set(t,i);else if(a===void 0||a===i)this.set(t,i);else{this.set(t,a);const c=this._animatingSettings[t]=new sc(this,a,i,n,l,s,this._animationTime());return this._startAnimation(),c}const h=new sc(this,a,i,n,l,s,null);return h.stop(),h}animatePrivate(e){const t=e.key,i=e.to,n=e.duration||0,s=e.loops||1,a=e.from===void 0?this.getPrivate(t):e.from,l=e.easing===void 0?Dm:e.easing;if(n===0)this.setPrivate(t,i);else if(a===void 0||a===i)this.setPrivate(t,i);else{this.setPrivate(t,a);const c=this._animatingPrivateSettings[t]=new sc(this,a,i,n,l,s,this._animationTime());return this._startAnimation(),c}const h=new sc(this,a,i,n,l,s,null);return h.stop(),h}_dispose(){}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class dr extends zv{constructor(e,t,i,n=[]){if(super(t),Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_user_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new e8(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new i8(this)}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:this._createEvents()}),Object.defineProperty(this,"_userPrivateProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPrivate",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_internalTemplates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_defaultThemes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_templateDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_runSetup",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposerProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._root=e,this._internalTemplates=n,t.id&&this._registerId(t.id)}static new(e,t,i){const n=new this(e,t,!0);return n._template=i,n._afterNew(),n}static _new(e,t,i=[]){const n=new this(e,t,!0,i);return n._afterNew(),n}_afterNew(){this._checkDirty();let e=!1;const t=this._template;t&&(e=!0,t._setObjectTemplate(this)),ce(this._internalTemplates,i=>{e=!0,i._setObjectTemplate(this)}),e&&this._applyTemplates(!1),this.states.create("default",{}),this._setDefaults()}_afterNewApplyThemes(){this._checkDirty();const e=this._template;e&&e._setObjectTemplate(this),ce(this._internalTemplates,t=>{t._setObjectTemplate(this)}),this.states.create("default",{}),this._setDefaults(),this._applyThemes()}_createEvents(){return new wl}get classNames(){return this.constructor.classNames}get className(){return this.constructor.className}_setDefaults(){}_setDefault(e,t){e in this._settings||super.set(e,t)}_setRawDefault(e,t){e in this._settings||super.setRaw(e,t)}_clearDirty(){Li(this._dirty).forEach(e=>{this._dirty[e]=!1}),Li(this._dirtyPrivate).forEach(e=>{this._dirtyPrivate[e]=!1})}isDirty(e){return!!this._dirty[e]}isPrivateDirty(e){return!!this._dirtyPrivate[e]}_markDirtyKey(e){this._dirty[e]=!0,super._markDirtyKey(e)}_markDirtyPrivateKey(e){this._dirtyPrivate[e]=!0,super._markDirtyKey(e)}isType(e){return this.classNames.indexOf(e)!==-1}_pushPropertyDisposer(e,t){let i=this._disposerProperties[e];return i===void 0&&(i=this._disposerProperties[e]=[]),i.push(t),t}_disposeProperty(e){const t=this._disposerProperties[e];t!==void 0&&(ce(t,i=>{i.dispose()}),delete this._disposerProperties[e])}set template(e){const t=this._template;t!==e&&(this._template=e,t&&t._removeObjectTemplate(this),e&&e._setObjectTemplate(this),this._applyTemplates())}get template(){return this._template}markDirty(){this._root._addDirtyEntity(this)}_startAnimation(){this._root._addAnimation(this)}_animationTime(){return this._root.animationTime}_applyState(e){}_applyStateAnimated(e,t){}get(e,t){const i=this.adapters.fold(e,this._settings[e]);return i!==void 0?i:t}isUserSetting(e){return this._userProperties[e]||!1}set(e,t){return this._userProperties[e]=!0,super.set(e,t)}setRaw(e,t){this._userProperties[e]=!0,super.setRaw(e,t)}_setSoft(e,t){return this._userProperties[e]?t:super.set(e,t)}remove(e){delete this._userProperties[e],this._removeTemplateProperty(e)}setPrivate(e,t){return this._userPrivateProperties[e]=!0,super.setPrivate(e,t)}setPrivateRaw(e,t){this._userPrivateProperties[e]=!0,super.setPrivateRaw(e,t)}removePrivate(e){delete this._userPrivateProperties[e],this._removeTemplatePrivateProperty(e)}_setTemplateProperty(e,t,i){if(!this._userProperties[t]){const n=this._findTemplateByKey(t);e===n&&super.set(t,i)}}_setTemplatePrivateProperty(e,t,i){if(!this._userPrivateProperties[t]){const n=this._findTemplateByPrivateKey(t);e===n&&super.setPrivate(t,i)}}_removeTemplateProperty(e){if(!this._userProperties[e]){const t=this._findTemplateByKey(e);t?super.set(e,t._settings[e]):super.remove(e)}}_removeTemplatePrivateProperty(e){if(!this._userPrivateProperties[e]){const t=this._findTemplateByPrivateKey(e);t?super.setPrivate(e,t._privateSettings[e]):super.removePrivate(e)}}_walkParents(e){e(this._root._rootContainer),e(this)}_applyStateByKey(e){const t=this.states.create(e,{}),i={};this._eachTemplate(n=>{const s=n.states.lookup(e);s&&s._apply(t,i)}),Zt(t._settings,n=>{!i[n]&&!t._userSettings[n]&&t.remove(n)})}_applyTemplate(e,t){this._templateDisposers.push(e._apply(this,t)),Zt(e._settings,(i,n)=>{!t.settings[i]&&!this._userProperties[i]&&(t.settings[i]=!0,super.set(i,n))}),Zt(e._privateSettings,(i,n)=>{!t.privateSettings[i]&&!this._userPrivateProperties[i]&&(t.privateSettings[i]=!0,super.setPrivate(i,n))}),this._runSetup&&e.setup&&(this._runSetup=!1,e.setup(this))}_findStaticTemplate(e){if(this._template&&e(this._template))return this._template}_eachTemplate(e){this._findStaticTemplate(t=>(e(t),!1)),xu(this._internalTemplates,e),ce(this._templates,e)}_applyTemplates(e=!0){e&&this._disposeTemplates();const t={settings:{},privateSettings:{},states:{}};this._eachTemplate(i=>{this._applyTemplate(i,t)}),e&&(Zt(this._settings,i=>{!this._userProperties[i]&&!t.settings[i]&&super.remove(i)}),Zt(this._privateSettings,i=>{!this._userPrivateProperties[i]&&!t.privateSettings[i]&&super.removePrivate(i)}))}_findTemplate(e){const t=this._findStaticTemplate(e);if(t===void 0){const i=yO(this._internalTemplates,e);return i===void 0?Cv(this._templates,e):i}else return t}_findTemplateByKey(e){return this._findTemplate(t=>e in t._settings)}_findTemplateByPrivateKey(e){return this._findTemplate(t=>e in t._privateSettings)}_disposeTemplates(){ce(this._templateDisposers,e=>{e.dispose()}),this._templateDisposers.length=0}_removeTemplates(){ce(this._templates,e=>{e._removeObjectTemplate(this)}),this._templates.length=0}_applyThemes(){let e=!1;const t=[];let i=[];const n=new Set,s=this.get("themeTagsSelf");return s&&ce(s,a=>{n.add(a)}),this._walkParents(a=>{a===this._root._rootContainer&&(e=!0),a._defaultThemes.length>0&&t.push(a._defaultThemes);const l=a.get("themes");l&&i.push(l);const h=a.get("themeTags");h&&ce(h,c=>{n.add(c)})}),i=t.concat(i),this._removeTemplates(),e&&xu(this.classNames,a=>{const l=[];ce(i,h=>{ce(h,c=>{const p=c._lookupRules(a);p&&xu(p,g=>{if(g.tags.every(_=>n.has(_))){const _=wO(l,b=>{const x=io(g.tags.length,b.tags.length);return x===0?Hv(g.tags,b.tags,io):x});l.splice(_.index,0,g)}})})}),ce(l,h=>{this._templates.push(h.template),h.template._setObjectTemplate(this)})}),this._applyTemplates(),e&&(this._runSetup=!1),e}_changed(){}_beforeChanged(){if(this.isDirty("id")){const e=this.get("id");e&&this._registerId(e);const t=this._prevSettings.id;t&&delete hs.entitiesById[t]}}_registerId(e){if(hs.entitiesById[e]&&hs.entitiesById[e]!==this)throw new Error('An entity with id "'+e+'" already exists.');hs.entitiesById[e]=this}_afterChanged(){}addDisposer(e){return this._disposers.push(e),e}_dispose(){super._dispose();const e=this._template;e&&e._removeObjectTemplate(this),ce(this._internalTemplates,i=>{i._removeObjectTemplate(this)}),this._removeTemplates(),this._disposeTemplates(),this.events.dispose(),this._disposers.forEach(i=>{i.dispose()}),Zt(this._disposerProperties,(i,n)=>{ce(n,s=>{s.dispose()})});const t=this.get("id");t&&delete hs.entitiesById[t]}setTimeout(e,t){const i=setTimeout(()=>{this.removeDispose(n),e()},t),n=new Ni(()=>{clearTimeout(i)});return this._disposers.push(n),n}removeDispose(e){if(!this.isDisposed()){let t=Su(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()}hasTag(e){return Su(this.get("themeTags",[]),e)!==-1}addTag(e){if(!this.hasTag(e)){const t=this.get("themeTags",[]);t.push(e),this.set("themeTags",t)}}removeTag(e){if(this.hasTag(e)){const t=this.get("themeTags",[]);yn(t,e),this.set("themeTags",t)}}_t(e,t,...i){return this._root.language.translate(e,t,...i)}get root(){return this._root}}Object.defineProperty(dr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Entity"});Object.defineProperty(dr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:["Entity"]});class n8{constructor(e,t,i){Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=e,this._template=t,this._settings=i}get(e,t){const i=this._settings[e];return i!==void 0?i:t}set(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}remove(e){delete this._settings[e],this._template._stateChanged(this._name)}setAll(e){Li(e).forEach(t=>{this._settings[t]=e[t]}),this._template._stateChanged(this._name)}_apply(e,t){Zt(this._settings,(i,n)=>{!t[i]&&!e._userSettings[i]&&(t[i]=!0,e.setRaw(i,n))})}}class s8{constructor(e){Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const n=new n8(e,this._template,t);return this._states[e]=n,this._template._stateChanged(e),n}}remove(e){delete this._states[e],this._template._stateChanged(e)}_apply(e,t){Zt(this._states,(i,n)=>{let s=t.states[i];s==null&&(s=t.states[i]={});const a=e.states.create(i,{});n._apply(a,s)})}}class a8{constructor(){Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}add(e,t){let i=this._callbacks[e];return i===void 0&&(i=this._callbacks[e]=[]),i.push(t),new Ni(()=>{Cr(i,t),i.length===0&&delete this._callbacks[e]})}remove(e){this._callbacks[e]!==void 0&&delete this._callbacks[e]}_apply(e){const t=[];return Zt(this._callbacks,(i,n)=>{ce(n,s=>{t.push(e.adapters.add(i,s))})}),new Kr(t)}}class Hi{constructor(e,t){if(Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new s8(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new a8}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new wl}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=e}static new(e){return new Hi(e,!0)}get entities(){return this._entities}get(e,t){const i=this._settings[e];return i!==void 0?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach(i=>{i._setTemplateProperty(this,e,t)}))}remove(e){e in this._settings&&(delete this._settings[e],this._entities.forEach(t=>{t._removeTemplateProperty(e)}))}removeAll(){Zt(this._settings,(e,t)=>{this.remove(e)})}getPrivate(e,t){const i=this._privateSettings[e];return i!==void 0?i:t}setPrivateRaw(e,t){return this._privateSettings[e]=t,t}setPrivate(e,t){return this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach(i=>{i._setTemplatePrivateProperty(this,e,t)})),t}removePrivate(e){e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach(t=>{t._removeTemplatePrivateProperty(e)}))}setAll(e){Zt(e,(t,i)=>{this.set(t,i)})}on(e,t){let i=this._settingEvents[e];return i===void 0&&(i=this._settingEvents[e]=[]),i.push(t),new Ni(()=>{Cr(i,t),i.length===0&&delete this._settingEvents[e]})}onPrivate(e,t){let i=this._privateSettingEvents[e];return i===void 0&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ni(()=>{Cr(i,t),i.length===0&&delete this._privateSettingEvents[e]})}_apply(e,t){const i=[];return Zt(this._settingEvents,(n,s)=>{ce(s,a=>{i.push(e.on(n,a))})}),Zt(this._privateSettingEvents,(n,s)=>{ce(s,a=>{i.push(e.onPrivate(n,a))})}),this.states._apply(e,t),i.push(this.adapters._apply(e)),i.push(e.events.copyFrom(this.events)),new Kr(i)}_setObjectTemplate(e){this._entities.push(e)}_removeObjectTemplate(e){yn(this._entities,e)}_stateChanged(e){this._entities.forEach(t=>{t._applyStateByKey(e)})}}class Yc extends wl{constructor(e){super(),Object.defineProperty(this,"_sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rendererDisposers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dispatchParents",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this._sprite=e}_makePointerEvent(e,t){return{type:e,originalEvent:t.event,point:t.point,simulated:t.simulated,native:t.native,target:this._sprite}}_onRenderer(e,t){this._sprite.set("interactive",!0),this._sprite._display.interactive=!0;let i=this._rendererDisposers[e];if(i===void 0){const n=this._sprite._display.on(e,s=>{t.call(this,s)});i=this._rendererDisposers[e]=new Sv(()=>{delete this._rendererDisposers[e],n.dispose()})}return i.increment()}_on(e,t,i,n,s,a){const l=super._on(e,t,i,n,s,a),h=Yc.RENDERER_EVENTS[t];return h!==void 0&&(l.disposer=new Kr([l.disposer,this._onRenderer(t,h)])),l}stopParentDispatch(){this._dispatchParents=!1}dispatchParents(e,t){const i=this._dispatchParents;this._dispatchParents=!0;try{this.dispatch(e,t),this._dispatchParents&&this._sprite.parent&&this._sprite.parent.events.dispatchParents(e,t)}finally{this._dispatchParents=i}}}Object.defineProperty(Yc,"RENDERER_EVENTS",{enumerable:!0,configurable:!0,writable:!0,value:{click:function(r){this.isEnabled("click")&&!this._sprite.isDragging()&&this._sprite._hasDown()&&!this._sprite._hasMoved(this._makePointerEvent("click",r))&&this.dispatch("click",this._makePointerEvent("click",r))},rightclick:function(r){this.isEnabled("rightclick")&&this.dispatch("rightclick",this._makePointerEvent("rightclick",r))},middleclick:function(r){this.isEnabled("middleclick")&&this.dispatch("middleclick",this._makePointerEvent("middleclick",r))},dblclick:function(r){this.dispatchParents("dblclick",this._makePointerEvent("dblclick",r))},pointerover:function(r){this.isEnabled("pointerover")&&this.dispatch("pointerover",this._makePointerEvent("pointerover",r))},pointerout:function(r){this.isEnabled("pointerout")&&this.dispatch("pointerout",this._makePointerEvent("pointerout",r))},pointerdown:function(r){this.dispatchParents("pointerdown",this._makePointerEvent("pointerdown",r))},pointerup:function(r){this.isEnabled("pointerup")&&this.dispatch("pointerup",this._makePointerEvent("pointerup",r))},globalpointerup:function(r){this.isEnabled("globalpointerup")&&this.dispatch("globalpointerup",this._makePointerEvent("globalpointerup",r))},globalpointermove:function(r){this.isEnabled("globalpointermove")&&this.dispatch("globalpointermove",this._makePointerEvent("globalpointermove",r))},wheel:function(r){this.dispatchParents("wheel",{type:"wheel",target:this._sprite,originalEvent:r.event,point:r.point})}}});class Xn extends dr{constructor(){super(...arguments),Object.defineProperty(this,"_adjustedLocalBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templateField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sizeDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dragEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isHidden",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isShowing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isHiding",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_downPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downPoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_toggleDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipMoveDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipPointerDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_statesHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.setPrivateRaw("visible",!0),super._afterNew()}_markDirtyKey(e){super._markDirtyKey(e),(e=="x"||e=="y"||e=="dx"||e=="dy")&&(this.markDirtyBounds(),this._addPercentagePositionChildren(),this.markDirtyPosition())}_markDirtyPrivateKey(e){super._markDirtyPrivateKey(e),(e=="x"||e=="y")&&this.markDirtyPosition()}_removeTemplateField(){this._templateField&&this._templateField._removeObjectTemplate(this)}_createEvents(){return new Yc(this)}_processTemplateField(){let e;const t=this.get("templateField");if(t){const i=this.dataItem;if(i){const n=i.dataContext;n&&(e=n[t],!(e instanceof Hi)&&e&&(e=Hi.new(e)))}}this._templateField!==e&&(this._removeTemplateField(),this._templateField=e,e&&e._setObjectTemplate(this),this._applyTemplates())}_setDataItem(e){const t=this._dataItem;this._dataItem=e,this._processTemplateField();const i="dataitemchanged";e!=t&&this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,oldDataItem:t,newDataItem:e})}set dataItem(e){this._setDataItem(e)}get dataItem(){if(this._dataItem)return this._dataItem;{let e=this._parent;for(;e;){if(e._dataItem)return e._dataItem;e=e._parent}}}_addPercentageSizeChildren(){let e=this.parent;e&&(this.get("width")instanceof gt||this.get("height")instanceof gt?Du(e._percentageSizeChildren,this):Cr(e._percentageSizeChildren,this))}_addPercentagePositionChildren(){let e=this.parent;e&&(this.get("x")instanceof gt||this.get("y")instanceof gt?Du(e._percentagePositionChildren,this):Cr(e._percentagePositionChildren,this))}markDirtyPosition(){this._root._addDirtyPosition(this)}updatePivotPoint(){const e=this._localBounds;if(e){const t=this.get("centerX");t!=null&&(this._display.pivot.x=e.left+ai(t,e.right-e.left));const i=this.get("centerY");i!=null&&(this._display.pivot.y=e.top+ai(i,e.bottom-e.top))}}_beforeChanged(){if(super._beforeChanged(),this._handleStates(),this.isDirty("tooltip")){const e=this._prevSettings.tooltip;e&&e.dispose()}if((this.isDirty("layer")||this.isDirty("layerMargin"))&&(this._display.setLayer(this.get("layer"),this.get("layerMargin")),this.markDirtyLayer()),this.isDirty("tooltipPosition")){const e=this._tooltipMoveDp;e&&(e.dispose(),this._tooltipMoveDp=void 0);const t=this._tooltipPointerDp;t&&(t.dispose(),this._tooltipPointerDp=void 0),this.get("tooltipPosition")=="pointer"&&(this._tooltipPointerDp=new Kr([this.events.on("pointerover",()=>{this._tooltipMoveDp=this.events.on("globalpointermove",i=>{this.showTooltip(i.point)})}),this.events.on("pointerout",()=>{const i=this._tooltipMoveDp;i&&(i.dispose(),this._tooltipMoveDp=void 0)})]))}}_handleStates(){this._statesHandled||(this.isDirty("active")&&(this.get("active")?(this.states.applyAnimate("active"),this.set("ariaChecked",!0)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!1)),this.markDirtyAccessibility()),this.isDirty("disabled")&&(this.get("disabled")?(this.states.applyAnimate("disabled"),this.set("ariaChecked",!1)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!0)),this.markDirtyAccessibility()),this._statesHandled=!0)}_changed(){super._changed();const e=this._display,t=this.events;if(this.isDirty("draggable")){const i=this.get("draggable");i?(this.set("interactive",!0),this._dragDp=new Kr([t.on("pointerdown",n=>{this.dragStart(n)}),t.on("globalpointermove",n=>{this.dragMove(n)}),t.on("globalpointerup",n=>{this.dragStop(n)})])):this._dragDp&&(this._dragDp.dispose(),this._dragDp=void 0),e.cancelTouch=!!i}if(this.isDirty("tooltipText")||this.isDirty("tooltipHTML")||this.isDirty("showTooltipOn")){const i=this.get("tooltipText"),n=this.get("tooltipHTML"),s=this.get("showTooltipOn","hover");this._tooltipDp&&(this._tooltipDp.dispose(),this._tooltipDp=void 0),(i||n)&&(s=="click"?(this._tooltipDp=new Kr([t.on("click",()=>{this.setTimeout(()=>this.showTooltip(),10)}),fi(document,"click",a=>{this.hideTooltip()})]),this._disposers.push(this._tooltipDp)):s=="always"||(this._tooltipDp=new Kr([t.on("pointerover",()=>{this.showTooltip()}),t.on("pointerout",()=>{this.hideTooltip()})]),this._disposers.push(this._tooltipDp)))}if(this.isDirty("toggleKey")){let i=this.get("toggleKey");i&&i!="none"?this._toggleDp=t.on("click",()=>{this._isDragging||this.set(i,!this.get(i))}):this._toggleDp&&(this._toggleDp.dispose(),this._toggleDp=void 0)}if(this.isDirty("opacity")&&(e.alpha=Math.max(0,this.get("opacity",1))),this.isDirty("rotation")&&(this.markDirtyBounds(),e.angle=this.get("rotation",0)),this.isDirty("scale")&&(this.markDirtyBounds(),e.scale=this.get("scale",0)),(this.isDirty("centerX")||this.isDirty("centerY"))&&(this.markDirtyBounds(),this.updatePivotPoint()),(this.isDirty("visible")||this.isPrivateDirty("visible")||this.isDirty("forceHidden"))&&(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden")?(e.visible=!1,this.hideTooltip()):e.visible=!0,this.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("width")||this.isDirty("height")){this.markDirtyBounds(),this._addPercentageSizeChildren();const i=this.parent;i&&(this.isDirty("width")&&this.get("width")instanceof gt||this.isDirty("height")&&this.get("height")instanceof gt)&&(i.markDirty(),i._prevWidth=0),this._sizeDirty=!0}if((this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("minWidth")||this.isDirty("minHeight")||this.isPrivateDirty("maxWidth")||this.isPrivateDirty("maxHeight")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&(this.markDirtyBounds(),this._sizeDirty=!0),this._sizeDirty&&this._updateSize(),this.isDirty("wheelable")){const i=this.get("wheelable");i&&this.set("interactive",!0),e.wheelable=!!i}if((this.isDirty("tabindexOrder")||this.isDirty("focusableGroup"))&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this)),this.isDirty("filter")&&(e.filter=this.get("filter")),this.isDirty("cursorOverStyle")&&(e.cursorOverStyle=this.get("cursorOverStyle")),this.isDirty("hoverOnFocus")&&(this.get("hoverOnFocus")?this._focusDp=new Kr([t.on("focus",()=>{this.showTooltip()}),t.on("blur",()=>{this.hideTooltip()})]):this._focusDp&&(this._focusDp.dispose(),this._focusDp=void 0)),this.isDirty("focusable")&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this),this.markDirtyAccessibility()),this.isPrivateDirty("focusable")&&this.markDirtyAccessibility(),(this.isDirty("role")||this.isDirty("ariaLive")||this.isDirty("ariaChecked")||this.isDirty("ariaHidden")||this.isDirty("ariaOrientation")||this.isDirty("ariaValueNow")||this.isDirty("ariaValueMin")||this.isDirty("ariaValueMax")||this.isDirty("ariaValueText")||this.isDirty("ariaLabel")||this.isDirty("ariaControls"))&&this.markDirtyAccessibility(),this.isDirty("exportable")&&(e.exportable=this.get("exportable")),this.isDirty("interactive")){const i=this.events;this.get("interactive")?this._hoverDp=new Kr([i.on("click",n=>{gd(n.originalEvent)&&(this.getPrivate("touchHovering")||this.setTimeout(()=>{this._handleOver(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.showTooltip(),this.setPrivateRaw("touchHovering",!0),this.events.dispatch("pointerover",{type:"pointerover",target:n.target,originalEvent:n.originalEvent,point:n.point,simulated:n.simulated})},10))}),i.on("globalpointerup",n=>{gd(n.originalEvent)&&this.getPrivate("touchHovering")&&(this._handleOut(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.hideTooltip(),this.setPrivateRaw("touchHovering",!1),this.events.dispatch("pointerout",{type:"pointerout",target:n.target,originalEvent:n.originalEvent,point:n.point,simulated:n.simulated})),this._isDown&&this._handleUp(n)}),i.on("pointerover",()=>{this._handleOver()}),i.on("pointerout",()=>{this._handleOut()}),i.on("pointerdown",n=>{this._handleDown(n)})]):(this._display.interactive=!1,this._hoverDp&&(this._hoverDp.dispose(),this._hoverDp=void 0))}this.isDirty("forceInactive")&&(this._display.inactive=this.get("forceInactive",!1)),this.get("showTooltipOn")=="always"&&this._display.visible&&this.showTooltip()}dragStart(e){this._dragEvent=e,this.events.stopParentDispatch()}dragStop(e){if(this._dragEvent=void 0,this._dragPoint=void 0,this.events.stopParentDispatch(),this._isDragging){this._isDragging=!1;const t="dragstop";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}_handleOver(){this.isHidden()||(this.get("active")&&this.states.lookup("hoverActive")?this.states.applyAnimate("hoverActive"):this.get("disabled")&&this.states.lookup("hoverDisabled")?this.states.applyAnimate("hoverDisabled"):this.states.applyAnimate("hover"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleOut(){this.isHidden()||(this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):(this.states.lookup("hover")||this.states.lookup("hoverActive"))&&this.states.applyAnimate("default"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleUp(e){if(!this.isHidden()){this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):this.states.lookup("down")&&(this.isHover()?this.states.applyAnimate("hover"):this.states.applyAnimate("default")),this._downPoint=void 0;const t=Xf(e.originalEvent);delete this._downPoints[t],Li(this._downPoints).length==0&&(this._isDown=!1)}}_hasMoved(e){const t=Xf(e.originalEvent),i=this._downPoints[t];if(i){const n=Math.abs(i.x-e.point.x),s=Math.abs(i.y-e.point.y);return n>5||s>5}return!1}_hasDown(){return Li(this._downPoints).length>0}_handleDown(e){const t=this.parent;if(t&&!this.get("draggable")&&t._handleDown(e),this.get("interactive")&&!this.isHidden()){this.states.lookup("down")&&this.states.applyAnimate("down"),this._downPoint={x:e.point.x,y:e.point.y},this._isDown=!0;const i=Xf(e.originalEvent);this._downPoints[i]={x:e.point.x,y:e.point.y}}}dragMove(e){let t=this._dragEvent;if(t){if(t.simulated&&!e.simulated)return!0;let i=0,n=this.parent;for(;n!=null;)i+=n.get("rotation",0),n=n.parent;let s=e.point.x-t.point.x,a=e.point.y-t.point.y;const l=this.events;if(t.simulated&&!this._isDragging){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const h="dragstart";l.isEnabled(h)&&l.dispatch(h,{type:h,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}if(this._isDragging){let h=this._dragPoint;this.set("x",h.x+s*cs(i)+a*bn(i)),this.set("y",h.y+a*cs(i)-s*bn(i));const c="dragged";l.isEnabled(c)&&l.dispatch(c,{type:c,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}else if(Math.hypot(s,a)>5){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const h="dragstart";l.isEnabled(h)&&l.dispatch(h,{type:h,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}}_updateSize(){}_getBounds(){this._localBounds=this._display.getLocalBounds()}depth(){let e=this.parent,t=0;for(;;)if(e)++t,e=e.parent;else return t}markDirtySize(){this._sizeDirty=!0,this.markDirty()}markDirtyBounds(){if(this.get("isMeasured")){const e=this._display;this._root._addDirtyBounds(this),e.isMeasured=!0,e.invalidateBounds();const t=this.parent;t&&this.get("position")!="absolute"&&(t.get("width")==null||t.get("height")==null||t.get("layout"))&&t.markDirtyBounds(),this.get("focusable")&&this.isFocus()&&this.markDirtyAccessibility()}}markDirtyAccessibility(){this._root._invalidateAccessibility(this)}markDirtyLayer(){this._display.markDirtyLayer(!0)}markDirty(){super.markDirty(),this.markDirtyLayer()}_updateBounds(){const e=this._adjustedLocalBounds;let t;if(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden")?(t={left:0,right:0,top:0,bottom:0},this._localBounds=t,this._adjustedLocalBounds=t):(this._getBounds(),this._fixMinBounds(this._localBounds),this.updatePivotPoint(),this._adjustedLocalBounds=this._display.getAdjustedBounds(this._localBounds),t=this._adjustedLocalBounds),!e||e.left!==t.left||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom){const i="boundschanged";this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this}),this.parent&&(this.parent.markDirty(),this.parent.markDirtyBounds())}}_fixMinBounds(e){let t=this.get("minWidth",this.getPrivate("minWidth")),i=this.get("minHeight",this.getPrivate("minHeight"));ve(t)&&e.right-e.left<t&&(e.right=e.left+t),ve(i)&&e.bottom-e.top<i&&(e.bottom=e.top+i);let n=this.getPrivate("width"),s=this.getPrivate("height");ve(n)&&(n>0?e.right=e.left+n:e.left=e.right+n),ve(s)&&(s>0?e.bottom=e.top+s:e.top=e.bottom+s)}_removeParent(e){e&&(e.children.removeValue(this),Cr(e._percentageSizeChildren,this),Cr(e._percentagePositionChildren,this))}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._statesHandled=!1}hover(){this.showTooltip(),this._handleOver()}unhover(){this.hideTooltip(),this._handleOut()}showTooltip(e){const t=this.getTooltip(),i=this.get("tooltipText"),n=this.get("tooltipHTML");if((i||n)&&t){const s=this.get("tooltipPosition"),a=this.getPrivate("tooltipTarget",this);(s=="fixed"||!e)&&(this._display._setMatrix(),e=this.toGlobal(a._getTooltipPoint())),t.set("pointTo",e),t.set("tooltipTarget",a),t.get("x")||t.set("x",e.x),t.get("y")||t.set("y",e.y),i&&t.label.set("text",i),n&&t.label.set("html",n);const l=this.dataItem;if(l&&t.label._setDataItem(l),this.get("showTooltipOn")=="always"&&(e.x<0||e.x>this._root.width()||e.y<0||e.y>this._root.height())){this.hideTooltip();return}t.label.text.markDirtyText();const h=t.show();return this.setPrivateRaw("showingTooltip",!0),h}}hideTooltip(){const e=this.getTooltip();if(e&&e.get("tooltipTarget")==this.getPrivate("tooltipTarget",this)){let t=e.get("keepTargetHover")&&e.get("stateAnimationDuration",0)==0?400:void 0;const i=e.hide(t);return this.setPrivateRaw("showingTooltip",!1),i}}_getTooltipPoint(){const e=this._localBounds;if(e){let t=0,i=0;return this.get("isMeasured")?(t=e.left+ai(this.get("tooltipX",0),e.right-e.left),i=e.top+ai(this.get("tooltipY",0),e.bottom-e.top)):(t=ai(this.get("tooltipX",0),this.width()),i=ai(this.get("tooltipY",0),this.height())),{x:t,y:i}}return{x:0,y:0}}getTooltip(){let e=this.get("tooltip");if(e)return e;{let t=this.parent;if(t)return t.getTooltip()}}_updatePosition(){const e=this.parent;let t=this.get("dx",0),i=this.get("dy",0),n=this.get("x"),s=this.getPrivate("x"),a=0,l=0;const h=this.get("position");n instanceof gt&&(e?n=e.innerWidth()*n.value+e.get("paddingLeft",0):n=0),ve(n)?a=n+t:s!=null?a=s:e&&h=="relative"&&(a=e.get("paddingLeft",0)+t);let c=this.get("y"),p=this.getPrivate("y");c instanceof gt&&(e?c=e.innerHeight()*c.value+e.get("paddingTop",0):c=0),ve(c)?l=c+i:p!=null?l=p:e&&h=="relative"&&(l=e.get("paddingTop",0)+i);const g=this._display;if(g.x!=a||g.y!=l){g.invalidateBounds(),g.x=a,g.y=l;const m="positionchanged";this.events.isEnabled(m)&&this.events.dispatch(m,{type:m,target:this})}this.getPrivate("showingTooltip")&&this.showTooltip()}x(){let e=this.get("x"),t=this.getPrivate("x");const i=this.parent;return i?e instanceof gt?ai(e,i.innerWidth())+i.get("paddingLeft",0):ve(e)?e:t??i.get("paddingLeft",this._display.x):this._display.x}y(){let e=this.getPrivate("y");if(e!=null)return e;let t=this.get("y");const i=this.parent;return i?t instanceof gt?ai(t,i.innerHeight())+i.get("paddingTop",0):ve(t)?t:e??i.get("paddingTop",this._display.y):this._display.y}_dispose(){super._dispose(),this._display.dispose(),this._removeTemplateField(),this._removeParent(this.parent),this._root._removeFocusElement(this);const e=this.get("tooltip");e&&e.dispose(),this.markDirty()}adjustedLocalBounds(){return this._fixMinBounds(this._adjustedLocalBounds),this._adjustedLocalBounds}localBounds(){return this._localBounds}bounds(){const e=this._adjustedLocalBounds,t=this.x(),i=this.y();return{left:e.left+t,right:e.right+t,top:e.top+i,bottom:e.bottom+i}}globalBounds(){const e=this.localBounds(),t=this.toGlobal({x:e.left,y:e.top}),i=this.toGlobal({x:e.right,y:e.top}),n=this.toGlobal({x:e.right,y:e.bottom}),s=this.toGlobal({x:e.left,y:e.bottom});return{left:Math.min(t.x,i.x,n.x,s.x),top:Math.min(t.y,i.y,n.y,s.y),right:Math.max(t.x,i.x,n.x,s.x),bottom:Math.max(t.y,i.y,n.y,s.y)}}_onShow(e){}_onHide(e){}appear(e,t){return Oi(this,void 0,void 0,function*(){return yield this.hide(0),t?new Promise((i,n)=>{this.setTimeout(()=>{i(this.show(e))},t)}):this.show(e)})}show(e){return Oi(this,void 0,void 0,function*(){if(!this._isShowing){this._isHidden=!1,this._isShowing=!0,this._isHiding=!1,this.states.lookup("default").get("visible")&&this.set("visible",!0),this._onShow(e);const t=this.states.applyAnimate("default",e);yield Sm(t),this._isShowing=!1}})}hide(e){return Oi(this,void 0,void 0,function*(){if(!this._isHiding&&!this._isHidden){this._isHiding=!0,this._isShowing=!1;let t=this.states.lookup("hidden");t||(t=this.states.create("hidden",{opacity:0,visible:!1})),this._isHidden=!0,this._onHide(e);const i=this.states.applyAnimate("hidden",e);yield Sm(i),this._isHiding=!1}})}isHidden(){return this._isHidden}isShowing(){return this._isShowing}isHiding(){return this._isHiding}isHover(){return this._display.hovering()}isFocus(){return this._root.focused(this)}isDragging(){return this._isDragging}isVisible(){return!!(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden"))}isVisibleDeep(){return this._parent?this._parent.isVisibleDeep()&&this.isVisible():this.isVisible()}compositeOpacity(){const e=this.get("opacity",1);return this._parent?this._parent.compositeOpacity()*e:e}width(){let e=this.get("width"),t=this.get("maxWidth",this.getPrivate("maxWidth")),i=this.get("minWidth",this.getPrivate("minWidth")),n=this.getPrivate("width"),s=0;if(ve(n))s=n;else if(e==null)this._adjustedLocalBounds&&(s=this._adjustedLocalBounds.right-this._adjustedLocalBounds.left);else if(e instanceof gt){const a=this.parent;a?s=a.innerWidth()*e.value:s=this._root.width()*e.value}else ve(e)&&(s=e);return ve(i)&&(s=Math.max(i,s)),ve(t)&&(s=Math.min(t,s)),s}maxWidth(){let e=this.get("maxWidth",this.getPrivate("maxWidth"));if(ve(e))return e;{let i=this.get("width");if(ve(i))return i}const t=this.parent;return t?t.innerWidth():this._root.width()}maxHeight(){let e=this.get("maxHeight",this.getPrivate("maxHeight"));if(ve(e))return e;{let i=this.get("height");if(ve(i))return i}const t=this.parent;return t?t.innerHeight():this._root.height()}height(){let e=this.get("height"),t=this.get("maxHeight",this.getPrivate("maxHeight")),i=this.get("minHeight",this.getPrivate("minHeight")),n=this.getPrivate("height"),s=0;if(ve(n))s=n;else if(e==null)this._adjustedLocalBounds&&(s=this._adjustedLocalBounds.bottom-this._adjustedLocalBounds.top);else if(e instanceof gt){const a=this.parent;a?s=a.innerHeight()*e.value:s=this._root.height()*e.value}else ve(e)&&(s=e);return ve(i)&&(s=Math.max(i,s)),ve(t)&&(s=Math.min(t,s)),s}_findStaticTemplate(e){return this._templateField&&e(this._templateField)?this._templateField:super._findStaticTemplate(e)}_walkParents(e){this._parent&&this._walkParent(e)}_walkParent(e){this._parent&&this._parent._walkParent(e),e(this)}get parent(){return this._parent}_setParent(e,t=!1){const i=this._parent;e!==i&&(this.markDirtyBounds(),e.markDirty(),this._parent=e,t&&(this._removeParent(i),e&&(this._addPercentageSizeChildren(),this._addPercentagePositionChildren())),this.markDirtyPosition(),this._applyThemes())}getNumberFormatter(){return this.get("numberFormatter",this._root.numberFormatter)}getDateFormatter(){return this.get("dateFormatter",this._root.dateFormatter)}getDurationFormatter(){return this.get("durationFormatter",this._root.durationFormatter)}toGlobal(e){return this._display.toGlobal(e)}toLocal(e){return this._display.toLocal(e)}_getDownPoint(){const e=this._getDownPointId();if(e)return this._downPoints[e]}_getDownPointId(){if(this._downPoints)return PO(this._downPoints,(e,t)=>e>t?1:e<t?-1:0)[0]}toFront(){const e=this.parent;e&&e.children.moveValue(this,e.children.length-1)}toBack(){const e=this.parent;e&&e.children.moveValue(this,0)}}Object.defineProperty(Xn,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sprite"});Object.defineProperty(Xn,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Xn.className])});class Ou extends dr{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_backgroundDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_pattern",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNewApplyThemes()}get pattern(){return this._pattern}_draw(){}_beforeChanged(){super._beforeChanged(),(this.isDirty("repetition")||this.isDirty("width")||this.isDirty("height")||this.isDirty("rotation")||this.isDirty("color")||this.isDirty("strokeWidth")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("colorOpacity")||this.isDirty("fill")||this.isDirty("fillOpacity"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("repetition",""),t=this.get("width",100),i=this.get("height",100),n=this.get("fill"),s=this.get("fillOpacity",1);this._display.clear(),this._backgroundDisplay.clear(),n&&s>0&&(this._backgroundDisplay.beginFill(n,s),this._backgroundDisplay.drawRect(0,0,t,i),this._backgroundDisplay.endFill()),this._display.angle=this.get("rotation",0),this._draw(),this._pattern=this._root._renderer.createPattern(this._display,this._backgroundDisplay,e,t,i)}}}Object.defineProperty(Ou,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Pattern"});Object.defineProperty(Ou,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Ou.className])});class Mu extends Ou{constructor(){super(...arguments),Object.defineProperty(this,"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_beforeChanged(){super._beforeChanged(),this._clear=!0,this.isDirty("src")&&this._load()}_draw(){super._draw();const e=this._image;if(e){const t=this.get("width",100),i=this.get("height",100),n=this.get("fit","image");let s=0,a=0;n=="pattern"?(s=t,a=i):(s=e.width,a=e.height,n=="image"&&(this.set("width",s),this.set("height",a)));const l=this.get("centered",!0);let h=0,c=0;l&&(h=t/2-s/2,c=i/2-a/2),this._display.image(e,s,a,h,c)}}_load(){const e=this.get("src");if(e){const t=new Image;t.src=e,t.decode().then(()=>{this._image=t,this._draw(),this.events.isEnabled("loaded")&&this.events.dispatch("loaded",{type:"loaded",target:this})}).catch(i=>{})}}}Object.defineProperty(Mu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PicturePattern"});Object.defineProperty(Mu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ou.classNames.concat([Mu.className])});var Ac;(function(r){r.ADD="lighter",r.COLOR="color",r.COLOR_BURN="color-burn",r.COLOR_DODGE="color-dodge",r.DARKEN="darken",r.DIFFERENCE="difference",r.DST_OVER="destination-over",r.EXCLUSION="exclusion",r.HARD_LIGHT="hard-light",r.HUE="hue",r.LIGHTEN="lighten",r.LUMINOSITY="luminosity",r.MULTIPLY="multiply",r.NORMAL="source-over",r.OVERLAY="overlay",r.SATURATION="saturation",r.SCREEN="screen",r.SOFT_LIGHT="soft-light",r.SRC_ATOP="source-atop",r.XOR="xor"})(Ac||(Ac={}));const Uv=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","fillPattern","strokePattern","fillGradient","strokeGradient","strokeDasharray","strokeDashoffset"];class wi extends Xn{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_beforeChanged(){if(super._beforeChanged(),(this.isDirty("draw")||this.isDirty("svgPath"))&&this.markDirtyBounds(),(this.isDirty("fill")||this.isDirty("stroke")||this.isDirty("visible")||this.isDirty("forceHidden")||this.isDirty("scale")||this.isDirty("fillGradient")||this.isDirty("strokeGradient")||this.isDirty("fillPattern")||this.isDirty("strokePattern")||this.isDirty("fillOpacity")||this.isDirty("strokeOpacity")||this.isDirty("strokeWidth")||this.isDirty("draw")||this.isDirty("blendMode")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("svgPath")||this.isDirty("lineJoin")||this.isDirty("shadowColor")||this.isDirty("shadowBlur")||this.isDirty("shadowOffsetX")||this.isDirty("shadowOffsetY"))&&(this._clear=!0),this._display.crisp=this.get("crisp",!1),this.isDirty("fillGradient")){const e=this.get("fillGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",()=>{this._markDirtyKey("fill")})),this._disposers.push(t.events.on("positionchanged",()=>{this._markDirtyKey("fill")})))}}if(this.isDirty("strokeGradient")){const e=this.get("strokeGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",()=>{this._markDirtyKey("stroke")})),this._disposers.push(t.events.on("positionchanged",()=>{this._markDirtyKey("stroke")})))}}}_changed(){if(super._changed(),this._clear){this.markDirtyBounds(),this.markDirtyLayer(),this._display.clear();let e=this.get("strokeDasharray");ve(e)&&(e<.5?e=[0]:e=[e]),this._display.setLineDash(e);const t=this.get("strokeDashoffset");t&&this._display.setLineDashOffset(t);const i=this.get("blendMode",Ac.NORMAL);this._display.blendMode=i;const n=this.get("draw");n&&n(this._display,this);const s=this.get("svgPath");s!=null&&this._display.svgPath(s)}}_afterChanged(){if(super._afterChanged(),this._clear){const e=this.get("fill"),t=this.get("fillGradient"),i=this.get("fillPattern"),n=this.get("fillOpacity"),s=this.get("stroke"),a=this.get("strokeGradient"),l=this.get("strokePattern"),h=this.get("shadowColor"),c=this.get("shadowBlur"),p=this.get("shadowOffsetX"),g=this.get("shadowOffsetY"),m=this.get("shadowOpacity");if(h&&(c||p||g)&&this._display.shadow(h,c,p,g,m),i){let _=!1;e&&(!i.get("fill")||i.get("fillInherited"))&&(i.set("fill",e),i.set("fillInherited",!0),_=!0),s&&(!i.get("color")||i.get("colorInherited"))&&(i.set("color",s),i.set("colorInherited",!0),_=!0),_&&i._changed();const b=i.pattern;b&&(this._display.beginFill(b,n),this._display.endFill(),i instanceof Mu&&i.events.once("loaded",()=>{this._clear=!0,this.markDirty()}))}else if(t){if(e){const b=t.get("stops",[]);b.length&&ce(b,x=>{(!x.color||x.colorInherited)&&e&&(x.color=e,x.colorInherited=!0),(x.opacity==null||x.opacityInherited)&&(x.opacity=n,x.opacityInherited=!0)})}const _=t.getFill(this);_&&(this._display.beginFill(_,n),this._display.endFill())}else e&&(this._display.beginFill(e,n),this._display.endFill());if(s||a||l){const _=this.get("strokeOpacity");let b=this.get("strokeWidth",1);this.get("nonScalingStroke")&&(b=b/this.get("scale",1)),this.get("crisp")&&(b/=this._root._renderer.resolution);const x=this.get("lineJoin");if(l){let w=!1;s&&(!l.get("color")||l.get("colorInherited"))&&(l.set("color",s),l.set("colorInherited",!0),w=!0),w&&l._changed();const P=l.pattern;P&&(this._display.lineStyle(b,P,_,x),this._display.endStroke(),l instanceof Mu&&l.events.once("loaded",()=>{this._clear=!0,this.markDirty()}))}else if(a){const w=a.get("stops",[]);w.length&&ce(w,E=>{(!E.color||E.colorInherited)&&s&&(E.color=s,E.colorInherited=!0),(E.opacity==null||E.opacityInherited)&&(E.opacity=_,E.opacityInherited=!0)});const P=a.getFill(this);P&&(this._display.lineStyle(b,P,_,x),this._display.endStroke())}else s&&(this._display.lineStyle(b,s,_,x),this._display.endStroke())}this.getPrivate("showingTooltip")&&this.showTooltip()}this._clear=!1}}Object.defineProperty(wi,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Graphics"});Object.defineProperty(wi,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Xn.classNames.concat([wi.className])});class Tn extends wi{_beforeChanged(){super._beforeChanged(),(this.isDirty("width")||this.isDirty("height")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){super._changed(),this._clear&&!this.get("draw")&&this._draw()}_draw(){this._display.drawRect(0,0,this.width(),this.height())}_updateSize(){this.markDirty(),this._clear=!0}}Object.defineProperty(Tn,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Rectangle"});Object.defineProperty(Tn,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([Tn.className])});function Hs(r,e){r.get("reverseChildren",!1)?r.children.eachReverse(e):r.children.each(e)}class Us extends dr{}Object.defineProperty(Us,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Layout"});Object.defineProperty(Us,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Us.className])});class fl extends Us{updateContainer(e){let t=e.get("paddingLeft",0),i=e.innerWidth(),n=0;Hs(e,a=>{if(a.isVisible()&&a.get("position")=="relative"){let l=a.get("width");if(l instanceof gt){n+=l.value;let h=i*l.value,c=a.get("minWidth",a.getPrivate("minWidth",-1/0));c>h&&(i-=c,n-=l.value);let p=a.get("maxWidth",a.getPrivate("maxWidth",1/0));h>p&&(i-=p,n-=l.value)}else ve(l)||(l=a.width()),i-=l+a.get("marginLeft",0)+a.get("marginRight",0)}}),(i<=0||i==1/0)&&(i=.1),Hs(e,a=>{if(a.isVisible()&&a.get("position")=="relative"){let l=a.get("width");if(l instanceof gt){let h=i*l.value/n-a.get("marginLeft",0)-a.get("marginRight",0),c=a.get("minWidth",a.getPrivate("minWidth",-1/0)),p=a.get("maxWidth",a.getPrivate("maxWidth",1/0));h=Math.min(Math.max(c,h),p),a.setPrivate("width",h)}}});let s=t;Hs(e,a=>{if(a.get("position")=="relative")if(a.isVisible()){let l=a.adjustedLocalBounds(),h=a.get("marginLeft",0),c=a.get("marginRight",0),p=a.get("maxWidth"),g=l.left,m=l.right;p&&m-g>p&&(m=g+p);let _=s+h-g;a.setPrivate("x",_),s=_+m+c}else a.setPrivate("x",void 0)})}}Object.defineProperty(fl,"className",{enumerable:!0,configurable:!0,writable:!0,value:"HorizontalLayout"});Object.defineProperty(fl,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Us.classNames.concat([fl.className])});class dl extends Us{updateContainer(e){let t=e.get("paddingTop",0),i=e.innerHeight(),n=0;Hs(e,a=>{if(a.isVisible()&&a.get("position")=="relative"){let l=a.get("height");if(l instanceof gt){n+=l.value;let h=i*l.value,c=a.get("minHeight",a.getPrivate("minHeight",-1/0));c>h&&(i-=c,n-=l.value);let p=a.get("maxHeight",a.getPrivate("maxHeight",1/0));h>p&&(i-=p,n-=l.value)}else ve(l)||(l=a.height()),i-=l+a.get("marginTop",0)+a.get("marginBottom",0)}}),(i<=0||i==1/0)&&(i=.1),Hs(e,a=>{if(a.isVisible()&&a.get("position")=="relative"){let l=a.get("height");if(l instanceof gt){let h=i*l.value/n-a.get("marginTop",0)-a.get("marginBottom",0),c=a.get("minHeight",a.getPrivate("minHeight",-1/0)),p=a.get("maxHeight",a.getPrivate("maxHeight",1/0));h=Math.min(Math.max(c,h),p),a.setPrivate("height",h)}}});let s=t;Hs(e,a=>{if(a.get("position")=="relative")if(a.isVisible()){let l=a.adjustedLocalBounds(),h=a.get("marginTop",0),c=l.top,p=l.bottom,g=a.get("maxHeight");g&&p-c>g&&(p=c+g);let m=a.get("marginBottom",0),_=s+h-c;a.setPrivate("y",_),s=_+p+m}else a.setPrivate("y",void 0)})}}Object.defineProperty(dl,"className",{enumerable:!0,configurable:!0,writable:!0,value:"VerticalLayout"});Object.defineProperty(dl,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Us.classNames.concat([dl.className])});class ao extends Us{_afterNew(){this._setRawDefault("maxColumns",Number.MAX_VALUE),super._afterNew()}updateContainer(e){let t=e.get("paddingLeft",0),i=e.get("paddingRight",0),n=e.get("paddingTop",0),s=e.maxWidth()-t-i,a=s,l=1;Hs(e,b=>{if(b.get("visible")&&b.getPrivate("visible")&&!b.get("forceHidden")&&b.get("position")!="absolute"){let x=b.width();x<a&&(a=x),x>l&&(l=x)}}),a=Di(a,1,s),l=Di(l,1,s);let h=1;this.get("fixedWidthGrid")?h=s/l:h=s/a,h=Math.max(1,Math.floor(h)),h=Math.min(this.get("maxColumns",Number.MAX_VALUE),h);let c=this.getColumnWidths(e,h,l,s),p=n,g=0,m=0;h=c.length;let _=t;Hs(e,b=>{if(b.get("position")=="relative"&&b.isVisible()){const x=b.get("marginTop",0),w=b.get("marginBottom",0);let P=b.adjustedLocalBounds(),E=b.get("marginLeft",0),k=b.get("marginRight",0),C=_+E-P.left,O=p+x-P.top;b.setPrivate("x",C),b.setPrivate("y",O),_+=c[g]+k,m=Math.max(m,b.height()+x+w),g++,g>=h&&(g=0,_=t,p+=m)}})}getColumnWidths(e,t,i,n){let s=0,a=[],l=0;return Hs(e,h=>{let c=h.adjustedLocalBounds();h.get("position")!="absolute"&&h.isVisible()&&(this.get("fixedWidthGrid")?a[l]=i:a[l]=Math.max(a[l]|0,c.right-c.left+h.get("marginLeft",0)+h.get("marginRight",0)),l<e.children.length-1&&(l++,l==t&&(l=0)))}),ce(a,h=>{s+=h}),s>n?t>2?(t-=1,this.getColumnWidths(e,t,i,n)):[n]:a}}Object.defineProperty(ao,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GridLayout"});Object.defineProperty(ao,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Us.classNames.concat([ao.className])});class jn{static escape(e){return e.replace(/\[\[/g,this.prefix+"1").replace(/([^\/\]]{1})\]\]/g,"$1"+this.prefix+"2").replace(/\]\]/g,this.prefix+"2").replace(/\{\{/g,this.prefix+"3").replace(/\}\}/g,this.prefix+"4").replace(/\'\'/g,this.prefix+"5")}static unescape(e){return e.replace(new RegExp(this.prefix+"1","g"),"[[").replace(new RegExp(this.prefix+"2","g"),"]]").replace(new RegExp(this.prefix+"3","g"),"{{").replace(new RegExp(this.prefix+"4","g"),"}}").replace(new RegExp(this.prefix+"5","g"),"''")}static cleanUp(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")}static chunk(e,t=!1,i=!1){let n=[];e=this.escape(e);let s=t?e.split("'"):[e];for(let a=0;a<s.length;a++){let l=s[a];if(l!=="")if(a%2===0){l=l.replace(/\]\[/g,"]"+va+"["),l=l.replace(/\[\]/g,"[ ]");let h=l.split(/[\[\]]+/);for(let c=0;c<h.length;c++){let p=this.cleanUp(this.unescape(h[c]));p!==va&&p!==""&&(c%2===0?n.push({type:"value",text:p}):n.push({type:i?"value":"format",text:"["+p+"]"}))}}else{let h=l.split(/[\[\]]+/);for(let c=0;c<h.length;c++){let p=this.cleanUp(this.unescape(h[c]));p!==""&&(c%2===0?n.push({type:"text",text:p}):this.isImage(p)?n.push({type:"image",text:"["+p+"]"}):n.push({type:"format",text:"["+p+"]"}))}}}return n}static isImage(e){return!!e.match(/img[ ]?:/)}static getTextStyle(e){let t={};if(e==""||e=="[ ]")return{};const i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(let s=0;s<i.length;s++)e=e.replace(i[s],i[s].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));let n=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w\-]+)|(\/)/gi);if(!n)return{};for(let s=0;s<n.length;s++)if(n[s].match(/^(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)$/i))t.fontWeight=n[s];else if(n[s].match(/^(underline|line-through)$/i))t.textDecoration=n[s];else if(n[s]!="/")if(!n[s].match(/:/))t.fill=Ve.fromString(n[s]);else{const a=n[s].replace("+"," ").split(/:[ ]*/);t[a[0]]=a[1]}return t}}Object.defineProperty(jn,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:"__amcharts__"});function Fu(r,e){if(e!=null){e=""+e,e=jn.escape(e);let t=e.match(/\{([^}]+)\}/g),i;if(t)for(i=0;i<t.length;i++){let n=t[i].replace(/\{([^}]+)\}/,"$1"),s=md(r,n);s==null&&(s=""),e=e.split(t[i]).join(s)}e=jn.unescape(e)}else e="";return e}function md(r,e,t){let i;const n=r.dataItem;let s=[],a=/(format[a-zA-Z]*)\((.*)\)|([^.]+)/g,l;for(;l=a.exec(e),l!==null;)if(l[3]){s.push({prop:l[3]});const h=r.getDateFormatter().get("dateFields",[]),c=r.getNumberFormatter().get("numericFields",[]),p=r.getDurationFormatter().get("durationFields",[]);h.indexOf(l[3])!==-1?s.push({method:"formatDate",params:[]}):c.indexOf(l[3])!==-1?s.push({method:"formatNumber",params:[]}):p.indexOf(l[3])!==-1&&s.push({method:"formatDuration",params:[]})}else{let h=[];if(hc(l[2])!=""){let c=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g,p;for(;p=c.exec(l[2]),p!==null;)h.push(p[1]||p[2]||p[3])}s.push({method:l[1],params:h})}if(n){i=$a(r,s,n._settings),(i==null||Xc(i))&&(i=$a(r,s,n));let h=n.dataContext;i==null&&h&&(i=$a(r,s,h),i==null&&(i=$a(r,[{prop:e}],h)),i==null&&h.dataContext&&(i=$a(r,s,h.dataContext))),i==null&&n.component&&n.component.dataItem!==n&&(i=md(n.component,e))}return i==null&&(i=$a(r,s,r)),i==null&&r.parent&&(i=md(r.parent,e)),i}function o8(r,e){const t=r.getPrivate("customData");if(Xc(t))return t[e]}function $a(r,e,t,i){let n=t,s=!1;for(let a=0,l=e.length;a<l;a++){let h=e[a];if(h.prop){if(n instanceof Xn){let c=n.get(h.prop);c==null&&(c=n.getPrivate(h.prop)),c==null&&(c=o8(n,h.prop)),c==null&&(c=n[h.prop]),n=c}else if(n.get){let c=n.get(h.prop);c==null&&(c=n[h.prop]),n=c}else n=n[h.prop];if(n==null)return}else switch(h.method){case"formatNumber":let c=an(n);c!=null&&(n=r.getNumberFormatter().format(c,i||h.params[0]||void 0),s=!0);break;case"formatDate":let p=_O(n);if(!hd(p)||xa(p.getTime()))return;p!=null&&(n=r.getDateFormatter().format(p,i||h.params[0]||void 0),s=!0);break;case"formatDuration":let g=an(n);g!=null&&(n=r.getDurationFormatter().format(g,i||h.params[0]||void 0,h.params[1]||void 0),s=!0);break;case"urlEncode":case"encodeURIComponent":n=encodeURIComponent(n);break;default:n[h.method]&&n[h.method].apply(t,h.params);break}}if(!s){let a=[{method:"",params:i}];if(i==null)ve(n)?(a[0].method="formatNumber",a[0].params=""):hd(n)&&(a[0].method="formatDate",a[0].params="");else{let l=NO(i);l==="number"?a[0].method="formatNumber":l==="date"?a[0].method="formatDate":l==="duration"&&(a[0].method="formatDuration")}a[0].method&&(n=$a(r,a,n))}return n}class Qe extends Xn{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"_childrenDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:new kO(this)}),Object.defineProperty(this,"_percentageSizeChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_percentagePositionChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_prevWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prevHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd1",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew(),this._display.addChild(this._childrenDisplay)}_dispose(){xu(this.allChildren(),e=>{e.dispose()}),this.getPrivate("htmlElement")&&this._root._removeHTMLContent(this),super._dispose()}_changed(){if(super._changed(),this.isDirty("interactiveChildren")&&(this._display.interactiveChildren=this.get("interactiveChildren",!1)),this.isDirty("layout")&&(this._prevWidth=0,this._prevHeight=0,this.markDirtyBounds(),this._prevSettings.layout&&this.children.each(e=>{e.removePrivate("x"),e.removePrivate("y")})),(this.isDirty("paddingTop")||this.isDirty("paddingBottom")||this.isDirty("paddingLeft")||this.isDirty("paddingRight"))&&this.children.each(e=>{e.markDirtyPosition()}),this.isDirty("maskContent")){const e=this._childrenDisplay;let t=this._contentMask;this.get("maskContent")?t||(t=Tn.new(this._root,{x:-.5,y:-.5,width:this.width()+1,height:this.height()+1}),this._contentMask=t,e.addChildAt(t._display,0),e.mask=t._display):t&&(e.removeChild(t._display),e.mask=null,t.dispose(),this._contentMask=void 0)}}_updateSize(){super._updateSize(),ce(this._percentageSizeChildren,e=>{e._updateSize()}),ce(this._percentagePositionChildren,e=>{e.markDirtyPosition(),e._updateSize()}),this.updateBackground()}updateBackground(){const e=this.get("background");let t=this._localBounds;if(t&&!this.isHidden()){let i=t.left,n=t.top,s=t.right-i,a=t.bottom-n,l=this.get("maxWidth"),h=this.get("maxHeight");h&&a>h&&(a=h),l&&s>l&&(s=l);let c=this.width(),p=this.height();e&&(e.setAll({width:s,height:a,x:i,y:n}),this._display.interactive&&(e._display.interactive=!0));const g=this._contentMask;g&&g.setAll({width:c+1,height:p+1});const m=this.get("verticalScrollbar");if(m){m.set("height",p),m.set("x",c-m.width()-m.get("marginRight",0)),m.set("end",m.get("start",0)+p/this._contentHeight);const _=m.get("background");_&&_.setAll({width:m.width(),height:p});let b=!0;this._contentHeight<=p&&(b=!1),m.setPrivate("visible",b)}}}_applyThemes(){return super._applyThemes()?(this.eachChildren(e=>{e._applyThemes()}),!0):!1}_applyState(e){super._applyState(e),this.get("setStateOnChildren")&&this.eachChildren(t=>{t.states.apply(e)})}_applyStateAnimated(e,t){super._applyStateAnimated(e,t),this.get("setStateOnChildren")&&this.eachChildren(i=>{i.states.applyAnimate(e,t)})}innerWidth(){return this.width()-this.get("paddingRight",0)-this.get("paddingLeft",0)}innerHeight(){return this.height()-this.get("paddingTop",0)-this.get("paddingBottom",0)}_getBounds(){let e=this.get("width"),t=this.get("height"),i=this.getPrivate("width"),n=this.getPrivate("height"),s={left:0,top:0,right:this.width(),bottom:this.height()},a=this.get("layout"),l=!1,h=!1;if((a instanceof fl||a instanceof ao)&&(l=!0),a instanceof dl&&(h=!0),!((e!=null||i!=null)&&(t!=null||n!=null)&&!this.get("verticalScrollbar"))){let c=Number.MAX_VALUE,p=c,g=-c,m=c,_=-c;const b=this.get("paddingLeft",0),x=this.get("paddingTop",0),w=this.get("paddingRight",0),P=this.get("paddingBottom",0);this.children.each(E=>{if(E.get("position")!="absolute"&&E.get("isMeasured")){let k=E.adjustedLocalBounds(),C=E.x(),O=E.y(),F=C+k.left,D=C+k.right,N=O+k.top,X=O+k.bottom;l&&(F-=E.get("marginLeft",0),D+=E.get("marginRight",0)),h&&(N-=E.get("marginTop",0),X+=E.get("marginBottom",0)),F<p&&(p=F),D>g&&(g=D),N<m&&(m=N),X>_&&(_=X)}}),p==c&&(p=0),g==-c&&(g=0),m==c&&(m=0),_==-c&&(_=0),s.left=p-b,s.top=m-x,s.right=g+w,s.bottom=_+P}this._contentWidth=s.right-s.left,this._contentHeight=s.bottom-s.top,ve(e)&&(s.left=0,s.right=e),ve(i)&&(s.left=0,s.right=i),ve(t)&&(s.top=0,s.bottom=t),ve(n)&&(s.top=0,s.bottom=n),this._localBounds=s}_updateBounds(){const e=this.get("layout");e&&e.updateContainer(this),super._updateBounds(),this.updateBackground()}markDirty(){super.markDirty(),this._root._addDirtyParent(this)}_prepareChildren(){const e=this.innerWidth(),t=this.innerHeight();if(e!=this._prevWidth||t!=this._prevHeight){let i=this.get("layout"),n=!1,s=!1;i&&((i instanceof fl||i instanceof ao)&&(n=!0),i instanceof dl&&(s=!0)),ce(this._percentageSizeChildren,a=>{if(!n){let l=a.get("width");l instanceof gt&&a.setPrivate("width",l.value*e)}if(!s){let l=a.get("height");l instanceof gt&&a.setPrivate("height",l.value*t)}}),ce(this._percentagePositionChildren,a=>{a.markDirtyPosition(),a.markDirtyBounds()}),this._prevWidth=e,this._prevHeight=t,this._sizeDirty=!0,this.updateBackground()}this._handleStates()}_updateChildren(){if(this.isDirty("html")){const e=this.get("html");e&&e!==""?this._root._setHTMLContent(this,Fu(this,this.get("html",""))):this._root._removeHTMLContent(this),this._root._positionHTMLElement(this)}if(this.isDirty("verticalScrollbar")){const e=this.get("verticalScrollbar");if(e){e._setParent(this),e.startGrip.setPrivate("visible",!1),e.endGrip.setPrivate("visible",!1),this.set("maskContent",!0),this.set("paddingRight",e.width()+e.get("marginRight",0)+e.get("marginLeft",0));let t=this.get("background");t||(t=this.set("background",Tn.new(this._root,{themeTags:["background"],fillOpacity:0,fill:this._root.interfaceColors.get("alternativeBackground")}))),this._vsbd0=this.events.on("wheel",i=>{const n=i.originalEvent;if(Ov(n,this))n.preventDefault();else return;let s=n.deltaY/5e3;const a=e.get("start",0),l=e.get("end",1);a+s<=0&&(s=-a),l+s>=1&&(s=1-l),a+s>=0&&l+s<=1&&(e.set("start",a+s),e.set("end",l+s))}),this._disposers.push(this._vsbd0),this._vsbd1=e.events.on("rangechanged",()=>{let i=this._contentHeight;const n=this._childrenDisplay,s=this._contentMask;n.y=-e.get("start")*i,n.markDirtyLayer(),s&&(s._display.y=-n.y,n.mask=s._display)}),this._disposers.push(this._vsbd1),this._display.addChild(e._display)}else{const t=this._prevSettings.verticalScrollbar;if(t){this._display.removeChild(t._display),this._vsbd0&&this._vsbd0.dispose(),this._vsbd1&&this._vsbd1.dispose();const i=this._childrenDisplay;i.y=0,this.setPrivate("height",void 0),this.set("maskContent",!1),this.set("paddingRight",void 0)}}}if(this.isDirty("background")){const e=this._prevSettings.background;e&&this._display.removeChild(e._display);const t=this.get("background");t instanceof Xn&&(t.set("isMeasured",!1),t._setParent(this),this._display.addChildAt(t._display,0))}if(this.isDirty("mask")){const e=this.get("mask"),t=this._prevSettings.mask;if(t&&(this._display.removeChild(t._display),t!=e&&t.dispose()),e){const i=e.parent;i&&i.children.removeValue(e),e._setParent(this),this._display.addChildAt(e._display,0),this._childrenDisplay.mask=e._display}}}_processTemplateField(){super._processTemplateField(),this.children.each(e=>{e._processTemplateField()})}walkChildren(e){this.children.each(t=>{t instanceof Qe&&t.walkChildren(e),e(t)})}eachChildren(e){const t=this.get("background");t&&e(t);const i=this.get("verticalScrollbar");i&&e(i);const n=this.get("mask");n&&e(n),this.children.values.forEach(s=>{e(s)})}allChildren(){const e=[];return this.eachChildren(t=>{e.push(t)}),e}_setDataItem(e){const t=e!==this._dataItem;super._setDataItem(e);const i=this.get("html","");i&&i!==""&&t&&this._root._setHTMLContent(this,Fu(this,i))}}Object.defineProperty(Qe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Container"});Object.defineProperty(Qe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Xn.classNames.concat([Qe.className])});class oo extends Xn{constructor(){super(...arguments),Object.defineProperty(this,"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeTextStyle()}),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeText("",this.textStyle)}),Object.defineProperty(this,"_textStyles",{enumerable:!0,configurable:!0,writable:!0,value:["textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale"]}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_updateBounds(){if(this.get("text"))super._updateBounds();else{let e={left:0,right:0,top:0,bottom:0};this._adjustedLocalBounds=e}}_changed(){super._changed(),this._display.clear();let e=this.textStyle;if(this.isDirty("opacity")){let t=this.get("opacity",1);this._display.alpha=t}if((this.isDirty("text")||this.isDirty("populateText"))&&(this._display.text=this._getText(),this.markDirtyBounds(),this.get("role")=="tooltip"&&this._root.updateTooltip(this)),this.isPrivateDirty("tooltipElement")&&this.getPrivate("tooltipElement")&&this._disposers.push(new Ni(()=>{this._root._removeTooltipElement(this)})),this.isDirty("width")&&(e.wordWrapWidth=this.width(),this.markDirtyBounds()),this.isDirty("oversizedBehavior")&&(e.oversizedBehavior=this.get("oversizedBehavior","none"),this.markDirtyBounds()),this.isDirty("breakWords")&&(e.breakWords=this.get("breakWords",!1),this.markDirtyBounds()),this.isDirty("ellipsis")&&(e.ellipsis=this.get("ellipsis"),this.markDirtyBounds()),this.isDirty("ignoreFormatting")&&(e.ignoreFormatting=this.get("ignoreFormatting",!1),this.markDirtyBounds()),this.isDirty("minScale")&&(e.minScale=this.get("minScale",0),this.markDirtyBounds()),this.isDirty("fill")){let t=this.get("fill");t&&(e.fill=t)}if(this.isDirty("fillOpacity")){let t=this.get("fillOpacity",1);t&&(e.fillOpacity=t)}(this.isDirty("maxWidth")||this.isPrivateDirty("maxWidth"))&&(e.maxWidth=this.get("maxWidth",this.getPrivate("maxWidth")),this.markDirtyBounds()),(this.isDirty("maxHeight")||this.isPrivateDirty("maxHeight"))&&(e.maxHeight=this.get("maxHeight",this.getPrivate("maxHeight")),this.markDirtyBounds()),ce(this._textStyles,t=>{this._dirty[t]&&(e[t]=this.get(t),this.markDirtyBounds())}),e.fontSize=this.get("fontSize"),e.fontFamily=this.get("fontFamily"),this._display.style=e,this.isDirty("role")&&this.get("role")=="tooltip"&&this._root.updateTooltip(this)}_getText(){const e=this.get("text","");return this.get("populateText")?Fu(this,e):e}markDirtyText(){this._display.text=this._getText(),this.get("role")=="tooltip"&&this._root.updateTooltip(this),this.markDirtyBounds(),this.markDirty()}_setDataItem(e){super._setDataItem(e),this.get("populateText")&&this.markDirtyText()}getNumberFormatter(){return this.parent?this.parent.getNumberFormatter():super.getNumberFormatter()}getDateFormatter(){return this.parent?this.parent.getDateFormatter():super.getDateFormatter()}getDurationFormatter(){return this.parent?this.parent.getDurationFormatter():super.getDurationFormatter()}}Object.defineProperty(oo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"});Object.defineProperty(oo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Xn.classNames.concat([oo.className])});class l8{constructor(){Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver(e=>{ce(e,t=>{ce(this._targets,i=>{i.target===t.target&&i.callback()})})})}addTarget(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}removeTarget(e){this._observer.unobserve(e),Gc(this._targets,t=>t.target!==e)}}class Vc{constructor(){Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}addTarget(e,t){if(this._timer===null){let n=null;const s=()=>{const a=Date.now();(n===null||a>n+Vc.delay)&&(n=a,ce(this._targets,l=>{let h=l.target.getBoundingClientRect();(h.width!==l.size.width||h.height!==l.size.height)&&(l.size=h,l.callback())})),this._targets.length===0?this._timer=null:this._timer=requestAnimationFrame(s)};this._timer=requestAnimationFrame(s)}let i={width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0};this._targets.push({target:e,callback:t,size:i})}removeTarget(e){Gc(this._targets,t=>t.target!==e),this._targets.length===0&&this._timer!==null&&(cancelAnimationFrame(this._timer),this._timer=null)}}Object.defineProperty(Vc,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});let ac=null;function u8(){return ac===null&&(typeof ResizeObserver<"u"?ac=new l8:ac=new Vc),ac}class h8{constructor(e,t){Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=u8(),this._element=e,this._listener=Dv(t),this._sensor.addTarget(e,t)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}get sensor(){return this._sensor}}class Cc extends dr{}Object.defineProperty(Cc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"});Object.defineProperty(Cc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([Cc.className])});class cr extends Qe{constructor(){super(...arguments),Object.defineProperty(this,"_text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_textKeys",{enumerable:!0,configurable:!0,writable:!0,value:["text","fill","fillOpacity","textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","populateText","role","ignoreFormatting"]})}get text(){return this._text}_afterNew(){super._afterNew(),this._makeText(),ce(this._textKeys,e=>{const t=this.get(e);t!=null&&this._text.set(e,t)}),this.get("html","")!==""&&this._text.set("text",""),this.onPrivate("maxWidth",()=>{this._setMaxDimentions()}),this.onPrivate("maxHeight",()=>{this._setMaxDimentions()})}_makeText(){this._text=this.children.push(oo.new(this._root,{}))}_updateChildren(){if(super._updateChildren(),ce(this._textKeys,e=>{this._text.set(e,this.get(e))}),this.isDirty("maxWidth")&&this._setMaxDimentions(),this.isDirty("maxHeight")&&this._setMaxDimentions(),this.isDirty("rotation")&&this._setMaxDimentions(),this.get("html","")!==""?this._text.set("text",""):this._text.set("text",this.get("text")),this.isDirty("textAlign")||this.isDirty("width")){const e=this.get("textAlign");let t;this.get("width")!=null?e=="right"?t=ze:e=="center"?t=ot:t=0:e=="left"||e=="start"?t=this.get("paddingLeft"):(e=="right"||e=="end")&&(t=-this.get("paddingRight")),this.text.set("x",t)}}_setMaxDimentions(){const e=this.get("rotation"),t=e==90||e==270||e==-90,i=this.get("maxWidth",this.getPrivate("maxWidth",1/0));ve(i)?this.text.set(t?"maxHeight":"maxWidth",i-this.get("paddingLeft",0)-this.get("paddingRight",0)):this.text.set(t?"maxHeight":"maxWidth",void 0);const n=this.get("maxHeight",this.getPrivate("maxHeight",1/0));ve(n)?this.text.set(t?"maxWidth":"maxHeight",n-this.get("paddingTop",0)-this.get("paddingBottom",0)):this.text.set(t?"maxWidth":"maxHeight",void 0)}_setDataItem(e){super._setDataItem(e),this._markDirtyKey("text"),this.text.get("populateText")&&this.text.markDirtyText()}getText(){return this._text._getText()}}Object.defineProperty(cr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Label"});Object.defineProperty(cr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([cr.className])});class ol extends wi{_beforeChanged(){super._beforeChanged(),(this.isDirty("pointerBaseWidth")||this.isDirty("cornerRadius")||this.isDirty("pointerLength")||this.isDirty("pointerX")||this.isDirty("pointerY")||this.isDirty("width")||this.isDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){this.markDirtyBounds();let e=this.width(),t=this.height();if(e>0&&t>0){let i=this.get("cornerRadius",8);i=Di(i,0,Math.min(e/2,t/2));let n=this.get("pointerX",0),s=this.get("pointerY",0),a=this.get("pointerBaseWidth",15)/2,l=0,h=0,c=e,p=0,g=e,m=t,_=0,b=t,x=(n-l)*(m-h)-(s-h)*(g-l),w=(n-_)*(p-b)-(s-b)*(c-_);const P=this._display;if(P.moveTo(i,0),x>0&&w>0){let E=Math.round(Di(n,i+a,e-a-i));s=Di(s,-1/0,0),P.lineTo(E-a,0),P.lineTo(n,s),P.lineTo(E+a,0)}if(P.lineTo(e-i,0),P.arcTo(e,0,e,i,i),x>0&&w<0){let E=Math.round(Di(s,i+a,t-a-i));n=Di(n,e,1/0),P.lineTo(e,i),P.lineTo(e,Math.max(E-a,i)),P.lineTo(n,s),P.lineTo(e,E+a)}if(P.lineTo(e,t-i),P.arcTo(e,t,e-i,t,i),x<0&&w<0){let E=Math.round(Di(n,i+a,e-a-i));s=Di(s,t,1/0),P.lineTo(e-i,t),P.lineTo(E+a,t),P.lineTo(n,s),P.lineTo(E-a,t)}if(P.lineTo(i,t),P.arcTo(0,t,0,t-i,i),x<0&&w>0){let E=Math.round(Di(s,i+a,t-i-a));n=Di(n,-1/0,0),P.lineTo(0,t-i),P.lineTo(0,E+a),P.lineTo(n,s),P.lineTo(0,Math.max(E-a,i))}P.lineTo(0,i),P.arcTo(0,0,i,0,i),P.closePath()}}}}Object.defineProperty(ol,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PointedRectangle"});Object.defineProperty(ol,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([ol.className])});class Ws extends Qe{constructor(e,t,i,n=[]){super(e,t,i,n),Object.defineProperty(this,"_fx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_fy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_labelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_w",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_h",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_keepHoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlContentHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["tooltip"]),super._afterNew(),this.set("background",ol.new(this._root,{themeTags:["tooltip","background"]})),this._label=this.children.push(cr.new(this._root,{})),this._disposers.push(this._label.events.on("boundschanged",()=>{this._updateBackground()})),this._disposers.push(this.on("bounds",()=>{this._updateBackground()})),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate("htmlElement",e=>{e&&(fi(e,"pointerover",t=>{this._htmlContentHovered=!0}),fi(e,"pointerout",t=>{this._htmlContentHovered=!1}))})),this._root._tooltips.push(this)}get label(){return this._label}dispose(){super.dispose(),yn(this._root._tooltips,this)}_updateChildren(){super._updateChildren(),(this.isDirty("pointerOrientation")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&this.get("background")._markDirtyKey("width"),this.get("labelText")!=null&&this.label.set("text",this.get("labelText")),this.get("labelHTML")!=null&&this.label.set("html",this.get("labelHTML"))}_changed(){if(super._changed(),(this.isDirty("pointTo")||this.isDirty("pointerOrientation"))&&this._updateBackground(),this.isDirty("tooltipTarget")&&this.updateBackgroundColor(),this.isDirty("keepTargetHover"))if(this.get("keepTargetHover")){const t=this.get("background");this._keepHoverDp=new Kr([t.events.on("pointerover",i=>{let n=this.get("tooltipTarget");n&&(n.parent&&n.parent.getPrivate("tooltipTarget")==n&&(n=n.parent),n.hover())}),t.events.on("pointerout",i=>{let n=this.get("tooltipTarget");n&&(n.parent&&n.parent.getPrivate("tooltipTarget")==n&&(n=n.parent),this._htmlContentHovered||n.unhover())})]),this.label.onPrivate("htmlElement",i=>{this._keepHoverDp&&i&&this._keepHoverDp.disposers.push(fi(i,"pointerleave",n=>{const s=this.root._renderer.getEvent(n);t.events.dispatch("pointerout",{type:"pointerout",originalEvent:s.event,point:s.point,simulated:!1,target:t})}))})}else this._keepHoverDp&&(this._keepHoverDp.dispose(),this._keepHoverDp=void 0)}_onShow(){super._onShow(),this.updateBackgroundColor()}updateBackgroundColor(){let e=this.get("tooltipTarget");const t=this.get("background");let i,n;e&&t&&(i=e.get("fill"),n=e.get("stroke"),i==null&&(i=n),this.get("getFillFromSprite")&&(this._fillDp&&this._fillDp.dispose(),i!=null&&t.set("fill",i),this._fillDp=e.on("fill",s=>{s!=null&&(t.set("fill",s),this._updateTextColor(s))}),this._disposers.push(this._fillDp)),this.get("getStrokeFromSprite")&&(this._strokeDp&&this._strokeDp.dispose(),i!=null&&t.set("stroke",i),this._strokeDp=e.on("fill",s=>{s!=null&&t.set("stroke",s)}),this._disposers.push(this._strokeDp)),this.get("getLabelFillFromSprite")&&(this._labelDp&&this._labelDp.dispose(),i!=null&&this.label.set("fill",i),this._labelDp=e.on("fill",s=>{s!=null&&this.label.set("fill",s)}),this._disposers.push(this._labelDp))),this._updateTextColor(i)}_updateTextColor(e){this.get("autoTextColor")&&(e==null&&(e=this.get("background").get("fill")),e==null&&(e=this._root.interfaceColors.get("background")),e instanceof Ve&&this.label.set("fill",Ve.alternative(e,this._root.interfaceColors.get("alternativeText"),this._root.interfaceColors.get("text"))))}_setDataItem(e){super._setDataItem(e),this.label._setDataItem(e)}_updateBackground(){super.updateBackground();const e=this._root.container;if(e){let t=.5,i=.5,n=this.get("centerX");n instanceof gt&&(t=n.value);let s=this.get("centerY");s instanceof gt&&(i=s.value);let a=e.width(),l=e.height(),h=this.parent,c=0,p=0;if(h){c=h.x(),p=h.y();const U=h.get("layerMargin");U&&(c+=U.left||0,p+=U.top||0,a+=(U.left||0)+(U.right||0),l+=(U.top||0)+(U.bottom||0))}const g=this.get("bounds",{left:-c,top:-p,right:a-c,bottom:l-p});this._updateBounds();let m=this.width(),_=this.height();m===0&&(m=this._w),_===0&&(_=this._h);let b=this.get("pointTo",{x:a/2,y:l/2}),x=b.x,w=b.y,P=this.get("pointerOrientation"),E=this.get("background"),k=0,C=0,O=0;E instanceof ol&&(k=E.get("pointerLength",0),C=E.get("strokeWidth",0)/2,O=C,E.set("width",m),E.set("height",_));let F=0,D=0,N=g.right-g.left,X=g.bottom-g.top;P=="horizontal"||P=="left"||P=="right"?(C=0,P=="horizontal"?x>g.left+N/2?(x-=m*(1-t)+k,O*=-1):x+=m*t+k:P=="left"?x+=m*(1-t)+k:(x-=m*t+k,O*=-1)):(O=0,P=="vertical"?w>g.top+_/2+k?w-=_*(1-i)+k:(w+=_*i+k,C*=-1):P=="down"?w-=_*(1-i)+k:(w+=_*i+k,C*=-1)),x=Di(x,g.left+m*t,g.left+N-m*(1-t))+O,w=Di(w,g.top+_*i,g.top+X-_*(1-i))-C,F=b.x-x+m*t+O,D=b.y-w+_*i-C,this._fx=x,this._fy=w;const z=this.get("animationDuration",0);if(z>0&&this.get("visible")&&this.get("opacity")>.1){const U=this.get("animationEasing");this.animate({key:"x",to:x,duration:z,easing:U}),this.animate({key:"y",to:w,duration:z,easing:U})}else this.set("x",x),this.set("y",w);E instanceof ol&&(E.set("pointerX",F),E.set("pointerY",D)),m>0&&(this._w=m),_>0&&(this._h=_)}}}Object.defineProperty(Ws,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tooltip"});Object.defineProperty(Ws,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([Ws.className])});class c8 extends dr{_setDefaults(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);const e="_big_number_suffix_",t="_small_number_suffix_",i="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(i+"B")},{number:1024,suffix:this._t(i+"KB")},{number:1048576,suffix:this._t(i+"MB")},{number:1073741824,suffix:this._t(i+"GB")},{number:1099511627776,suffix:this._t(i+"TB")},{number:0x4000000000000,suffix:this._t(i+"PB")}]),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){(t==null||cl(t)&&t.toLowerCase()==="number")&&(t=this.get("numberFormat",""));let n,s=Number(e);if(Xc(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(s):new Intl.NumberFormat(void 0,t).format(s)}catch{return"Invalid"}else{t=ep(t);let a=this.parseFormat(t,this._root.language),l;s>this.get("negativeBase")?l=a.positive:s<this.get("negativeBase")?l=a.negative:l=a.zero,i!=null&&!l.mod&&(l=su(l),l.decimals.active=s==0?0:i),n=l.template.split(va).join(this.applyFormat(s,l))}return this.get("forceLTR")===!0&&(n="‎"+n),n}parseFormat(e,t){const i=t.translateEmpty("_thousandSeparator"),n=t.translateEmpty("_decimalSeparator");let s={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1}};e=e.replace("||",il);let a=e.split("|");return s.positive.source=a[0],typeof a[2]>"u"?s.zero=s.positive:s.zero.source=a[2],typeof a[1]>"u"?s.negative=s.positive:s.negative.source=a[1],Zt(s,(l,h)=>{if(h.parsed)return;let c=h.source;c.toLowerCase()==="number"&&(c=this.get("numberFormat","#,###.#####"));let p=jn.chunk(c,!0);for(let g=0;g<p.length;g++){let m=p[g];if(m.text=m.text.replace(il,"|"),m.type==="value"){let _=m.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP‰!]?/);if(_)if(_===null||_[0]==="")h.template+=m.text;else{let b=_[0].match(/[abespABESP%‰!]{2}|[abespABESP%‰]{1}$/);b&&(h.mod=b[0].toLowerCase(),h.modSpacing=!!_[0].match(/[ ]{1}[abespABESP%‰!]{1}$/));let x=_[0].split(".");if(x[0]!==""){h.thousands.active=(x[0].match(/0/g)||[]).length,h.thousands.passive=(x[0].match(/\#/g)||[]).length+h.thousands.active;let w=x[0].split(",");w.length===1||(h.thousands.interval=(w.pop()||"").length,h.thousands.interval===0&&(h.thousands.interval=-1))}typeof x[1]>"u"||(h.decimals.active=(x[1].match(/0/g)||[]).length,h.decimals.passive=(x[1].match(/\#/g)||[]).length+h.decimals.active),h.template+=m.text.split(_[0]).join(va)}}else h.template+=m.text}h.parsed=!0}),s}applyFormat(e,t){let i=e<0;e=Math.abs(e);let n="",s="",a=t.mod?t.mod.split(""):[];if(a.indexOf("b")!==-1){let g=this.applyPrefix(e,this.get("bytePrefixes"),a.indexOf("!")!==-1);e=g[0],n=g[1],s=g[2],t.modSpacing&&(s=" "+s)}else if(a.indexOf("a")!==-1){let g=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),a.indexOf("!")!==-1);e=g[0],n=g[1],s=g[2],t.modSpacing&&(s=" "+s)}else if(a.indexOf("p")!==-1){let g=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(g)),n=this._root.language.translate("_percentPrefix"),s=this._root.language.translate("_percentSuffix"),n==""&&s==""&&(s="%")}else if(a.indexOf("%")!==-1){let g=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(g)),s="%"}else if(a.indexOf("‰")!==-1){let g=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(g)),s="‰"}if(a.indexOf("e")!==-1){let g;t.decimals.passive>=0?g=e.toExponential(t.decimals.passive).split("e"):g=e.toExponential().split("e"),e=Number(g[0]),s="e"+g[1],t.modSpacing&&(s=" "+s)}else if(t.decimals.passive===0)e=Math.round(e);else if(t.decimals.passive>0){let g=Math.pow(10,t.decimals.passive);e=Math.round(e*g)/g}let l="",h=mO(e).split("."),c=h[0];if(c.length<t.thousands.active&&(c=Array(t.thousands.active-c.length+1).join("0")+c),t.thousands.interval>0){let g=[],m=c.split("").reverse().join("");for(let _=0,b=c.length;_<=b;_+=t.thousands.interval){let x=m.substr(_,t.thousands.interval).split("").reverse().join("");x!==""&&g.unshift(x)}c=g.join(t.thousands.separator)}l+=c,h.length===1&&h.push("");let p=h[1];return p.length<t.decimals.active&&(p+=Array(t.decimals.active-p.length+1).join("0")),p!==""&&(l+=t.decimals.separator+p),l===""&&(l="0"),e!==0&&i&&a.indexOf("s")===-1&&(l="-"+l),n&&(l=n+l),s&&(l+=s),l}applyPrefix(e,t,i=!1){let n=e,s="",a="",l=!1,h=1;for(let c=0,p=t.length;c<p;c++)t[c].number<=e&&(t[c].number===0?n=0:(n=e/t[c].number,h=t[c].number),s=t[c].prefix,a=t[c].suffix,l=!0);return!l&&i&&t.length&&e!=0&&(n=e/t[0].number,s=t[0].prefix,a=t[0].suffix,l=!0),l&&(n=parseFloat(n.toPrecision(Math.min(h.toString().length+Math.floor(n).toString().replace(/[^0-9]*/g,"").length,21)))),[n,s,a]}escape(e){return e.replace("||",il)}unescape(e){return e.replace(il,"|")}}function Wv(r,e){let t=0,i=0,n=1,s=0,a=0,l=0,h=0,c=0;return r.formatToParts(e).forEach(p=>{switch(p.type){case"year":t=+p.value;break;case"month":i=+p.value-1;break;case"day":n=+p.value;break;case"hour":s=+p.value;break;case"minute":a=+p.value;break;case"second":l=+p.value;break;case"fractionalSecond":h=+p.value;break;case"weekday":switch(p.value){case"Sun":c=0;break;case"Mon":c=1;break;case"Tue":c=2;break;case"Wed":c=3;break;case"Thu":c=4;break;case"Fri":c=5;break;case"Sat":c=6;break}}}),s===24&&(s=0),{year:t,month:i,day:n,hour:s,minute:a,second:l,millisecond:h,weekday:c}}function Om(r,e){const{year:t,month:i,day:n,hour:s,minute:a,second:l,millisecond:h}=Wv(r,e);return Date.UTC(t,i,n,s,a,l,h)}class f8{constructor(e,t){if(Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=e,this._utc=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}static new(e){return new this(e,!0)}convertLocal(e){const t=this.offsetUTC(e),i=e.getTimezoneOffset(),n=new Date(e);n.setUTCMinutes(n.getUTCMinutes()-(t-i));const s=n.getTimezoneOffset();return i!=s&&n.setUTCMinutes(n.getUTCMinutes()+s-i),n}offsetUTC(e){const t=Om(this._utc,e),i=Om(this._dtf,e);return(t-i)/6e4}parseDate(e){return Wv(this._dtf,e)}}class d8 extends dr{_setDefaults(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t){(typeof t>"u"||t==="")&&(t=this.get("dateFormat","yyyy-MM-dd"));let i,n=e;if(Xc(t))try{const l=this.get("intlLocales");return l?new Intl.DateTimeFormat(l,t).format(n):new Intl.DateTimeFormat(void 0,t).format(n)}catch{return"Invalid"}let s=this.parseFormat(t);const a=this._root.timezone;return a&&!this._root.utc&&(n=a.convertLocal(n)),ve(n.getTime())?(i=this.applyFormat(n,s),this.get("capitalize")&&(i=i.replace(/^.{1}/,i.substr(0,1).toUpperCase())),i):"Invalid date"}applyFormat(e,t){let i=t.template,n,s,a,l,h,c,p,g,m=e.getTime();this._root.utc?(n=e.getUTCFullYear(),s=e.getUTCMonth(),a=e.getUTCDay(),l=e.getUTCDate(),h=e.getUTCHours(),c=e.getUTCMinutes(),p=e.getUTCSeconds(),g=e.getUTCMilliseconds()):(n=e.getFullYear(),s=e.getMonth(),a=e.getDay(),l=e.getDate(),h=e.getHours(),c=e.getMinutes(),p=e.getSeconds(),g=e.getMilliseconds());for(let _=0,b=t.parts.length;_<b;_++){let x="";switch(t.parts[_]){case"G":x=this._t(n<0?"_era_bc":"_era_ad");break;case"yyyy":x=Math.abs(n).toString(),n<0&&(x+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":x=Math.abs(n).toString().substr(-t.parts[_].length),n<0&&(x+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":let w=HO(e,this._root.utc);t.parts[_]=="YYYY"?x=Math.abs(w).toString():x=Math.abs(w).toString().substr(-t.parts[_].length),w<0&&(x+=this._t("_era_bc"));break;case"u":break;case"q":x=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":x=this._t(this._getMonth(s)).substr(0,1);break;case"MMMM":x=this._t(this._getMonth(s));break;case"MMM":x=this._t(this._getShortMonth(s));break;case"MM":x=yi(s+1,2,"0");break;case"M":x=(s+1).toString();break;case"ww":x=yi(Ec(e,this._root.utc),2,"0");break;case"w":x=Ec(e,this._root.utc).toString();break;case"W":x=zO(e,this._root.utc).toString();break;case"dd":x=yi(l,2,"0");break;case"d":x=l.toString();break;case"DD":case"DDD":x=yi(Em(e,this._root.utc).toString(),t.parts[_].length,"0");break;case"D":x=Em(e,this._root.utc).toString();break;case"F":break;case"g":break;case"t":x=this._root.language.translateFunc("_dateOrd").call(this,l);break;case"E":x=(a||7).toString();break;case"EE":x=yi((a||7).toString(),2,"0");break;case"EEE":case"eee":x=this._t(this._getShortWeekday(a));break;case"EEEE":case"eeee":x=this._t(this._getWeekday(a));break;case"EEEEE":case"eeeee":x=this._t(this._getShortWeekday(a)).substr(0,1);break;case"e":case"ee":x=(a-(this._root.locale.firstDayOfWeek||1)+1).toString(),t.parts[_]=="ee"&&(x=yi(x,2,"0"));break;case"a":h>=12?x=this._t("PM"):x=this._t("AM");break;case"aa":h>=12?x=this._t("P.M."):x=this._t("A.M.");break;case"aaa":h>=12?x=this._t("P"):x=this._t("A");break;case"h":x=ic(h).toString();break;case"hh":x=yi(ic(h),2,"0");break;case"H":x=h.toString();break;case"HH":x=yi(h,2,"0");break;case"K":x=ic(h,0).toString();break;case"KK":x=yi(ic(h,0),2,"0");break;case"k":x=(h+1).toString();break;case"kk":x=yi(h+1,2,"0");break;case"m":x=c.toString();break;case"mm":x=yi(c,2,"0");break;case"s":x=p.toString();break;case"ss":x=yi(p,2,"0");break;case"S":case"SS":case"SSS":x=Math.round(g/1e3*Math.pow(10,t.parts[_].length)).toString();break;case"x":x=m.toString();break;case"n":case"nn":case"nnn":x=yi(g,t.parts[_].length,"0");break;case"z":x=rc(e,!1,!1,this._root.utc);break;case"zz":x=rc(e,!0,!1,this._root.utc);break;case"zzz":x=rc(e,!1,!0,this._root.utc);break;case"zzzz":x=rc(e,!0,!0,this._root.utc);break;case"Z":case"ZZ":let P=this._root.utc?"UTC":this._root.timezone;P instanceof f8&&(P=P.name);const E=P?WO(P):e.getTimezoneOffset();let k=Math.abs(E)/60,C=Math.floor(k),O=k*60-C*60;this._root.utc&&(C=0,O=0),t.parts[_]=="Z"?(x="GMT",x+=E>0?"-":"+",x+=yi(C,2)+":"+yi(O,2)):(x=E>0?"-":"+",x+=yi(C,2)+yi(O,2));break;case"i":x=e.toISOString();break;case"I":x=e.toUTCString();break}i=i.replace(va,x)}return i}parseFormat(e){let t={template:"",parts:[]},i=jn.chunk(e,!0);for(let n=0;n<i.length;n++){let s=i[n];if(s.type==="value"){if(s.text.match(/^date$/i)){let l=this.get("dateFormat","yyyy-MM-dd");cl(l)||(l="yyyy-MM-dd"),s.text=l}let a=s.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(a)for(let l=0;l<a.length;l++)t.parts.push(a[l]),s.text=s.text.replace(a[l],va)}t.template+=s.text}return t}_months(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}_getMonth(e){return this._months()[e]}_shortMonths(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}_getShortMonth(e){return this._shortMonths()[e]}_weekdays(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}_getWeekday(e){return this._weekdays()[e]}_shortWeekdays(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}_getShortWeekday(e){return this._shortWeekdays()[e]}parse(e,t){if(e instanceof Date)return e;if(ve(e))return new Date(e);cl(e)||(e=e.toString());let i,n="";t=ep(t),t=t.substr(0,e.length);let s=this.parseFormat(t),a={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},l={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this._root.utc},h=0,c=0;for(let m=0;m<s.parts.length;m++){switch(c=m+h+1,s.parts[m]){case"yyyy":case"YYYY":n+="([0-9]{4})",a.year=c;break;case"yyy":case"YYY":n+="([0-9]{3})",a.year3=c;break;case"yy":case"YY":n+="([0-9]{2})",a.year2=c;break;case"y":case"Y":n+="([0-9]{1})",a.year1=c;break;case"MMMM":n+="("+this.getStringList(this._months()).join("|")+")",a.monthLong=c;break;case"MMM":n+="("+this.getStringList(this._shortMonths()).join("|")+")",a.monthShort=c;break;case"MM":case"M":n+="([0-9]{2}|[0-9]{1})",a.month=c;break;case"ww":case"w":n+="([0-9]{2}|[0-9]{1})",a.week=c;break;case"dd":case"d":n+="([0-9]{2}|[0-9]{1})",a.day=c;break;case"DDD":case"DD":case"D":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.yearDay=c;break;case"dddd":n+="("+this.getStringList(this._weekdays()).join("|")+")",a.weekdayLong=c;break;case"ddd":n+="("+this.getStringList(this._shortWeekdays()).join("|")+")",a.weekdayShort=c;break;case"aaa":case"aa":case"a":n+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",a.am=c;break;case"hh":case"h":n+="([0-9]{2}|[0-9]{1})",a.hour12Base1=c;break;case"HH":case"H":n+="([0-9]{2}|[0-9]{1})",a.hourBase0=c;break;case"KK":case"K":n+="([0-9]{2}|[0-9]{1})",a.hour12Base0=c;break;case"kk":case"k":n+="([0-9]{2}|[0-9]{1})",a.hourBase1=c;break;case"mm":case"m":n+="([0-9]{2}|[0-9]{1})",a.minute=c;break;case"ss":case"s":n+="([0-9]{2}|[0-9]{1})",a.second=c;break;case"SSS":case"SS":case"S":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=c,a.millisecondDigits=s.parts[m].length;break;case"nnn":case"nn":case"n":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=c;break;case"x":n+="([0-9]{1,})",a.timestamp=c;break;case"Z":n+="GMT([-+]+[0-9]{2}:[0-9]{2})",a.zone=c;break;case"ZZ":n+="([\\-+]+[0-9]{2}[0-9]{2})",a.zone=c;break;case"i":n+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",a.iso=c,h+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":h--;break}n+="[^0-9]*"}let p=new RegExp(n),g=e.match(p);if(g){if(a.year>-1&&(l.year=parseInt(g[a.year])),a.year3>-1){let m=parseInt(g[a.year3]);m+=1e3,l.year=m}if(a.year2>-1){let m=parseInt(g[a.year2]);m>50?m+=1e3:m+=2e3,l.year=m}if(a.year1>-1){let m=parseInt(g[a.year1]);m=Math.floor(new Date().getFullYear()/10)*10+m,l.year=m}if(a.monthLong>-1&&(l.month=this.resolveMonth(g[a.monthLong])),a.monthShort>-1&&(l.month=this.resolveShortMonth(g[a.monthShort])),a.month>-1&&(l.month=parseInt(g[a.month])-1),a.week>-1&&a.day===-1&&(l.month=0,l.day=UO(parseInt(g[a.week]),l.year,1,this._root.utc)),a.day>-1&&(l.day=parseInt(g[a.day])),a.yearDay>-1&&(l.month=0,l.day=parseInt(g[a.yearDay])),a.hourBase0>-1&&(l.hour=parseInt(g[a.hourBase0])),a.hourBase1>-1&&(l.hour=parseInt(g[a.hourBase1])-1),a.hour12Base0>-1){let m=parseInt(g[a.hour12Base0]);m==11&&(m=0),a.am>-1&&!this.isAm(g[a.am])&&(m+=12),l.hour=m}if(a.hour12Base1>-1){let m=parseInt(g[a.hour12Base1]);m==12&&(m=0),a.am>-1&&!this.isAm(g[a.am])&&(m+=12),l.hour=m}if(a.minute>-1&&(l.minute=parseInt(g[a.minute])),a.second>-1&&(l.second=parseInt(g[a.second])),a.millisecond>-1){let m=parseInt(g[a.millisecond]);a.millisecondDigits==2?m*=10:a.millisecondDigits==1&&(m*=100),l.millisecond=m}if(a.timestamp>-1){l.timestamp=parseInt(g[a.timestamp]);const m=new Date(l.timestamp);l.year=m.getUTCFullYear(),l.month=m.getUTCMonth(),l.day=m.getUTCDate(),l.hour=m.getUTCHours(),l.minute=m.getUTCMinutes(),l.second=m.getUTCSeconds(),l.millisecond=m.getUTCMilliseconds()}a.zone>-1&&(l.offset=this.resolveTimezoneOffset(new Date(l.year,l.month,l.day),g[a.zone])),a.iso>-1&&(l.year=an(g[a.iso+0]),l.month=an(g[a.iso+1])-1,l.day=an(g[a.iso+2]),l.hour=an(g[a.iso+3]),l.minute=an(g[a.iso+4]),l.second=an(g[a.iso+5]),l.millisecond=an(g[a.iso+6]),g[a.iso+7]=="Z"||g[a.iso+7]=="z"?l.utc=!0:g[a.iso+7]!=""&&(l.offset=this.resolveTimezoneOffset(new Date(l.year,l.month,l.day),g[a.iso+7]))),l.utc?i=new Date(Date.UTC(l.year,l.month,l.day,l.hour,l.minute,l.second,l.millisecond)):i=new Date(l.year,l.month,l.day,l.hour,l.minute+l.offset,l.second,l.millisecond)}else i=new Date(e);return i}resolveTimezoneOffset(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){let n=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),s=n[1],a=n[2],l=n[3],h=parseInt(a)*60+parseInt(l);s=="+"&&(h*=-1);let c=(e||new Date).getTimezoneOffset();return h-c}return 0}resolveMonth(e){let t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e),t>-1)?t:0}resolveShortMonth(e){let t=this._shortMonths().indexOf(e);return t>-1||(t=this._months().indexOf(e),t>-1)||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e),t>-1)?t:0}isAm(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}getStringList(e){let t=[];for(let i=0;i<e.length;i++)this._root.language?t.push(Pm(this._t(e[i]))):t.push(Pm(e[i]));return t}}class p8 extends dr{constructor(){super(...arguments),Object.defineProperty(this,"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}})}_setDefaults(){const e="_duration_millisecond",t="_duration_second",i="_duration_minute",n="_duration_hour",s="_duration_day",a="_duration_week",l="_duration_month",h="_duration_year",c="_second",p="_minute",g="_hour",m="_day",_="_week",b="_week",x="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+c),minute:this._t(e+p),hour:this._t(e+g),day:this._t(e+m),week:this._t(e+_),month:this._t(e+b),year:this._t(e+x)},second:{second:this._t(t),minute:this._t(t+p),hour:this._t(t+g),day:this._t(t+m),week:this._t(t+_),month:this._t(t+b),year:this._t(t+x)},minute:{minute:this._t(i),hour:this._t(i+g),day:this._t(i+m),week:this._t(i+_),month:this._t(i+b),year:this._t(i+x)},hour:{hour:this._t(n),day:this._t(n+m),week:this._t(n+_),month:this._t(n+b),year:this._t(n+x)},day:{day:this._t(s),week:this._t(s+_),month:this._t(s+b),year:this._t(s+x)},week:{week:this._t(a),month:this._t(a+b),year:this._t(a+x)},month:{month:this._t(l),year:this._t(l+x)},year:{year:this._t(h)}}),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let n=i||this.get("baseUnit");(typeof t>"u"||t==="")&&(this.get("durationFormat")!=null?t=this.get("durationFormat"):t=this.getFormat(an(e),void 0,n)),t=ep(t);let s=this.parseFormat(t,n),a=Number(e),l;a>this.get("negativeBase")?l=s.positive:a<this.get("negativeBase")?l=s.negative:l=s.zero;let h=this.applyFormat(a,l);return l.color!==""&&(h="["+l.color+"]"+h+"[/]"),h}parseFormat(e,t){let i=t||this.get("baseUnit"),n={positive:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1}};e=e.replace("||",il);let s=e.split("|");return n.positive.source=s[0],typeof s[2]>"u"?n.zero=n.positive:n.zero.source=s[2],typeof s[1]>"u"?n.negative=n.positive:n.negative.source=s[1],Zt(n,(a,l)=>{if(l.parsed)return;let h=l.source,c=[];c=l.source.match(/^\[([^\]]*)\]/),c&&c.length&&c[0]!==""&&(h=l.source.substr(c[0].length),l.color=c[1]);let p=jn.chunk(h,!0);for(let g=0;g<p.length;g++){let m=p[g];if(m.text=m.text.replace(il,"|"),m.type==="value"){m.text.match(/[yYMdDwhHKkmsSn]+a/)&&(l.absolute=!0,m.text=m.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));let _=m.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(_)for(let b=0;b<_.length;b++)_[b]==null&&(_[b]=this._unitAliases[_[b]]),l.parts.push(_[b]),m.text=m.text.replace(_[b],va)}l.template+=m.text}l.parsed=!0}),n}applyFormat(e,t){let i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);let n=this.toTimeStamp(e,t.baseUnit),s=t.template;for(let a=0,l=t.parts.length;a<l;a++){let h=t.parts[a],c=this._toTimeUnit(h.substr(0,1)),p=h.length,g=Math.floor(n/this._getUnitValue(c));s=s.replace(va,yi(g,p,"0")),n-=g*this._getUnitValue(c)}return i&&(s="-"+s),s}toTimeStamp(e,t){return e*this._getUnitValue(t)}_toTimeUnit(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}getFormat(e,t,i){if(this.get("durationFormat")!=null)return this.get("durationFormat");if(i||(i=this.get("baseUnit")),t!=null&&e!=t){e=Math.abs(e),t=Math.abs(t);let n=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][n]}else{let n=this.getValueUnit(e,i);return this.get("durationFormats")[i][n]}}getValueUnit(e,t){t||(t=this.get("baseUnit"));let i,n=this.getMilliseconds(e,t);return EO(this._getUnitValues(),(s,a)=>{if(s==t||i){if(n/a<=1)return i||(i=s),!1;i=s}return!0}),i}getMilliseconds(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}_getUnitValue(e){return this._getUnitValues()[e]}_getUnitValues(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}const jv={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"μ",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(r){let e="th";if(r<11||r>13)switch(r%10){case 1:e="st";break;case 2:e="nd";break;case 3:e="rd";break}return e},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""};class g8 extends dr{_setDefaults(){this.setPrivate("defaultLocale",jv),super._setDefaults()}translate(e,t,...i){t||(t=this._root.locale||this.getPrivate("defaultLocale"));let n=e,s=t[e];if(s===null)n="";else if(s!=null)s&&(n=s);else if(t!==this.getPrivate("defaultLocale"))return this.translate(e,this.getPrivate("defaultLocale"),...i);if(i.length)for(let a=i.length,l=0;l<a;++l)n=n.split("%"+(l+1)).join(i[l]);return n}translateAny(e,t,...i){return this.translate(e,t,...i)}setTranslationAny(e,t,i){const n=i||this._root.locale;n[e]=t}setTranslationsAny(e,t){Zt(e,(i,n)=>{this.setTranslationAny(i,n,t)})}translateEmpty(e,t,...i){let n=this.translate(e,t,...i);return n==e?"":n}translateFunc(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):()=>""}translateAll(e,t){return this.isDefault()?e:cd(e,i=>this.translate(i,t))}isDefault(){return this.getPrivate("defaultLocale")===this._root.locale}}class Zc{constructor(e,t){if(Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=e,!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}static new(e){const t=new this(e,!0);return t.setupDefaultRules(),t}setupDefaultRules(){}_lookupRules(e){return this._rules[e]}ruleRaw(e,t=[]){let i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(io);const{index:n,found:s}=bO(i,a=>{const l=io(a.tags.length,t.length);return l===0?Hv(a.tags,t,io):l});if(s)return i[n].template;{const a=Hi.new({});return i.splice(n,0,{tags:t,template:a}),a}}rule(e,t=[]){return this.ruleRaw(e,t)}}function Ze(r,e,t,i){r.set(e,t.get(i)),t.on(i,n=>{r.set(e,n)})}class _8 extends Zc{setupDefaultRules(){super.setupDefaultRules();const e=this._root.language,t=this._root.interfaceColors,i=this._root.horizontalLayout,n=this._root.verticalLayout,s=this.rule.bind(this);s("InterfaceColors").setAll({stroke:Ve.fromHex(15066597),fill:Ve.fromHex(15987699),primaryButton:Ve.fromHex(6788316),primaryButtonHover:Ve.fromHex(6779356),primaryButtonDown:Ve.fromHex(6872182),primaryButtonActive:Ve.fromHex(6872182),primaryButtonText:Ve.fromHex(16777215),primaryButtonStroke:Ve.fromHex(16777215),secondaryButton:Ve.fromHex(14277081),secondaryButtonHover:Ve.fromHex(10724259),secondaryButtonDown:Ve.fromHex(9276813),secondaryButtonActive:Ve.fromHex(15132390),secondaryButtonText:Ve.fromHex(0),secondaryButtonStroke:Ve.fromHex(16777215),grid:Ve.fromHex(0),background:Ve.fromHex(16777215),alternativeBackground:Ve.fromHex(0),text:Ve.fromHex(0),alternativeText:Ve.fromHex(16777215),disabled:Ve.fromHex(11382189),positive:Ve.fromHex(5288704),negative:Ve.fromHex(11730944)});{const a=s("ColorSet");a.setAll({passOptions:{hue:.05,saturation:0,lightness:0},colors:[Ve.fromHex(6797276)],step:1,reuse:!1,startIndex:0}),a.setPrivate("currentStep",0),a.setPrivate("currentPass",0)}s("Entity").setAll({stateAnimationDuration:0,stateAnimationEasing:nc(au)}),s("Component").setAll({interpolationDuration:0,interpolationEasing:nc(au)}),s("Sprite").setAll({visible:!0,scale:1,opacity:1,rotation:0,position:"relative",tooltipX:ot,tooltipY:ot,tooltipPosition:"fixed",isMeasured:!0}),s("Sprite").states.create("default",{visible:!0,opacity:1}),s("Container").setAll({interactiveChildren:!0,setStateOnChildren:!1}),s("Graphics").setAll({strokeWidth:1}),s("Chart").setAll({width:ze,height:ze,interactiveChildren:!1}),s("Sprite",["horizontal","center"]).setAll({centerX:ot,x:ot}),s("Sprite",["vertical","center"]).setAll({centerY:ot,y:ot}),s("Container",["horizontal","layout"]).setAll({layout:i}),s("Container",["vertical","layout"]).setAll({layout:n}),s("Pattern").setAll({repetition:"repeat",width:50,height:50,rotation:0,fillOpacity:1}),s("LinePattern").setAll({gap:6,colorOpacity:1,width:49,height:49}),s("RectanglePattern").setAll({gap:6,checkered:!1,centered:!0,maxWidth:5,maxHeight:5,width:48,height:48,strokeWidth:0}),s("CirclePattern").setAll({gap:5,checkered:!1,centered:!1,radius:3,strokeWidth:0,width:45,height:45}),s("LinearGradient").setAll({rotation:90}),s("Legend").setAll({fillField:"fill",strokeField:"stroke",nameField:"name",layout:ao.new(this._root,{}),layer:30,clickTarget:"itemContainer"}),s("Container",["legend","item","itemcontainer"]).setAll({paddingLeft:5,paddingRight:5,paddingBottom:5,paddingTop:5,layout:i,setStateOnChildren:!0,interactiveChildren:!1,ariaChecked:!0,focusable:!0,ariaLabel:e.translate("Press ENTER to toggle"),role:"checkbox"});{const a=s("Rectangle",["legend","item","background"]);a.setAll({fillOpacity:0}),Ze(a,"fill",t,"background")}s("Container",["legend","marker"]).setAll({setStateOnChildren:!0,centerY:ot,paddingLeft:0,paddingRight:0,paddingBottom:0,paddingTop:0,width:18,height:18}),s("RoundedRectangle",["legend","marker","rectangle"]).setAll({width:ze,height:ze,cornerRadiusBL:3,cornerRadiusTL:3,cornerRadiusBR:3,cornerRadiusTR:3});{const a=s("RoundedRectangle",["legend","marker","rectangle"]).states.create("disabled",{});Ze(a,"fill",t,"disabled"),Ze(a,"stroke",t,"disabled")}s("Label",["legend","label"]).setAll({centerY:ot,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,populateText:!0});{const a=s("Label",["legend","label"]).states.create("disabled",{});Ze(a,"fill",t,"disabled")}s("Label",["legend","value","label"]).setAll({centerY:ot,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,width:50,centerX:ze,populateText:!0});{const a=s("Label",["legend","value","label"]).states.create("disabled",{});Ze(a,"fill",t,"disabled")}s("HeatLegend").setAll({stepCount:1}),s("RoundedRectangle",["heatlegend","marker"]).setAll({cornerRadiusTR:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusBL:0}),s("RoundedRectangle",["vertical","heatlegend","marker"]).setAll({height:ze,width:15}),s("RoundedRectangle",["horizontal","heatlegend","marker"]).setAll({width:ze,height:15}),s("HeatLegend",["vertical"]).setAll({height:ze}),s("HeatLegend",["horizontal"]).setAll({width:ze}),s("Label",["heatlegend","start"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5}),s("Label",["heatlegend","end"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5});{const a=s("Label");a.setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"1em",populateText:!1}),Ze(a,"fill",t,"text")}s("RadialLabel").setAll({textType:"regular",centerY:ot,centerX:ot,inside:!1,radius:0,baseRadius:ze,orientation:"auto",textAlign:"center"}),s("RoundedRectangle").setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8}),s("PointedRectangle").setAll({pointerBaseWidth:15,pointerLength:10,cornerRadius:8}),s("Slice").setAll({shiftRadius:0,dRadius:0,dInnerRadius:0});{const a=s("Tick");a.setAll({strokeOpacity:.15,isMeasured:!1,length:4.5,position:"absolute",crisp:!0}),Ze(a,"stroke",t,"grid")}s("Bullet").setAll({locationX:.5,locationY:.5}),s("Tooltip").setAll({position:"absolute",getFillFromSprite:!0,getStrokeFromSprite:!1,autoTextColor:!0,paddingTop:9,paddingBottom:8,paddingLeft:10,paddingRight:10,marginBottom:5,pointerOrientation:"vertical",centerX:ot,centerY:ot,animationEasing:nc(au),exportable:!1}),s("PointedRectangle",["tooltip","background"]).setAll({strokeOpacity:.9,cornerRadius:4,pointerLength:4,pointerBaseWidth:8,fillOpacity:.9,stroke:Ve.fromHex(16777215)});{const a=s("Label",["tooltip"]);a.setAll({role:"tooltip",populateText:!0,paddingRight:0,paddingTop:0,paddingLeft:0,paddingBottom:0}),Ze(a,"fill",t,"alternativeText")}s("Button").setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,interactive:!0,layout:i,interactiveChildren:!1,setStateOnChildren:!0,focusable:!0}),s("Button").states.create("hover",{}),s("Button").states.create("down",{stateAnimationDuration:0}),s("Button").states.create("active",{});{const a=s("RoundedRectangle",["button","background"]);Ze(a,"fill",t,"primaryButton"),Ze(a,"stroke",t,"primaryButtonStroke")}{const a=s("RoundedRectangle",["button","background"]).states.create("hover",{});Ze(a,"fill",t,"primaryButtonHover")}{const a=s("RoundedRectangle",["button","background"]).states.create("down",{stateAnimationDuration:0});Ze(a,"fill",t,"primaryButtonDown")}{const a=s("RoundedRectangle",["button","background"]).states.create("active",{});Ze(a,"fill",t,"primaryButtonActive")}{const a=s("Graphics",["button","icon"]);Ze(a,"stroke",t,"primaryButtonText")}{const a=s("Label",["button"]);Ze(a,"fill",t,"primaryButtonText")}s("Button",["zoom"]).setAll({paddingTop:18,paddingBottom:18,paddingLeft:12,paddingRight:12,centerX:46,centerY:-10,y:0,x:ze,role:"button",ariaLabel:e.translate("Zoom Out"),layer:30});{const a=s("RoundedRectangle",["background","button","zoom"]);a.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),Ze(a,"fill",t,"primaryButton")}{const a=s("RoundedRectangle",["background","button","zoom"]).states.create("hover",{});Ze(a,"fill",t,"primaryButtonHover")}{const a=s("RoundedRectangle",["background","button","zoom"]).states.create("down",{stateAnimationDuration:0});Ze(a,"fill",t,"primaryButtonDown")}{const a=s("Graphics",["icon","button","zoom"]);a.setAll({crisp:!0,strokeOpacity:.7,draw:l=>{l.moveTo(0,0),l.lineTo(12,0)}}),Ze(a,"stroke",t,"primaryButtonText")}s("Button",["resize"]).setAll({paddingTop:9,paddingBottom:9,paddingLeft:13,paddingRight:13,draggable:!0,centerX:ot,centerY:ot,position:"absolute",role:"slider",ariaValueMin:"0",ariaValueMax:"100",ariaLabel:e.translate("Use up and down arrows to move selection")});{const a=s("RoundedRectangle",["background","resize","button"]);a.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),Ze(a,"fill",t,"secondaryButton"),Ze(a,"stroke",t,"secondaryButtonStroke")}{const a=s("RoundedRectangle",["background","resize","button"]).states.create("hover",{});Ze(a,"fill",t,"secondaryButtonHover")}{const a=s("RoundedRectangle",["background","resize","button"]).states.create("down",{stateAnimationDuration:0});Ze(a,"fill",t,"secondaryButtonDown")}{const a=s("Graphics",["resize","button","icon"]);a.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:l=>{l.moveTo(0,.5),l.lineTo(0,12.5),l.moveTo(4,.5),l.lineTo(4,12.5)}}),Ze(a,"stroke",t,"secondaryButtonText")}s("Button",["resize","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize"}),s("Button",["resize","horizontal"]).setAll({cursorOverStyle:"ew-resize"}),s("Button",["play"]).setAll({paddingTop:13,paddingBottom:13,paddingLeft:14,paddingRight:14,ariaLabel:e.translate("Play"),toggleKey:"active"});{const a=s("RoundedRectangle",["play","background"]);a.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),Ze(a,"fill",t,"primaryButton")}{const a=s("Graphics",["play","icon"]);a.setAll({stateAnimationDuration:0,dx:1,draw:l=>{l.moveTo(0,-5),l.lineTo(8,0),l.lineTo(0,5),l.lineTo(0,-5)}}),Ze(a,"fill",t,"primaryButtonText")}s("Graphics",["play","icon"]).states.create("default",{stateAnimationDuration:0}),s("Graphics",["play","icon"]).states.create("active",{stateAnimationDuration:0,draw:a=>{a.moveTo(-4,-5),a.lineTo(-1,-5),a.lineTo(-1,5),a.lineTo(-4,5),a.lineTo(-4,-5),a.moveTo(4,-5),a.lineTo(1,-5),a.lineTo(1,5),a.lineTo(4,5),a.lineTo(4,-5)}}),s("Button",["switch"]).setAll({paddingTop:4,paddingBottom:4,paddingLeft:4,paddingRight:4,ariaLabel:e.translate("Press ENTER to toggle"),toggleKey:"active",width:40,height:24,layout:null});{const a=s("RoundedRectangle",["switch","background"]);a.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),Ze(a,"fill",t,"primaryButton")}{const a=s("Circle",["switch","icon"]);a.setAll({radius:8,centerY:0,centerX:0,dx:0}),Ze(a,"fill",t,"primaryButtonText")}s("Graphics",["switch","icon"]).states.create("active",{dx:16}),s("Scrollbar").setAll({start:0,end:1,layer:30,animationEasing:nc(au)}),s("Scrollbar",["vertical"]).setAll({marginRight:13,marginLeft:13,minWidth:12,height:ze}),s("Scrollbar",["horizontal"]).setAll({marginTop:13,marginBottom:13,minHeight:12,width:ze}),this.rule("Button",["scrollbar"]).setAll({exportable:!1});{const a=s("RoundedRectangle",["scrollbar","main","background"]);a.setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8,fillOpacity:.8}),Ze(a,"fill",t,"fill")}{const a=s("RoundedRectangle",["scrollbar","thumb"]);a.setAll({role:"slider",ariaLive:"polite",position:"absolute",draggable:!0}),Ze(a,"fill",t,"secondaryButton")}{const a=s("RoundedRectangle",["scrollbar","thumb"]).states.create("hover",{});Ze(a,"fill",t,"secondaryButtonHover")}{const a=s("RoundedRectangle",["scrollbar","thumb"]).states.create("down",{stateAnimationDuration:0});Ze(a,"fill",t,"secondaryButtonDown")}s("RoundedRectangle",["scrollbar","thumb","vertical"]).setAll({x:ot,width:ze,centerX:ot,ariaLabel:e.translate("Use up and down arrows to move selection")}),s("RoundedRectangle",["scrollbar","thumb","horizontal"]).setAll({y:ot,centerY:ot,height:ze,ariaLabel:e.translate("Use left and right arrows to move selection")});{const a=s("PointedRectangle",["axis","tooltip","background"]);a.setAll({cornerRadius:0}),Ze(a,"fill",t,"alternativeBackground")}s("Label",["axis","tooltip"]).setAll({role:void 0}),s("Label",["axis","tooltip","y"]).setAll({textAlign:"right"}),s("Label",["axis","tooltip","y","opposite"]).setAll({textAlign:"left"}),s("Label",["axis","tooltip","x"]).setAll({textAlign:"center"}),s("Tooltip",["categoryaxis"]).setAll({labelText:"{category}"}),s("Star").setAll({spikes:5,innerRadius:5,radius:10}),s("Tooltip",["stock"]).setAll({paddingTop:6,paddingBottom:5,paddingLeft:7,paddingRight:7}),s("PointedRectangle",["tooltip","stock","axis"]).setAll({pointerLength:0,pointerBaseWidth:0,cornerRadius:3}),s("Label",["tooltip","stock"]).setAll({fontSize:"0.8em"}),s("SpriteResizer").setAll({rotationStep:10}),s("Container",["resizer","grip"]).states.create("hover",{});{const a=s("RoundedRectangle",["resizer","grip"]);a.setAll({strokeOpacity:.7,strokeWidth:1,fillOpacity:1,width:12,height:12}),Ze(a,"fill",t,"background"),Ze(a,"stroke",t,"alternativeBackground")}{const a=s("RoundedRectangle",["resizer","grip","outline"]);a.setAll({strokeOpacity:0,fillOpacity:0,width:20,height:20}),a.states.create("hover",{fillOpacity:.3}),Ze(a,"fill",t,"alternativeBackground")}s("RoundedRectangle",["resizer","grip","left"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0}),s("RoundedRectangle",["resizer","grip","right"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0});{const a=s("Rectangle",["resizer","rectangle"]);a.setAll({strokeDasharray:[2,2],strokeOpacity:.5,strokeWidth:1}),Ze(a,"stroke",t,"alternativeBackground")}}}class Vf{constructor(e=1,t=0,i=0,n=1,s=0,a=0){Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=a}setTransform(e,t,i,n,s,a=1){this.a=Math.cos(s)*a,this.b=Math.sin(s)*a,this.c=-Math.sin(s)*a,this.d=Math.cos(s)*a,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d)}apply(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}applyInverse(e){const t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}append(e){const t=this.a,i=this.b,n=this.c,s=this.d;this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}copyFrom(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}var m8=function(){function r(e,t){var i=[],n=!0,s=!1,a=void 0;try{for(var l=e[Symbol.iterator](),h;!(n=(h=l.next()).done)&&(i.push(h.value),!(t&&i.length===t));n=!0);}catch(c){s=!0,a=c}finally{try{!n&&l.return&&l.return()}finally{if(s)throw a}}return i}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),yu=Math.PI*2,Zf=function(e,t,i,n,s,a,l){var h=e.x,c=e.y;h*=t,c*=i;var p=n*h-s*c,g=s*h+n*c;return{x:p+a,y:g+l}},x8=function(e,t){var i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),s=Math.sin(e),a=Math.cos(e+t),l=Math.sin(e+t);return[{x:n-s*i,y:s+n*i},{x:a+l*i,y:l-a*i},{x:a,y:l}]},Mm=function(e,t,i,n){var s=e*n-t*i<0?-1:1,a=e*i+t*n;return a>1&&(a=1),a<-1&&(a=-1),s*Math.acos(a)},v8=function(e,t,i,n,s,a,l,h,c,p,g,m){var _=Math.pow(s,2),b=Math.pow(a,2),x=Math.pow(g,2),w=Math.pow(m,2),P=_*b-_*w-b*x;P<0&&(P=0),P/=_*w+b*x,P=Math.sqrt(P)*(l===h?-1:1);var E=P*s/a*m,k=P*-a/s*g,C=p*E-c*k+(e+i)/2,O=c*E+p*k+(t+n)/2,F=(g-E)/s,D=(m-k)/a,N=(-g-E)/s,X=(-m-k)/a,z=Mm(1,0,F,D),U=Mm(F,D,N,X);return h===0&&U>0&&(U-=yu),h===1&&U<0&&(U+=yu),[C,O,z,U]},y8=function(e){var t=e.px,i=e.py,n=e.cx,s=e.cy,a=e.rx,l=e.ry,h=e.xAxisRotation,c=h===void 0?0:h,p=e.largeArcFlag,g=p===void 0?0:p,m=e.sweepFlag,_=m===void 0?0:m,b=[];if(a===0||l===0)return[];var x=Math.sin(c*yu/360),w=Math.cos(c*yu/360),P=w*(t-n)/2+x*(i-s)/2,E=-x*(t-n)/2+w*(i-s)/2;if(P===0&&E===0)return[];a=Math.abs(a),l=Math.abs(l);var k=Math.pow(P,2)/Math.pow(a,2)+Math.pow(E,2)/Math.pow(l,2);k>1&&(a*=Math.sqrt(k),l*=Math.sqrt(k));var C=v8(t,i,n,s,a,l,g,_,x,w,P,E),O=m8(C,4),F=O[0],D=O[1],N=O[2],X=O[3],z=Math.abs(X)/(yu/4);Math.abs(1-z)<1e-7&&(z=1);var U=Math.max(Math.ceil(z),1);X/=U;for(var j=0;j<U;j++)b.push(x8(N,X)),N+=X;return b.map(function(q){var pe=Zf(q[0],a,l,w,x,F,D),fe=pe.x,Ee=pe.y,de=Zf(q[1],a,l,w,x,F,D),De=de.x,ee=de.y,Fe=Zf(q[2],a,l,w,x,F,D),se=Fe.x,R=Fe.y;return{x1:fe,y1:Ee,x2:De,y2:ee,x:se,y:R}})};function b8(r,e,t){if(e!==t)throw new Error("Required "+t+" arguments for "+r+" but got "+e)}function ou(r,e,t){if(e<t)throw new Error("Required at least "+t+" arguments for "+r+" but got "+e)}function sn(r,e,t){if(ou(r,e,t),e%t!==0)throw new Error("Arguments for "+r+" must be in pairs of "+t)}function w8(r){for(let e=0;e<r.length;e+=7){let t=e+3,i=r[t];if(i.length>1){const n=/^([01])([01])(.*)$/.exec(i);n!==null&&(r.splice(t,0,n[1]),++t,r.splice(t,0,n[2]),++t,n[3].length>0?r[t]=n[3]:r.splice(t,1))}if(++t,i=r[t],i.length>1){const n=/^([01])(.+)$/.exec(i);n!==null&&(r.splice(t,0,n[1]),++t,r[t]=n[2])}}}function Fm(r){if(r===0||r===1)return r;throw new Error("Flag must be 0 or 1")}function T8(r){const e=[0,0,0];for(let t=0;t<24;t++)e[t%3]<<=1,e[t%3]|=r&1,r>>=1;return(e[2]|0)+(e[1]<<8)+(e[0]<<16)}function oc(r,e){for(;!(r.interactive&&!e(r));)if(r._parent)r=r._parent;else break}function k8(r,e,t){return fi(r,pd(e),i=>{const n=Lv(i);let s=i.touches;s?(s.length==0&&(s=i.changedTouches),t(fd(s),n)):t([i],n)})}function Rm(r){const e=document.createElement("canvas");e.width=1,e.height=1;const t=e.getContext("2d",{willReadFrequently:!0});t.drawImage(r,0,0,1,1);try{return t.getImageData(0,0,1,1),!1}catch{return console.warn('Image "'+r.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function lu(r){r.width=0,r.height=0,r.style.width="0px",r.style.height="0px"}class P8{constructor(){Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}get x(){return this._x}get y(){return this._y}set x(e){this._x=e}set y(e){this._y=e}}class Kc extends Qd{constructor(e){super(),Object.defineProperty(this,"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new P8}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new Vf}),Object.defineProperty(this,"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new Vf}),Object.defineProperty(this,"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new Vf}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._renderer=e}_dispose(){this._renderer._removeObject(this),this.getLayer().dirty=!0}getCanvas(){return this.getLayer().view}getLayer(){let e=this;for(;;){if(e._layer)return e._layer;if(e._parent)e=e._parent;else return this._renderer.defaultLayer}}setLayer(e,t){e==null?this._layer=void 0:(this._layer=this._renderer.getLayer(e,!0),this._layer.visible=!0,this._layer.margin=t,t&&el(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost())}markDirtyLayer(){this.getLayer().dirty=!0}clear(){this.invalidateBounds()}invalidateBounds(){this._localBounds=void 0}_addBounds(e){}_getColorId(){return this._colorId===void 0&&(this._colorId=this._renderer.paintId(this)),this._colorId}_isInteractive(){return this.inactive==!1&&(this.interactive||this._renderer._forceInteractive>0)}_isInteractiveMask(){return this._isInteractive()}contains(e){for(;;){if(e===this)return!0;if(e._parent)e=e._parent;else return!1}}toGlobal(e){return this._matrix.apply(e)}toLocal(e){return this._matrix.applyInverse(e)}getLocalMatrix(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}getLocalBounds(){return this._localBounds||(this._localBounds={left:1e7,top:1e7,right:-1e7,bottom:-1e7},this._addBounds(this._localBounds)),this._localBounds}getAdjustedBounds(e){this._setMatrix();const t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),n=t.apply({x:e.right,y:e.top}),s=t.apply({x:e.right,y:e.bottom}),a=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,n.x,s.x,a.x),top:Math.min(i.y,n.y,s.y,a.y),right:Math.max(i.x,n.x,s.x,a.x),bottom:Math.max(i.y,n.y,s.y,a.y)}}on(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new Ni(()=>{})}_setMatrix(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}_transform(e,t){const i=this._matrix;let n=i.tx*t,s=i.ty*t;this.crisp&&(n=Math.floor(n)+.5,s=Math.floor(s)+.5),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,n,s)}_transformMargin(e,t,i){const n=this._matrix;e.setTransform(n.a*t,n.b*t,n.c*t,n.d*t,(n.tx+i.left)*t,(n.ty+i.top)*t)}_transformLayer(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}render(e){if(this.visible&&(this.exportable!==!1||!this._renderer._omitTainted)){this._setMatrix();const t=this._renderer.resolution,i=this._renderer.layers,n=this._renderer._ghostLayer,s=n.context,a=this.mask;a&&a._setMatrix(),ce(i,l=>{if(l){const h=l.context;h.save(),a&&(a._transformLayer(h,t,l),a._runPath(h),h.clip()),h.globalAlpha=this.compoundAlpha*this.alpha,this._transformLayer(h,t,l),this.filter&&(h.filter=this.filter)}}),s.save(),a&&this._isInteractiveMask()&&(a._transformMargin(s,t,n.margin),a._runPath(s),s.clip()),this._transformMargin(s,t,n.margin),this._render(e),s.restore(),ce(i,l=>{l&&l.context.restore()})}}_render(e){if(this.exportable===!1){const t=this._layer||e;t.tainted=!0}}hovering(){return this._renderer._hovering.has(this)}dragging(){return this._renderer._dragging.some(e=>e.value===this)}shouldCancelTouch(){const e=this._renderer;return e.tapToActivate&&!e._touchActive?!1:this.cancelTouch?!0:this._parent?this._parent.shouldCancelTouch():!1}}class E8 extends Kc{constructor(){super(...arguments),Object.defineProperty(this,"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_isInteractiveMask(){return this.interactiveChildren||super._isInteractiveMask()}addChild(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}addChildAt(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}removeChild(e){e._parent=void 0,Cr(this._children,e)}_render(e){super._render(e);const t=this._renderer;this.interactive&&this.interactiveChildren&&++t._forceInteractive;const i=this._layer||e;ce(this._children,n=>{n.compoundAlpha=this.compoundAlpha*this.alpha,n.render(i)}),this.interactive&&this.interactiveChildren&&--t._forceInteractive}registerChildLayer(e){this._childLayers||(this._childLayers=[]),Du(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}markDirtyLayer(e=!1){super.markDirtyLayer(),e&&this._childLayers&&ce(this._childLayers,t=>t.dirty=!0)}_dispose(){super._dispose(),this._childLayers&&ce(this._childLayers,e=>{e.dirty=!0})}}function bi(r,e){r.left=Math.min(r.left,e.x),r.top=Math.min(r.top,e.y),r.right=Math.max(r.right,e.x),r.bottom=Math.max(r.bottom,e.y)}class Wi{colorize(e,t){}path(e){}addBounds(e){}}class A8 extends Wi{colorize(e,t){e.beginPath()}}class Kf extends Wi{constructor(e){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){t!==void 0?e.fillStyle=t:e.fillStyle=this.color}}class C8 extends Wi{constructor(e){super(),Object.defineProperty(this,"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}class S8 extends Wi{colorize(e,t){e.stroke()}}class $f extends Wi{constructor(e,t,i){super(),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:i})}colorize(e,t){t!==void 0?e.strokeStyle=t:e.strokeStyle=this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}class D8 extends Wi{constructor(e){super(),Object.defineProperty(this,"dash",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.setLineDash(this.dash)}}class L8 extends Wi{constructor(e){super(),Object.defineProperty(this,"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.lineDashOffset=this.dashOffset}}class O8 extends Wi{constructor(e,t,i,n){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.rect(this.x,this.y,this.width,this.height)}addBounds(e){const t=this.x,i=this.y,n=t+this.width,s=i+this.height;bi(e,{x:t,y:i}),bi(e,{x:n,y:i}),bi(e,{x:t,y:s}),bi(e,{x:n,y:s})}}class M8 extends Wi{constructor(e,t,i){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i})}path(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}addBounds(e){bi(e,{x:this.x-this.radius,y:this.y-this.radius}),bi(e,{x:this.x+this.radius,y:this.y+this.radius})}}class F8 extends Wi{constructor(e,t,i,n){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,Math.PI*2)}addBounds(e){bi(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),bi(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}class R8 extends Wi{constructor(e,t,i,n,s,a){super(),Object.defineProperty(this,"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}addBounds(e){let t=_d(this.cx,this.cy,this.startAngle*vu,this.endAngle*vu,this.radius);bi(e,{x:t.left,y:t.top}),bi(e,{x:t.right,y:t.bottom})}}class I8 extends Wi{constructor(e,t,i,n,s){super(),Object.defineProperty(this,"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y1",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"x2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"y2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}addBounds(e){}}class B8 extends Wi{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.lineTo(this.x,this.y)}addBounds(e){bi(e,{x:this.x,y:this.y})}}class N8 extends Wi{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.moveTo(this.x,this.y)}addBounds(e){bi(e,{x:this.x,y:this.y})}}class H8 extends Wi{path(e){e.closePath()}}class z8 extends Wi{constructor(e,t,i,n,s,a){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}addBounds(e){bi(e,{x:this.cpX,y:this.cpY}),bi(e,{x:this.cpX2,y:this.cpY2}),bi(e,{x:this.toX,y:this.toY})}}class U8 extends Wi{constructor(e,t,i,n){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}addBounds(e){bi(e,{x:this.cpX,y:this.cpY}),bi(e,{x:this.toX,y:this.toY})}}class W8 extends Wi{constructor(e,t,i,n,s){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"blur",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"opacity",{enumerable:!0,configurable:!0,writable:!0,value:s})}colorize(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}class j8 extends Wi{constructor(e,t,i,n,s){super(),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}addBounds(e){bi(e,{x:this.x,y:this.y}),bi(e,{x:this.width,y:this.height})}}class X8 extends Kc{constructor(){super(...arguments),Object.defineProperty(this,"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:Ac.NORMAL}),Object.defineProperty(this,"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}clear(){super.clear(),this._operations.length=0}_pushOp(e){this._operations.push(e)}beginFill(e,t=1){this._fillAlpha=t,e?e instanceof Ve?this._pushOp(new Kf(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new Kf(e))):this._pushOp(new Kf("rgba(0, 0, 0, "+t+")"))}endFill(){this._pushOp(new C8(this._hasShadows))}endStroke(){this._pushOp(new S8)}beginPath(){this._pushOp(new A8)}lineStyle(e=0,t,i=1,n){this._strokeAlpha=i,t?t instanceof Ve?this._pushOp(new $f(e,t.toCSS(i),n)):this._pushOp(new $f(e,t,n)):this._pushOp(new $f(e,"rgba(0, 0, 0, "+i+")",n))}setLineDash(e){this._pushOp(new D8(e||[]))}setLineDashOffset(e=0){this._pushOp(new L8(e))}drawRect(e,t,i,n){this._pushOp(new O8(e,t,i,n))}drawCircle(e,t,i){this._pushOp(new M8(e,t,i))}drawEllipse(e,t,i,n){this._pushOp(new F8(e,t,i,n))}arc(e,t,i,n,s,a=!1){this._pushOp(new R8(e,t,i,n,s,a))}arcTo(e,t,i,n,s){this._pushOp(new I8(e,t,i,n,s))}lineTo(e,t){this._pushOp(new B8(e,t))}moveTo(e,t){this._pushOp(new N8(e,t))}bezierCurveTo(e,t,i,n,s,a){this._pushOp(new z8(e,t,i,n,s,a))}quadraticCurveTo(e,t,i,n){this._pushOp(new U8(e,t,i,n))}closePath(){this._pushOp(new H8)}shadow(e,t=0,i=0,n=0,s){this._hasShadows=!0,this._pushOp(new W8(s?e.toCSS(s):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,n))}image(e,t,i,n,s){this._pushOp(new j8(e,t,i,n,s))}svgPath(e){let t=0,i=0,n=null,s=null,a=null,l=null;const h=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,c=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;let p;for(;(p=h.exec(e))!==null;){const g=p[1],m=p[2],_=[];for(;(p=c.exec(m))!==null;)_.push(p[1]);switch(g!=="S"&&g!=="s"&&g!=="C"&&g!=="c"&&(n=null,s=null),g!=="Q"&&g!=="q"&&g!=="T"&&g!=="t"&&(a=null,l=null),g){case"M":sn(g,_.length,2),t=+_[0],i=+_[1],this.moveTo(t,i);for(let x=2;x<_.length;x+=2)t=+_[x],i=+_[x+1],this.lineTo(t,i);break;case"m":sn(g,_.length,2),t+=+_[0],i+=+_[1],this.moveTo(t,i);for(let x=2;x<_.length;x+=2)t+=+_[x],i+=+_[x+1],this.lineTo(t,i);break;case"L":sn(g,_.length,2);for(let x=0;x<_.length;x+=2)t=+_[x],i=+_[x+1],this.lineTo(t,i);break;case"l":sn(g,_.length,2);for(let x=0;x<_.length;x+=2)t+=+_[x],i+=+_[x+1],this.lineTo(t,i);break;case"H":ou(g,_.length,1);for(let x=0;x<_.length;++x)t=+_[x],this.lineTo(t,i);break;case"h":ou(g,_.length,1);for(let x=0;x<_.length;++x)t+=+_[x],this.lineTo(t,i);break;case"V":ou(g,_.length,1);for(let x=0;x<_.length;++x)i=+_[x],this.lineTo(t,i);break;case"v":ou(g,_.length,1);for(let x=0;x<_.length;++x)i+=+_[x],this.lineTo(t,i);break;case"C":sn(g,_.length,6);for(let x=0;x<_.length;x+=6){const w=+_[x],P=+_[x+1];n=+_[x+2],s=+_[x+3],t=+_[x+4],i=+_[x+5],this.bezierCurveTo(w,P,n,s,t,i)}break;case"c":sn(g,_.length,6);for(let x=0;x<_.length;x+=6){const w=+_[x]+t,P=+_[x+1]+i;n=+_[x+2]+t,s=+_[x+3]+i,t+=+_[x+4],i+=+_[x+5],this.bezierCurveTo(w,P,n,s,t,i)}break;case"S":sn(g,_.length,4),(n===null||s===null)&&(n=t,s=i);for(let x=0;x<_.length;x+=4){const w=2*t-n,P=2*i-s;n=+_[x],s=+_[x+1],t=+_[x+2],i=+_[x+3],this.bezierCurveTo(w,P,n,s,t,i)}break;case"s":sn(g,_.length,4),(n===null||s===null)&&(n=t,s=i);for(let x=0;x<_.length;x+=4){const w=2*t-n,P=2*i-s;n=+_[x]+t,s=+_[x+1]+i,t+=+_[x+2],i+=+_[x+3],this.bezierCurveTo(w,P,n,s,t,i)}break;case"Q":sn(g,_.length,4);for(let x=0;x<_.length;x+=4)a=+_[x],l=+_[x+1],t=+_[x+2],i=+_[x+3],this.quadraticCurveTo(a,l,t,i);break;case"q":sn(g,_.length,4);for(let x=0;x<_.length;x+=4)a=+_[x]+t,l=+_[x+1]+i,t+=+_[x+2],i+=+_[x+3],this.quadraticCurveTo(a,l,t,i);break;case"T":sn(g,_.length,2),(a===null||l===null)&&(a=t,l=i);for(let x=0;x<_.length;x+=2)a=2*t-a,l=2*i-l,t=+_[x],i=+_[x+1],this.quadraticCurveTo(a,l,t,i);break;case"t":sn(g,_.length,2),(a===null||l===null)&&(a=t,l=i);for(let x=0;x<_.length;x+=2)a=2*t-a,l=2*i-l,t+=+_[x],i+=+_[x+1],this.quadraticCurveTo(a,l,t,i);break;case"A":case"a":const b=g==="a";w8(_),sn(g,_.length,7);for(let x=0;x<_.length;x+=7){let w=+_[x+5],P=+_[x+6];b&&(w+=t,P+=i);const E=y8({px:t,py:i,rx:+_[x],ry:+_[x+1],xAxisRotation:+_[x+2],largeArcFlag:Fm(+_[x+3]),sweepFlag:Fm(+_[x+4]),cx:w,cy:P});ce(E,k=>{this.bezierCurveTo(k.x1,k.y1,k.x2,k.y2,k.x,k.y),t=k.x,i=k.y})}break;case"Z":case"z":b8(g,_.length,0),this.closePath();break}}}_runPath(e){e.beginPath(),ce(this._operations,t=>{t.path(e)})}_render(e){super._render(e);const t=this._layer||e,i=t.dirty,n=this._isInteractive();if(i||n){const s=t.context,a=this._renderer._ghostLayer.context;i&&(s.globalCompositeOperation=this.blendMode,s.beginPath());let l;n&&(a.beginPath(),l=this._getColorId()),ce(this._operations,h=>{i&&(h.path(s),h.colorize(s,void 0)),n&&(h.path(a),h.colorize(a,l))})}}renderDetached(e){if(this.visible){this._setMatrix(),e.save();const t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),ce(this._operations,i=>{i.path(e),i.colorize(e,void 0)}),e.restore()}}_addBounds(e){this.visible&&this.isMeasured&&ce(this._operations,t=>{t.addBounds(e)})}}class Xv extends Kc{constructor(e,t,i){super(e),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),this.text=t,this.style=i}invalidateBounds(){super.invalidateBounds(),this._textInfo=void 0}_shared(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}_prerender(e,t=!1,i=!1){super._render(e);const n=e.context,s=this._renderer._ghostLayer.context,a=this.style;let l=this._getFontStyle(void 0,i);n.font=l,this._isInteractive()&&!t&&(s.font=l),a.fill&&(a.fill instanceof Ve?n.fillStyle=a.fill.toCSS(a.fillOpacity!=null?a.fillOpacity:1):n.fillStyle=a.fill),a.shadowColor&&(e.context.shadowColor=a.shadowColor.toCSS(a.shadowOpacity||1)),a.shadowBlur&&(e.context.shadowBlur=a.shadowBlur),a.shadowOffsetX&&(e.context.shadowOffsetX=a.shadowOffsetX),a.shadowOffsetY&&(e.context.shadowOffsetY=a.shadowOffsetY),this._shared(n),this._isInteractive()&&!t&&(s.fillStyle=this._getColorId(),this._shared(s))}_getFontStyle(e,t=!1){const i=this.style;let n=[];return e&&e.fontVariant?n.push(e.fontVariant):i.fontVariant&&n.push(i.fontVariant),t||(e&&e.fontWeight?n.push(e.fontWeight):i.fontWeight&&n.push(i.fontWeight)),e&&e.fontStyle?n.push(e.fontStyle):i.fontStyle&&n.push(i.fontStyle),e&&e.fontSize?(ve(e.fontSize)&&(e.fontSize=e.fontSize+"px"),n.push(e.fontSize)):i.fontSize&&(ve(i.fontSize)&&(i.fontSize=i.fontSize+"px"),n.push(i.fontSize)),e&&e.fontFamily?n.push(e.fontFamily):i.fontFamily?n.push(i.fontFamily):n.length&&n.push("Arial"),n.join(" ")}_render(e){const t=this._layer||e;if(this._textInfo||this._measure(t),this.textVisible){const i=this._isInteractive(),n=t.context,s=t.dirty,a=this._renderer._ghostLayer.context;n.save(),a.save(),this._prerender(t),ce(this._textInfo,(l,h)=>{ce(l.textChunks,(c,p)=>{if(c.style&&(n.save(),a.save(),n.font=c.style,this._isInteractive()&&(a.font=c.style)),c.fill&&(n.save(),n.fillStyle=c.fill.toCSS()),s&&n.fillText(c.text,c.offsetX,l.offsetY+c.offsetY),c.textDecoration=="underline"||c.textDecoration=="line-through"){let g=1,m=1,_=c.height,b=c.offsetX;switch(this.style.textAlign){case"right":case"end":b-=c.width;break;case"center":b-=c.width/2;break}if(c.style)switch(jn.getTextStyle(c.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":g=2;break}_&&(m=_/20);let x;c.textDecoration=="line-through"?x=g+l.offsetY+c.offsetY-c.height/2:x=g+m*1.5+l.offsetY+c.offsetY,n.save(),n.beginPath(),c.fill?n.strokeStyle=c.fill.toCSS():this.style.fill&&this.style.fill instanceof Ve&&(n.strokeStyle=this.style.fill.toCSS()),n.lineWidth=g*m,n.moveTo(b,x),n.lineTo(b+c.width,x),n.stroke(),n.restore()}i&&this.interactive&&a.fillText(c.text,c.offsetX,l.offsetY+c.offsetY),c.fill&&n.restore(),c.style&&(n.restore(),a.restore())})}),n.restore(),a.restore()}}_addBounds(e){if(this.visible&&this.isMeasured){const t=this._measure(this.getLayer());bi(e,{x:t.left,y:t.top}),bi(e,{x:t.right,y:t.bottom})}}_ignoreFontWeight(){return/apple/i.test(navigator.vendor)}_measure(e){const t=e.context,i=this._renderer._ghostLayer.context,n=this.style.direction=="rtl";this._textInfo=[];const s=this.style.oversizedBehavior,a=this.style.maxWidth,l=ve(a)&&s=="truncate",h=ve(a)&&(s=="wrap"||s=="wrap-no-break");t.save(),i.save(),this._prerender(e,!0,this._ignoreFontWeight());const c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",p=this.text.toString().replace(/\r/g,"").split(/\n/);let g=!0,m=0,_=0,b=0,x;ce(p,(P,E)=>{let k;for(P==""?k=[{type:"value",text:""}]:k=jn.chunk(P,!1,this.style.ignoreFormatting);k.length>0;){let C={offsetY:b,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};const O=this._measureText(c,t),F=O.actualBoundingBoxAscent+O.actualBoundingBoxDescent;C.height=F,C.ascent=O.actualBoundingBoxAscent;let D,N=this.style.textDecoration,X,z,U=!1,j=!0,q=[],pe;Ev(k,(fe,Ee)=>{if(fe.type=="format")if(fe.text=="[/]")g||(t.restore(),i.restore(),g=!0),X=void 0,x=void 0,z=void 0,N=this.style.textDecoration,pe=void 0,D=fe.text;else{g||(t.restore(),i.restore());let de=jn.getTextStyle(fe.text);const De=this._getFontStyle(de);t.save(),i.save(),t.font=De,x=De,D=fe.text,de.textDecoration&&(N=de.textDecoration),de.fill&&(X=de.fill),de.width&&(z=an(de.width)),de.verticalAlign&&(pe=de.verticalAlign),g=!1;const ee=this._measureText(c,t),Fe=ee.actualBoundingBoxAscent+ee.actualBoundingBoxDescent;Fe>C.height&&(C.height=Fe),ee.actualBoundingBoxAscent>C.ascent&&(C.ascent=ee.actualBoundingBoxAscent)}else if(fe.type=="value"&&!U){const de=this._measureText(fe.text,t);let De=de.actualBoundingBoxLeft+de.actualBoundingBoxRight;if(l){let R=j||this.style.breakWords||!1;const J=this.style.ellipsis||"",Y=this._measureText(J,t),ie=Y.actualBoundingBoxLeft+Y.actualBoundingBoxRight;if(C.width+De>a){const he=a-C.width-ie;fe.text=this._truncateText(t,fe.text,he,R),fe.text+=J,U=!0}}else if(h&&C.width+De>a){const R=a-C.width,J=this._truncateText(t,fe.text,R,!1,j&&this.style.oversizedBehavior!="wrap-no-break");if(J=="")return this.textVisible=!0,!1;q=k.slice(Ee+1),hc(J)!=hc(fe.text)&&(q.unshift({type:"value",text:fe.text.substr(J.length)}),D&&q.unshift({type:"format",text:D})),fe.text=hc(J),k=[],U=!0}let ee=1,Fe=1;if(x&&z&&z>De){const R=De/z;switch(this.style.textAlign){case"right":case"end":ee=R;break;case"center":ee=R,Fe=R;break;default:Fe=R}De=z}const se=de.actualBoundingBoxAscent+de.actualBoundingBoxDescent;se>C.height&&(C.height=se),de.actualBoundingBoxAscent>C.ascent&&(C.ascent=de.actualBoundingBoxAscent),C.width+=De,C.left+=de.actualBoundingBoxLeft/ee,C.right+=de.actualBoundingBoxRight/Fe,C.textChunks.push({style:x,fill:X,text:fe.text,width:De,height:se,left:de.actualBoundingBoxLeft,right:de.actualBoundingBoxRight,ascent:de.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:N,verticalAlign:pe}),j=!1}return!0}),this.style.lineHeight instanceof gt?(C.height*=this.style.lineHeight.value,C.ascent*=this.style.lineHeight.value):(C.height*=this.style.lineHeight||1.2,C.ascent*=this.style.lineHeight||1.2),m<C.left&&(m=C.left),_<C.right&&(_=C.right),this._textInfo.push(C),b+=C.height,k=q||[]}}),g||(t.restore(),i.restore()),ce(this._textInfo,(P,E)=>{let k=0;ce(P.textChunks,C=>{if(C.offsetX=k+C.left-P.left,C.offsetY+=P.height-P.height*(this.style.baselineRatio||.19),k+=C.width,C.verticalAlign)switch(C.verticalAlign){case"super":C.offsetY-=P.height/2-C.height/2;break;case"sub":C.offsetY+=C.height/2;break}})});const w={left:n?-_:-m,top:0,right:n?m:_,bottom:b};if(s!=="none"){const P=this._fitRatio(w);if(P<1)if(s=="fit")ve(this.style.minScale)&&P<this.style.minScale?(this.textVisible=!1,w.left=0,w.top=0,w.right=0,w.bottom=0):((!this._originalScale||this._originalScale==1)&&(this._originalScale=this.scale),this.scale=P,this.textVisible=!0);else if(s=="hide")this.textVisible=!1,w.left=0,w.top=0,w.right=0,w.bottom=0;else{switch(this.style.textAlign){case"right":case"end":w.left=-a,w.right=0;break;case"center":w.left=-a/2,w.right=a/2;break;default:w.left=0,w.right=a}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return t.restore(),i.restore(),w}_fitRatio(e){const t=this.style.maxWidth,i=this.style.maxHeight;if(!ve(t)&&!ve(i))return 1;const n=e.right-e.left,s=e.bottom-e.top;return Math.min(t/n||1,i/s||1)}_truncateText(e,t,i,n=!1,s=!0){let a;do{if(n)t=t.slice(0,-1);else{let h=t.replace(/[^,;:!?\\\/\s]+[,;:!?\\\/\s]*$/g,"");if(h==""&&s)n=!0;else{if(h=="")return t;t=h}}const l=this._measureText(t,e);a=l.actualBoundingBoxLeft+l.actualBoundingBoxRight}while(a>i&&t!="");return t}_measureText(e,t){let i=t.measureText(e),n={};if(i.actualBoundingBoxAscent==null){const a=document.createElement("div");a.innerText=e,a.style.visibility="hidden",a.style.position="absolute",a.style.top="-1000000px;",a.style.fontFamily=this.style.fontFamily||"",a.style.fontSize=this.style.fontSize+"",document.body.appendChild(a);const l=a.getBoundingClientRect();document.body.removeChild(a);const h=l.height,c=i.width;n={actualBoundingBoxAscent:h,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:c,fontBoundingBoxAscent:h,fontBoundingBoxDescent:0,width:c}}else n={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};const s=i.width;switch(this.style.textAlign){case"right":case"end":n.actualBoundingBoxLeft=s,n.actualBoundingBoxRight=0;break;case"center":n.actualBoundingBoxLeft=s/2,n.actualBoundingBoxRight=s/2;break;default:n.actualBoundingBoxLeft=0,n.actualBoundingBoxRight=s}return n}}class G8{constructor(){Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:ar(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"…"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})}}class Y8 extends Xv{constructor(){super(...arguments),Object.defineProperty(this,"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(this,"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_render(e){switch(this.textType){case"circular":this._renderCircular(e);break;default:super._render(e);break}}_renderCircular(e){if(this.textVisible){const t=this._layer||e;this._prerender(t);const i=this._isInteractive(),n=t.context,s=t.dirty,a=this._renderer._ghostLayer.context;n.save(),i&&a.save(),this._textInfo||this._measure(t);let l=this.radius||0,h=this.startAngle||0,c=0,p=this.orientation,g=p=="auto"?"auto":p=="inward";const m=this.inside,_=this.style.textAlign||"left",b=this.kerning||0;let x=_=="left"?1:-1;const w=!this._textReversed;if(g=="auto"){let P=0,E=0;ce(this._textInfo,(k,C)=>{const O=h+k.width/(l-k.height)/2*-x;O>P&&(P=O)}),_=="left"?E=(P+c/2)*vu:_=="right"?E=(P-c/2)*vu:E=h*vu,E=tp(E),g=E>=270||E<=90}g==!0&&w&&(this._textInfo.reverse(),this._textReversed=!0),ce(this._textInfo,(P,E)=>{const k=P.height;m||(l+=k),(x==-1&&g||x==1&&!g)&&w&&P.textChunks.reverse();let C=h;c=0,_=="center"&&(C+=P.width/(l-k)/2*-x,c=C-h),C+=Math.PI*(g?0:1),n.save(),i&&a.save(),n.rotate(C),i&&a.rotate(C);let O=0;ce(P.textChunks,(F,D)=>{const N=F.text,X=F.width;O=X/2/(l-k)*x,n.rotate(O),i&&a.rotate(O),F.style&&(n.save(),a.save(),n.font=F.style,i&&(a.font=F.style)),F.fill&&(n.save(),n.fillStyle=F.fill.toCSS()),n.textBaseline="middle",n.textAlign="center",i&&(a.textBaseline="middle",a.textAlign="center"),s&&n.fillText(N,0,(g?1:-1)*(0-l+k/2)),i&&a.fillText(N,0,(g?1:-1)*(0-l+k/2)),F.fill&&n.restore(),F.style&&(n.restore(),a.restore()),O=(X/2+b)/(l-k)*x,n.rotate(O),i&&a.rotate(O)}),n.restore(),i&&a.restore(),m&&(l-=k)}),n.restore(),i&&a.restore()}}_measure(e){switch(this.textType){case"circular":return this._measureCircular(e);default:return super._measure(e)}}_measureCircular(e){const t=e.context,i=this._renderer._ghostLayer.context,n=this.style.direction=="rtl",s=this.style.oversizedBehavior,a=this.style.maxWidth,l=ve(a)&&s=="truncate",h=this.style.ellipsis||"";let c;this.textVisible=!0,this._textInfo=[],this._textReversed=!1,t.save(),i.save(),this._prerender(e,!0);const p=this.text.toString().replace(/\r/g,"").split(/\n/);let g=!0,m=0,_=0;return ce(p,(b,x)=>{let w=jn.chunk(b,!1,this.style.ignoreFormatting),P={offsetY:_,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]},E,k,C;ce(w,(O,F)=>{if(O.type=="format"){if(O.text=="[/]")g||(t.restore(),i.restore(),g=!0),k=void 0,E=void 0,C=void 0;else{let D=jn.getTextStyle(O.text);const N=this._getFontStyle(D);t.save(),i.save(),t.font=N,E=N,D.fill&&(k=D.fill),D.width&&(C=an(D.width)),g=!1}l&&(c=this._measureText(h,t))}else if(O.type=="value"){const D=O.text.match(/./ug)||[];n&&D.reverse();for(let N=0;N<D.length;N++){const X=D[N],z=this._measureText(X,t);let U=z.width;E&&C&&C>U&&(U=C);const j=z.actualBoundingBoxAscent+z.actualBoundingBoxDescent;if(j>P.height&&(P.height=j),z.actualBoundingBoxAscent>P.ascent&&(P.ascent=z.actualBoundingBoxAscent),P.width+=U,P.left+=z.actualBoundingBoxLeft,P.right+=z.actualBoundingBoxRight,P.textChunks.push({style:E,fill:k,text:X,width:U,height:j+z.actualBoundingBoxDescent,left:z.actualBoundingBoxLeft,right:z.actualBoundingBoxRight,ascent:z.actualBoundingBoxAscent,offsetX:0,offsetY:j,textDecoration:void 0}),m+=U,l){c||(c=this._measureText(h,t));const q=c.actualBoundingBoxLeft+c.actualBoundingBoxRight;if(m+=q,m+q>a){P.textChunks.length==1?this.textVisible=!1:(P.width+=q,P.left+=c.actualBoundingBoxLeft,P.right+=c.actualBoundingBoxRight,P.textChunks.push({style:E,fill:k,text:h,width:q,height:j+c.actualBoundingBoxDescent,left:c.actualBoundingBoxLeft,right:c.actualBoundingBoxRight,ascent:c.actualBoundingBoxAscent,offsetX:0,offsetY:j,textDecoration:void 0}));break}}if(n)break}}}),this.style.lineHeight instanceof gt?P.height*=this.style.lineHeight.value:P.height*=this.style.lineHeight||1.2,this._textInfo.push(P),_+=P.height}),g||(t.restore(),i.restore()),s=="hide"&&m>a&&(this.textVisible=!1),ce(this._textInfo,b=>{ce(b.textChunks,x=>{x.offsetY+=Math.round((b.height-x.height+(b.ascent-x.ascent))/2)})}),t.restore(),i.restore(),{left:0,top:0,right:0,bottom:0}}}class V8 extends Kc{constructor(e,t){super(e),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.image=t}_dispose(){super._dispose(),this._imageMask&&lu(this._imageMask)}getLocalBounds(){if(!this._localBounds){let e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}_render(e){if(super._render(e),this.image){const t=this._layer||e;if(this.tainted===void 0&&(this.tainted=Rm(this.image),t.tainted=!0),this.tainted&&this._renderer._omitTainted)return;if(t.dirty){this.shadowColor&&(t.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(t.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(t.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(t.context.shadowOffsetY=this.shadowOffsetY);const i=this.width||this.image.naturalWidth,n=this.height||this.image.naturalHeight;t.context.drawImage(this.image,0,0,i,n)}if(this.interactive&&this._isInteractive()){const i=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(i,0,0)}}}clear(){super.clear(),this.image=void 0,this._imageMask=void 0}_getMask(e){if(this._imageMask===void 0){const t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,n=document.createElement("canvas");n.width=t,n.height=i;const s=n.getContext("2d");s.imageSmoothingEnabled=!1,s.fillStyle=this._getColorId(),s.fillRect(0,0,t,i),Rm(e)||(s.globalCompositeOperation="destination-in",s.drawImage(e,0,0,t,i)),this._imageMask=n}return this._imageMask}}class Z8{constructor(e,t,i,n){Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Ns("touchevents")&&e instanceof Touch?this.id=e.identifier:this.id=null}}class K8 extends TO{constructor(e){if(super(),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:this.getLayer(0)}),Object.defineProperty(this,"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new $8}),Object.defineProperty(this,"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(this,"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:this._patternCanvas.getContext("2d")}),Object.defineProperty(this,"_domWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_domHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_canvasWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_canvasHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e==null?this.resolution=window.devicePixelRatio:this.resolution=e,this.view.style.position="absolute",this.view.appendChild(this._layerDom),this._disposers.push(new Ni(()=>{Zt(this._events,(t,i)=>{i.disposer.dispose()}),ce(this.layers,t=>{lu(t.view),t.exportableView&&lu(t.exportableView)}),lu(this._ghostLayer.view),lu(this._patternCanvas)})),this._disposers.push(Dv(()=>{e==null&&(this.resolution=window.devicePixelRatio)})),Ns("touchevents")){const t=i=>{this._dragging.length!==0&&Ev(this._dragging,n=>n.value.shouldCancelTouch()?(i.preventDefault(),!1):!0),this._touchActiveTimeout&&this._delayTouchDeactivate()};this._disposers.push(fi(window,"touchstart",t,{passive:!1})),this._disposers.push(fi(this.view,"touchstart",t,{passive:!1})),this._disposers.push(fi(this.view,"touchmove",()=>{this._touchActiveTimeout&&this._delayTouchDeactivate()},{passive:!0})),this._disposers.push(fi(window,"click",i=>{this._touchActive=!1},{passive:!0})),this._disposers.push(fi(this.view,"click",i=>{window.setTimeout(()=>{this._touchActive=!0,this._delayTouchDeactivate()},100)},{passive:!0}))}Ns("wheelevents")&&this._disposers.push(fi(this.view,"wheel",t=>{let i=!1;this._hovering.forEach(n=>{if(n.wheelable)return i=!0,!1}),i&&t.preventDefault()},{passive:!1}))}_delayTouchDeactivate(){this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout(()=>{this._touchActive=!1},this.tapToActivateTimeout))}get debugGhostView(){return!!this._ghostLayer.view.parentNode}set debugGhostView(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}createLinearGradient(e,t,i,n){return this.defaultLayer.context.createLinearGradient(e,t,i,n)}createRadialGradient(e,t,i,n,s,a){return this.defaultLayer.context.createRadialGradient(e,t,i,n,s,a)}createPattern(e,t,i,n,s){return this._patternCanvas.width=n,this._patternCanvas.height=s,this._patternContext.clearRect(0,0,n,s),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}makeContainer(){return new E8(this)}makeGraphics(){return new X8(this)}makeText(e,t){return new Xv(this,e,t)}makeTextStyle(){return new G8}makeRadialText(e,t){return new Y8(this,e,t)}makePicture(e){return new V8(this,e)}resizeLayer(e){e.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}resizeGhost(){this._ghostLayer.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}resize(e,t,i,n){this._canvasWidth=e,this._canvasHeight=t,this._domWidth=i,this._domHeight=n,ce(this.layers,s=>{s&&(s.dirty=!0,this.resizeLayer(s))}),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=n+"px"}createDetachedLayer(e=!1){const t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),n=new q8(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",n}getLayerByOrder(e){const t=this.layers,i=t.length;for(let n=0;n<i;n++){const s=t[n];if(s.order==e)return s}}getLayer(e,t=!0){let i=this.getLayerByOrder(e);if(i)return i;const n=this.createDetachedLayer(e==99);n.order=e,n.visible=t,n.visible&&this.resizeLayer(n);const s=this.layers;s.push(n),s.sort((c,p)=>c.order>p.order?1:c.order<p.order?-1:0);const a=s.length,l=Su(s,n);let h;for(let c=l+1;c<a;c++)if(s[c].visible){h=s[c];break}return n.visible&&(h===void 0?this._layerDom.appendChild(n.view):this._layerDom.insertBefore(n.view,h.view)),n}render(e){if(this._dirtyLayers.length=0,ce(this.layers,t=>{t&&t.dirty&&t.visible&&(this._dirtyLayers.push(t),t.clear())}),this._ghostLayer.clear(),e.render(this.defaultLayer),this._ghostLayer.context.restore(),ce(this.layers,t=>{if(t){const i=t.context;i.beginPath(),i.moveTo(0,0),i.stroke()}}),ce(this._dirtyLayers,t=>{t.context.restore(),t.dirty=!1}),this._hovering.size&&this._lastPointerMoveEvent){const{events:t,target:i,native:n}=this._lastPointerMoveEvent;ce(t,s=>{this._dispatchGlobalMousemove(s,i,n)})}}paintId(e){const t=T8(++this._colorId),i=Ve.fromHex(t).toCSS();return this._colorMap[i]=e,i}_removeObject(e){e._colorId!==void 0&&delete this._colorMap[e._colorId]}_adjustBoundingBox(e){const t=this._ghostLayer.margin;return new DOMRect(e.left-t.left,e.top-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}getEvent(e,t=!0){const i=this.view.getBoundingClientRect(),n={x:e.clientX||0,y:e.clientY||0},s={x:n.x-(t?i.left:0),y:n.y-(t?i.top:0)};return new Z8(e,n,s,this._adjustBoundingBox(i))}_getHitTarget(e,t,i){if(t.width===0||t.height===0||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom||!i||!this._layerDom.contains(i))return;const n=this._ghostLayer.getImageData(e,t);if(n.data[0]===0&&n.data[1]===0&&n.data[2]===0)return!1;const s=Ve.fromRGB(n.data[0],n.data[1],n.data[2]).toCSS();return this._colorMap[s]}_withEvents(e,t){const i=this._events[e];if(i!==void 0){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,Gc(i.callbacks,n=>!n.disposed),i.callbacks.length===0&&(i.disposer.dispose(),delete this._events[e]))}}}_dispatchEventAll(e,t){this.interactionsEnabled&&this._withEvents(e,i=>{ce(i.callbacks,n=>{n.disposed||n.callback.call(n.context,t)})})}_dispatchEvent(e,t,i){if(!this.interactionsEnabled)return!1;let n=!1;return this._withEvents(e,s=>{ce(s.callbacks,a=>{!a.disposed&&a.object===t&&(a.callback.call(a.context,i),n=!0)})}),n}_dispatchMousedown(e,t){const i=e.button;if(i!=0&&i!=2&&i!=1&&i!==void 0)return;const n=this.getEvent(e),s=this._getHitTarget(n.originalPoint,n.bbox,t);if(s){const a=n.id;let l=!1;oc(s,h=>{const c={id:a,value:h};return this._mousedown.push(c),!l&&this._dispatchEvent("pointerdown",h,n)&&(l=!0,this._dragging.some(g=>g.value===h&&g.id===a)||this._dragging.push(c)),!0})}}_dispatchGlobalMousemove(e,t,i){const n=this.getEvent(e),s=this._getHitTarget(n.originalPoint,n.bbox,t);n.native=i,s?(this._hovering.forEach(a=>{a.contains(s)||(this._hovering.delete(a),a.cursorOverStyle&&Gf(document.body,"cursor",a._replacedCursorStyle),this._dispatchEvent("pointerout",a,n))}),n.native&&oc(s,a=>(this._hovering.has(a)||(this._hovering.add(a),a.cursorOverStyle&&(a._replacedCursorStyle=LO(document.body,"cursor"),Gf(document.body,"cursor",a.cursorOverStyle)),this._dispatchEvent("pointerover",a,n)),!0))):(this._hovering.forEach(a=>{a.cursorOverStyle&&Gf(document.body,"cursor",a._replacedCursorStyle),this._dispatchEvent("pointerout",a,n)}),this._hovering.clear()),this._dispatchEventAll("globalpointermove",n)}_dispatchGlobalMouseup(e,t){const i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}_dispatchDragMove(e){if(this._dragging.length!==0){const t=this.getEvent(e),i=t.id;this._dragging.forEach(n=>{n.id===i&&this._dispatchEvent("pointermove",n.value,t)})}}_dispatchDragEnd(e,t){const i=e.button;let n;if(i==0||i===void 0)n="click";else if(i==2)n="rightclick";else if(i==1)n="middleclick";else return;const s=this.getEvent(e),a=s.id;if(this._mousedown.length!==0){const l=this._getHitTarget(s.originalPoint,s.bbox,t);l&&this._mousedown.forEach(h=>{h.id===a&&h.value.contains(l)&&this._dispatchEvent(n,h.value,s)}),this._mousedown.length=0}this._dragging.length!==0&&(this._dragging.forEach(l=>{l.id===a&&this._dispatchEvent("pointerup",l.value,s)}),this._dragging.length=0)}_dispatchDoubleClick(e,t){const i=this.getEvent(e),n=this._getHitTarget(i.originalPoint,i.bbox,t);n&&oc(n,s=>!this._dispatchEvent("dblclick",s,i))}_dispatchWheel(e,t){const i=this.getEvent(e),n=this._getHitTarget(i.originalPoint,i.bbox,t);n&&oc(n,s=>!this._dispatchEvent("wheel",s,i))}_makeSharedEvent(e,t){if(this._listeners[e]===void 0){const i=t();this._listeners[e]=new Sv(()=>{delete this._listeners[e],i.dispose()})}return this._listeners[e].increment()}_onPointerEvent(e,t){let i=!1,n=null;function s(){n=null,i=!1}return new Kr([new Ni(()=>{n!==null&&clearTimeout(n),s()}),fi(this.view,pd(e),a=>{i=!0,n!==null&&clearTimeout(n),n=window.setTimeout(s,0)}),k8(window,e,(a,l)=>{n!==null&&(clearTimeout(n),n=null),t(a,l,i),i=!1})])}_initEvent(e){switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",()=>{const t=(i,n,s)=>{this._lastPointerMoveEvent={events:i,target:n,native:s},ce(i,a=>{this._dispatchGlobalMousemove(a,n,s)})};return new Kr([this._onPointerEvent("pointerdown",t),this._onPointerEvent("pointermove",t)])});case"globalpointerup":return this._makeSharedEvent("pointerup",()=>{const t=this._onPointerEvent("pointerup",(n,s,a)=>{ce(n,l=>{this._dispatchGlobalMouseup(l,a)}),this._lastPointerMoveEvent={events:n,target:s,native:a}}),i=this._onPointerEvent("pointercancel",(n,s,a)=>{ce(n,l=>{this._dispatchGlobalMouseup(l,a)}),this._lastPointerMoveEvent={events:n,target:s,native:a}});return new Ni(()=>{t.dispose(),i.dispose()})});case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",()=>{const t=this._onPointerEvent("pointerdown",(a,l)=>{ce(a,h=>{this._dispatchMousedown(h,l)})}),i=this._onPointerEvent("pointermove",a=>{ce(a,l=>{this._dispatchDragMove(l)})}),n=this._onPointerEvent("pointerup",(a,l)=>{ce(a,h=>{this._dispatchDragEnd(h,l)})}),s=this._onPointerEvent("pointercancel",(a,l)=>{ce(a,h=>{this._dispatchDragEnd(h,l)})});return new Ni(()=>{t.dispose(),i.dispose(),n.dispose(),s.dispose()})});case"dblclick":return this._makeSharedEvent("dblclick",()=>this._onPointerEvent("dblclick",(t,i)=>{ce(t,n=>{this._dispatchDoubleClick(n,i)})}));case"wheel":return this._makeSharedEvent("wheel",()=>fi(window,pd("wheel"),t=>{this._dispatchWheel(t,Lv(t))},{passive:!1}))}}_addEvent(e,t,i,n){let s=this._events[t];s===void 0&&(s=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});const a={object:e,context:n,callback:i,disposed:!1};return s.callbacks.push(a),new Ni(()=>{a.disposed=!0,s.dispatching?s.cleanup=!0:(Cr(s.callbacks,a),s.callbacks.length===0&&(s.disposer.dispose(),delete this._events[t]))})}getCanvas(e,t){this.render(e),t||(t={});let i=this.resolution,n=Math.floor(this._canvasWidth*this.resolution),s=Math.floor(this._canvasHeight*this.resolution);if(t.minWidth&&t.minWidth>n){let _=t.minWidth/n;_>i&&(i=_*this.resolution)}if(t.minHeight&&t.minHeight>s){let _=t.minHeight/s;_>i&&(i=_*this.resolution)}if(t.maxWidth&&t.maxWidth<n){let _=t.maxWidth/n;_<i&&(i=_*this.resolution)}if(t.maxHeight&&t.maxHeight>s){let _=t.maxHeight/s;_<i&&(i=_*this.resolution)}t.maintainPixelRatio&&(i/=this.resolution);const a=[];let l=!1;const h=document.createElement("canvas");i!=this.resolution&&(l=!0,n=n*i/this.resolution,s=s*i/this.resolution),h.width=n,h.height=s,h.style.position="fixed",h.style.top="-10000px",this.view.appendChild(h),a.push(h);const c=h.getContext("2d");let p=0,g=0,m=!1;return ce(this.layers,_=>{if(_&&_.visible&&(_.tainted||l)){m=!0,_.exportableView=_.view,_.exportableContext=_.context,_.view=document.createElement("canvas"),_.view.style.position="fixed",_.view.style.top="-10000px",this.view.appendChild(_.view),a.push(_.view);let b=0,x=0;_.margin&&(b+=_.margin.left||0+_.margin.right||0,x+=_.margin.top||0+_.margin.bottom||0),_.view.width=n+b,_.view.height=s+x,_.context=_.view.getContext("2d"),_.dirty=!0,_.scale=i}}),m&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),ce(this.layers,_=>{if(_&&_.visible){let b=0,x=0;_.margin&&(b=-(_.margin.left||0)*this.resolution,x=-(_.margin.top||0)*this.resolution),c.drawImage(_.view,b,x),_.exportableView&&(_.view=_.exportableView,_.exportableView=void 0),_.exportableContext&&(_.context=_.exportableContext,_.exportableContext=void 0),p<_.view.clientWidth&&(p=_.view.clientWidth),g<_.view.clientHeight&&(g=_.view.clientHeight),_.scale=void 0}}),h.style.width=p+"px",h.style.height=g+"px",ce(a,_=>{_.style.position="",_.style.top="",this.view.removeChild(_)}),h}}class $8{constructor(){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}resize(e,t,i,n,s){e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*s),this._height=Math.floor(t*s),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}getImageData(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}setMargin(e){this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,ce(e,t=>{t.margin&&(this.margin.left=Math.max(this.margin.left,t.margin.left),this.margin.right=Math.max(this.margin.right,t.margin.right),this.margin.top=Math.max(this.margin.top,t.margin.top),this.margin.bottom=Math.max(this.margin.bottom,t.margin.bottom))})}clear(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}class q8{constructor(e,t){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=e,this.context=t}resize(e,t,i,n,s){this.width!=null&&(e=this.width,i=this.width),this.height!=null&&(t=this.height,n=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*s),this._height=Math.floor(t*s),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}clear(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}function Im(r,e){r==null?requestAnimationFrame(e):setTimeout(()=>{requestAnimationFrame(e)},1e3/r)}class th{constructor(e,t={},i){if(Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new wl}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:g8.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:jv}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:c8.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:d8.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:p8.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:dl.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:fl.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:ao.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=t,t.accessible==!1&&(this._a11yD=!0),t.useSafeResolution==null&&(t.useSafeResolution=!0);let n;t.useSafeResolution&&(n=FO()),this._renderer=new K8(n);let s;if(e instanceof HTMLElement?s=e:s=document.getElementById(e),ce(hs.rootElements,h=>{if(h.dom===s)throw new Error("You cannot have multiple Roots on the same DOM node")}),this.interfaceColors=Cc.new(this,{}),s===null)throw new Error("Could not find HTML element with id `"+e+"`");this.dom=s;let a=document.createElement("div");a.style.position="relative",a.style.height="100%",s.appendChild(a);const l=t.tooltipContainerBounds;l&&(this._tooltipContainerSettings=l),this._inner=a,this._updateComputedStyles(),hs.rootElements.push(this)}static new(e,t){const i=new th(e,t,!0);return i._init(),i}moveDOM(e){let t;if(e instanceof HTMLElement?t=e:t=document.getElementById(e),t){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}_handleLogo(){if(this._logo){const e=this.dom.offsetWidth,t=this.dom.offsetHeight;e<=150||t<=60?this._logo.hide():this._logo.show()}}_showBranding(){if(!this._logo){const e=this.tooltipContainer.children.push(Qe.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:ar(100),centerY:ze,tooltipText:"Created using amCharts 5",tooltipX:ze,cursorOverStyle:"pointer",background:Tn.new(this,{fill:Ql(4671320),fillOpacity:0,tooltipY:5})})),t=Ws.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",()=>{window.open("https://www.amcharts.com/","_blank")}),e.states.create("hover",{}),e.children.push(wi.new(this,{stroke:Ql(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:Ql(3976191)}),e.children.push(wi.new(this,{stroke:Ql(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:Ql(4671320)}),this._logo=e,this._handleLogo()}}_getRealSize(){return this.dom.getBoundingClientRect()}_getCalculatedSize(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}_init(){const e=this._renderer,t=this._getRealSize(),i=this._getCalculatedSize(t),n=Math.floor(i.width),s=Math.floor(i.height),a=Math.floor(t.width),l=Math.floor(t.height),h=Qe.new(this,{visible:!0,width:a,height:l});this._rootContainer=h,this._rootContainer._defaultThemes.push(_8.new(this));const c=h.children.push(Qe.new(this,{visible:!0,width:ze,height:ze}));this.container=c,e.resize(a,l,n,s),this._inner.appendChild(e.view),this._initResizeSensor();const p=document.createElement("div");if(this._htmlElementContainer=p,p.className="am5-html-container",p.style.position="absolute",p.style.pointerEvents="none",this._tooltipContainerSettings||(p.style.overflow="hidden"),this._inner.appendChild(p),this._a11yD!==!0){const g=document.createElement("div");g.className="am5-reader-container",g.setAttribute("role","alert"),g.style.position="absolute",g.style.width="1px",g.style.height="1px",g.style.overflow="hidden",g.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=g,this._inner.appendChild(this._readerAlertElement);const m=document.createElement("div");m.className="am5-focus-container",m.style.position="absolute",m.style.pointerEvents="none",m.style.top="0px",m.style.left="0px",m.style.overflow="hidden",m.style.width=n+"px",m.style.height=s+"px",m.setAttribute("role","application"),el(m,!1),this._focusElementContainer=m,this._inner.appendChild(this._focusElementContainer);const _=document.createElement("div");this._tooltipElementContainer=_,_.className="am5-tooltip-container",this._inner.appendChild(_),Ns("keyboardevents")&&(this._disposers.push(fi(window,"keydown",b=>{b.keyCode==16?this._isShift=!0:b.keyCode==9&&(this._isShift=b.shiftKey)})),this._disposers.push(fi(window,"keyup",b=>{b.keyCode==16&&(this._isShift=!1)})),this._disposers.push(fi(m,"keydown",b=>{const x=this._focusedSprite;if(x){b.keyCode==27&&(SO(),this._focusedSprite=void 0);let w=0,P=0;switch(b.keyCode){case 13:b.preventDefault();const E=e.getEvent(new MouseEvent("click"));x.events.dispatch("click",{type:"click",originalEvent:E.event,point:E.point,simulated:!0,target:x});return;case 37:w=-6;break;case 39:w=6;break;case 38:P=-6;break;case 40:P=6;break;default:return}if(w!=0||P!=0){if(b.preventDefault(),!x.isDragging()){this._keyboardDragPoint={x:0,y:0};const C=e.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));x.events.isEnabled("pointerdown")&&x.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:C.event,point:C.point,simulated:!0,target:x})}const E=this._keyboardDragPoint;E.x+=w,E.y+=P;const k=e.getEvent(new MouseEvent("mousemove",{clientX:E.x,clientY:E.y}),!1);x.events.isEnabled("globalpointermove")&&x.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:k.event,point:k.point,simulated:!0,target:x})}}})),this._disposers.push(fi(m,"keyup",b=>{if(this._focusedSprite){const x=this._focusedSprite,w=b.keyCode;switch(w){case 37:case 39:case 38:case 40:if(x.isDragging()){const P=this._keyboardDragPoint,E=e.getEvent(new MouseEvent("mouseup",{clientX:P.x,clientY:P.y}));x.events.isEnabled("globalpointerup")&&x.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:E.event,point:E.point,simulated:!0,target:x}),this._keyboardDragPoint=void 0;return}else if(x.get("focusableGroup")){const P=x.get("focusableGroup"),E=this._tabindexes.filter(O=>O.get("focusableGroup")==P&&O.getPrivate("focusable")!==!1);let k=E.indexOf(x);const C=E.length-1;k+=w==39||w==40?1:-1,k<0?k=C:k>C&&(k=0),DO(E[k].getPrivate("focusElement").dom)}break}}})))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}_initResizeSensor(){this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new h8(this.dom,()=>{this.autoResize&&this.resize()}),this._disposers.push(this._resizeSensorDisposer)}resize(){const e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),n=Math.floor(t.height);if(i>0&&n>0){const s=Math.floor(e.width),a=Math.floor(e.height),l=this._htmlElementContainer;if(l.style.width=i+"px",l.style.height=n+"px",this._a11yD!==!0){const c=this._focusElementContainer;c.style.width=i+"px",c.style.height=n+"px"}this._renderer.resize(s,a,i,n);const h=this._rootContainer;h.setPrivate("width",s),h.setPrivate("height",a),this._render(),this._handleLogo()}}_render(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}_runTickers(e){ce(this._tickers,t=>{t(e)})}_runAnimations(e){Gc(this._animations,t=>t._runAnimation(e))}_runDirties(){let e={};for(;this._isDirtyParents;)this._isDirtyParents=!1,Li(this._dirtyParents).forEach(a=>{const l=this._dirtyParents[a];delete this._dirtyParents[a],l.isDisposed()||(e[l.uid]=l,l._prepareChildren())});Li(e).forEach(a=>{e[a]._updateChildren()});const t=[];Li(this._dirty).forEach(a=>{const l=this._dirty[a];l.isDisposed()?delete this._dirty[l.uid]:(t.push(l),l._beforeChanged())}),t.forEach(a=>{a._changed(),delete this._dirty[a.uid],a._clearDirty()}),this._isDirty=!1;const i={},n=[];Li(this._dirtyBounds).forEach(a=>{const l=this._dirtyBounds[a];delete this._dirtyBounds[a],l.isDisposed()||(i[l.uid]=l.depth(),n.push(l))}),this._positionHTMLElements(),n.sort((a,l)=>io(i[l.uid],i[a.uid])),n.forEach(a=>{a._updateBounds()});const s=this._dirtyPositions;Li(s).forEach(a=>{const l=s[a];delete s[a],l.isDisposed()||l._updatePosition()}),t.forEach(a=>{a._afterChanged()})}_renderFrame(e){return this._updateTick?(this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e),this._runAnimations(e),this._runDirties(),this._render(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),this._tickers.length===0&&this._animations.length===0&&!this._isDirty):!0}_runTicker(e,t){this.isDisposed()||(this.animationTime=e,this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||(t?this._ticker:Im(this.fps,this._ticker)))}_runTickerNow(e=1e4){if(!this.isDisposed()){const t=performance.now()+e;for(;;){const i=performance.now();if(i>=t){this.animationTime=null;break}if(this.animationTime=i,this._renderFrame(i)){this.animationTime=null;break}}}}_startTicker(){this._ticker===null&&(this.animationTime=null,this._ticker=e=>{this._runTicker(e)},Im(this.fps,this._ticker))}get updateTick(){return this._updateTick}set updateTick(e){this._updateTick=e,e&&this._startTicker()}_addDirtyEntity(e){this._dirty[e.uid]===void 0&&(this._isDirty=!0,this._dirty[e.uid]=e,this._startTicker())}_addDirtyParent(e){this._dirtyParents[e.uid]===void 0&&(this._isDirty=!0,this._isDirtyParents=!0,this._dirtyParents[e.uid]=e,this._startTicker())}_addDirtyBounds(e){this._dirtyBounds[e.uid]===void 0&&(this._isDirty=!0,this._dirtyBounds[e.uid]=e,this._startTicker())}_addDirtyPosition(e){this._dirtyPositions[e.uid]===void 0&&(this._isDirty=!0,this._dirtyPositions[e.uid]=e,this._startTicker())}_addAnimation(e){this._animations.indexOf(e)===-1&&(this._animations.push(e),this._startTicker())}_markDirty(){this._isDirty=!0}_markDirtyRedraw(){this.events.once("frameended",()=>{this._isDirty=!0,this._startTicker()})}eachFrame(e){return this._tickers.push(e),this._startTicker(),new Ni(()=>{Cr(this._tickers,e)})}markDirtyGlobal(e){e||(e=this.container),e.walkChildren(t=>{t instanceof Qe&&this.markDirtyGlobal(t),t.markDirty(),t.markDirtyBounds()})}width(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}height(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}dispose(){this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),ce(this._disposers,e=>{e.dispose()}),this._inner&&CO(this._inner),yn(hs.rootElements,this))}isDisposed(){return this._isDisposed}readerAlert(e){this._a11yD!==!0&&(this._readerAlertElement.innerHTML=km(e))}setThemes(e){this._rootContainer.set("themes",e);const t=this.tooltipContainer;t&&t._applyThemes();const i=this.interfaceColors;i&&i._applyThemes()}_addTooltip(){if(!this.tooltipContainer){const e=this._tooltipContainerSettings,t=this._rootContainer.children.push(Qe.new(this,{position:"absolute",isMeasured:!1,width:ze,height:ze,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;const i=Ws.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}_registerTabindexOrder(e){this._a11yD!=!0&&(e.get("focusable")?Du(this._tabindexes,e):yn(this._tabindexes,e),this._invalidateTabindexes())}_unregisterTabindexOrder(e){this._a11yD!=!0&&(yn(this._tabindexes,e),this._invalidateTabindexes())}_invalidateTabindexes(){if(this._a11yD==!0)return;this._tabindexes.sort((t,i)=>{const n=t.get("tabindexOrder",0),s=i.get("tabindexOrder",0);return n==s?0:n>s?1:-1});const e=[];ce(this._tabindexes,(t,i)=>{t.getPrivate("focusElement")?this._moveFocusElement(i,t):this._makeFocusElement(i,t);const n=t.get("focusableGroup");n&&t.getPrivate("focusable")!==!1&&(e.indexOf(n)!==-1?t.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):e.push(n))})}_updateCurrentFocus(){this._a11yD!=!0&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}_decorateFocusElement(e,t){if(this._a11yD==!0||(t||(t=e.getPrivate("focusElement").dom),!t))return;e.get("visible")&&e.get("role")!="tooltip"&&!e.isHidden()&&e.getPrivate("focusable")!==!1?t.getAttribute("tabindex")!="-1"&&t.setAttribute("tabindex",""+this.tabindex):t.removeAttribute("tabindex");const i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");const n=e.get("ariaLabel");if(n){const _=Fu(e,n);t.setAttribute("aria-label",_)}else t.removeAttribute("aria-label");const s=e.get("ariaLive");s?t.setAttribute("aria-live",s):t.removeAttribute("aria-live");const a=e.get("ariaChecked");a!=null?t.setAttribute("aria-checked",a?"true":"false"):t.removeAttribute("aria-checked"),e.get("ariaHidden")?t.setAttribute("aria-hidden","hidden"):t.removeAttribute("aria-hidden");const l=e.get("ariaOrientation");l?t.setAttribute("aria-orientation",l):t.removeAttribute("aria-orientation");const h=e.get("ariaValueNow");h?t.setAttribute("aria-valuenow",h):t.removeAttribute("aria-valuenow");const c=e.get("ariaValueMin");c?t.setAttribute("aria-valuemin",c):t.removeAttribute("aria-valuemin");const p=e.get("ariaValueMax");p?t.setAttribute("aria-valuemax",p):t.removeAttribute("aria-valuemax");const g=e.get("ariaValueText");g?t.setAttribute("aria-valuetext",g):t.removeAttribute("aria-valuetext");const m=e.get("ariaControls");m?t.setAttribute("aria-controls",m):t.removeAttribute("aria-controls")}_makeFocusElement(e,t){if(t.getPrivate("focusElement")||this._a11yD==!0)return;const i=document.createElement("div");t.get("role")!="tooltip"&&(i.tabIndex=this.tabindex),i.style.position="absolute",el(i,!1);const n=[];t.setPrivate("focusElement",{dom:i,disposers:n}),this._decorateFocusElement(t),n.push(fi(i,"focus",s=>{this._handleFocus(s,e)})),n.push(fi(i,"blur",s=>{this._handleBlur(s,e)})),this._moveFocusElement(e,t)}_removeFocusElement(e){if(this._a11yD==!0)return;yn(this._tabindexes,e);const t=e.getPrivate("focusElement");t&&(this._focusElementContainer.removeChild(t.dom),ce(t.disposers,n=>{n.dispose()}))}_hideFocusElement(e){if(this._a11yD==!0)return;const t=e.getPrivate("focusElement");t.dom.style.display="none"}_moveFocusElement(e,t){if(this._a11yD==!0)return;const i=this._focusElementContainer,n=t.getPrivate("focusElement").dom;if(n===this._focusElementContainer.children[e])return;const s=this._focusElementContainer.children[e+1];s?i.insertBefore(n,s):i.append(n)}_positionFocusElement(e){if(this._a11yD==!0)return;const t=e.globalBounds();let i=t.right==t.left?e.width():t.right-t.left,n=t.top==t.bottom?e.height():t.bottom-t.top,s=t.left-2,a=t.top-2;i<0&&(s+=i,i=Math.abs(i)),n<0&&(a+=n,n=Math.abs(n));const l=e.getPrivate("focusElement").dom;l.style.top=a+"px",l.style.left=s+"px",l.style.width=i+4+"px",l.style.height=n+4+"px"}_handleFocus(e,t){if(this._a11yD==!0)return;const i=this._tabindexes[t];if(!i.isVisibleDeep()){this._focusNext(e.target,this._isShift?-1:1);return}this._positionFocusElement(i),this._focusedSprite=i,i.events.isEnabled("focus")&&i.events.dispatch("focus",{type:"focus",originalEvent:e,target:i})}_focusNext(e,t){if(this._a11yD==!0)return;const i=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(",")));let n=i.indexOf(e)+t;n<0?n=i.length-1:n>=i.length&&(n=0),i[n].focus()}_handleBlur(e,t){if(this._a11yD==!0)return;const i=this._focusedSprite;i&&i.events.isEnabled("blur")&&i.events.dispatch("blur",{type:"blur",originalEvent:e,target:i}),this._focusedSprite=void 0}updateTooltip(e){if(this._a11yD==!0)return;const t=km(e._getText());let i=e.getPrivate("tooltipElement");e.get("role")=="tooltip"&&t!=""?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t)):i&&(i.remove(),e.removePrivate("tooltipElement"))}_makeTooltipElement(e){const t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",el(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}_removeTooltipElement(e){if(this._a11yD==!0)return;const t=e.getPrivate("tooltipElement");if(t){const i=t.parentElement;i&&i.removeChild(t)}}_invalidateAccessibility(e){if(this._a11yD==!0)return;this._focusElementDirty=!0;const t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}focused(e){return this._focusedSprite===e}documentPointToRoot(e){const t=this.dom.getBoundingClientRect();return{x:e.x-t.left,y:e.y-t.top}}rootPointToDocument(e){const t=this.dom.getBoundingClientRect();return{x:e.x+t.left,y:e.y+t.top}}addDisposer(e){return this._disposers.push(e),e}_updateComputedStyles(){const e=window.getComputedStyle(this.dom);let t="";Zt(e,(n,s)=>{cl(n)&&n.match(/^font/)&&(t+=s)});const i=t!=this._fontHash;return i&&(this._fontHash=t),i}_checkComputedStyles(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}_invalidateLabelBounds(e){e instanceof Qe?e.children.each(t=>{this._invalidateLabelBounds(t)}):e instanceof oo&&e.markDirtyBounds()}_hasLicense(){for(let e=0;e<hs.licenses.length;e++)if(hs.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}_licenseApplied(){this._logo&&this._logo.set("forceHidden",!0)}get debugGhostView(){return this._renderer.debugGhostView}set debugGhostView(e){this._renderer.debugGhostView=e}set tapToActivate(e){this._renderer.tapToActivate=e}get tapToActivate(){return this._renderer.tapToActivate}set tapToActivateTimeout(e){this._renderer.tapToActivateTimeout=e}get tapToActivateTimeout(){return this._renderer.tapToActivateTimeout}_makeHTMLElement(e){const t=this._htmlElementContainer,i=document.createElement("div");return e.setPrivate("htmlElement",i),i.style.position="absolute",i.style.overflow="auto",i.style.boxSizing="border-box",el(i,e.get("interactive",!1)),e.events.isEnabled("click")&&(el(i,!0),this._disposers.push(fi(i,"click",n=>{const s=this._renderer.getEvent(n);e.events.dispatch("click",{type:"click",originalEvent:s.event,point:s.point,simulated:!1,target:e})}))),this._positionHTMLElement(e),t.append(i),Du(this._htmlEnabledContainers,e),i}_positionHTMLElements(){ce(this._htmlEnabledContainers,e=>{this._positionHTMLElement(e)})}_positionHTMLElement(e){const t=e.getPrivate("htmlElement");if(t){ce(["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"],g=>{const m=e.get(g);m?t.style[g]=m+"px":t.style[g]=""});const n=e.compositeOpacity();setTimeout(()=>{t.style.opacity=n+""},10);const s=e.isVisibleDeep();s&&(t.style.display="block");const a=e.globalBounds();t.style.top=a.top+"px",t.style.left=a.left+"px";const l=e.get("width"),h=e.get("height");let c=0,p=0;if(l&&(c=e.width()),h&&(p=e.height()),!l||!h){t.style.position="fixed",t.style.width="",t.style.height="";const g=t.getBoundingClientRect();t.style.position="absolute",c=g.width,p=g.height,e._adjustedLocalBounds={left:0,right:0,top:0,bottom:0},e.setPrivate("minWidth",c),e.setPrivate("minHeight",p)}else e.removePrivate("minWidth"),e.removePrivate("minHeight");c>0&&(t.style.minWidth=c+"px"),p>0&&(t.style.minHeight=p+"px"),(!s||n==0)&&(t.style.display="none")}}_setHTMLContent(e,t){let i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}_removeHTMLContent(e){let t=e.getPrivate("htmlElement");t&&this._htmlElementContainer.removeChild(t),yn(this._htmlEnabledContainers,e)}}class ya extends Tn{_beforeChanged(){super._beforeChanged(),(this.isDirty("cornerRadiusTL")||this.isDirty("cornerRadiusTR")||this.isDirty("cornerRadiusBR")||this.isDirty("cornerRadiusBL"))&&(this._clear=!0)}_draw(){let e=this.width(),t=this.height(),i=e,n=t,s=i/Math.abs(e),a=n/Math.abs(t);if(ve(i)&&ve(n)){let l=Math.min(i,n)/2,h=ai(this.get("cornerRadiusTL",8),l),c=ai(this.get("cornerRadiusTR",8),l),p=ai(this.get("cornerRadiusBR",8),l),g=ai(this.get("cornerRadiusBL",8),l),m=Math.min(Math.abs(i/2),Math.abs(n/2));h=Di(h,0,m),c=Di(c,0,m),p=Di(p,0,m),g=Di(g,0,m);const _=this._display;_.moveTo(h*s,0),_.lineTo(i-c*s,0),c>0&&_.arcTo(i,0,i,c*a,c),_.lineTo(i,n-p*a),p>0&&_.arcTo(i,n,i-p*s,n,p),_.lineTo(g*s,n),g>0&&_.arcTo(0,n,0,n-g*a,g),_.lineTo(0,h*a),h>0&&_.arcTo(0,0,h*s,0,h),_.closePath()}}}Object.defineProperty(ya,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RoundedRectangle"});Object.defineProperty(ya,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Tn.classNames.concat([ya.className])});class Sc extends Qe{_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["button"]),super._afterNew(),this._settings.background||this.set("background",ya.new(this._root,{themeTags:It(this._settings.themeTags,["background"])}))}_prepareChildren(){if(super._prepareChildren(),this.isDirty("icon")){const e=this._prevSettings.icon,t=this.get("icon");t!==e&&(this._disposeProperty("icon"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.icon=t)}if(this.isDirty("label")){const e=this._prevSettings.label,t=this.get("label");t!==e&&(this._disposeProperty("label"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.label=t)}}}Object.defineProperty(Sc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Button"});Object.defineProperty(Sc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([Sc.className])});class J8 extends Tl{constructor(){super(...arguments),Object.defineProperty(this,"processor",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}incrementRef(){}decrementRef(){}_onPush(e){this.processor&&this.processor.processRow(e),super._onPush(e)}_onInsertIndex(e,t){this.processor&&this.processor.processRow(t),super._onInsertIndex(e,t)}_onSetIndex(e,t,i){this.processor&&this.processor.processRow(i),super._onSetIndex(e,t,i)}}class ll extends zv{constructor(e,t,i){super(i),Object.defineProperty(this,"component",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dataContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"open",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"close",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dataContext=t,this.component=e,this._settings.visible=!0,this._checkDirty()}markDirty(){this.component.markDirtyValues(this)}_startAnimation(){this.component._root._addAnimation(this)}_animationTime(){return this.component._root.animationTime}_dispose(){this.component&&this.component.disposeDataItem(this),super._dispose()}show(e){this.setRaw("visible",!0),this.component&&this.component.showDataItem(this,e)}hide(e){this.setRaw("visible",!1),this.component&&this.component.hideDataItem(this,e)}isHidden(){return!this.get("visible")}}class lo extends Qe{constructor(){super(...arguments),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:new J8}),Object.defineProperty(this,"_dataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mainDataItems",{enumerable:!0,configurable:!0,writable:!0,value:this._dataItems}),Object.defineProperty(this,"valueFields",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:["id"]}),Object.defineProperty(this,"_valueFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueFieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataChanged",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inited",{enumerable:!0,configurable:!0,writable:!0,value:!1})}set data(e){e.incrementRef(),this._data.decrementRef(),this._data=e}get data(){return this._data}_dispose(){super._dispose(),this._data.decrementRef()}_onDataClear(){}_afterNew(){super._afterNew(),this._data.incrementRef(),this._updateFields(),this._disposers.push(this.data.events.onAll(e=>{const t=this._mainDataItems;if(this.markDirtyValues(),this._markDirtyGroup(),this._dataChanged=!0,e.type==="clear")ce(t,i=>{i.dispose()}),t.length=0,this._onDataClear();else if(e.type==="push"){const i=new ll(this,e.newValue,this._makeDataItem(e.newValue));t.push(i),this.processDataItem(i)}else if(e.type==="setIndex"){const i=t[e.index],n=this._makeDataItem(e.newValue);i.bullets&&i.bullets.length==0&&(i.bullets=void 0),Li(n).forEach(s=>{i.animate({key:s,to:n[s],duration:this.get("interpolationDuration",0),easing:this.get("interpolationEasing")})}),i.dataContext=e.newValue}else if(e.type==="insertIndex"){const i=new ll(this,e.newValue,this._makeDataItem(e.newValue));t.splice(e.index,0,i),this.processDataItem(i)}else if(e.type==="removeIndex")t[e.index].dispose(),t.splice(e.index,1);else if(e.type==="moveIndex"){const i=t[e.oldIndex];t.splice(e.oldIndex,1),t.splice(e.newIndex,0,i)}else throw new Error("Unknown IStreamEvent type");this._afterDataChange()}))}_updateFields(){this.valueFields&&(this._valueFields=[],this._valueFieldsF={},ce(this.valueFields,e=>{this.get(e+"Field")&&(this._valueFields.push(e),this._valueFieldsF[e]={fieldKey:e+"Field",workingKey:e+"Working"})})),this.fields&&(this._fields=[],this._fieldsF={},ce(this.fields,e=>{this.get(e+"Field")&&(this._fields.push(e),this._fieldsF[e]=e+"Field")}))}get dataItems(){return this._dataItems}processDataItem(e){}_makeDataItem(e){const t={};return this._valueFields&&ce(this._valueFields,i=>{const n=this.get(this._valueFieldsF[i].fieldKey);t[i]=e[n],t[this._valueFieldsF[i].workingKey]=t[i]}),this._fields&&ce(this._fields,i=>{const n=this.get(this._fieldsF[i]);t[i]=e[n]}),t}makeDataItem(e){let t=new ll(this,void 0,e);return this.processDataItem(t),t}pushDataItem(e){const t=this.makeDataItem(e);return this._mainDataItems.push(t),t}disposeDataItem(e){}showDataItem(e,t){return Oi(this,void 0,void 0,function*(){e.set("visible",!0)})}hideDataItem(e,t){return Oi(this,void 0,void 0,function*(){e.set("visible",!1)})}_clearDirty(){super._clearDirty(),this._valuesDirty=!1}_afterDataChange(){}_afterChanged(){if(super._afterChanged(),this._dataChanged){const e="datavalidated";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this}),this._dataChanged=!1}this.inited=!0}markDirtyValues(e){this.markDirty(),this._valuesDirty=!0}_markDirtyGroup(){this._dataGrouped=!1}markDirtySize(){this._sizeDirty=!0,this.markDirty()}}Object.defineProperty(lo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Component"});Object.defineProperty(lo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([lo.className])});function Q8(r){return new Promise((e,t)=>{setTimeout(e,r)})}let e3={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:365.242/12*864e5,year:31536e6};function eu(r,e){return e==null&&(e=1),e3[r]*e}function xd(r,e,t,i,n,s,a){if(!a||n){let l=0;switch(!n&&e!="millisecond"&&(l=r.getTimezoneOffset(),r.setUTCMinutes(r.getUTCMinutes()-l)),e){case"day":let h=r.getUTCDate();if(t>1){if(s){s=xd(s,"day",1);let P=r.getTime()-s.getTime(),E=Math.floor(P/eu("day")/t),k=eu("day",E*t);r.setTime(s.getTime()+k-l*eu("minute"))}}else r.setUTCDate(h);r.setUTCHours(0,0,0,0);break;case"second":let c=r.getUTCSeconds();t>1&&(c=Math.floor(c/t)*t),r.setUTCSeconds(c,0);break;case"millisecond":if(t==1)return r;let p=r.getUTCMilliseconds();p=Math.floor(p/t)*t,r.setUTCMilliseconds(p);break;case"hour":let g=r.getUTCHours();t>1&&(g=Math.floor(g/t)*t),r.setUTCHours(g,0,0,0);break;case"minute":let m=r.getUTCMinutes();t>1&&(m=Math.floor(m/t)*t),r.setUTCMinutes(m,0,0);break;case"month":let _=r.getUTCMonth();t>1&&(_=Math.floor(_/t)*t),r.setUTCMonth(_,1),r.setUTCHours(0,0,0,0);break;case"year":let b=r.getUTCFullYear();t>1&&(b=Math.floor(b/t)*t),r.setUTCFullYear(b,0,1),r.setUTCHours(0,0,0,0);break;case"week":let x=r.getUTCDate(),w=r.getUTCDay();ve(i)||(i=1),w>=i?x=x-w+i:x=x-(7+w)+i,r.setUTCDate(x),r.setUTCHours(0,0,0,0);break}if(!n&&e!="millisecond"&&(r.setUTCMinutes(r.getUTCMinutes()+l),e=="day"||e=="week"||e=="month"||e=="year")){let h=r.getTimezoneOffset();if(h!=l){let c=h-l;r.setUTCMinutes(r.getUTCMinutes()+c)}}return r}else{if(isNaN(r.getTime()))return r;let l=a.offsetUTC(r),h=r.getTimezoneOffset(),c=a.parseDate(r),p=c.year,g=c.month,m=c.day,_=c.hour,b=c.minute,x=c.second,w=c.millisecond,P=c.weekday;switch(e){case"day":if(t>1&&s){s=xd(s,"day",1,i,n,void 0,a);let k=r.getTime()-s.getTime(),C=Math.floor(k/eu("day")/t),O=eu("day",C*t);r.setTime(s.getTime()+O),c=a.parseDate(r),p=c.year,g=c.month,m=c.day}_=0,b=l-h,x=0,w=0;break;case"second":b+=l-h,t>1&&(x=Math.floor(x/t)*t),w=0;break;case"millisecond":b+=l-h,t>1&&(w=Math.floor(w/t)*t);break;case"hour":t>1&&(_=Math.floor(_/t)*t),b=l-h,x=0,w=0;break;case"minute":t>1&&(b=Math.floor(b/t)*t),b+=l-h,x=0,w=0;break;case"month":t>1&&(g=Math.floor(g/t)*t),m=1,_=0,b=l-h,x=0,w=0;break;case"year":t>1&&(p=Math.floor(p/t)*t),g=0,m=1,_=0,b=l-h,x=0,w=0;break;case"week":ve(i)||(i=1),P>=i?m=m-P+i:m=m-(7+P)+i,_=0,b=l-h,x=0,w=0;break}r=new Date(p,g,m,_,b,x,w);let E=r.getTimezoneOffset();return E!=h&&r.setTime(r.getTime()+(h-E)*6e4),r}}class js extends lo{constructor(){super(...arguments),Object.defineProperty(this,"_aggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionAggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_psi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pei",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:new Tl}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{width:ze,height:ze,position:"absolute"})})}_afterNew(){this.valueFields.push("value"),super._afterNew(),this.setPrivate("customData",{}),this._disposers.push(this.bullets.events.onAll(e=>{if(e.type==="clear")this._handleBullets(this.dataItems);else if(e.type==="push")this._handleBullets(this.dataItems);else if(e.type==="setIndex")this._handleBullets(this.dataItems);else if(e.type==="insertIndex")this._handleBullets(this.dataItems);else if(e.type==="removeIndex")this._handleBullets(this.dataItems);else if(e.type==="moveIndex")this._handleBullets(this.dataItems);else throw new Error("Unknown IListEvent type")}))}_dispose(){this.bulletsContainer.dispose(),super._dispose()}startIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("startIndex",0),e)}endIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("endIndex",e),e)}_handleBullets(e){ce(e,t=>{const i=t.bullets;i&&(ce(i,n=>{n.dispose()}),t.bullets=void 0)}),this.markDirtyValues()}getDataItemById(e){return Cv(this.dataItems,t=>t.get("id")==e)}_makeBullets(e){this._shouldMakeBullet(e)&&(e.bullets=[],this.bullets.each(t=>{this._makeBullet(e,t)}))}_shouldMakeBullet(e){return!0}_makeBullet(e,t,i){const n=t(this._root,this,e);if(n){let s=n.get("sprite");s&&(s._setDataItem(e),s.setRaw("position","absolute"),this.bulletsContainer.children.push(s)),n._index=i,n.series=this,e.bullets.push(n)}return n}_clearDirty(){super._clearDirty(),this._aggregatesCalculated=!1,this._selectionAggregatesCalculated=!1}_prepareChildren(){super._prepareChildren();let e=this.startIndex(),t=this.endIndex();if(this.isDirty("heatRules")&&(this._valuesDirty=!0),this.isPrivateDirty("baseValueSeries")){const n=this.getPrivate("baseValueSeries");n&&this._disposers.push(n.onPrivate("startIndex",()=>{this.markDirtyValues()}))}if(this.get("calculateAggregates")&&(this._valuesDirty&&!this._dataProcessed&&(this._aggregatesCalculated||(this._calculateAggregates(0,this.dataItems.length),this._aggregatesCalculated=!0)),(this._psi!=e||this._pei!=t)&&!this._selectionAggregatesCalculated&&(e===0&&t===this.dataItems.length&&this._aggregatesCalculated||this._calculateAggregates(e,t),this._selectionAggregatesCalculated=!0)),this.isDirty("tooltip")){let n=this.get("tooltip");n&&(n.hide(0),n.set("tooltipTarget",this))}if(this.isDirty("fill")||this.isDirty("stroke")){let n;const s=this.get("legendDataItem");if(s&&(n=s.get("markerRectangle"),n&&this.isVisible())){if(this.isDirty("stroke")){let a=this.get("stroke");n.set("stroke",a)}if(this.isDirty("fill")){let a=this.get("fill");n.set("fill",a)}}this.updateLegendMarker(void 0)}if(this.bullets.length>0){let n=this.startIndex(),s=this.endIndex();s<this.dataItems.length&&s++;for(let a=n;a<s;a++){let l=this.dataItems[a];l.bullets||this._makeBullets(l)}}}_calculateAggregates(e,t){let i=this._valueFields;if(!i)throw new Error("No value fields are set for the series.");const n={},s={},a={},l={},h={},c={},p={},g={},m={};ce(i,_=>{n[_]=0,s[_]=0,a[_]=0}),ce(i,_=>{let b=_+"Change",x=_+"ChangePercent",w=_+"ChangePrevious",P=_+"ChangePreviousPercent",E=_+"ChangeSelection",k=_+"ChangeSelectionPercent",C="valueY";(_=="valueX"||_=="openValueX"||_=="lowValueX"||_=="highValueX")&&(C="valueX");const O=this.getPrivate("baseValueSeries");for(let F=e;F<t;F++){const D=this.dataItems[F];let N=D.get(_);N!=null&&(a[_]++,n[_]+=N,s[_]+=Math.abs(N),g[_]=n[_]/a[_],(l[_]>N||l[_]==null)&&(l[_]=N),(h[_]<N||h[_]==null)&&(h[_]=N),p[_]=N,c[_]==null&&(c[_]=N,m[_]=N,O&&(c[C]=O._getBase(C))),e===0&&(D.setRaw(b,N-c[C]),D.setRaw(x,(N-c[C])/c[C]*100)),D.setRaw(w,N-m[C]),D.setRaw(P,(N-m[C])/m[C]*100),D.setRaw(E,N-c[C]),D.setRaw(k,(N-c[C])/c[C]*100),m[_]=N)}}),ce(i,_=>{this.setPrivate(_+"AverageSelection",g[_]),this.setPrivate(_+"CountSelection",a[_]),this.setPrivate(_+"SumSelection",n[_]),this.setPrivate(_+"AbsoluteSumSelection",s[_]),this.setPrivate(_+"LowSelection",l[_]),this.setPrivate(_+"HighSelection",h[_]),this.setPrivate(_+"OpenSelection",c[_]),this.setPrivate(_+"CloseSelection",p[_])}),e===0&&t===this.dataItems.length&&ce(i,_=>{this.setPrivate(_+"Average",g[_]),this.setPrivate(_+"Count",a[_]),this.setPrivate(_+"Sum",n[_]),this.setPrivate(_+"AbsoluteSum",s[_]),this.setPrivate(_+"Low",l[_]),this.setPrivate(_+"High",h[_]),this.setPrivate(_+"Open",c[_]),this.setPrivate(_+"Close",p[_])})}_updateChildren(){super._updateChildren(),this._psi=this.startIndex(),this._pei=this.endIndex(),this.isDirty("visible")&&this.bulletsContainer.set("visible",this.get("visible"));const e=this.get("heatRules");if(this._valuesDirty&&e&&e.length>0&&ce(e,t=>{const i=t.minValue||this.getPrivate(t.dataField+"Low")||0,n=t.maxValue||this.getPrivate(t.dataField+"High")||0;ce(t.target._entities,s=>{const a=s.dataItem.get(t.dataField);if(!ve(a)){t.neutral&&s.set(t.key,t.neutral);return}if(t.customFunction)t.customFunction.call(this,s,i,n,a);else{let l;t.logarithmic?l=(Math.log(a)*Math.LOG10E-Math.log(i)*Math.LOG10E)/(Math.log(n)*Math.LOG10E-Math.log(i)*Math.LOG10E):l=(a-i)/(n-i),ve(a)&&(!ve(l)||Math.abs(l)==1/0)&&(l=.5);let h;ve(t.min)?h=t.min+(t.max-t.min)*l:t.min instanceof Ve?h=Ve.interpolate(l,t.min,t.max):t.min instanceof gt&&(h=Bv(l,t.min,t.max)),s.set(t.key,h)}})}),this.get("visible")&&this.bullets.length>0){let t=this.dataItems.length,i=this.startIndex(),n=this.endIndex();n<t&&n++,i>0&&i--;for(let s=0;s<i;s++)this._hideBullets(this.dataItems[s]);for(let s=i;s<n;s++)this._positionBullets(this.dataItems[s]);for(let s=n;s<t;s++)this._hideBullets(this.dataItems[s])}}_positionBullets(e){e.bullets&&ce(e.bullets,t=>{this._positionBullet(t);const i=t.get("sprite");t.get("dynamic")&&(i&&(i._markDirtyKey("fill"),i.markDirtySize()),i instanceof Qe&&i.walkChildren(n=>{n._markDirtyKey("fill"),n.markDirtySize(),n instanceof cr&&n.text.markDirtyText()})),i instanceof cr&&i.get("populateText")&&i.text.markDirtyText()})}_hideBullets(e){e.bullets&&ce(e.bullets,t=>{let i=t.get("sprite");i&&i.setPrivate("visible",!1)})}_positionBullet(e){}_placeBulletsContainer(e){e.bulletsContainer.children.moveValue(this.bulletsContainer)}_removeBulletsContainer(){const e=this.bulletsContainer;e.parent&&e.parent.children.removeValue(e)}disposeDataItem(e){const t=e.bullets;t&&ce(t,i=>{i.dispose()})}_getItemReaderLabel(){return""}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)],s=e.bullets;s&&ce(s,a=>{n.push(a.get("sprite").show(t))}),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],s=e.bullets;s&&ce(s,a=>{n.push(a.get("sprite").hide(t))}),yield Promise.all(n)})}_sequencedShowHide(e,t){return Oi(this,void 0,void 0,function*(){if(this.get("sequencedInterpolation"))if(ve(t)||(t=this.get("interpolationDuration",0)),t>0){const i=this.startIndex(),n=this.endIndex();yield Promise.all(cd(this.dataItems,(s,a)=>Oi(this,void 0,void 0,function*(){let l=t||0;(a<i-10||a>n+10)&&(l=0);let h=this.get("sequencedDelay",0)+l/(n-i);yield Q8(h*(a-i)),e?yield this.showDataItem(s,l):yield this.hideDataItem(s,l)})))}else yield Promise.all(cd(this.dataItems,i=>e?this.showDataItem(i,0):this.hideDataItem(i,0)))})}updateLegendValue(e){if(e){const t=e.get("legendDataItem");if(t){const i=t.get("valueLabel");if(i){const s=i.text;let a="";i._setDataItem(e),a=this.get("legendValueText",s.get("text","")),i.set("text",a),s.markDirtyText()}const n=t.get("label");if(n){const s=n.text;let a="";n._setDataItem(e),a=this.get("legendLabelText",s.get("text","")),n.set("text",a),s.markDirtyText()}}}}updateLegendMarker(e){}_onHide(){super._onHide();const e=this.getTooltip();e&&e.hide()}hoverDataItem(e){}unhoverDataItem(e){}_getBase(e){const t=this.dataItems[this.startIndex()];return t?t.get(e):0}}Object.defineProperty(js,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Series"});Object.defineProperty(js,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:lo.classNames.concat([js.className])});class Dc extends js{constructor(){super(...arguments),Object.defineProperty(this,"itemContainers",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>Qe._new(this._root,{themeTags:It(this.itemContainers.template.get("themeTags",[]),["legend","item"]),themeTagsSelf:It(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"]),background:ya.new(this._root,{themeTags:It(this.itemContainers.template.get("themeTags",[]),["legend","item","background"]),themeTagsSelf:It(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"])})},[this.itemContainers.template]))}),Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>Qe._new(this._root,{themeTags:It(this.markers.template.get("themeTags",[]),["legend","marker"])},[this.markers.template]))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>cr._new(this._root,{themeTags:It(this.labels.template.get("themeTags",[]),["legend","label"])},[this.labels.template]))}),Object.defineProperty(this,"valueLabels",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>cr._new(this._root,{themeTags:It(this.valueLabels.template.get("themeTags",[]),["legend","label","value"])},[this.valueLabels.template]))}),Object.defineProperty(this,"markerRectangles",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>ya._new(this._root,{themeTags:It(this.markerRectangles.template.get("themeTags",[]),["legend","marker","rectangle"])},[this.markerRectangles.template]))})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["legend"]),this.fields.push("name","stroke","fill"),super._afterNew()}makeItemContainer(e){const t=this.children.push(this.itemContainers.make());return t._setDataItem(e),this.itemContainers.push(t),t.states.create("disabled",{}),t}makeMarker(){const e=this.markers.make();return this.markers.push(e),e.states.create("disabled",{}),e}makeLabel(){const e=this.labels.make();return e.states.create("disabled",{}),e}makeValueLabel(){const e=this.valueLabels.make();return e.states.create("disabled",{}),e}makeMarkerRectangle(){const e=this.markerRectangles.make();return e.states.create("disabled",{}),e}processDataItem(e){super.processDataItem(e);const t=this.makeItemContainer(e),i=this.get("nameField"),n=this.get("fillField"),s=this.get("strokeField");if(t){const a=this.get("clickTarget","itemContainer"),l=e.dataContext;l&&l.set&&l.set("legendDataItem",e),t._setDataItem(e),e.set("itemContainer",t);const h=this.makeMarker();if(h){t.children.push(h),h._setDataItem(e),e.set("marker",h);const g=this.get("useDefaultMarker"),m=h.children.push(this.makeMarkerRectangle());let _=e.get("fill"),b=e.get("stroke");e.set("markerRectangle",m),l&&l.get&&(_=l.get(n,_),b=l.get(s,b)),b||(b=_),g?l.on&&(l.on(n,()=>{m.set("fill",l.get(n))}),l.on(s,()=>{m.set("stroke",l.get(s))})):l&&l.createLegendMarker&&l.createLegendMarker(),m.setAll({fill:_,stroke:b});const x=l.component;x&&x.updateLegendMarker&&x.updateLegendMarker(l)}const c=this.makeLabel();if(c){t.children.push(c),c._setDataItem(e),e.set("label",c),c.text.on("text",()=>{t.setRaw("ariaLabel",c.text._getText()+(this.get("clickTarget")!=="none"?"; "+this._t("Press ENTER to toggle"):"")),t.markDirtyAccessibility()}),l&&l.get&&e.set("name",l.get(i));let g=e.get("name");g&&c.set("text",g)}const p=this.makeValueLabel();if(p&&(t.children.push(p),p._setDataItem(e),e.set("valueLabel",p)),l&&l.show&&(l.on("visible",g=>{t.set("disabled",!g)}),l.get("visible")||t.set("disabled",!0),a!="none")){let g=t;a=="marker"&&(g=h),this._addClickEvents(g,l,e)}this.children.values.sort((g,m)=>{const _=g.dataItem.dataContext,b=m.dataItem.dataContext;if(_&&b){const x=this.data.indexOf(_),w=this.data.indexOf(b);if(x>w)return 1;if(x<w)return-1}return 0}),l&&l.updateLegendValue&&l.updateLegendValue()}}_addClickEvents(e,t,i){e.set("cursorOverStyle","pointer"),e.events.on("pointerover",()=>{const n=t.component;n&&n.hoverDataItem&&n.hoverDataItem(t)}),e.events.on("pointerout",()=>{const n=t.component;n&&n.hoverDataItem&&n.unhoverDataItem(t)}),e.events.on("click",()=>{const n=i.get("label").text._getText();t.show&&t.isHidden&&(t.isHidden()||t.get("visible")===!1)?(t.show(),e.set("disabled",!1),this._root.readerAlert(this._t("%1 shown",this._root.locale,n))):t.hide&&(t.hide(),e.set("disabled",!0),this._root.readerAlert(this._t("%1 hidden",this._root.locale,n)))})}disposeDataItem(e){super.disposeDataItem(e);const t=e.dataContext;t&&t.get&&t.get("legendDataItem")==e&&t.set("legendDataItem",void 0);let i=e.get("itemContainer");i&&(this.itemContainers.removeValue(i),i.dispose());let n=e.get("marker");n&&(this.markers.removeValue(n),n.dispose());let s=e.get("markerRectangle");s&&(this.markerRectangles.removeValue(s),s.dispose());let a=e.get("label");a&&(this.labels.removeValue(a),a.dispose());let l=e.get("valueLabel");l&&(this.valueLabels.removeValue(l),l.dispose())}}Object.defineProperty(Dc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Legend"});Object.defineProperty(Dc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:js.classNames.concat([Dc.className])});function Bm(r,e){for(let t=0,i=e.length;t<i;t++){const n=e[t];if(n.length>0){let s=n[0];if(s.length>0){let a=s[0];r.moveTo(a.x,a.y);for(let l=0,h=n.length;l<h;l++)t3(r,n[l])}}}}function t3(r,e){for(let t=0,i=e.length;t<i;t++){const n=e[t];r.lineTo(n.x,n.y)}}class Ru extends wi{_beforeChanged(){super._beforeChanged(),(this.isDirty("points")||this.isDirty("segments")||this._sizeDirty||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("points"),t=this.get("segments");if(e&&e.length>0){let i=e[0];this._display.moveTo(i.x,i.y),Bm(this._display,[[e]])}else if(t)Bm(this._display,t);else if(!this.get("draw")){let i=this.width(),n=this.height();this._display.moveTo(0,0),this._display.lineTo(i,n)}}}}Object.defineProperty(Ru,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Line"});Object.defineProperty(Ru,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([Ru.className])});class Lc extends oo{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeRadialText("",this.textStyle)})}_afterNew(){super._afterNew()}_beforeChanged(){super._beforeChanged(),this._display.clear(),this.isDirty("textType")&&(this._display.textType=this.get("textType"),this.markDirtyBounds()),this.isDirty("radius")&&(this._display.radius=this.get("radius"),this.markDirtyBounds()),this.isDirty("startAngle")&&(this._display.startAngle=(this.get("startAngle",0)+90)*Lu,this.markDirtyBounds()),this.isDirty("inside")&&(this._display.inside=this.get("inside"),this.markDirtyBounds()),this.isDirty("orientation")&&(this._display.orientation=this.get("orientation"),this.markDirtyBounds()),this.isDirty("kerning")&&(this._display.kerning=this.get("kerning"),this.markDirtyBounds())}}Object.defineProperty(Lc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialText"});Object.defineProperty(Lc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:oo.classNames.concat([Lc.className])});class Oc extends cr{constructor(){super(...arguments),Object.defineProperty(this,"_flipped",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._textKeys.push("textType","kerning"),super._afterNew()}_makeText(){this._text=this.children.push(Lc.new(this._root,{}))}baseRadius(){const e=this.getPrivate("radius",0),t=this.getPrivate("innerRadius",0),i=this.get("baseRadius",0);return t+ai(i,e-t)}radius(){const e=this.get("inside",!1);return this.baseRadius()+this.get("radius",0)*(e?-1:1)}_updateChildren(){if(super._updateChildren(),this.isDirty("baseRadius")||this.isPrivateDirty("radius")||this.isPrivateDirty("innerRadius")||this.isDirty("labelAngle")||this.isDirty("radius")||this.isDirty("inside")||this.isDirty("orientation")||this.isDirty("textType")){const e=this.get("textType","adjusted"),t=this.get("inside",!1),i=this.get("orientation");let n=tp(this.get("labelAngle",0));this._text.set("startAngle",this.get("labelAngle",0)),this._text.set("inside",t);const s=bn(n),a=cs(n);let l=this.baseRadius(),h=this.radius();if(this._display.angle=0,e=="circular")this.setAll({paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}),this._text.set("orientation",i),this._text.set("radius",h);else{l==0&&(n=0,h=0);let c=h*a,p=h*s;e=="radial"?(this.setRaw("x",c),this.setRaw("y",p),n<90||n>270||i!="auto"?(this._display.angle=n,this._flipped=!1):(this._display.angle=n+180,this._flipped=!0),this._dirty.rotation=!1):e=="adjusted"?(this.setRaw("centerX",ot),this.setRaw("centerY",ot),this.setRaw("x",c),this.setRaw("y",p)):e=="regular"&&(this.setRaw("x",c),this.setRaw("y",p))}this.markDirtyPosition(),this.markDirtyBounds()}}_updatePosition(){const e=this.get("textType","regular"),t=this.get("inside",!1);let i=0,n=0,s=this.get("labelAngle",0),a=this.localBounds(),l=a.right-a.left,h=a.bottom-a.top;if(e=="radial"){if(this._flipped){let c=this.get("centerX");c instanceof gt&&(l=l*(1-c.value*2)),i=l*cs(s),n=l*bn(s)}}else!t&&e=="adjusted"&&(i=l/2*cs(s),n=h/2*bn(s));this.setRaw("dx",i),this.setRaw("dy",n),super._updatePosition()}get text(){return this._text}}Object.defineProperty(Oc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialLabel"});Object.defineProperty(Oc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:cr.classNames.concat([Oc.className])});function ua(r){return function(){return r}}const Nm=Math.abs,nr=Math.atan2,Ka=Math.cos,i3=Math.max,qf=Math.min,ls=Math.sin,rl=Math.sqrt,Vr=1e-12,Iu=Math.PI,Mc=Iu/2,r3=2*Iu;function n3(r){return r>1?0:r<-1?Iu:Math.acos(r)}function Hm(r){return r>=1?Mc:r<=-1?-Mc:Math.asin(r)}const vd=Math.PI,yd=2*vd,qa=1e-6,s3=yd-qa;function Gv(r){this._+=r[0];for(let e=1,t=r.length;e<t;++e)this._+=arguments[e]+r[e]}function a3(r){let e=Math.floor(r);if(!(e>=0))throw new Error(`invalid digits: ${r}`);if(e>15)return Gv;const t=10**e;return function(i){this._+=i[0];for(let n=1,s=i.length;n<s;++n)this._+=Math.round(arguments[n]*t)/t+i[n]}}class o3{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Gv:a3(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,i,n){this._append`Q${+e},${+t},${this._x1=+i},${this._y1=+n}`}bezierCurveTo(e,t,i,n,s,a){this._append`C${+e},${+t},${+i},${+n},${this._x1=+s},${this._y1=+a}`}arcTo(e,t,i,n,s){if(e=+e,t=+t,i=+i,n=+n,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,l=this._y1,h=i-e,c=n-t,p=a-e,g=l-t,m=p*p+g*g;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(m>qa)if(!(Math.abs(g*h-c*p)>qa)||!s)this._append`L${this._x1=e},${this._y1=t}`;else{let _=i-a,b=n-l,x=h*h+c*c,w=_*_+b*b,P=Math.sqrt(x),E=Math.sqrt(m),k=s*Math.tan((vd-Math.acos((x+m-w)/(2*P*E)))/2),C=k/E,O=k/P;Math.abs(C-1)>qa&&this._append`L${e+C*p},${t+C*g}`,this._append`A${s},${s},0,0,${+(g*_>p*b)},${this._x1=e+O*h},${this._y1=t+O*c}`}}arc(e,t,i,n,s,a){if(e=+e,t=+t,i=+i,a=!!a,i<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(n),h=i*Math.sin(n),c=e+l,p=t+h,g=1^a,m=a?n-s:s-n;this._x1===null?this._append`M${c},${p}`:(Math.abs(this._x1-c)>qa||Math.abs(this._y1-p)>qa)&&this._append`L${c},${p}`,i&&(m<0&&(m=m%yd+yd),m>s3?this._append`A${i},${i},0,1,${g},${e-l},${t-h}A${i},${i},0,1,${g},${this._x1=c},${this._y1=p}`:m>qa&&this._append`A${i},${i},0,${+(m>=vd)},${g},${this._x1=e+i*Math.cos(s)},${this._y1=t+i*Math.sin(s)}`)}rect(e,t,i,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${i=+i}v${+n}h${-i}Z`}toString(){return this._}}function l3(r){let e=3;return r.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const i=Math.floor(t);if(!(i>=0))throw new RangeError(`invalid digits: ${t}`);e=i}return r},()=>new o3(e)}function u3(r){return r.innerRadius}function h3(r){return r.outerRadius}function c3(r){return r.startAngle}function f3(r){return r.endAngle}function d3(r){return r&&r.padAngle}function p3(r,e,t,i,n,s,a,l){var h=t-r,c=i-e,p=a-n,g=l-s,m=g*h-p*c;if(!(m*m<Vr))return m=(p*(e-s)-g*(r-n))/m,[r+m*h,e+m*c]}function lc(r,e,t,i,n,s,a){var l=r-t,h=e-i,c=(a?s:-s)/rl(l*l+h*h),p=c*h,g=-c*l,m=r+p,_=e+g,b=t+p,x=i+g,w=(m+b)/2,P=(_+x)/2,E=b-m,k=x-_,C=E*E+k*k,O=n-s,F=m*x-b*_,D=(k<0?-1:1)*rl(i3(0,O*O*C-F*F)),N=(F*k-E*D)/C,X=(-F*E-k*D)/C,z=(F*k+E*D)/C,U=(-F*E+k*D)/C,j=N-w,q=X-P,pe=z-w,fe=U-P;return j*j+q*q>pe*pe+fe*fe&&(N=z,X=U),{cx:N,cy:X,x01:-p,y01:-g,x11:N*(n/O-1),y11:X*(n/O-1)}}function g3(){var r=u3,e=h3,t=ua(0),i=null,n=c3,s=f3,a=d3,l=null,h=l3(c);function c(){var p,g,m=+r.apply(this,arguments),_=+e.apply(this,arguments),b=n.apply(this,arguments)-Mc,x=s.apply(this,arguments)-Mc,w=Nm(x-b),P=x>b;if(l||(l=p=h()),_<m&&(g=_,_=m,m=g),!(_>Vr))l.moveTo(0,0);else if(w>r3-Vr)l.moveTo(_*Ka(b),_*ls(b)),l.arc(0,0,_,b,x,!P),m>Vr&&(l.moveTo(m*Ka(x),m*ls(x)),l.arc(0,0,m,x,b,P));else{var E=b,k=x,C=b,O=x,F=w,D=w,N=a.apply(this,arguments)/2,X=N>Vr&&(i?+i.apply(this,arguments):rl(m*m+_*_)),z=qf(Nm(_-m)/2,+t.apply(this,arguments)),U=z,j=z,q,pe;if(X>Vr){var fe=Hm(X/m*ls(N)),Ee=Hm(X/_*ls(N));(F-=fe*2)>Vr?(fe*=P?1:-1,C+=fe,O-=fe):(F=0,C=O=(b+x)/2),(D-=Ee*2)>Vr?(Ee*=P?1:-1,E+=Ee,k-=Ee):(D=0,E=k=(b+x)/2)}var de=_*Ka(E),De=_*ls(E),ee=m*Ka(O),Fe=m*ls(O);if(z>Vr){var se=_*Ka(k),R=_*ls(k),J=m*Ka(C),Y=m*ls(C),ie;if(w<Iu)if(ie=p3(de,De,J,Y,se,R,ee,Fe)){var he=de-ie[0],Pe=De-ie[1],we=se-ie[0],Oe=R-ie[1],Le=1/ls(n3((he*we+Pe*Oe)/(rl(he*he+Pe*Pe)*rl(we*we+Oe*Oe)))/2),it=rl(ie[0]*ie[0]+ie[1]*ie[1]);U=qf(z,(m-it)/(Le-1)),j=qf(z,(_-it)/(Le+1))}else U=j=0}D>Vr?j>Vr?(q=lc(J,Y,de,De,_,j,P),pe=lc(se,R,ee,Fe,_,j,P),l.moveTo(q.cx+q.x01,q.cy+q.y01),j<z?l.arc(q.cx,q.cy,j,nr(q.y01,q.x01),nr(pe.y01,pe.x01),!P):(l.arc(q.cx,q.cy,j,nr(q.y01,q.x01),nr(q.y11,q.x11),!P),l.arc(0,0,_,nr(q.cy+q.y11,q.cx+q.x11),nr(pe.cy+pe.y11,pe.cx+pe.x11),!P),l.arc(pe.cx,pe.cy,j,nr(pe.y11,pe.x11),nr(pe.y01,pe.x01),!P))):(l.moveTo(de,De),l.arc(0,0,_,E,k,!P)):l.moveTo(de,De),!(m>Vr)||!(F>Vr)?l.lineTo(ee,Fe):U>Vr?(q=lc(ee,Fe,se,R,m,-U,P),pe=lc(de,De,J,Y,m,-U,P),l.lineTo(q.cx+q.x01,q.cy+q.y01),U<z?l.arc(q.cx,q.cy,U,nr(q.y01,q.x01),nr(pe.y01,pe.x01),!P):(l.arc(q.cx,q.cy,U,nr(q.y01,q.x01),nr(q.y11,q.x11),!P),l.arc(0,0,m,nr(q.cy+q.y11,q.cx+q.x11),nr(pe.cy+pe.y11,pe.cx+pe.x11),P),l.arc(pe.cx,pe.cy,U,nr(pe.y11,pe.x11),nr(pe.y01,pe.x01),!P))):l.arc(0,0,m,O,C,P)}if(l.closePath(),p)return l=null,p+""||null}return c.centroid=function(){var p=(+r.apply(this,arguments)+ +e.apply(this,arguments))/2,g=(+n.apply(this,arguments)+ +s.apply(this,arguments))/2-Iu/2;return[Ka(g)*p,ls(g)*p]},c.innerRadius=function(p){return arguments.length?(r=typeof p=="function"?p:ua(+p),c):r},c.outerRadius=function(p){return arguments.length?(e=typeof p=="function"?p:ua(+p),c):e},c.cornerRadius=function(p){return arguments.length?(t=typeof p=="function"?p:ua(+p),c):t},c.padRadius=function(p){return arguments.length?(i=p==null?null:typeof p=="function"?p:ua(+p),c):i},c.startAngle=function(p){return arguments.length?(n=typeof p=="function"?p:ua(+p),c):n},c.endAngle=function(p){return arguments.length?(s=typeof p=="function"?p:ua(+p),c):s},c.padAngle=function(p){return arguments.length?(a=typeof p=="function"?p:ua(+p),c):a},c.context=function(p){return arguments.length?(l=p??null,c):l},c}class Fc extends wi{constructor(){super(...arguments),Object.defineProperty(this,"ix",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"iy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_generator",{enumerable:!0,configurable:!0,writable:!0,value:g3()})}_getTooltipPoint(){let e=this.get("tooltipX"),t=this.get("tooltipY"),i=0,n=0;ve(e)&&(i=e),ve(t)&&(n=t);let s=this.get("radius",0),a=this.get("innerRadius",0),l=this.get("dRadius",0),h=this.get("dInnerRadius",0);return s+=l,a+=h,a<0&&(a=s+a),e instanceof gt&&(i=this.ix*(a+(s-a)*e.value)),t instanceof gt&&(n=this.iy*(a+(s-a)*t.value)),this.get("arc")>=360&&a==0&&(i=0,n=0),{x:i,y:n}}_beforeChanged(){super._beforeChanged(),(this.isDirty("radius")||this.isDirty("arc")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("dRadius")||this.isDirty("dInnerRadius")||this.isDirty("cornerRadius"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){let e=this.get("startAngle",0),t=this.get("arc",0);const i=this._generator;t<0&&(e=e+t,t=t*-1),t>.1&&i.cornerRadius(this.get("cornerRadius",0)),i.context(this._display);let n=this.get("radius",0),s=this.get("innerRadius",0),a=this.get("dRadius",0),l=this.get("dInnerRadius",0);n+=a,s+=l,s<0&&(s=n+s),i({innerRadius:s,outerRadius:n,startAngle:(e+90)*Lu,endAngle:(e+t+90)*Lu});let h=e+t/2;this.ix=cs(h),this.iy=bn(h)}if(this.isDirty("shiftRadius")){const e=this.get("shiftRadius",0);this.setRaw("dx",this.ix*e),this.setRaw("dy",this.iy*e),this.markDirtyPosition()}}}Object.defineProperty(Fc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Slice"});Object.defineProperty(Fc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([Fc.className])});class Bu extends Qe{constructor(){super(...arguments),Object.defineProperty(this,"chartContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{width:ze,height:ze,interactiveChildren:!1}))}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{interactiveChildren:!1,isMeasured:!1,position:"absolute",width:ze,height:ze})})}}Object.defineProperty(Bu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chart"});Object.defineProperty(Bu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([Bu.className])});class uo extends Bu{constructor(){super(...arguments),Object.defineProperty(this,"seriesContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{width:ze,height:ze,isMeasured:!1})}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:new Pc})}_afterNew(){super._afterNew(),this._disposers.push(this.series);const e=this.seriesContainer.children;this._disposers.push(this.series.events.onAll(t=>{if(t.type==="clear"){ce(t.oldValues,n=>{this._removeSeries(n)});const i=this.get("colors");i&&i.reset()}else if(t.type==="push")e.moveValue(t.newValue),this._processSeries(t.newValue);else if(t.type==="setIndex")e.setIndex(t.index,t.newValue),this._processSeries(t.newValue);else if(t.type==="insertIndex")e.insertIndex(t.index,t.newValue),this._processSeries(t.newValue);else if(t.type==="removeIndex")this._removeSeries(t.oldValue);else if(t.type==="moveIndex")e.moveValue(t.value,t.newIndex),this._processSeries(t.value);else throw new Error("Unknown IListEvent type")}))}_processSeries(e){e.chart=this,e._placeBulletsContainer(this)}_removeSeries(e){e.isDisposed()||(this.seriesContainer.children.removeValue(e),e._removeBulletsContainer())}}Object.defineProperty(uo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SerialChart"});Object.defineProperty(uo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Bu.classNames.concat([uo.className])});class pl extends Ru{}Object.defineProperty(pl,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tick"});Object.defineProperty(pl,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ru.classNames.concat([pl.className])});class gl extends dr{_afterNew(){super._afterNewApplyThemes(),this._dirty.colors=!1}_beforeChanged(){this.isDirty("colors")&&this.reset()}generateColors(){this.setPrivate("currentPass",this.getPrivate("currentPass",0)+1);const e=this.getPrivate("currentPass"),t=this.get("colors",[this.get("baseColor",Ve.fromHex(16711680))]);this.getPrivate("numColors")||this.setPrivate("numColors",t.length);const i=this.getPrivate("numColors"),n=0,s=this.get("passOptions"),a=this.get("reuse");for(let l=n;l<i;l++)if(a)t.push(t[l]);else{const h=t[l].toHSL();let c=h.h+(s.hue||0)*e;for(;c>1;)c-=1;let p=h.s+(s.saturation||0)*e;p>1&&(p=1),p<0&&(p=0);let g=h.l+(s.lightness||0)*e;for(;g>1;)g-=1;t.push(Ve.fromHSL(c,p,g))}}getIndex(e){const t=this.get("colors",[]),i=this.get("saturation");return e>=t.length?(this.generateColors(),this.getIndex(e)):i!=null?Ve.saturate(t[e],i):t[e]}next(){let e=this.getPrivate("currentStep",this.get("startIndex",0));return this.setPrivate("currentStep",e+this.get("step",1)),this.getIndex(e)}reset(){this.setPrivate("currentStep",this.get("startIndex",0)),this.setPrivate("currentPass",0)}}Object.defineProperty(gl,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColorSet"});Object.defineProperty(gl,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:dr.classNames.concat([gl.className])});class _3 extends Zc{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this._root.language,i=this.rule.bind(this);i("XYChart").setAll({colors:gl.new(this._root,{}),paddingLeft:20,paddingRight:20,paddingTop:16,paddingBottom:16,panX:!1,panY:!1,wheelStep:.25,arrangeTooltips:!0,pinchZoomX:!1,pinchZoomY:!1}),i("XYSeries").setAll({legendLabelText:"{name}"}),i("XYChart",["scrollbar","chart"]).setAll({paddingBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,colors:gl.new(this._root,{saturation:0})});{const h=i("Graphics",["scrollbar","overlay"]);h.setAll({fillOpacity:.5}),Ze(h,"fill",e,"background")}i("RoundedRectangle",["xy","scrollbar","thumb"]).setAll({cornerRadiusTR:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusBL:0,fillOpacity:0,focusable:!0}),i("RoundedRectangle",["xy","scrollbar","thumb"]).states.create("hover",{fillOpacity:.4}),i("RoundedRectangle",["xy","scrollbar","chart","background"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),i("RoundedRectangle",["xy","scrollbar","chart","background","resize","button"]).setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),i("AxisRendererX",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0}),i("AxisRendererY",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0,minGridDistance:5}),i("AxisLabel",["xy","scrollbar","x"]).setAll({opacity:.5,centerY:ze,minPosition:.01,maxPosition:.99,fontSize:"0.8em"}),i("AxisLabel",["category"]).setAll({text:"{category}",populateText:!0}),i("AxisLabel",["x"]).setAll({centerY:0}),i("AxisLabel",["x","inside"]).setAll({centerY:ze}),i("AxisLabel",["x","inside","opposite"]).setAll({centerY:0}),i("AxisLabel",["x","opposite"]).setAll({centerY:ze}),i("AxisLabel",["y"]).setAll({centerX:ze}),i("AxisLabel",["y","inside"]).setAll({centerX:0}),i("AxisLabel",["y","inside","opposite"]).setAll({centerX:ze}),i("AxisLabel",["y","opposite"]).setAll({centerX:0}),i("AxisLabel",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","x"]).setAll({opacity:.5}),i("XYCursor").setAll({behavior:"none",layer:30,exportable:!1,snapToSeriesBy:"xy",moveThreshold:1});{const h=i("Grid",["cursor","x"]);h.setAll({strokeOpacity:.8,strokeDasharray:[2,2],ariaLabel:t.translate("Use left and right arrows to move selection")}),Ze(h,"stroke",e,"alternativeBackground")}{const h=i("Grid",["cursor","y"]);h.setAll({strokeOpacity:.8,strokeDasharray:[2,2],ariaLabel:t.translate("Use up and down arrows to move selection")}),Ze(h,"stroke",e,"alternativeBackground")}{const h=i("Graphics",["cursor","selection"]);h.setAll({fillOpacity:.15}),Ze(h,"fill",e,"alternativeBackground")}i("Axis").setAll({start:0,end:1,minZoomCount:1,maxZoomCount:1/0,maxZoomFactor:1e3,maxDeviation:.1,snapTooltip:!0,tooltipLocation:.5,panX:!0,panY:!0,zoomX:!0,zoomY:!0,fixAxisSize:!0}),i("AxisLabel").setAll({location:.5,multiLocation:0,centerX:ot,centerY:ot,paddingTop:3,paddingBottom:3,paddingLeft:5,paddingRight:5}),i("Container",["axis","header"]).setAll({layer:30}),i("Rectangle",["axis","header","background"]).setAll({crisp:!0});{const h=i("AxisRenderer");h.setAll({crisp:!0,strokeOpacity:0}),Ze(h,"stroke",e,"grid")}i("AxisRendererX").setAll({minGridDistance:120,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,width:ze}),i("AxisRendererY").setAll({minGridDistance:40,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,height:ze});{const h=i("Rectangle",["axis","thumb"]);h.setAll({fillOpacity:0}),Ze(h,"fill",e,"alternativeBackground"),h.states.create("hover",{fillOpacity:.1})}i("Rectangle",["axis","thumb","x"]).setAll({cursorOverStyle:"ew-resize"}),i("Rectangle",["axis","thumb","y"]).setAll({cursorOverStyle:"ns-resize"});{const h=i("Grid");h.setAll({location:0,strokeOpacity:.15,crisp:!0}),Ze(h,"stroke",e,"grid")}i("Grid",["base"]).setAll({strokeOpacity:.3});{const h=i("Graphics",["axis","fill"]);h.setAll({visible:!1,isMeasured:!1,position:"absolute",fillOpacity:.05}),Ze(h,"fill",e,"alternativeBackground")}i("Graphics",["axis","fill","range"]).setAll({isMeasured:!0}),i("Graphics",["series","fill","range"]).setAll({visible:!1,isMeasured:!0}),i("Grid",["series","range"]).setAll({visible:!1}),i("AxisTick",["series","range"]).setAll({visible:!1}),i("AxisLabel",["series","range"]).setAll({visible:!1});{const h=i("AxisTick");h.setAll({location:.5,multiLocation:0,strokeOpacity:1,isMeasured:!1,position:"absolute",visible:!1}),Ze(h,"stroke",e,"grid")}i("CategoryAxis").setAll({startLocation:0,endLocation:1,fillRule:(h,c)=>{const p=h.get("axisFill");p&&(!ve(c)||c%2==0?p.setPrivate("visible",!0):p.setPrivate("visible",!1))}});const n=[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:5},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:50},{timeUnit:"millisecond",count:100},{timeUnit:"millisecond",count:500},{timeUnit:"second",count:1},{timeUnit:"second",count:5},{timeUnit:"second",count:10},{timeUnit:"second",count:30},{timeUnit:"minute",count:1},{timeUnit:"minute",count:5},{timeUnit:"minute",count:10},{timeUnit:"minute",count:15},{timeUnit:"minute",count:30},{timeUnit:"hour",count:1},{timeUnit:"hour",count:3},{timeUnit:"hour",count:6},{timeUnit:"hour",count:12},{timeUnit:"day",count:1},{timeUnit:"day",count:2},{timeUnit:"day",count:3},{timeUnit:"day",count:4},{timeUnit:"day",count:5},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"month",count:2},{timeUnit:"month",count:3},{timeUnit:"month",count:6},{timeUnit:"year",count:1},{timeUnit:"year",count:2},{timeUnit:"year",count:5},{timeUnit:"year",count:10},{timeUnit:"year",count:50},{timeUnit:"year",count:100},{timeUnit:"year",count:200},{timeUnit:"year",count:500},{timeUnit:"year",count:1e3},{timeUnit:"year",count:2e3},{timeUnit:"year",count:5e3},{timeUnit:"year",count:1e4},{timeUnit:"year",count:1e5}],s={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_hour"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month"),year:t.translate("_date_year")},a={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_day"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month")+" "+t.translate("_date_year"),year:t.translate("_date_year")},l={millisecond:t.translate("_date_millisecond_full"),second:t.translate("_date_second_full"),minute:t.translate("_date_minute_full"),hour:t.translate("_date_hour_full"),day:t.translate("_date_day_full"),week:t.translate("_date_week_full"),month:t.translate("_date_month_full"),year:t.translate("_date_year")};i("CategoryDateAxis").setAll({markUnitChange:!0,gridIntervals:fd(n),dateFormats:su(s),periodChangeDateFormats:su(a)}),i("DateAxis").setAll({maxZoomFactor:null,strictMinMax:!0,startLocation:0,endLocation:1,markUnitChange:!0,groupData:!1,groupCount:500,gridIntervals:fd(n),dateFormats:su(s),periodChangeDateFormats:su(a),tooltipDateFormats:l,groupIntervals:[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:100},{timeUnit:"second",count:1},{timeUnit:"second",count:10},{timeUnit:"minute",count:1},{timeUnit:"minute",count:10},{timeUnit:"hour",count:1},{timeUnit:"day",count:1},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"year",count:1}],fillRule:h=>{const c=h.get("axisFill");if(c){const p=h.component,g=h.get("value"),m=h.get("endValue"),_=p.intervalDuration(),b=p.getPrivate("baseInterval"),x=p.getPrivate("gridInterval",b);let w=p.getPrivate("min",0);if(w=xd(new Date(w),x.timeUnit,x.count,this._root.locale.firstDayOfWeek,this._root.utc,void 0,this._root.timezone).getTime(),g!=null&&m!=null){const P=Math.round(Math.round((g-w)/_))/2;P==Math.round(P)?c.setPrivate("visible",!0):c.setPrivate("visible",!1)}}}}),i("GaplessDateAxis").setAll({fillRule:h=>{const c=h.get("axisFill");if(c){const p=h.get("index");let g=!1;(!ve(p)||p%2==0)&&(g=!0),c.setPrivate("visible",g)}}}),i("ValueAxis").setAll({baseValue:0,logarithmic:!1,strictMinMax:!1,autoZoom:!0,fillRule:h=>{const c=h.get("axisFill");if(c){const p=h.component,g=h.get("value"),m=p.getPrivate("step");ve(g)&&ve(m)&&(kr(g/m/2,5)==Math.round(g/m/2)?c.setPrivate("visible",!1):c.setPrivate("visible",!0))}}}),i("DurationAxis").setAll({baseUnit:"second"}),i("XYSeries").setAll({maskBullets:!0,stackToNegative:!0,locationX:.5,locationY:.5,snapTooltip:!1,openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close",seriesTooltipTarget:"series"}),i("BaseColumnSeries").setAll({adjustBulletPosition:!0}),i("ColumnSeries").setAll({clustered:!0}),i("RoundedRectangle",["series","column"]).setAll({position:"absolute",isMeasured:!1,width:ar(70),height:ar(70),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("LineSeries").setAll({connect:!0,autoGapCount:1.1,stackToNegative:!1}),i("Graphics",["series","stroke"]).setAll({position:"absolute",strokeWidth:1,strokeOpacity:1,isMeasured:!1}),i("Graphics",["series","fill"]).setAll({visible:!1,fillOpacity:0,position:"absolute",strokeWidth:0,strokeOpacity:0,isMeasured:!1}),i("Graphics",["line","series","legend","marker","stroke"]).setAll({draw:(h,c)=>{const p=c.parent;if(p){const g=p.height(),m=p.width();h.moveTo(0,g/2),h.lineTo(m,g/2)}}});{const h=i("Graphics",["line","series","legend","marker","stroke"]).states.create("disabled",{});Ze(h,"stroke",e,"disabled")}i("Graphics",["line","series","legend","marker","fill"]).setAll({draw:(h,c)=>{const p=c.parent;if(p){const g=p.height(),m=p.width();h.moveTo(0,0),h.lineTo(m,0),h.lineTo(m,g),h.lineTo(0,g),h.lineTo(0,0)}}});{const h=i("Graphics",["line","series","legend","marker","fill"]).states.create("disabled",{});Ze(h,"stroke",e,"disabled")}i("SmoothedXYLineSeries").setAll({tension:.5}),i("SmoothedXLineSeries").setAll({tension:.5}),i("SmoothedYLineSeries").setAll({tension:.5}),i("Candlestick").setAll({position:"absolute",isMeasured:!1,width:ar(50),height:ar(50),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("OHLC").setAll({width:ar(80),height:ar(80)}),i("CandlestickSeries").setAll({lowValueXGrouped:"low",lowValueYGrouped:"low",highValueXGrouped:"high",highValueYGrouped:"high",openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close"});{const h=i("Rectangle",["column","autocolor"]).states.create("riseFromOpen",{});Ze(h,"fill",e,"positive"),Ze(h,"stroke",e,"positive")}{const h=i("Rectangle",["column","autocolor"]).states.create("dropFromOpen",{});Ze(h,"fill",e,"negative"),Ze(h,"stroke",e,"negative")}i("Rectangle",["column","autocolor","pro"]).states.create("riseFromOpen",{fillOpacity:0}),i("Rectangle",["column","autocolor","pro"]).states.create("dropFromOpen",{fillOpacity:1});{const h=i("Rectangle",["column","autocolor","pro"]).states.create("riseFromPrevious",{});Ze(h,"fill",e,"positive"),Ze(h,"stroke",e,"positive")}{const h=i("Rectangle",["column","autocolor","pro"]).states.create("dropFromPrevious",{});Ze(h,"fill",e,"negative"),Ze(h,"stroke",e,"negative")}}}class Nu extends uo{constructor(){super(...arguments),Object.defineProperty(this,"xAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Pc}),Object.defineProperty(this,"yAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Pc}),Object.defineProperty(this,"topAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Qe.new(this._root,{width:ze,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"yAxesAndPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Qe.new(this._root,{width:ze,height:ze,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"bottomAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(Qe.new(this._root,{width:ze,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"leftAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Qe.new(this._root,{height:ze,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"plotsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Qe.new(this._root,{width:ze,height:ze,maskContent:!1}))}),Object.defineProperty(this,"plotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(Qe.new(this._root,{width:ze,height:ze}))}),Object.defineProperty(this,"topPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(Qe.new(this._root,{width:ze,height:ze}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(Qe.new(this._root,{width:ze,height:ze,isMeasured:!1}))}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{width:ze,height:ze,isMeasured:!1})}),Object.defineProperty(this,"rightAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(Qe.new(this._root,{height:ze,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"axisHeadersContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(Qe.new(this._root,{}))}),Object.defineProperty(this,"zoomOutButton",{enumerable:!0,configurable:!0,writable:!0,value:this.topPlotContainer.children.push(Sc.new(this._root,{themeTags:["zoom"],icon:wi.new(this._root,{themeTags:["button","icon"]})}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_wheelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_otherCharts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_movePoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_downStartX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStartY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._defaultThemes.push(_3.new(this._root)),super._afterNew(),this._disposers.push(this.xAxes),this._disposers.push(this.yAxes);const e=this._root;let t=this._root.verticalLayout;const i=this.zoomOutButton;i.events.on("click",()=>{this.zoomOut()}),i.set("opacity",0),i.states.lookup("default").set("opacity",1),this.chartContainer.set("layout",t);const n=this.plotContainer;n.children.push(this.seriesContainer),this._disposers.push(this._processAxis(this.xAxes,this.bottomAxesContainer)),this._disposers.push(this._processAxis(this.yAxes,this.leftAxesContainer)),n.children.push(this.topGridContainer),n.children.push(this.bulletsContainer),n.set("interactive",!0),n.set("interactiveChildren",!1),n.set("background",Tn.new(e,{themeTags:["xy","background"],fill:Ve.fromHex(0),fillOpacity:0})),this._disposers.push(n.events.on("pointerdown",s=>{this._handlePlotDown(s.originalEvent)})),this._disposers.push(n.events.on("globalpointerup",s=>{this._handlePlotUp(s.originalEvent)})),this._disposers.push(n.events.on("globalpointermove",s=>{this._handlePlotMove(s.originalEvent)})),this._maskGrid(),this._setUpTouch()}_beforeChanged(){super._beforeChanged(),(this.isDirty("pinchZoomX")||this.isDirty("pinchZoomY")||this.get("panX")||this.get("panY"))&&this._setUpTouch()}_setUpTouch(){this.plotContainer._display.cancelTouch||(this.plotContainer._display.cancelTouch=!!(this.get("pinchZoomX")||this.get("pinchZoomY")||this.get("panX")||this.get("panY")))}_maskGrid(){this.gridContainer.set("maskContent",!0),this.topGridContainer.set("maskContent",!0)}_removeSeries(e){e._unstack(),e._posXDp&&e._posXDp.dispose(),e._posYDp&&e._posYDp.dispose(),e.set("baseAxis",void 0);const t=e.get("xAxis");t&&(yn(t.series,e),t.markDirtyExtremes());const i=e.get("yAxis");i&&(yn(i.series,e),i.markDirtyExtremes());const n=this.get("cursor");if(n){const s=n.get("snapToSeries");s&&yn(s,e)}super._removeSeries(e)}handleWheel(e){const t=this.get("wheelX"),i=this.get("wheelY"),n=this.plotContainer,s=e.originalEvent;if(Ov(s,this))s.preventDefault();else return;const a=n.toLocal(this._root.documentPointToRoot({x:s.clientX,y:s.clientY})),l=this.get("wheelStep",.2),h=s.deltaY/100,c=s.deltaX/100,p=this.get("wheelZoomPositionX"),g=this.get("wheelZoomPositionY");(t==="zoomX"||t==="zoomXY")&&c!=0&&this.xAxes.each(m=>{if(m.get("zoomX")){let _=m.get("start"),b=m.get("end"),x=m.fixPosition(a.x/n.width());p!=null&&(x=p);let w=_-l*(b-_)*c*x,P=b+l*(b-_)*c*(1-x);1/(P-w)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(w,P))}}),(i==="zoomX"||i==="zoomXY")&&h!=0&&this.xAxes.each(m=>{if(m.get("zoomX")){let _=m.get("start"),b=m.get("end"),x=m.fixPosition(a.x/n.width());p!=null&&(x=p);let w=_-l*(b-_)*h*x,P=b+l*(b-_)*h*(1-x);1/(P-w)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(w,P))}}),(t==="zoomY"||t==="zoomXY")&&c!=0&&this.yAxes.each(m=>{if(m.get("zoomY")){let _=m.get("start"),b=m.get("end"),x=m.fixPosition(a.y/n.height());g!=null&&(x=g);let w=_-l*(b-_)*c*x,P=b+l*(b-_)*c*(1-x);1/(P-w)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(w,P))}}),(i==="zoomY"||i==="zoomXY")&&h!=0&&this.yAxes.each(m=>{if(m.get("zoomY")){let _=m.get("start"),b=m.get("end"),x=m.fixPosition(a.y/n.height());g!=null&&(x=g);let w=_-l*(b-_)*h*x,P=b+l*(b-_)*h*(1-x);1/(P-w)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(w,P))}}),(t==="panX"||t==="panXY")&&c!=0&&this.xAxes.each(m=>{if(m.get("panX")){let _=m.get("start"),b=m.get("end"),x=this._getWheelSign(m)*l*(b-_)*c,w=_+x,P=b+x,E=this._fixWheel(w,P);w=E[0],P=E[1],this._handleWheelAnimation(m.zoom(w,P))}}),(i==="panX"||i==="panXY")&&h!=0&&this.xAxes.each(m=>{if(m.get("panX")){let _=m.get("start"),b=m.get("end"),x=this._getWheelSign(m)*l*(b-_)*h,w=_+x,P=b+x,E=this._fixWheel(w,P);w=E[0],P=E[1],this._handleWheelAnimation(m.zoom(w,P))}}),(t==="panY"||t==="panXY")&&c!=0&&this.yAxes.each(m=>{if(m.get("panY")){let _=m.get("start"),b=m.get("end"),x=this._getWheelSign(m)*l*(b-_)*c,w=_+x,P=b+x,E=this._fixWheel(w,P);w=E[0],P=E[1],this._handleWheelAnimation(m.zoom(w,P))}}),(i==="panY"||i==="panXY")&&h!=0&&this.yAxes.each(m=>{if(m.get("panY")){let _=m.get("start"),b=m.get("end"),x=this._getWheelSign(m)*l*(b-_)*h,w=_-x,P=b-x,E=this._fixWheel(w,P);w=E[0],P=E[1],this._handleWheelAnimation(m.zoom(w,P))}})}_handleSetWheel(){const e=this.get("wheelX"),t=this.get("wheelY"),i=this.plotContainer;e!=="none"||t!=="none"?(this._wheelDp=i.events.on("wheel",n=>{this.handleWheel(n)}),this._disposers.push(this._wheelDp)):this._wheelDp&&this._wheelDp.dispose()}_getWheelSign(e){let t=1;return e.get("renderer").get("inversed")&&(t=-1),t}_fixWheel(e,t){const i=t-e;return e<0&&(e=0,t=e+i),t>1&&(t=1,e=t-i),[e,t]}_handlePlotDown(e){if(e.button==2)return;const t=this.plotContainer;let i=t.toLocal(this._root.documentPointToRoot({x:e.clientX,y:e.clientY}));if((this.get("pinchZoomX")||this.get("pinchZoomY"))&&e.pointerId&&Li(t._downPoints).length>0){const a=this.xAxes.getIndex(0),l=this.yAxes.getIndex(0);a&&(this._downStartX=a.get("start",0),this._downEndX=a.get("end",1)),l&&(this._downStartY=l.get("start",0),this._downEndY=l.get("end",1))}if((this.get("panX")||this.get("panY"))&&i.x>=0&&i.y>=0&&i.x<=t.width()&&i.y<=this.height()){this._downPoint={x:e.clientX,y:e.clientY};const n=this.get("panX"),s=this.get("panY");n&&this.xAxes.each(l=>{l._panStart=l.get("start"),l._panEnd=l.get("end")}),s&&this.yAxes.each(l=>{l._panStart=l.get("start"),l._panEnd=l.get("end")});const a="panstarted";this.events.isEnabled(a)&&this.events.dispatch(a,{type:a,target:this,originalEvent:e})}}_handleWheelAnimation(e){e?e.events.on("stopped",()=>{this._dispatchWheelAnimation()}):this._dispatchWheelAnimation()}_dispatchWheelAnimation(){const e="wheelended";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}_handlePlotUp(e){const t=this._downPoint;if(t&&(this.get("panX")||this.get("panY"))){let i=this.plotContainer.toLocal(this._root.documentPointToRoot({x:e.clientX,y:e.clientY}));if(i.x==t.x&&i.y==t.y){const s="pancancelled";this.events.isEnabled(s)&&this.events.dispatch(s,{type:s,target:this,originalEvent:e})}const n="panended";this.events.isEnabled(n)&&this.events.dispatch(n,{type:n,target:this,originalEvent:e})}this._downPoint=void 0,this.xAxes.each(i=>{i._isPanning=!1}),this.yAxes.each(i=>{i._isPanning=!1})}_handlePlotMove(e){const t=this.plotContainer;if(this.get("pinchZoomX")||this.get("pinchZoomY")){const s=e.pointerId;if(s&&(this._movePoints[s]=this._root.documentPointToRoot({x:e.clientX,y:e.clientY}),Li(t._downPoints).length>1)){this._handlePinch();return}}let i=this._downPoint;if(i){i=t.toLocal(this._root.documentPointToRoot(i));let n=t.toLocal(this._root.documentPointToRoot({x:e.clientX,y:e.clientY}));const s=this.get("panX"),a=this.get("panY");if(s){let l=this.get("scrollbarX");l&&l.events.disableType("rangechanged"),this.xAxes.each(h=>{if(h.get("panX")){h._isPanning=!0;let c=h._panStart,p=h._panEnd,m=(p-c)*(i.x-n.x)/t.width();h.get("renderer").get("inversed")&&(m*=-1);let _=c+m,b=p+m;b-_<1+h.get("maxDeviation",1)*2&&(h.set("start",_),h.set("end",b))}}),l&&l.events.enableType("rangechanged")}if(a){let l=this.get("scrollbarY");l&&l.events.disableType("rangechanged"),this.yAxes.each(h=>{if(h.get("panY")){h._isPanning=!0;let c=h._panStart,p=h._panEnd,m=(p-c)*(i.y-n.y)/t.height();h.get("renderer").get("inversed")&&(m*=-1);let _=c-m,b=p-m;b-_<1+h.get("maxDeviation",1)*2&&(h.set("start",_),h.set("end",b))}}),l&&l.events.enableType("rangechanged")}}}_handlePinch(){const e=this.plotContainer;let t=0,i=[],n=[];if(Zt(e._downPoints,(s,a)=>{i[t]=a;let l=this._movePoints[s];l&&(n[t]=l),t++}),i.length>1&&n.length>1){const s=e.width(),a=e.height();let l=i[0],h=i[1],c=n[0],p=n[1];if(l&&h&&c&&p){if(c=e.toLocal(c),p=e.toLocal(p),l=e.toLocal(l),h=e.toLocal(h),this.get("pinchZoomX")){const g=this._downStartX,m=this._downEndX;if(g!=null&&m!=null){l.x>h.x&&([l,h]=[h,l],[c,p]=[p,c]);let _=g+l.x/s*(m-g),b=g+h.x/s*(m-g),x=g+c.x/s*(m-g),w=g+p.x/s*(m-g),P=Math.max(.001,b-_),E=Math.max(.001,w-x),k=P/E,C=g*k+_-x*k,O=m*k+b-w*k;this.xAxes.each(F=>{let D=F.fixPosition(C),N=F.fixPosition(O);F.zoom(D,N,0)})}}if(this.get("pinchZoomY")){const g=this._downStartY,m=this._downEndY;if(g!=null&&m!=null){l.y<h.y&&([l,h]=[h,l],[c,p]=[p,c]);let _=g+(1-l.y/a)*(m-g),b=g+(1-h.y/a)*(m-g),x=g+(1-c.y/a)*(m-g),w=g+(1-p.y/a)*(m-g),P=Math.max(.001,b-_),E=Math.max(.001,w-x),k=P/E,C=g*k+_-x*k,O=m*k+b-w*k;this.yAxes.each(F=>{let D=F.fixPosition(C),N=F.fixPosition(O);F.zoom(D,N,0)})}}}}}_handleCursorPosition(){const e=this.get("cursor");if(e){const t=e.getPrivate("point");let i=e.get("snapToSeries");if(e._downPoint&&(i=void 0),i&&t){const n=e.get("snapToSeriesBy"),s=[];ce(i,h=>{if(!h.isHidden()&&!h.isHiding())if(n!="x!"&&n!="y!"){const c=h.startIndex(),p=h.endIndex();for(let g=c;g<p;g++){const m=h.dataItems[g];m&&!m.isHidden()&&s.push(m)}}else{const c=h.get("tooltipDataItem");c&&s.push(c)}});let a=1/0,l;if(ce(s,h=>{const c=h.get("point");if(c){let p=0;n=="x"||n=="x!"?p=Math.abs(t.x-c.x):n=="y"||n=="y!"?p=Math.abs(t.y-c.y):p=Math.hypot(t.x-c.x,t.y-c.y),p<a&&(a=p,l=h)}}),ce(i,h=>{const c=h.get("tooltip");c&&c._setDataItem(void 0)}),l){let h=l.component;h.showDataItemTooltip(l);const c=l.get("point");c&&e.handleMove(h.toGlobal({x:c.x-h.x(),y:c.y-h.y()}),!0)}}}}_updateCursor(){let e=this.get("cursor");e&&e.handleMove()}_addCursor(e){this.plotContainer.children.push(e)}_prepareChildren(){if(super._prepareChildren(),this.series.each(e=>{this._colorize(e)}),(this.isDirty("wheelX")||this.isDirty("wheelY"))&&this._handleSetWheel(),this.isDirty("cursor")){const e=this._prevSettings.cursor,t=this.get("cursor");t!==e&&(this._disposeProperty("cursor"),e&&e.dispose(),t&&(t._setChart(this),this._addCursor(t),this._pushPropertyDisposer("cursor",t.events.on("selectended",()=>{this._handleCursorSelectEnd()}))),this._prevSettings.cursor=t)}if(this.isDirty("scrollbarX")){const e=this._prevSettings.scrollbarX,t=this.get("scrollbarX");t!==e&&(this._disposeProperty("scrollbarX"),e&&e.dispose(),t&&(t.parent||this.topAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarX",t.events.on("rangechanged",i=>{this._handleScrollbar(this.xAxes,i.start,i.end,i.grip)})),t.setPrivate("positionTextFunction",i=>{const n=this.xAxes.getIndex(0);return n&&n.getTooltipText(i)||""})),this._prevSettings.scrollbarX=t)}if(this.isDirty("scrollbarY")){const e=this._prevSettings.scrollbarY,t=this.get("scrollbarY");t!==e&&(this._disposeProperty("scrollbarY"),e&&e.dispose(),t&&(t.parent||this.rightAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarY",t.events.on("rangechanged",i=>{this._handleScrollbar(this.yAxes,i.start,i.end,i.grip)})),t.setPrivate("positionTextFunction",i=>{const n=this.yAxes.getIndex(0);return n&&n.getTooltipText(i)||""})),this._prevSettings.scrollbarY=t)}this._handleZoomOut()}_processSeries(e){super._processSeries(e);const t=e.get("xAxis"),i=e.get("yAxis");Tm(t.series,e),Tm(i.series,e),e._posXDp=e.addDisposer(t.events.on("positionchanged",()=>{e._fixPosition()})),e._posXDp=e.addDisposer(i.events.on("positionchanged",()=>{e._fixPosition()})),e.get("baseAxis")||(i.isType("CategoryAxis")||i.isType("DateAxis")?e.set("baseAxis",i):e.set("baseAxis",t)),e.get("stacked")&&(e._markDirtyKey("stacked"),ce(e.dataItems,n=>{n.set("stackToItemY",void 0),n.set("stackToItemX",void 0)})),e._markDirtyAxes(),i.markDirtyExtremes(),t.markDirtyExtremes(),this._colorize(e)}_colorize(e){const t=this.get("colors");if(t&&e.get("fill")==null){const i=t.next();e._setSoft("stroke",i),e._setSoft("fill",i)}}_handleCursorSelectEnd(){const e=this.get("cursor"),t=e.get("behavior"),i=e.getPrivate("downPositionX",0),n=e.getPrivate("downPositionY",0),s=e.getPrivate("positionX",.5),a=e.getPrivate("positionY",.5);this.xAxes.each(l=>{if(t==="zoomX"||t==="zoomXY"){let h=l.toAxisPosition(i),c=l.toAxisPosition(s);l.zoom(h,c)}l.setPrivate("updateScrollbar",!0)}),this.yAxes.each(l=>{if(t==="zoomY"||t==="zoomXY"){let h=l.toAxisPosition(n),c=l.toAxisPosition(a);l.zoom(h,c)}l.setPrivate("updateScrollbar",!0)})}_handleScrollbar(e,t,i,n){e.each(s=>{let a=s.fixPosition(t),l=s.fixPosition(i),h=s.zoom(a,l,void 0,n);const c="updateScrollbar";s.setPrivateRaw(c,!1),h?h.events.on("stopped",()=>{s.setPrivateRaw(c,!0)}):s.setPrivateRaw(c,!0)})}_processAxis(e,t){return e.events.onAll(i=>{if(i.type==="clear")ce(i.oldValues,n=>{this._removeAxis(n)});else if(i.type==="push")t.children.push(i.newValue),i.newValue.processChart(this);else if(i.type==="setIndex")t.children.setIndex(i.index,i.newValue),i.newValue.processChart(this);else if(i.type==="insertIndex")t.children.insertIndex(i.index,i.newValue),i.newValue.processChart(this);else if(i.type==="removeIndex")this._removeAxis(i.oldValue);else if(i.type==="moveIndex")t.children.moveValue(i.value,i.newIndex),i.value.processChart(this);else throw new Error("Unknown IListEvent type")})}_removeAxis(e){if(!e.isDisposed()){const t=e.parent;t&&t.children.removeValue(e);const i=e.gridContainer,n=i.parent;n&&n.children.removeValue(i);const s=e.topGridContainer,a=s.parent;a&&a.children.removeValue(s)}}_updateChartLayout(){const e=this.leftAxesContainer.width(),t=this.rightAxesContainer.width(),i=this.bottomAxesContainer;i.set("paddingLeft",e),i.set("paddingRight",t);const n=this.topAxesContainer;n.set("paddingLeft",e),n.set("paddingRight",t)}processAxis(e){}_handleAxisSelection(e,t){let i=e.fixPosition(e.get("start",0)),n=e.fixPosition(e.get("end",1));if(i>n&&([i,n]=[n,i]),this.xAxes.indexOf(e)!=-1){if(t||e.getPrivate("updateScrollbar")){let s=this.get("scrollbarX");s&&(!s.getPrivate("isBusy")||t)&&(s.setRaw("start",i),s.setRaw("end",n),s.updateGrips())}}else if(this.yAxes.indexOf(e)!=-1&&(t||e.getPrivate("updateScrollbar"))){let s=this.get("scrollbarY");s&&(!s.getPrivate("isBusy")||t)&&(s.setRaw("start",i),s.setRaw("end",n),s.updateGrips())}this._handleZoomOut()}_handleZoomOut(){let e=this.zoomOutButton;if(e&&e.parent){let t=!1;this.xAxes.each(i=>{(i.get("start")!=0||i.get("end")!=1)&&(t=!0)}),this.yAxes.each(i=>{(i.get("start")!=0||i.get("end")!=1)&&(t=!0)}),t?e.isHidden()&&e.show():e.hide()}}inPlot(e){const t=this.plotContainer,i=this.getPrivate("otherCharts",this._otherCharts),n=t.toGlobal(e);if(e.x>=-.5&&e.y>=-.5&&e.x<=t.width()+.5&&e.y<=t.height()+.5)return!0;if(i)for(let s=i.length-1;s>=0;s--){const a=i[s];if(a!=this){const l=a.plotContainer,h=this._root.rootPointToDocument(n),c=a._root.documentPointToRoot(h),p=l.toLocal(c);if(p.x>=-.1&&p.y>=-.1&&p.x<=l.width()+.1&&p.y<=l.height()+.1)return!0}}return!1}arrangeTooltips(){const e=this.plotContainer,t=e.width(),i=e.height(),n=this.height();let s=e._display.toGlobal({x:0,y:0}),a=e._display.toGlobal({x:t,y:i});const l=[];let h=0,c=1/0,p=this._movePoint,g=this.get("maxTooltipDistance"),m=this.get("maxTooltipDistanceBy","xy"),_,b;ve(g)&&this.series.each(w=>{if(!w.isHidden()){const P=w.get("tooltip");if(P){let E=P.get("pointTo");if(E){let k=Math.hypot(p.x-E.x,p.y-E.y);m=="x"?k=Math.abs(p.x-E.x):m=="y"&&(k=Math.abs(p.y-E.y)),k<c&&(c=k,_=w,b=E)}}}});const x=[];if(this.series.each(w=>{const P=w.get("tooltip");if(P){let E=!1,k=P.get("pointTo");if(k){if(g>=0){let C=P.get("pointTo");if(C&&w!=_){let O=Math.hypot(b.x-C.x,b.y-C.y);m=="x"?O=Math.abs(b.x-C.x):m=="y"&&(O=Math.abs(b.y-C.y)),O>g&&(E=!0)}}else g==-1&&w!=_&&(E=!0);!this.inPlot(this._tooltipToLocal(k))||!P.dataItem?E=!0:E||(h+=k.y),E||w.isHidden()||w.isHiding()?P.hide(0):(P.show(),l.push(P),x.push(w))}}}),this.setPrivate("tooltipSeries",x),this.get("arrangeTooltips")){const w=this._root.tooltipContainer,P=l.length;if(h/P>i/2+s.y){l.sort((C,O)=>Lm(O.get("pointTo").y,C.get("pointTo").y));let k=a.y;if(ce(l,C=>{let O=C.height(),F=C.get("centerY");F instanceof gt&&(O*=F.value),O+=C.get("marginBottom",0),C.set("bounds",{left:s.x,top:s.y,right:a.x,bottom:k}),C.setPrivate("customData",{left:s.x,top:s.y,right:a.x,bottom:k}),k=Math.min(k-O,C._fy-O),C.parent==w&&w.children.moveValue(C,0)}),k<0){l.reverse();let C=k;ce(l,O=>{let F=O.get("bounds");if(F){let D=F.top-k,N=F.bottom-k;D<C&&(D=C,N=D+O.height()),O.set("bounds",{left:F.left,top:D,right:F.right,bottom:N}),C=F.bottom-k+O.get("marginBottom",0)}})}}else{l.reverse(),l.sort((C,O)=>Lm(C.get("pointTo").y,O.get("pointTo").y));let k=0;if(ce(l,C=>{let O=C.height(),F=C.get("centerY");F instanceof gt&&(O*=F.value),O+=C.get("marginBottom",0),C.set("bounds",{left:s.x,top:k,right:a.x,bottom:Math.max(s.y+n,k+O)}),C.parent==w&&w.children.moveValue(C,0),k=Math.max(k+O,C._fy+O)}),k>n){l.reverse();let C=n;ce(l,O=>{let F=O.get("bounds");if(F){let D=F.top-(n-k),N=F.bottom-(n-k);N>C&&(N=C,D=N-O.height()),O.set("bounds",{left:F.left,top:D,right:F.right,bottom:N}),C=N-O.height()-O.get("marginBottom",0)}})}}}}_tooltipToLocal(e){return this.plotContainer.toLocal(e)}zoomOut(){this.xAxes.each(e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)}),this.yAxes.each(e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)})}}Object.defineProperty(Nu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYChart"});Object.defineProperty(Nu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:uo.classNames.concat([Nu.className])});class _l extends wi{_beforeChanged(){super._beforeChanged(),(this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}}Object.defineProperty(_l,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Grid"});Object.defineProperty(_l,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([_l.className])});class Hu extends Qe{constructor(){super(...arguments),Object.defineProperty(this,"lineX",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(_l.new(this._root,{themeTags:["x"]}))}),Object.defineProperty(this,"lineY",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(_l.new(this._root,{themeTags:["y"]}))}),Object.defineProperty(this,"selection",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(wi.new(this._root,{themeTags:["selection","cursor"],layer:30}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lastPoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_tooltipX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_tooltipY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["xy","cursor"]),super._afterNew(),this.setAll({width:ze,height:ze,isMeasured:!0,position:"absolute"}),this.states.create("hidden",{visible:!0,opacity:0}),this._drawLines(),this.setPrivateRaw("visible",!1),this._disposers.push(this.setTimeout(()=>{this.setPrivate("visible",!0)},500)),this._disposers.push(this.lineX.events.on("positionchanged",()=>{this._handleXLine()})),this._disposers.push(this.lineY.events.on("positionchanged",()=>{this._handleYLine()})),this._disposers.push(this.lineX.events.on("focus",e=>this._handleLineFocus(e.target))),this._disposers.push(this.lineX.events.on("blur",e=>this._handleLineBlur(e.target))),this._disposers.push(this.lineY.events.on("focus",e=>this._handleLineFocus(e.target))),this._disposers.push(this.lineY.events.on("blur",e=>this._handleLineBlur(e.target))),Ns("keyboardevents")&&this._disposers.push(fi(document,"keydown",e=>{this._handleLineMove(e.keyCode)}))}_setUpTouch(){const e=this.chart;e&&(e.plotContainer._display.cancelTouch=this.get("behavior")!="none")}_handleXLine(){let e=this.lineX.x(),t=!0;(e<0||e>this.width())&&(t=!1),this.lineX.setPrivate("visible",t)}_handleYLine(){let e=this.lineY.y(),t=!0;(e<0||e>this.height())&&(t=!1),this.lineY.setPrivate("visible",t)}_handleLineMove(e){let t="",i=0,n=.1;const s=this.chart;this._root.focused(this.lineX)?(s&&s.xAxes.length&&(n=s.xAxes.getIndex(0).getCellWidthPosition()),i=this.getPrivate("positionX",0),t="positionX",e==37?i-=n:e==39&&(i+=n)):this._root.focused(this.lineY)&&(s&&s.yAxes.length&&(n=s.yAxes.getIndex(0).getCellWidthPosition()),i=this.getPrivate("positionY",0),t="positionY",e==38?i-=n:e==40&&(i+=n)),i<0?i=0:i>1&&(i=1),t!=""&&this.set(t,i)}_handleLineFocus(e){this.setAll({positionX:this.getPrivate("positionX"),positionY:this.getPrivate("positionY"),alwaysShow:!0})}_handleLineBlur(e){this.setAll({positionX:void 0,positionY:void 0,alwaysShow:!1})}_prepareChildren(){if(super._prepareChildren(),this.isDirty("xAxis")){this._tooltipX=!1;const e=this.get("xAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipX=!0,this._disposers.push(t.on("pointTo",()=>{this._updateXLine(t)})))}}if(this.isDirty("yAxis")){this._tooltipY=!1;const e=this.get("yAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipY=!0,this._disposers.push(t.on("pointTo",()=>{this._updateYLine(t)})))}}}_handleSyncWith(){const e=this.chart;if(e){const t=this.get("syncWith"),i=[];t&&ce(t,n=>{const s=n.chart;s&&i.push(s)}),e._otherCharts=i}}_updateChildren(){if(super._updateChildren(),this._handleSyncWith(),this.isDirty("positionX")||this.isDirty("positionY")){const e=this.get("positionX"),t=this.get("positionY");e==null&&t==null?this.hide(0):(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0))),this.handleMove())}}_updateXLine(e){let t=kr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).x,2);this._toX!=t&&(this.lineX.animate({key:"x",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toX=t)}_updateYLine(e){let t=kr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).y,2);this._toY!=t&&(this.lineY.animate({key:"y",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toY=t)}_drawLines(){this.lineX.set("draw",e=>{e.moveTo(0,0),e.lineTo(0,this.height())}),this.lineY.set("draw",e=>{e.moveTo(0,0),e.lineTo(this.width(),0)})}_setChart(e){this.chart=e,this._handleSyncWith();const t=e.plotContainer;this.events.on("boundschanged",()=>{this._disposers.push(this.setTimeout(()=>{this.get("alwaysShow")&&(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0))),this.handleMove())},50))}),Ns("touchevents")&&(this._disposers.push(t.events.on("click",n=>{gd(n.originalEvent)&&this._handleMove(n.originalEvent)})),this._setUpTouch()),this._disposers.push(t.events.on("pointerdown",n=>{this._handleCursorDown(n.originalEvent)})),this._disposers.push(t.events.on("globalpointerup",n=>{this._handleCursorUp(n.originalEvent),!n.native&&!this.isHidden()&&this._handleMove(n.originalEvent)})),this._disposers.push(t.events.on("globalpointermove",n=>{!this.get("syncWith")&&Li(t._downPoints).length==0&&!n.native&&this.isHidden()||this._handleMove(n.originalEvent)}));const i=this.parent;i&&i.children.moveValue(this.selection)}_inPlot(e){const t=this.chart;return t?t.inPlot(e):!1}_handleCursorDown(e){if(e.button==2)return;const t=this._root.documentPointToRoot({x:e.clientX,y:e.clientY});let i=this._display.toLocal(t);const n=this.chart;if(this.selection.set("draw",()=>{}),n&&this._inPlot(i)){if(this._downPoint=i,this.get("behavior")!="none"){this.selection.show();const l="selectstarted";this.events.isEnabled(l)&&this.events.dispatch(l,{type:l,target:this})}let s=this._getPosition(i).x,a=this._getPosition(i).y;this.setPrivate("downPositionX",s),this.setPrivate("downPositionY",a)}}_handleCursorUp(e){if(this._downPoint){const t=this.get("behavior","none");if(t!="none"){t.charAt(0)==="z"&&this.selection.hide();const i=this._root.documentPointToRoot({x:e.clientX,y:e.clientY});let n=this._display.toLocal(i);const s=this._downPoint,a=this.get("moveThreshold",1);if(n&&s){let l=!1;if((t==="zoomX"||t==="zoomXY"||t==="selectX"||t==="selectXY")&&Math.abs(n.x-s.x)>a&&(l=!0),(t==="zoomY"||t==="zoomXY"||t==="selectY"||t==="selectXY")&&Math.abs(n.y-s.y)>a&&(l=!0),l){const h="selectended";this.events.isEnabled(h)&&this.events.dispatch(h,{type:h,target:this})}}}}this._downPoint=void 0}_handleMove(e){if(this.getPrivate("visible")){const t=this.chart;if(t&&Li(t.plotContainer._downPoints).length>1){this.set("forceHidden",!0);return}else this.set("forceHidden",!1);const i=this._root.documentPointToRoot({x:e.clientX,y:e.clientY}),n=this._lastPoint;if(Math.round(n.x)===Math.round(i.x)&&Math.round(n.y)===Math.round(i.y))return;this._lastPoint=i,this.setPrivate("lastPoint",i),this.handleMove({x:i.x,y:i.y})}}_getPosition(e){return{x:e.x/this.width(),y:e.y/this.height()}}handleMove(e,t){e||(e=this._movePoint);const i=this.get("alwaysShow");if(!e){this.hide(0);return}this._movePoint=e;let n=this._display.toLocal(e),s=this.chart;if(s&&(this._inPlot(n)||this._downPoint)){s._movePoint=e,this.isHidden()&&(this.show(),this.get("behavior","").charAt(0)=="z"&&this.selection.set("draw",()=>{}));let a=n.x,l=n.y,h=this._getPosition(n);this.setPrivate("point",n);let c=this.get("snapToSeries");this._downPoint&&(c=void 0);let p=this.get("positionX"),g=h.x;ve(p)&&(g=p);let m=this.get("positionY"),_=h.y;ve(m)&&(_=m),this.setPrivate("positionX",g),this.setPrivate("positionY",_);const b=this._getPoint(g,_);if(a=b.x,l=b.y,s.xAxes.each(x=>{x._handleCursorPosition(g,c),i&&x.handleCursorShow()}),s.yAxes.each(x=>{x._handleCursorPosition(_,c),i&&x.handleCursorShow()}),!t){s._handleCursorPosition();const x="cursormoved";this.events.isEnabled(x)&&this.events.dispatch(x,{type:x,target:this})}this._updateLines(a,l),s.arrangeTooltips()}else if(!this._downPoint&&!i){this.hide(0);const a="cursorhidden";this.events.isEnabled(a)&&this.events.dispatch(a,{type:a,target:this})}this._downPoint&&this.get("behavior")!="none"&&this._updateSelection(n)}_getPoint(e,t){return{x:this.width()*e,y:this.height()*t}}_updateLines(e,t){this._tooltipX||this.lineX.set("x",e),this._tooltipY||this.lineY.set("y",t),this._drawLines()}_updateSelection(e){const t=this.selection,i=this.get("behavior"),n=this.width(),s=this.height();e.x<0&&(e.x=0),e.x>n&&(e.x=n),e.y<0&&(e.y=0),e.y>s&&(e.y=s),t.set("draw",a=>{const l=this._downPoint;l&&(i==="zoomXY"||i==="selectXY"?(a.moveTo(l.x,l.y),a.lineTo(l.x,e.y),a.lineTo(e.x,e.y),a.lineTo(e.x,l.y),a.lineTo(l.x,l.y)):i==="zoomX"||i==="selectX"?(a.moveTo(l.x,0),a.lineTo(l.x,s),a.lineTo(e.x,s),a.lineTo(e.x,0),a.lineTo(l.x,0)):(i==="zoomY"||i==="selectY")&&(a.moveTo(0,l.y),a.lineTo(n,l.y),a.lineTo(n,e.y),a.lineTo(0,e.y),a.lineTo(0,l.y)))})}_onHide(){if(this.isHidden()){let e=this.chart;e&&(e.xAxes.each(t=>{t.handleCursorHide()}),e.yAxes.each(t=>{t.handleCursorHide()}),e.series.each(t=>{t.handleCursorHide()}))}super._onHide()}_onShow(){if(!this.isHidden()){let e=this.chart;e&&(e.xAxes.each(t=>{t.handleCursorShow()}),e.yAxes.each(t=>{t.handleCursorShow()}))}super._onShow()}_dispose(){super._dispose(),this.selection.dispose()}}Object.defineProperty(Hu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYCursor"});Object.defineProperty(Hu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Qe.classNames.concat([Hu.className])});function m3(r,e){return r==null?e:e==null?r:e<r?e:r}function x3(r,e){return r==null?e:e==null?r:e>r?e:r}class zu extends js{constructor(){super(...arguments),Object.defineProperty(this,"_xField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_axesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_stackDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataSets",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_mainContainerMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"mainContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{}))}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Tl}),Object.defineProperty(this,"_skipped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_couldStackTo",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_reallyStackedTo",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_stackedSeries",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_aLocationX0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationX1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_aLocationY0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationY1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_showBullets",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueX","openValueX","lowValueX","highValueX"]}),Object.defineProperty(this,"valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueY","openValueY","lowValueY","highValueY"]}),Object.defineProperty(this,"_valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_emptyDataItem",{enumerable:!0,configurable:!0,writable:!0,value:new ll(this,void 0,{})}),Object.defineProperty(this,"_dataSetId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posXDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posYDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this.fields.push("categoryX","categoryY","openCategoryX","openCategoryY"),this.valueFields.push("valueX","valueY","openValueX","openValueY","lowValueX","lowValueY","highValueX","highValueY"),this._setRawDefault("vcx",1),this._setRawDefault("vcy",1),this._setRawDefault("valueXShow","valueXWorking"),this._setRawDefault("valueYShow","valueYWorking"),this._setRawDefault("openValueXShow","openValueXWorking"),this._setRawDefault("openValueYShow","openValueYWorking"),this._setRawDefault("lowValueXShow","lowValueXWorking"),this._setRawDefault("lowValueYShow","lowValueYWorking"),this._setRawDefault("highValueXShow","highValueXWorking"),this._setRawDefault("highValueYShow","highValueYWorking"),this._setRawDefault("lowValueXGrouped","low"),this._setRawDefault("lowValueYGrouped","low"),this._setRawDefault("highValueXGrouped","high"),this._setRawDefault("highValueYGrouped","high"),super._afterNew(),this.set("maskContent",!0),this._disposers.push(this.axisRanges.events.onAll(e=>{if(e.type==="clear")ce(e.oldValues,t=>{this._removeAxisRange(t)});else if(e.type==="push")this._processAxisRange(e.newValue);else if(e.type==="setIndex")this._processAxisRange(e.newValue);else if(e.type==="insertIndex")this._processAxisRange(e.newValue);else if(e.type==="removeIndex")this._removeAxisRange(e.oldValue);else if(e.type==="moveIndex")this._processAxisRange(e.value);else throw new Error("Unknown IStreamEvent type")})),this.states.create("hidden",{opacity:1,visible:!1}),this._makeFieldNames()}_processAxisRange(e){const t=Qe.new(this._root,{});e.container=t,this.children.push(t),e.series=this;const i=e.axisDataItem;i.setRaw("isRange",!0);const n=i.component;if(n){n._processAxisRange(i,["range","series"]);const s=i.get("bullet");if(s){const l=s.get("sprite");l&&l.setPrivate("visible",!1)}const a=i.get("axisFill");a&&t.set("mask",a),n._seriesAxisRanges.push(i)}}_removeAxisRange(e){const t=e.axisDataItem,i=t.component;i.disposeDataItem(t),yn(i._seriesAxisRanges,t);const n=e.container;n&&n.dispose()}_updateFields(){super._updateFields(),this._valueXFields=[],this._valueYFields=[],this._valueXShowFields=[],this._valueYShowFields=[],this.__valueXShowFields=[],this.__valueYShowFields=[],this.valueXFields&&ce(this.valueXFields,e=>{if(this.get(e+"Field")){this._valueXFields.push(e);let i=this.get(e+"Show");this.__valueXShowFields.push(i),i.indexOf("Working")!=-1?this._valueXShowFields.push(i.split("Working")[0]):this._valueXShowFields.push(i)}}),this.valueYFields&&ce(this.valueYFields,e=>{if(this.get(e+"Field")){this._valueYFields.push(e);let i=this.get(e+"Show");this.__valueYShowFields.push(i),i.indexOf("Working")!=-1?this._valueYShowFields.push(i.split("Working")[0]):this._valueYShowFields.push(i)}})}_dispose(){super._dispose();const e=this.chart;e&&e.series.removeValue(this),Cr(this.get("xAxis").series,this),Cr(this.get("yAxis").series,this)}_min(e,t){let i=m3(this.getPrivate(e),t);this.setPrivate(e,i)}_max(e,t){let i=x3(this.getPrivate(e),t);this.setPrivate(e,i)}_shouldMakeBullet(e){const t=this.get("xAxis"),i=this.get("yAxis"),n=this.get("baseAxis");if(!t.inited||!i.inited)return!1;const s=this.get("minBulletDistance",0);if(s>0){let a=this.startIndex(),h=this.endIndex()-a;if(t==n){if(t.get("renderer").axisLength()/h<s/5)return!1}else if(i==n&&i.get("renderer").axisLength()/h<s/5)return!1}return e.get(this._xField)!=null&&e.get(this._yField)!=null}_makeFieldNames(){const e=this.get("xAxis"),t=this.get("yAxis"),i=e.getPrivate("name"),n=Am(i),s=t.getPrivate("name"),a=Am(s),l=e.get("renderer").getPrivate("letter"),h=t.get("renderer").getPrivate("letter"),c="open",p="low",g="high",m="Show";e.className==="ValueAxis"?(this._xField=this.get(i+l+m),this._xOpenField=this.get(c+n+l+m),this._xLowField=this.get(p+n+l+m),this._xHighField=this.get(g+n+l+m)):(this._xField=i+l,this._xOpenField=c+n+l,this._xLowField=p+n+l,this._xHighField=g+n+l),t.className==="ValueAxis"?(this._yField=this.get(s+h+m),this._yOpenField=this.get(c+a+h+m),this._yLowField=this.get(p+a+h+m),this._yHighField=this.get(g+a+h+m)):(this._yField=s+h,this._yOpenField=c+a+h,this._yLowField=p+a+h,this._yHighField=g+a+h)}_fixVC(){const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis"),n=this.states.lookup("hidden"),s=this.get("sequencedInterpolation");if(n){let a=0;s&&(a=.999999999999),e===i?n.set("vcy",a):(t===i||n.set("vcy",a),n.set("vcx",a))}}_handleMaskBullets(){this.isDirty("maskBullets")&&this.bulletsContainer.set("maskContent",this.get("maskBullets"))}_fixPosition(){const e=this.get("xAxis"),t=this.get("yAxis");this.set("x",e.x()-ai(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0)),this.set("y",t.y()-ai(t.get("centerY",0),t.height())-t.parent.get("paddingTop",0)),this.bulletsContainer.set("y",this.y()),this.bulletsContainer.set("x",this.x())}_prepareChildren(){super._prepareChildren(),(this.isDirty("valueYShow")||this.isDirty("valueXShow")||this.isDirty("openValueYShow")||this.isDirty("openValueXShow")||this.isDirty("lowValueYShow")||this.isDirty("lowValueXShow")||this.isDirty("highValueYShow")||this.isDirty("highValueXShow"))&&(this._updateFields(),this._makeFieldNames(),this._valuesDirty=!0),(this.isDirty("xAxis")||this.isDirty("yAxis"))&&(this._valuesDirty=!0),this.set("width",this.get("xAxis").width()),this.set("height",this.get("yAxis").height()),this._handleMaskBullets();const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis"),n=this.get("tooltipPositionX");let s;switch(n){case"open":s=this._xOpenField;break;case"low":s=this._xLowField;break;case"high":s=this._xHighField;break;default:s=this._xField}this._tooltipFieldX=s;const a=this.get("tooltipPositionY");let l;switch(a){case"open":l=this._yOpenField;break;case"low":l=this._yLowField;break;case"high":l=this._yHighField;break;default:l=this._yField}this._tooltipFieldY=l,this.isDirty("baseAxis")&&this._fixVC(),this._fixPosition();const h=this.get("stacked");if(this.isDirty("stacked")&&(h?this._valuesDirty&&!this._dataProcessed||this._stack():this._unstack()),this._valuesDirty&&!this._dataProcessed&&(this._dataProcessed=!0,h&&this._stack(),ce(this.dataItems,c=>{ce(this._valueXShowFields,p=>{let g=c.get(p);g!=null&&(h&&(g+=this.getStackedXValue(c,p)),this._min("minX",g),this._max("maxX",g))}),ce(this._valueYShowFields,p=>{let g=c.get(p);g!=null&&(h&&(g+=this.getStackedYValue(c,p)),this._min("minY",g),this._max("maxY",g))}),e.processSeriesDataItem(c,this._valueXFields),t.processSeriesDataItem(c,this._valueYFields)}),e._seriesValuesDirty=!0,t._seriesValuesDirty=!0,this.get("ignoreMinMax")||((this.isPrivateDirty("minX")||this.isPrivateDirty("maxX"))&&e.markDirtyExtremes(),(this.isPrivateDirty("minY")||this.isPrivateDirty("maxY"))&&t.markDirtyExtremes()),this._markStakedDirtyStack(),this.get("tooltipDataItem")||this.updateLegendValue(void 0)),(this.isDirty("vcx")||this.isDirty("vcy"))&&this._markStakedDirtyStack(),this._dataGrouped||(e._groupSeriesData(this),t._groupSeriesData(this),this._dataGrouped=!0),this._valuesDirty||this.isPrivateDirty("startIndex")||this.isPrivateDirty("endIndex")||this.isDirty("vcx")||this.isDirty("vcy")||this._stackDirty){let c=this.startIndex(),p=this.endIndex(),g=this.get("minBulletDistance",0);if(g>0&&i&&(i.get("renderer").axisLength()/(p-c)>g?this._showBullets=!0:this._showBullets=!1),(this._psi!=c||this._pei!=p||this.isDirty("vcx")||this.isDirty("vcy")||this._stackDirty||this._valuesDirty)&&!this._selectionProcessed){this._selectionProcessed=!0;const m=this.get("vcx",1),_=this.get("vcy",1),b=this.get("stacked",!1),x=this.getPrivate("outOfSelection");if(i===e||!i)if(t._calculateTotals(),this.setPrivateRaw("selectionMinY",void 0),this.setPrivateRaw("selectionMaxY",void 0),x)t.markDirtySelectionExtremes();else for(let w=c;w<p;w++)this.processYSelectionDataItem(this.dataItems[w],_,b);if(i===t||!i)if(e._calculateTotals(),this.setPrivateRaw("selectionMinX",void 0),this.setPrivateRaw("selectionMaxX",void 0),x)t.markDirtySelectionExtremes();else for(let w=c;w<p;w++)this.processXSelectionDataItem(this.dataItems[w],m,b);if((i===e||!i)&&this.get("valueYShow")!=="valueYWorking"){const w=this.getPrivate("selectionMinY");w!=null&&(this.setPrivateRaw("minY",w),t.markDirtyExtremes());const P=this.getPrivate("selectionMaxY");P!=null&&(this.setPrivateRaw("maxY",P),t.markDirtyExtremes())}if((i===t||!i)&&this.get("valueXShow")!=="valueXWorking"){const w=this.getPrivate("selectionMinX");w!=null&&(this.setPrivateRaw("minX",w),t.markDirtyExtremes());const P=this.getPrivate("selectionMaxX");P!=null&&(this.setPrivateRaw("maxX",P),e.markDirtyExtremes())}(this.isPrivateDirty("selectionMinX")||this.isPrivateDirty("selectionMaxX"))&&e.markDirtySelectionExtremes(),(this.isPrivateDirty("selectionMinY")||this.isPrivateDirty("selectionMaxY"))&&t.markDirtySelectionExtremes()}}}_makeRangeMask(){if(this.axisRanges.length>0){let e=this._mainContainerMask;e==null&&(e=this.children.push(wi.new(this._root,{})),this._mainContainerMask=e,e.set("draw",(t,i)=>{const n=this.parent;if(n){const s=this._root.container.width(),a=this._root.container.height();t.moveTo(-s,-a),t.lineTo(-s,a*2),t.lineTo(s*2,a*2),t.lineTo(s*2,-a),t.lineTo(-s,-a),this.axisRanges.each(l=>{const h=l.axisDataItem.get("axisFill");if(n&&h){let c=h.get("draw");c&&c(t,i)}})}this.mainContainer._display.mask=e._display})),e.markDirty(),e._markDirtyKey("fill")}else this.mainContainer._display.mask=null}_updateChildren(){super._updateChildren(),this._x=this.x(),this._y=this.y(),this._makeRangeMask()}_stack(){const e=this.chart;if(e){const t=e.series.indexOf(this);if(this._couldStackTo=[],t>0){let i;for(let n=t-1;n>=0&&(i=e.series.getIndex(n),!(i.get("xAxis")===this.get("xAxis")&&i.get("yAxis")===this.get("yAxis")&&i.className===this.className&&(this._couldStackTo.push(i),!i.get("stacked"))));n--);}this._stackDataItems()}}_unstack(){Zt(this._reallyStackedTo,(e,t)=>{delete t._stackedSeries[this.uid]}),this._reallyStackedTo={},ce(this.dataItems,e=>{e.setRaw("stackToItemY",void 0),e.setRaw("stackToItemX",void 0)})}_stackDataItems(){const e=this.get("baseAxis"),t=this.get("xAxis"),i=this.get("yAxis");let n,s;e===t?(n="valueY",s="stackToItemY"):e===i&&(n="valueX",s="stackToItemX");let a=this._couldStackTo.length,l=0;const h=this.get("stackToNegative");this._reallyStackedTo={},ce(this.dataItems,c=>{for(let p=0;p<a;p++){let g=this._couldStackTo[p],m=g.dataItems[l],_=c.get(n);if(m){let b=m.get(n);if(h)if(ve(_)){if(ve(b)){if(_>=0&&b>=0){c.setRaw(s,m),this._reallyStackedTo[g.uid]=g,g._stackedSeries[this.uid]=this;break}if(_<0&&b<0){c.setRaw(s,m),this._reallyStackedTo[g.uid]=g,g._stackedSeries[this.uid]=this;break}}}else break;else if(ve(_)&&ve(b)){c.setRaw(s,m),this._reallyStackedTo[g.uid]=g,g._stackedSeries[this.uid]=this;break}}}l++})}processXSelectionDataItem(e,t,i){ce(this.__valueXShowFields,n=>{let s=e.get(n);s!=null&&(i&&(s+=this.getStackedXValueWorking(e,n)),this._min("selectionMinX",s),this._max("selectionMaxX",s*t))})}processYSelectionDataItem(e,t,i){ce(this.__valueYShowFields,n=>{let s=e.get(n);s!=null&&(i&&(s+=this.getStackedYValueWorking(e,n)),this._min("selectionMinY",s),this._max("selectionMaxY",s*t))})}getStackedYValueWorking(e,t){const i=e.get("stackToItemY");if(i){const n=i.component;return i.get(t,0)*n.get("vcy",1)+this.getStackedYValueWorking(i,t)}return 0}getStackedXValueWorking(e,t){const i=e.get("stackToItemX");if(i){const n=i.component;return i.get(t,0)*n.get("vcx",1)+this.getStackedXValueWorking(i,t)}return 0}getStackedYValue(e,t){const i=e.get("stackToItemY");return i?i.get(t,0)+this.getStackedYValue(i,t):0}getStackedXValue(e,t){const i=e.get("stackToItemX");return i?i.get(t,0)+this.getStackedXValue(i,t):0}createLegendMarker(e){this.updateLegendMarker()}_markDirtyAxes(){this._axesDirty=!0,this.markDirty()}_markDataSetDirty(){this._afterDataChange(),this._valuesDirty=!0,this._dataProcessed=!1,this._aggregatesCalculated=!1,this.markDirty()}_clearDirty(){super._clearDirty(),this._axesDirty=!1,this._selectionProcessed=!1,this._stackDirty=!1,this._dataProcessed=!1}_positionBullet(e){let t=e.get("sprite");if(t){let i=t.dataItem,n=e.get("locationX",i.get("locationX",.5)),s=e.get("locationY",i.get("locationY",.5)),a=this.get("xAxis"),l=this.get("yAxis");const h=a.getDataItemPositionX(i,this._xField,n,this.get("vcx",1)),c=l.getDataItemPositionY(i,this._yField,s,this.get("vcy",1));let p=this.getPoint(h,c),g=i.get("left",p.x),m=i.get("right",p.x),_=i.get("top",p.y),b=i.get("bottom",p.y);if(this._shouldShowBullet(h,c)){e.getPrivate("hidden")?t.setPrivate("visible",!1):t.setPrivate("visible",!0);let x=m-g,w=b-_;t.isType("Label")&&(t.setPrivate("maxWidth",Math.abs(x)),t.setPrivate("maxHeight",Math.abs(w)));let P=g+x*n,E=b-w*s;t.set("x",P),t.set("y",E)}else t.setPrivate("visible",!1)}}_shouldShowBullet(e,t){return this._showBullets}setDataSet(e){if(this._dataSets[e]){this._handleDataSetChange(),this._dataItems=this._dataSets[e],this._markDataSetDirty(),this._dataSetId=e;const t="datasetchanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,id:e})}}_handleDataSetChange(){this.bullets.length>0&&ce(this._dataItems,e=>{let t=e.bullets;t&&ce(t,i=>{if(i){let n=i.get("sprite");n&&n.setPrivate("visible",!1)}})}),this._selectionProcessed=!1}show(e){const t=Object.create(null,{show:{get:()=>super.show}});return Oi(this,void 0,void 0,function*(){this._fixVC();let i=[];i.push(t.show.call(this,e).then(()=>{this._isShowing=!1;let n=this.get("xAxis"),s=this.get("yAxis"),a=this.get("baseAxis");s!==a&&s.markDirtySelectionExtremes(),n!==a&&n.markDirtySelectionExtremes()})),i.push(this.bulletsContainer.show(e)),i.push(this._sequencedShowHide(!0,e)),yield Promise.all(i)})}hide(e){const t=Object.create(null,{hide:{get:()=>super.hide}});return Oi(this,void 0,void 0,function*(){this._fixVC();let i=[];i.push(t.hide.call(this,e).then(()=>{this._isHiding=!1})),i.push(this.bulletsContainer.hide(e)),i.push(this._sequencedShowHide(!1,e)),yield Promise.all(i)})}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)];ve(t)||(t=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");ce(this._valueFields,a=>{n.push(e.animate({key:a+"Working",to:e.get(a),duration:t,easing:s}).waitForStop())}),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.states.create("hidden",{});ve(t)||(t=s.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const a=s.get("stateAnimationEasing",this.get("stateAnimationEasing")),l=this.get("xAxis"),h=this.get("yAxis"),c=this.get("baseAxis"),p=this.get("stacked");if((c===l||!c)&&ce(this._valueYFields,g=>{let m=h.getPrivate("min"),_=h.baseValue();ve(m)&&m>_&&(_=m),p&&(_=0),e.get(g)!=null&&n.push(e.animate({key:g+"Working",to:_,duration:t,easing:a}).waitForStop())}),c===h||!c){let g=l.getPrivate("min"),m=l.baseValue();ve(g)&&g>m&&(m=g),p&&(m=0),ce(this._valueXFields,_=>{e.get(_)!=null&&n.push(e.animate({key:_+"Working",to:m,duration:t,easing:a}).waitForStop())})}yield Promise.all(n)})}_markDirtyStack(){this._stackDirty=!0,this.markDirty(),this._markStakedDirtyStack()}_markStakedDirtyStack(){const e=this._stackedSeries;e&&Zt(e,(t,i)=>{i._stackDirty||i._markDirtyStack()})}_afterChanged(){super._afterChanged(),this._skipped&&(this._markDirtyAxes(),this._skipped=!1)}showDataItemTooltip(e){this.updateLegendMarker(e),this.updateLegendValue(e);const t=this.get("tooltip");if(t){if(this.isHidden())this.hideTooltip();else if(t._setDataItem(e),e){let i=this.get("locationX",0),n=this.get("locationY",1),s=e.get("locationX",i),a=e.get("locationY",n);const l=this.get("xAxis"),h=this.get("yAxis"),c=this.get("vcx",1),p=this.get("vcy",1),g=l.getDataItemPositionX(e,this._tooltipFieldX,this._aLocationX0+(this._aLocationX1-this._aLocationX0)*s,c),m=h.getDataItemPositionY(e,this._tooltipFieldY,this._aLocationY0+(this._aLocationY1-this._aLocationY0)*a,p),_=this.getPoint(g,m);let b=!0;if(ce(this._valueFields,x=>{e.get(x)==null&&(b=!1)}),b){const x=this.chart;x&&x.inPlot(_)?(t.label.text.markDirtyText(),t.set("tooltipTarget",this._getTooltipTarget(e)),t.set("pointTo",this._display.toGlobal({x:_.x,y:_.y}))):t._setDataItem(void 0)}else t._setDataItem(void 0)}}}hideTooltip(){const e=this.get("tooltip");return e&&e.set("tooltipTarget",this),super.hideTooltip()}_getTooltipTarget(e){if(this.get("seriesTooltipTarget")=="bullet"){const t=e.bullets;if(t&&t.length>0){const n=t[0].get("sprite");if(n)return n}}return this}updateLegendValue(e){const t=this.get("legendDataItem");if(t){const i=t.get("label");if(i){let s="";e?(i._setDataItem(e),s=this.get("legendLabelText",i.get("text",this.get("name","")))):(i._setDataItem(this._emptyDataItem),s=this.get("legendRangeLabelText",this.get("legendLabelText",i.get("text",this.get("name",""))))),i.set("text",s)}const n=t.get("valueLabel");if(n){let s="";e?(n._setDataItem(e),s=this.get("legendValueText",n.get("text",""))):(n._setDataItem(this._emptyDataItem),s=this.get("legendRangeValueText",n.get("text",""))),n.set("text",s)}}}_getItemReaderLabel(){let e="X: {"+this._xField;return this.get("xAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}; Y: {"+this._yField,this.get("yAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}",e}getPoint(e,t){let i=this.get("xAxis").get("renderer").positionToCoordinate(e),n=this.get("yAxis").get("renderer").positionToCoordinate(t),s=999999999;return n<-s&&(n=-s),n>s&&(n=s),i<-s&&(i=-s),i>s&&(i=s),{x:i,y:n}}_shouldInclude(e){return!0}handleCursorHide(){this.hideTooltip(),this.updateLegendValue(void 0),this.updateLegendMarker(void 0)}_afterDataChange(){super._afterDataChange(),this.get("xAxis")._markDirtyKey("start"),this.get("yAxis")._markDirtyKey("start"),this.resetExtremes()}resetExtremes(){this.setPrivate("selectionMinX",void 0),this.setPrivate("selectionMaxX",void 0),this.setPrivate("selectionMinY",void 0),this.setPrivate("selectionMaxY",void 0),this.setPrivate("minX",void 0),this.setPrivate("minY",void 0),this.setPrivate("maxX",void 0),this.setPrivate("maxY",void 0)}createAxisRange(e){return this.axisRanges.push({axisDataItem:e})}get mainDataItems(){return this._mainDataItems}}Object.defineProperty(zu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYSeries"});Object.defineProperty(zu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:js.classNames.concat([zu.className])});class ho extends zu{constructor(){super(...arguments),Object.defineProperty(this,"_ph",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pw",{enumerable:!0,configurable:!0,writable:!0,value:0})}_makeGraphics(e,t){return this.makeColumn(t,e)}_makeFieldNames(){super._makeFieldNames();const e=this.get("xAxis"),t=this.get("yAxis"),i="CategoryAxis",n="ValueAxis";e.isType(i)&&(this.get("openCategoryXField")||(this._xOpenField=this._xField)),e.isType(n)&&(this.get("openValueXField")||(this._xOpenField=this._xField)),t.isType(i)&&(this.get("openCategoryYField")||(this._yOpenField=this._yField)),t.isType(n)&&(this.get("openValueYField")||(this._yOpenField=this._yField))}_prepareChildren(){super._prepareChildren();const e=this.get("xAxis"),t=this.get("yAxis"),i=this.dataItems.length,n=Math.max(0,this.startIndex()-2),s=Math.min(this.endIndex()+2,i-1);if(e.inited&&t.inited)for(let a=n;a<=s;a++){let l=this.dataItems[a];this._createGraphics(l)}}_updateChildren(){const e=this.chart;e&&(this._ph=e.plotContainer.height(),this._pw=e.plotContainer.width());const t=this.get("xAxis"),i=this.get("yAxis"),n=this.get("baseAxis"),s=this.columns.template;this.isDirty("fill")&&s.get("fill")==null&&s.set("fill",this.get("fill")),this.isDirty("stroke")&&s.get("stroke")==null&&s.set("stroke",this.get("stroke"));let a=0,l=0,h=0;ce(n.series,P=>{if(P instanceof ho){const E=P.get("stacked");E&&h==0&&l++,!E&&P.get("clustered")&&l++}P===this&&(a=l-1),h++}),this.get("clustered")||(a=0,l=1),l===0&&(l=1,a=0);const c=t.get("renderer"),p=i.get("renderer"),g="cellStartLocation",m="cellEndLocation",_=c.get(g,0),b=c.get(m,1),x=p.get(g,0),w=p.get(m,1);if(this._aLocationX0=_+a/l*(b-_),this._aLocationX1=_+(a+1)/l*(b-_),this._aLocationY0=x+a/l*(w-x),this._aLocationY1=x+(a+1)/l*(w-x),t.inited&&i.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty){const P=this.dataItems.length;let E=Math.max(0,this.startIndex()-2),k=Math.min(this.endIndex()+2,P-1);for(let O=0;O<E;O++)this._toggleColumn(this.dataItems[O],!1);let C=this.dataItems[E];for(let O=E;O<=k;O++){let F=this.dataItems[O];if(F.get("valueX")!=null&&F.get("valueY")!=null){if(C=F,O>0&&E>0)for(let D=O-1;D>=0;D--){let N=this.dataItems[D];if(N.get("valueX")!=null&&N.get("valueY")!=null){C=N;break}}break}else this._toggleColumn(F,!1)}for(let O=E;O<=k;O++){let F=this.dataItems[O];this._updateGraphics(F,C),F.get("valueX")!=null&&F.get("valueY")!=null&&(C=F)}for(let O=k+1;O<P;O++)this._toggleColumn(this.dataItems[O],!1)}}else this._skipped=!0;this.updateLegendMarker(this.get("tooltipDataItem")),super._updateChildren()}_createGraphics(e){let t=e.get("graphics");if(!t){t=this._makeGraphics(this.columns,e),e.set("graphics",t),t._setDataItem(e);const i=e.get("legendDataItem");if(i){const n=i.get("markerRectangle");n&&n.setAll({fill:t.get("fill"),stroke:t.get("stroke")})}this.axisRanges.each(n=>{const s=n.container,a=e.get("rangeGraphics",[]);e.set("rangeGraphics",a);const l=this._makeGraphics(n.columns,e);a.push(l),l.setPrivate("list",n.columns),s.children.push(l)})}}_updateGraphics(e,t){let i=e.get("graphics");const n=this._xField,s=this._yField,a=e.get(n),l=e.get(s);if(a!=null&&l!=null){const h=this._xOpenField,c=this._yOpenField,p=this.get("locationX",e.get("locationX",.5)),g=this.get("locationY",e.get("locationY",.5)),m=this.get("openLocationX",e.get("openLocationX",p)),_=this.get("openLocationY",e.get("openLocationY",g)),b=i.get("width"),x=i.get("height"),w=this.get("stacked"),P=this.get("xAxis"),E=this.get("yAxis"),k=this.get("baseAxis"),C=P.get("start"),O=P.get("end"),F=E.get("start"),D=E.get("end");let N,X,z,U,j=this.get("vcy",1),q=this.get("vcx",1),pe=!1,fe=!1;if(E.isType("CategoryAxis")&&P.isType("CategoryAxis")){let de=this._aLocationX0+m-.5,De=this._aLocationX1+p-.5;if(b instanceof gt){let ee=(De-de)*(1-b.value)/2;de+=ee,De-=ee}if(N=P.getDataItemPositionX(e,h,de,q),X=P.getDataItemPositionX(e,n,De,q),de=this._aLocationY0+_-.5,De=this._aLocationY1+g-.5,x instanceof gt){let ee=(De-de)*(1-x.value)/2;de+=ee,De-=ee}z=E.getDataItemPositionY(e,c,de,j),U=E.getDataItemPositionY(e,s,De,j),e.setRaw("point",{x:N+(X-N)/2,y:z+(U-z)/2})}else if(P===k){let de=this._aLocationX0+m-.5,De=this._aLocationX1+p-.5;if(b instanceof gt){let ee=(De-de)*(1-b.value)/2;de+=ee,De-=ee}if(N=P.getDataItemPositionX(e,h,de,q),X=P.getDataItemPositionX(e,n,De,q),z=E.getDataItemPositionY(e,s,g,j),this._yOpenField!==this._yField)U=E.getDataItemPositionY(e,c,_,j);else if(w){let ee=e.get("stackToItemY");ee?U=E.getDataItemPositionY(ee,s,_,ee.component.get("vcy")):U=E.basePosition()}else U=E.basePosition();e.setRaw("point",{x:N+(X-N)/2,y:z}),fe=!0}else if(E===k){let de=this._aLocationY0+_-.5,De=this._aLocationY1+g-.5;if(x instanceof gt){let ee=(De-de)*(1-x.value)/2;de+=ee,De-=ee}if(z=E.getDataItemPositionY(e,c,de,j),U=E.getDataItemPositionY(e,s,De,j),X=P.getDataItemPositionX(e,n,p,q),this._xOpenField!==this._xField)N=P.getDataItemPositionX(e,h,m,q);else if(w){let ee=e.get("stackToItemX");ee?N=P.getDataItemPositionX(ee,n,m,ee.component.get("vcx")):N=P.basePosition()}else N=P.basePosition();pe=!0,e.setRaw("point",{x:X,y:z+(U-z)/2})}this._updateSeriesGraphics(e,i,N,X,z,U,pe,fe),N<C&&X<C||N>O&&X>O||z<F&&U<=F||z>=D&&U>D||xa(N)||xa(z)?this._toggleColumn(e,!1):this._toggleColumn(e,!0);let Ee=e.get("rangeGraphics");Ee&&ce(Ee,de=>{this._updateSeriesGraphics(e,de,N,X,z,U,pe,fe)}),this._applyGraphicsStates(e,t)}}_updateSeriesGraphics(e,t,i,n,s,a,l,h){const c=t.get("width"),p=t.get("height"),g=t.get("maxWidth"),m=t.get("maxHeight"),_=this.getPoint(i,s),b=this.getPoint(n,a),x=e.get("point");if(x){const w=this.getPoint(x.x,x.y);x.x=w.x+this._x,x.y=w.y+this._y}if(i=_.x,n=b.x,s=_.y,a=b.y,ve(c)){const w=(n-i-c)/2;i+=w,n-=w}if(ve(g)&&g<Math.abs(n-i)){const w=(n-i-g)/2;i+=w,n-=w}if(ve(p)){const w=(a-s-p)/2;s+=w,a-=w}if(ve(m)&&m<Math.abs(a-s)){const w=(a-s-m)/2;s+=w,a-=w}this.get("adjustBulletPosition")&&(l&&(n=Math.min(Math.max(0,n),this._pw),i=Math.min(Math.max(0,i),this._pw)),h&&(s=Math.min(Math.max(0,s),this._ph),a=Math.min(Math.max(0,a),this._ph))),e.setRaw("left",i),e.setRaw("right",n),e.setRaw("top",s),e.setRaw("bottom",a),t.setPrivate("width",n-i),t.setPrivate("height",a-s),t.set("x",i),t.set("y",a-(a-s))}_handleDataSetChange(){super._handleDataSetChange(),ce(this._dataItems,e=>{this._toggleColumn(e,!1)})}_applyGraphicsStates(e,t){const i=e.get("graphics"),n=i.states.lookup("dropFromOpen"),s=i.states.lookup("riseFromOpen"),a=i.states.lookup("dropFromPrevious"),l=i.states.lookup("riseFromPrevious");if(n||a||s||l){const h=this.get("xAxis"),c=this.get("yAxis"),p=this.get("baseAxis");let g,m,_;p===h&&c.isType("ValueAxis")?(g=e.get(this._yOpenField),m=e.get(this._yField),_=t.get(this._yField)):p===c&&h.isType("ValueAxis")&&(g=e.get(this._xOpenField),m=e.get(this._xField),_=t.get(this._xField)),ve(g)&&ve(m)&&(m<g?n&&n.apply():s&&s.apply(),ve(_)&&(m<_?a&&a.apply():l&&l.apply()))}}disposeDataItem(e){super.disposeDataItem(e);const t=e.get("graphics");t&&(this.columns.removeValue(t),t.dispose());const i=e.get("rangeGraphics");i&&ce(i,n=>{const s=n.getPrivate("list");s&&s.removeValue(n),n.dispose()})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],s=e.get("graphics");s&&n.push(s.hide(t));const a=e.get("rangeGraphics");a&&ce(a,l=>{n.push(l.hide(t))}),yield Promise.all(n)})}_toggleColumn(e,t){const i=e.get("graphics");i&&i.setPrivate("visible",t);const n=e.get("rangeGraphics");n&&ce(n,a=>{a.setPrivate("visible",t)});const s=e.bullets;s&&ce(s,a=>{a.setPrivate("hidden",!t)})}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)],s=e.get("graphics");s&&n.push(s.show(t));const a=e.get("rangeGraphics");a&&ce(a,l=>{n.push(l.show(t))}),yield Promise.all(n)})}updateLegendMarker(e){let t=this.get("legendDataItem");if(this.get("useLastColorForLegendMarker")&&!e){const i=this.dataItems[this.endIndex()-1];i&&(e=i)}if(t){let i=this.columns.template;if(e){let s=e.get("graphics");s&&(i=s)}const n=t.get("markerRectangle");n&&(t.get("itemContainer").get("disabled")||ce(Uv,s=>{n.set(s,i.get(s,this.get(s)))}))}}_getTooltipTarget(e){if(this.get("seriesTooltipTarget")=="bullet")return super._getTooltipTarget(e);let t=e.get("graphics");return t||this}}Object.defineProperty(ho,"className",{enumerable:!0,configurable:!0,writable:!0,value:"BaseColumnSeries"});Object.defineProperty(ho,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zu.classNames.concat([ho.className])});class co extends lo{constructor(){super(...arguments),Object.defineProperty(this,"_series",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_isPanning",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{width:ze,height:ze})}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:Qe.new(this._root,{width:ze,height:ze})}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{isMeasured:!1,width:ze,height:ze,position:"absolute"}))}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rangesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_panStart",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_panEnd",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_sAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_eAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_skipSync",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Tl}),Object.defineProperty(this,"_seriesAxisRanges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"ghostLabel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cursorPosition",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"_snapToSeries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seriesValuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisHeader",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{themeTags:["axis","header"],position:"absolute",background:Tn.new(this._root,{themeTags:["header","background"],fill:this._root.interfaceColors.get("background")})}))}),Object.defineProperty(this,"_bullets",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_dispose(){this.gridContainer.dispose(),this.topGridContainer.dispose(),this.bulletsContainer.dispose(),this.labelsContainer.dispose(),this.axisHeader.dispose(),super._dispose()}_afterNew(){super._afterNew(),this.setPrivate("updateScrollbar",!0),this._disposers.push(this.axisRanges.events.onAll(t=>{if(t.type==="clear")ce(t.oldValues,i=>{this.disposeDataItem(i)});else if(t.type==="push")this._processAxisRange(t.newValue,["range"]);else if(t.type==="setIndex")this._processAxisRange(t.newValue,["range"]);else if(t.type==="insertIndex")this._processAxisRange(t.newValue,["range"]);else if(t.type==="removeIndex")this.disposeDataItem(t.oldValue);else if(t.type==="moveIndex")this._processAxisRange(t.value,["range"]);else throw new Error("Unknown IStreamEvent type")}));const e=this.get("renderer");e&&(e.axis=this,e.processAxis()),this.children.push(e),this.ghostLabel=e.makeLabel(new ll(this,void 0,{}),[]),this.ghostLabel.adapters.disable("text"),this.ghostLabel.setAll({opacity:0,tooltipText:void 0,tooltipHTML:void 0,interactive:!1}),this.ghostLabel.events.disable()}_updateFinals(e,t){}zoom(e,t,i,n){if(this._updateFinals(e,t),this.get("start")!==e||this.get("end")!=t){let s=this._sAnimation,a=this._eAnimation,l=this.get("maxDeviation",.5)*Math.min(1,t-e);e<-l&&(e=-l),t>1+l&&(t=1+l),e>t&&([e,t]=[t,e]),ve(i)||(i=this.get("interpolationDuration",0)),n||(n="end");let h=this.getPrivate("maxZoomFactor",this.get("maxZoomFactor",100)),c=h;t===1&&e!==0&&(e<this.get("start")?n="start":n="end"),e===0&&t!==1&&(t>this.get("end")?n="end":n="start");let p=this.get("minZoomCount"),g=this.get("maxZoomCount");ve(p)&&(h=c/p);let m=1;if(ve(g)&&(m=c/g),n==="start"?(g>0&&1/(t-e)<m&&(t=e+1/m),1/(t-e)>h&&(t=e+1/h),t>1&&t-e<1/h&&(e=t-1/h)):(g>0&&1/(t-e)<m&&(e=t-1/m),1/(t-e)>h&&(e=t-1/h),e<0&&t-e<1/h&&(t=e+1/h)),1/(t-e)>h&&(t=e+1/h),1/(t-e)>h&&(e=t-1/h),g!=null&&p!=null&&e==this.get("start")&&t==this.get("end")){const _=this.chart;_&&_._handleAxisSelection(this,!0)}if((s&&s.playing&&s.to==e||this.get("start")==e)&&(a&&a.playing&&a.to==t||this.get("end")==t))return;if(i>0){let _=this.get("interpolationEasing"),b,x;if(this.get("start")!=e&&(b=this.animate({key:"start",to:e,duration:i,easing:_})),this.get("end")!=t&&(x=this.animate({key:"end",to:t,duration:i,easing:_})),this._sAnimation=b,this._eAnimation=x,b)return b;if(x)return x}else this.set("start",e),this.set("end",t),this._root.events.once("frameended",()=>{this._markDirtyKey("start"),this._root._markDirty()})}else this._sAnimation&&this._sAnimation.stop(),this._eAnimation&&this._eAnimation.stop()}get series(){return this._series}_processAxisRange(e,t){e.setRaw("isRange",!0),this._createAssets(e,t),this._rangesDirty=!0,this._prepareDataItem(e);const i=e.get("above"),n=this.topGridContainer,s=e.get("grid");i&&s&&n.children.moveValue(s);const a=e.get("axisFill");i&&a&&n.children.moveValue(a)}_prepareDataItem(e,t){}markDirtyExtremes(){}markDirtySelectionExtremes(){}_calculateTotals(){}_updateAxisRanges(){this._bullets={},this.axisRanges.each(e=>{this._prepareDataItem(e)}),ce(this._seriesAxisRanges,e=>{this._prepareDataItem(e)})}_prepareChildren(){if(super._prepareChildren(),this.get("fixAxisSize")?this.ghostLabel.set("visible",!0):this.ghostLabel.set("visible",!1),this.isDirty("start")||this.isDirty("end")){this.chart._updateCursor();let t=this.get("start",0),i=this.get("end",1),n=this.get("maxDeviation",.5)*Math.min(1,i-t);if(t<-n){let s=t+n;t=-n,this.setRaw("start",t),this.isDirty("end")&&this.setRaw("end",i-s)}if(i>1+n){let s=i-1-n;i=1+n,this.setRaw("end",i),this.isDirty("start")&&this.setRaw("start",t-s)}}const e=this.get("renderer");if(e._start=this.get("start"),e._end=this.get("end"),e._inversed=e.get("inversed",!1),e._axisLength=e.axisLength()/(e._end-e._start),e._updateLC(),this.isDirty("tooltip")){const t=this.get("tooltip");if(t){const i=e.get("themeTags");t.addTag("axis"),t.addTag(this.className.toLowerCase()),t._applyThemes(),i&&(t.set("themeTags",It(t.get("themeTags"),i)),t.label._applyThemes())}}}_updateTooltipBounds(){const e=this.get("tooltip");e&&this.get("renderer").updateTooltipBounds(e)}_updateBounds(){super._updateBounds(),this._updateTooltipBounds()}processChart(e){this.chart=e;const t=this.get("renderer");t.chart=e,e.gridContainer.children.push(this.gridContainer),e.topGridContainer.children.push(this.topGridContainer),e.axisHeadersContainer.children.push(this.axisHeader),this.on("start",()=>{e._handleAxisSelection(this)}),this.on("end",()=>{e._handleAxisSelection(this)}),e.plotContainer.onPrivate("width",()=>{this.markDirtySize()}),e.plotContainer.onPrivate("height",()=>{this.markDirtySize()}),e.processAxis(this)}hideDataItem(e){return this._toggleDataItem(e,!1),super.hideDataItem(e)}showDataItem(e){return this._toggleDataItem(e,!0),super.showDataItem(e)}_toggleDataItem(e,t){const i=e.get("label");i&&i.setPrivate("visible",t);const n=e.get("grid");n&&n.setPrivate("visible",t);const s=e.get("tick");s&&s.setPrivate("visible",t);const a=e.get("axisFill");a&&a.setPrivate("visible",t);const l=e.get("bullet");if(l){const h=l.get("sprite");h&&h.setPrivate("visible",t)}}_createAssets(e,t){const i=this.get("renderer");e.get("label")||i.makeLabel(e,t),e.get("grid")||i.makeGrid(e,t),e.get("tick")||i.makeTick(e,t),e.get("axisFill")||i.makeAxisFill(e,t),this._processBullet(e)}_processBullet(e){let t=e.get("bullet"),i=this.get("bullet");if(!t&&i&&!e.get("isRange")&&(t=i(this._root,this,e)),t){t.axis=this;const n=t.get("sprite");n&&(n._setDataItem(e),e.setRaw("bullet",t),n.parent||this.bulletsContainer.children.push(n))}}_afterChanged(){super._afterChanged();const e=this.chart;e&&(e._updateChartLayout(),e.axisHeadersContainer.markDirtySize()),this.get("renderer")._updatePositions()}disposeDataItem(e){super.disposeDataItem(e);const t=this.get("renderer"),i=e.get("label");i&&(t.labels.removeValue(i),i.dispose());const n=e.get("tick");n&&(t.ticks.removeValue(n),n.dispose());const s=e.get("grid");s&&(t.grid.removeValue(s),s.dispose());const a=e.get("axisFill");a&&(t.axisFills.removeValue(a),a.dispose());const l=e.get("bullet");l&&l.dispose()}_updateGhost(){this.setPrivate("cellWidth",this.getCellWidthPosition()*this.get("renderer").axisLength());const e=this.ghostLabel;if(!e.isHidden()){const n=e.localBounds(),s=n.right-n.left;let a=e.get("text");ce(this.dataItems,l=>{const h=l.get("label");if(h&&!h.isHidden()){const c=h.localBounds();c.right-c.left>s&&(a=h.text._getText())}}),e.set("text",a)}let t=this.get("start",0),i=this.get("end",1);this.get("renderer").updateLabel(e,t+(i-t)*.5)}_handleCursorPosition(e,t){e=this.get("renderer").toAxisPosition(e),this._cursorPosition=e,this._snapToSeries=t,this.updateTooltip()}updateTooltip(){const e=this._snapToSeries;let t=this._cursorPosition;const i=this.get("tooltip"),n=this.get("renderer");ve(t)&&(ce(this.series,s=>{if(s.get("baseAxis")===this){const a=this.getSeriesItem(s,t,this.get("tooltipLocation"));s.setRaw("tooltipDataItem",a),e&&e.indexOf(s)!=-1?(s.updateLegendMarker(a),s.updateLegendValue(a)):s.showDataItemTooltip(a)}}),i&&(n.updateTooltipBounds(i),this.get("snapTooltip")&&(t=this.roundAxisPosition(t,this.get("tooltipLocation",.5))),xa(t)?i.hide(0):(this.setPrivateRaw("tooltipPosition",t),this._updateTooltipText(i,t),n.positionTooltip(i,t),t<this.get("start")||t>this.get("end")?i.hide(0):i.show(0))))}_updateTooltipText(e,t){e.label.set("text",this.getTooltipText(t))}roundAxisPosition(e,t){return e}handleCursorShow(){let e=this.get("tooltip");e&&e.show()}handleCursorHide(){let e=this.get("tooltip");e&&e.hide()}processSeriesDataItem(e,t){}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._rangesDirty=!1}coordinateToPosition(e){const t=this.get("renderer");return t.toAxisPosition(e/t.axisLength())}toAxisPosition(e){return this.get("renderer").toAxisPosition(e)}fixPosition(e){return this.get("renderer").fixPosition(e)}shouldGap(e,t,i,n){return!1}createAxisRange(e){return this.axisRanges.push(e)}_groupSeriesData(e){}getCellWidthPosition(){return .05}}Object.defineProperty(co,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Axis"});Object.defineProperty(co,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:lo.classNames.concat([co.className])});class ba extends co{constructor(){super(...arguments),Object.defineProperty(this,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_itemMap",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["axis"]),this.fields.push("category"),this.setPrivateRaw("name","category"),this.addTag("category"),super._afterNew()}_prepareChildren(){super._prepareChildren();const e=this.dataItems.length;let t=0;this._valuesDirty&&(this._itemMap={},ce(this.dataItems,i=>{i.setRaw("index",t),this._itemMap[i.get("category")]=i,t++}),this.setPrivateRaw("maxZoomFactor",e)),this.setPrivateRaw("startIndex",Math.max(Math.round(this.get("start",0)*e),0)),this.setPrivateRaw("endIndex",Math.min(Math.round(this.get("end",1)*e),e)),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("endIndex")||this.isPrivateDirty("startIndex")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&this.dataItems.length>0&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges())}_handleRangeChange(){ce(this.series,e=>{let t=this.dataItems[this.startIndex()].get("category"),i=this.dataItems[this.endIndex()-1].get("category"),n=e.get("baseAxis"),s=e.get("xAxis"),a=e.get("yAxis");if(s instanceof ba&&a instanceof ba)e._markDirtyAxes();else if(n===this){let l,h,c=a;if(s===n?(e.get("categoryXField")&&(l="categoryX"),e.get("openCategoryXField")&&(h="openCategoryX")):a===n&&(e.get("categoryYField")&&(l="categoryY"),e.get("openCategoryYField")&&(h="openCategoryY"),c=s),c.className=="ValueAxis"&&(l||h)){let p,g;for(let x=0,w=e.dataItems.length;x<w;x++){let P=e.dataItems[x];if(l&&P.get(l)===t){p=P;break}if(h&&P.get(h)===t){p=P;break}}for(let x=e.dataItems.length-1;x>=0;x--){let w=e.dataItems[x];if(l&&w.get(l)===i){g=w;break}if(h&&w.get(h)===i){g=w;break}}let m=0,_=e.dataItems.length;p&&(m=e.dataItems.indexOf(p)),g&&(_=e.dataItems.indexOf(g)+1),e.setPrivate("startIndex",m),e.setPrivate("endIndex",_);let b=!1;for(let x=m;x<_;x++){const w=e.dataItems[x];if(ce(e.__valueXShowFields,P=>{w.get(P)!=null&&(b=!0)}),ce(e.__valueYShowFields,P=>{w.get(P)!=null&&(b=!0)}),b)break}e.setPrivate("outOfSelection",!b)}e._markDirtyAxes()}})}_prepareAxisItems(){const e=this.get("renderer"),t=this.dataItems.length;let i=this.startIndex();i>0&&i--;let n=this.endIndex();n<t&&n++;let s=e.axisLength()/Math.max(e.get("minGridDistance"),1/Number.MAX_SAFE_INTEGER),a=Math.max(1,Math.min(t,Math.ceil((n-i)/s)));i=Math.floor(i/a)*a,this._frequency=a;for(let h=0;h<t;h++)this.dataItems[h].hide();let l=this.dataItems[i].get("index",0);for(let h=i;h<n;h=h+a){let c=this.dataItems[h];this._createAssets(c,[]),c.isHidden()&&c.show(),this._prepareDataItem(c,l,a),l++}this._updateGhost()}_prepareDataItem(e,t,i){let n=this.get("renderer"),s=e.get("categoryLocation",0),a=e.get("endCategoryLocation",1),l=e.get("index");ve(l)||(l=this.categoryToIndex(e.get("category")));let h=this.indexToPosition(l,s),c=e.get("endCategory"),p;c?(p=this.categoryToIndex(c),ve(p)||(p=l)):p=l;let g=this.indexToPosition(p,a),m,_;e.get("isRange")?m=p:m=l+this._frequency-1,_=this.indexToPosition(m,a),n.updateLabel(e.get("label"),h,g,i),n.updateGrid(e.get("grid"),h,g),n.updateTick(e.get("tick"),h,g,i),n.updateFill(e.get("axisFill"),h,_),this._processBullet(e),n.updateBullet(e.get("bullet"),h,g);const b=this.get("fillRule");b&&b(e,t)}startIndex(){let e=this.dataItems.length;return Math.min(Math.max(this.getPrivate("startIndex",0),0),e-1)}endIndex(){let e=this.dataItems.length;return Math.max(1,Math.min(this.getPrivate("endIndex",e),e))}baseValue(){}basePosition(){return 0}getX(e){let t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}getY(e){let t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}getDataItemPositionX(e,t,i,n){const s=e.get(t),a=this._itemMap[s];return a?this.indexToPosition(a.get("index",0),i):NaN}getDataItemCoordinateX(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,n))}getDataItemPositionY(e,t,i,n){const s=e.get(t),a=this._itemMap[s];return a?this.indexToPosition(a.get("index",0),i):NaN}getDataItemCoordinateY(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,n))}indexToPosition(e,t){ve(t)||(t=.5);let i=this.dataItems.length,n=this.get("startLocation",0),s=this.get("endLocation",1);i-=n,i-=1-s;let a=(e+t-n)/i,l=this.dataItems[e];return l&&(a+=l.get("deltaPosition",0)),a}categoryToIndex(e){let t=this._itemMap[e];return t?t.get("index"):NaN}dataItemToPosition(e){return this.indexToPosition(e.get("index"))}roundAxisPosition(e,t){return e+=(.5-t)/this.dataItems.length,this.indexToPosition(this.axisPositionToIndex(e),t)}axisPositionToIndex(e){let t=this.dataItems.length;return Di(Math.floor(e*t),0,t-1)}getTooltipText(e){const t=this.dataItems[this.axisPositionToIndex(e)];if(t){const i=t.get("label");if(i)return Fu(i,this.get("tooltipText",""))}}_updateTooltipText(e,t){e._setDataItem(this.dataItems[this.axisPositionToIndex(t)]),e.label.text.markDirtyText()}getSeriesItem(e,t){if(this.dataItems.length>0){let i=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),n=this.axisPositionToIndex(t),s=e.dataItems[n],a=this.dataItems[n],l=a.get("category");if(s&&a&&s.get(i)===l)return s;for(let h=0,c=e.dataItems.length;h<c;h++){let p=e.dataItems[h];if(p.get(i)===l)return p}}}zoomToIndexes(e,t,i){let n=this.dataItems.length;this.zoom(e/n,t/n,i)}zoomToCategories(e,t,i){this.zoomToIndexes(this.categoryToIndex(e),this.categoryToIndex(t)+1,i)}getCellWidthPosition(){return this._frequency/this.dataItems.length/(this.get("end",1)-this.get("start",0))}}Object.defineProperty(ba,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CategoryAxis"});Object.defineProperty(ba,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:co.classNames.concat([ba.className])});class Uu extends co{constructor(){super(...arguments),Object.defineProperty(this,"_dirtyExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirtySelectionExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_deltaMinMax",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_minReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_maxReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_baseValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_syncDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minLogAdjusted",{enumerable:!0,configurable:!0,writable:!0,value:1})}markDirtyExtremes(){this._dirtyExtremes=!0,this.markDirty()}markDirtySelectionExtremes(){this._dirtySelectionExtremes=!0,this.markDirty()}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["axis"]),this.setPrivateRaw("name","value"),this.addTag("value"),super._afterNew()}_prepareChildren(){if(super._prepareChildren(),this.isDirty("syncWithAxis")){this._prevSettings.syncWithAxis&&this._syncDp&&this._syncDp.dispose();let t=this.get("syncWithAxis");t&&(this._syncDp=new Kr([t.onPrivate("selectionMinFinal",()=>{this._dirtySelectionExtremes=!0}),t.onPrivate("selectionMaxFinal",()=>{this._dirtySelectionExtremes=!0})]))}(this._sizeDirty||this._dirtyExtremes||this._valuesDirty||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("min")||this.isDirty("max")||this.isDirty("extraMin")||this.isDirty("extraMax")||this.isDirty("logarithmic")||this.isDirty("treatZeroAs")||this.isDirty("baseValue")||this.isDirty("strictMinMax")||this.isDirty("strictMinMaxSelection")||this.isDirty("maxPrecision")||this.isDirty("numberFormat"))&&(this._getMinMax(),this.ghostLabel.set("text",""),this._dirtyExtremes=!1),this._dirtySelectionExtremes&&!this._isPanning&&this.get("autoZoom",!0)&&(this._getSelectionMinMax(),this._dirtySelectionExtremes=!1),this._groupData(),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("min")||this.isPrivateDirty("selectionMax")||this.isPrivateDirty("selectionMin")||this.isPrivateDirty("max")||this.isPrivateDirty("step")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("logarithmic"))&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges()),this._baseValue=this.baseValue()}_groupData(){}_formatText(e){const t=this.get("numberFormat"),i=this.getNumberFormatter();let n="";return t?n=i.format(e,t):n=i.format(e,void 0,this.getPrivate("stepDecimalPlaces")),n}_prepareAxisItems(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(ve(e)&&ve(t)){const i=this.get("logarithmic"),n=this.getPrivate("step"),s=this.getPrivate("selectionMin"),a=this.getPrivate("selectionMax")+n;let l=s-n,h=0,c=1,p=e;if(i){if(l=this._minLogAdjusted,l<s)for(;l<s;)l+=n;p=l,p<=0&&(p=1,n<1&&(p=n)),c=Math.log(a-n)*Math.LOG10E-Math.log(p)*Math.LOG10E,c>2&&(l=Math.pow(10,Math.log(p)*Math.LOG10E-5))}let g=-1/0;for(;l<a;){let m;this.dataItems.length<h+1?(m=new ll(this,void 0,{}),this._dataItems.push(m),this.processDataItem(m)):m=this.dataItems[h],this._createAssets(m,[]),m.isHidden()&&m.show(),m.setRaw("value",l);const _=m.get("label");if(_&&_.set("text",this._formatText(l)),this._prepareDataItem(m),i&&c>2?l=Math.pow(10,Math.log(p)*Math.LOG10E+h-5):l+=n,g==l)break;let b=Math.pow(10,Math.floor(Math.log(Math.abs(n))*Math.LOG10E));if(b<1){let x=Math.round(Math.abs(Math.log(Math.abs(b))*Math.LOG10E))+2;l=kr(l,x)}h++,g=l}for(let m=h;m<this.dataItems.length;m++)this.dataItems[m].hide();ce(this.series,m=>{m.inited&&m._markDirtyAxes()}),this._updateGhost()}}_prepareDataItem(e,t){let i=this.get("renderer"),n=e.get("value"),s=e.get("endValue"),a=this.valueToPosition(n),l=a,h=this.valueToPosition(n+this.getPrivate("step"));ve(s)&&(l=this.valueToPosition(s),h=l),e.get("isRange")&&s==null&&(h=a),i.updateLabel(e.get("label"),a,l,t);const c=e.get("grid");if(i.updateGrid(c,a,l),c&&(n==this.get("baseValue",0)?(c.addTag("base"),c._applyThemes()):c.hasTag("base")&&(c.removeTag("base"),c._applyThemes())),i.updateTick(e.get("tick"),a,l,t),i.updateFill(e.get("axisFill"),a,h),this._processBullet(e),i.updateBullet(e.get("bullet"),a,l),!e.get("isRange")){const p=this.get("fillRule");p&&p(e)}}_handleRangeChange(){let e=this.positionToValue(this.get("start",0)),t=this.positionToValue(this.get("end",1));const i=this.get("renderer").gridCount();let n=this._adjustMinMax(e,t,i,!0),s=RO(n.step);this.setPrivateRaw("stepDecimalPlaces",s),e=kr(e,s),t=kr(t,s),n=this._adjustMinMax(e,t,i,!0);let a=n.step;e=n.min,t=n.max,(this.getPrivate("selectionMin")!==e||this.getPrivate("selectionMax")!==t||this.getPrivate("step")!==a)&&(this.setPrivateRaw("selectionMin",e),this.setPrivateRaw("selectionMax",t),this.setPrivateRaw("step",a))}positionToValue(e){const t=this.getPrivate("min"),i=this.getPrivate("max");return this.get("logarithmic")?Math.pow(Math.E,(e*(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)+Math.log(t)*Math.LOG10E)/Math.LOG10E):e*(i-t)+t}valueToPosition(e){const t=this.getPrivate("min"),i=this.getPrivate("max");if(this.get("logarithmic")){if(e<=0){let n=this.get("treatZeroAs");ve(n)&&(e=n)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}else return(e-t)/(i-t)}valueToFinalPosition(e){const t=this.getPrivate("minFinal"),i=this.getPrivate("maxFinal");if(this.get("logarithmic")){if(e<=0){let n=this.get("treatZeroAs");ve(n)&&(e=n)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}else return(e-t)/(i-t)}getX(e,t,i){e=i+(e-i)*t;const n=this.valueToPosition(e);return this._settings.renderer.positionToCoordinate(n)}getY(e,t,i){e=i+(e-i)*t;const n=this.valueToPosition(e);return this._settings.renderer.positionToCoordinate(n)}getDataItemCoordinateX(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,n))}getDataItemPositionX(e,t,i,n){let s=e.get(t);if(e.get("stackToItemX")){const l=e.component;s=s*n+l.getStackedXValueWorking(e,t)}else s=this._baseValue+(s-this._baseValue)*n;return this.valueToPosition(s)}getDataItemCoordinateY(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,n))}getDataItemPositionY(e,t,i,n){let s=e.get(t);if(e.get("stackToItemY")){const l=e.component;s=s*n+l.getStackedYValueWorking(e,t)}else s=this._baseValue+(s-this._baseValue)*n;return this.valueToPosition(s)}basePosition(){return this.valueToPosition(this.baseValue())}baseValue(){const e=Math.min(this.getPrivate("minFinal",-1/0),this.getPrivate("selectionMin",-1/0)),t=Math.max(this.getPrivate("maxFinal",1/0),this.getPrivate("selectionMax",1/0));let i=this.get("baseValue",0);return i<e&&(i=e),i>t&&(i=t),i}cellEndValue(e){return e}fixSmallStep(e){return 1+e===1?(e*=2,this.fixSmallStep(e)):e}_fixMin(e){return e}_fixMax(e){return e}_calculateTotals(){if(this.get("calculateTotals")){let e=this.series[0];if(e){let t=e.startIndex();if(e.dataItems.length>0){t>0&&t--;let i=e.endIndex();i<e.dataItems.length&&i++;let n,s;e.get("yAxis")==this?(n="valueY",s="vcy"):e.get("xAxis")==this&&(n="valueX",s="vcx");let a=n+"Working";if(n)for(let l=t;l<i;l++){let h=0,c=0;ce(this.series,p=>{if(!p.get("excludeFromTotal")){let g=p.dataItems[l];if(g){let m=g.get(a)*p.get(s);xa(m)||(h+=m,c+=Math.abs(m))}}}),ce(this.series,p=>{if(!p.get("excludeFromTotal")){let g=p.dataItems[l];if(g){let m=g.get(a)*p.get(s);xa(m)||(g.set(n+"Total",c),g.set(n+"Sum",h),g.set(n+"TotalPercent",m/c*100))}}})}}}}}_getSelectionMinMax(){const e=this.getPrivate("minFinal"),t=this.getPrivate("maxFinal"),i=this.get("min"),n=this.get("max");let s=this.get("extraMin",0),a=this.get("extraMax",0);this.get("logarithmic")&&(this.get("extraMin")==null&&(s=.1),this.get("extraMax")==null&&(a=.2));const l=this.get("renderer").gridCount(),h=this.get("strictMinMaxSelection"),c=this.get("strictMinMax");if(ve(e)&&ve(t)){let p=t,g=e;if(ce(this.series,k=>{if(!k.get("ignoreMinMax")){let C,O;const F=k.getPrivate("outOfSelection");k.get("xAxis")===this?F||(C=k.getPrivate("selectionMinX",k.getPrivate("minX")),O=k.getPrivate("selectionMaxX",k.getPrivate("maxX"))):k.get("yAxis")===this&&(F||(C=k.getPrivate("selectionMinY",k.getPrivate("minY")),O=k.getPrivate("selectionMaxY",k.getPrivate("maxY")))),!k.isHidden()&&!k.isShowing()&&(ve(C)&&(p=Math.min(p,C)),ve(O)&&(g=Math.max(g,O)))}}),this.axisRanges.each(k=>{if(k.get("affectsMinMax")){let C=k.get("value");C!=null&&(p=Math.min(p,C),g=Math.max(g,C)),C=k.get("endValue"),C!=null&&(p=Math.min(p,C),g=Math.max(g,C))}}),p>g&&([p,g]=[g,p]),ve(i)?c?p=i:p=e:c&&ve(this._minReal)&&(p=this._minReal),ve(n)?c?g=n:g=t:c&&ve(this._maxReal)&&(g=this._maxReal),p===g){p-=this._deltaMinMax,g+=this._deltaMinMax;let k=this._adjustMinMax(p,g,l,c);p=k.min,g=k.max}let m=p,_=g;p-=(g-p)*s,g+=(g-p)*a;let b=this._adjustMinMax(p,g,l);p=b.min,g=b.max,p=Di(p,e,t),g=Di(g,e,t),b=this._adjustMinMax(p,g,l,!0),c||(p=b.min,g=b.max);const x=this.get("syncWithAxis");x&&(b=this._syncAxes(p,g,b.step,x.getPrivate("selectionMinFinal",x.getPrivate("minFinal",0)),x.getPrivate("selectionMaxFinal",x.getPrivate("maxFinal",1)),x.getPrivate("selectionStepFinal",x.getPrivate("step",1))),p=b.min,g=b.max),c&&(ve(i)&&(p=Math.max(p,i)),ve(n)&&(g=Math.min(g,n))),h&&(p=m-(g-p)*s,g=_+(g-p)*a),this.get("logarithmic")&&(p<=0&&(p=m*(1-Math.min(s,.99))),p<e&&(p=e),g>t&&(g=t));let w=Math.min(20,Math.ceil(Math.log(this.getPrivate("maxZoomFactor",100)+1)/Math.LN10)+2),P=kr(this.valueToFinalPosition(p),w),E=kr(this.valueToFinalPosition(g),w);this.setPrivateRaw("selectionMinFinal",p),this.setPrivateRaw("selectionMaxFinal",g),this.setPrivateRaw("selectionStepFinal",b.step),this.zoom(P,E)}}_getMinMax(){let e=this.get("min"),t=this.get("max"),i=1/0,n=-1/0,s=this.get("extraMin",0),a=this.get("extraMax",0);this.get("logarithmic")&&(this.get("extraMin")==null&&(s=.1),this.get("extraMax")==null&&(a=.2));let l=1/0;if(ce(this.series,k=>{if(!k.get("ignoreMinMax")){let C,O;if(k.get("xAxis")===this?(C=k.getPrivate("minX"),O=k.getPrivate("maxX")):k.get("yAxis")===this&&(C=k.getPrivate("minY"),O=k.getPrivate("maxY")),ve(C)&&ve(O)){i=Math.min(i,C),n=Math.max(n,O);let F=O-C;F<=0&&(F=Math.abs(O/100)),F<l&&(l=F)}}}),this.axisRanges.each(k=>{if(k.get("affectsMinMax")){let C=k.get("value");C!=null&&(i=Math.min(i,C),n=Math.max(n,C)),C=k.get("endValue"),C!=null&&(i=Math.min(i,C),n=Math.max(n,C))}}),this.get("logarithmic")){let k=this.get("treatZeroAs");ve(k)&&i<=0&&(i=k)}if(i===0&&n===0&&(n=.9,i=-.9),ve(e)&&(i=e),ve(t)&&(n=t),i===1/0||n===-1/0){this.setPrivate("minFinal",void 0),this.setPrivate("maxFinal",void 0);return}const h=i,c=n;let p=this.adapters.fold("min",i),g=this.adapters.fold("max",n);ve(p)&&(i=p),ve(g)&&(n=g),i=this._fixMin(i),n=this._fixMax(n),n-i<=1/Math.pow(10,15)&&(n-i!==0?this._deltaMinMax=(n-i)/2:this._getDelta(n),i-=this._deltaMinMax,n+=this._deltaMinMax),i-=(n-i)*s,n+=(n-i)*a,this.get("logarithmic")&&(i<0&&h>=0&&(i=0),n>0&&c<=0&&(n=0)),this._minReal=i,this._maxReal=n;let m=this.get("strictMinMax"),_=this.get("strictMinMaxSelection",!1);_&&(m=_);let b=m;ve(t)&&(b=!0);let x=this.get("renderer").gridCount(),w=this._adjustMinMax(i,n,x,b);i=w.min,n=w.max,w=this._adjustMinMax(i,n,x,!0),i=w.min,n=w.max,m&&(ve(e)?i=e:i=this._minReal,ve(t)?n=t:n=this._maxReal,n-i<=1e-8&&(i-=this._deltaMinMax,n+=this._deltaMinMax),i-=(n-i)*s,n+=(n-i)*a),p=this.adapters.fold("min",i),g=this.adapters.fold("max",n),ve(p)&&(i=p),ve(g)&&(n=g),l==1/0&&(l=n-i);let P=Math.round(Math.abs(Math.log(Math.abs(n-i))*Math.LOG10E))+5;i=kr(i,P),n=kr(n,P);const E=this.get("syncWithAxis");if(E&&(w=this._syncAxes(i,n,w.step,E.getPrivate("minFinal",E.getPrivate("min",0)),E.getPrivate("maxFinal",E.getPrivate("max",1)),E.getPrivate("step",1)),i=w.min,n=w.max),this.setPrivateRaw("maxZoomFactor",Math.max(1,Math.ceil((n-i)/l*this.get("maxZoomFactor",100)))),this._fixZoomFactor(),this.get("logarithmic")&&(this._minLogAdjusted=i,i=this._minReal,n=this._maxReal,i<=0&&(i=h*(1-Math.min(s,.99)))),ve(i)&&ve(n)&&(this.getPrivate("minFinal")!==i||this.getPrivate("maxFinal")!==n)){this.setPrivate("minFinal",i),this.setPrivate("maxFinal",n),this._saveMinMax(i,n);const k=this.get("interpolationDuration",0),C=this.get("interpolationEasing");this.animatePrivate({key:"min",to:i,duration:k,easing:C}),this.animatePrivate({key:"max",to:n,duration:k,easing:C})}}_fixZoomFactor(){}_getDelta(e){let t=Math.log(Math.abs(e))*Math.LOG10E,i=Math.pow(10,Math.floor(t));i=i/10,this._deltaMinMax=i}_saveMinMax(e,t){}_adjustMinMax(e,t,i,n){i<=1&&(i=1),i=Math.round(i);let s=e,a=t,l=t-e;l===0&&(l=Math.abs(t));let h=Math.log(Math.abs(l))*Math.LOG10E,c=Math.pow(10,Math.floor(h));c=c/10;let p=c;n&&(p=0),n?(e=Math.floor(e/c)*c,t=Math.ceil(t/c)*c):(e=Math.ceil(e/c)*c-p,t=Math.floor(t/c)*c+p),e<0&&s>=0&&(e=0),t>0&&a<=0&&(t=0),h=Math.log(Math.abs(l))*Math.LOG10E,c=Math.pow(10,Math.floor(h)),c=c/100;let g=Math.ceil(l/i/c)*c,m=Math.pow(10,Math.floor(Math.log(Math.abs(g))*Math.LOG10E)),_=Math.ceil(g/m);_>5?_=10:_<=5&&_>2&&(_=5),g=Math.ceil(g/(m*_))*m*_;let b=this.get("maxPrecision");if(ve(b)){let E=qO(g,b);b<Number.MAX_VALUE&&g!==E&&(g=E)}let x=0;m<1&&(x=Math.round(Math.abs(Math.log(Math.abs(m))*Math.LOG10E))+1,g=kr(g,x));let w=Math.floor(e/g);e=kr(g*w,x);let P;return n?P=Math.floor(t/g):P=Math.ceil(t/g),P===w&&P++,t=kr(g*P,x),t<a&&(t=t+g),e>s&&(e=e-g),g=this.fixSmallStep(g),{min:e,max:t,step:g}}getTooltipText(e){const t=this.get("tooltipNumberFormat",this.get("numberFormat")),i=this.getNumberFormatter(),n=this.get("extraTooltipPrecision",0),s=this.getPrivate("stepDecimalPlaces",0)+n,a=kr(this.positionToValue(e),s);return t?i.format(a,t):i.format(a,void 0,s)}getSeriesItem(e,t){let i=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),n=this.positionToValue(t),s,a;if(ce(e.dataItems,(l,h)=>{const c=Math.abs(l.get(i)-n);(s===void 0||c<a)&&(s=h,a=c)}),s!=null)return e.dataItems[s]}zoomToValues(e,t,i){const n=this.getPrivate("minFinal",0),s=this.getPrivate("maxFinal",0);this.getPrivate("min")!=null&&this.getPrivate("max")!=null&&this.zoom((e-n)/(s-n),(t-n)/(s-n),i)}_syncAxes(e,t,i,n,s,a){if(this.get("syncWithAxis")){let h=Math.round(s-n)/a,c=Math.round((t-e)/i),p=this.get("renderer").gridCount();if(ve(h)&&ve(c)){let g=!1,m=0,_=(t-e)*.01,b=e,x=t,w=i;for(;g!=!0;)if(g=this._checkSync(b,x,w,h),m++,m>500&&(g=!0),g)e=b,t=x,i=w;else{m/3==Math.round(m/3)?(b=e-_*m,e>=0&&b<0&&(b=0)):(x=t+_*m,x<=0&&x>0&&(x=0));let P=this._adjustMinMax(b,x,p,!0);b=P.min,x=P.max,w=P.step}}}return{min:e,max:t,step:i}}_checkSync(e,t,i,n){let s=(t-e)/i;for(let a=1;a<n;a++)if(kr(s/a,1)==n||s*a==n)return!0;return!1}getCellWidthPosition(){let e=this.getPrivate("selectionMax",this.getPrivate("max")),t=this.getPrivate("selectionMin",this.getPrivate("min"));return ve(e)&&ve(t)?this.getPrivate("step",1)/(e-t):.05}}Object.defineProperty(Uu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ValueAxis"});Object.defineProperty(Uu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:co.classNames.concat([Uu.className])});class Rc extends cr{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(Rc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisLabel"});Object.defineProperty(Rc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:cr.classNames.concat([Rc.className])});class Ic extends pl{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(Ic,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisTick"});Object.defineProperty(Ic,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:pl.classNames.concat([Ic.className])});class fo extends wi{constructor(){super(...arguments),Object.defineProperty(this,"_axisLength",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"_start",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_end",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_inversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_minSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lc",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_ls",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_thumbDownPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>Ic._new(this._root,{themeTags:It(this.ticks.template.get("themeTags",[]),this.get("themeTags",[]))},[this.ticks.template]))}),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>_l._new(this._root,{themeTags:It(this.grid.template.get("themeTags",[]),this.get("themeTags",[]))},[this.grid.template]))}),Object.defineProperty(this,"axisFills",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>wi._new(this._root,{themeTags:It(this.axisFills.template.get("themeTags",["axis","fill"]),this.get("themeTags",[]))},[this.axisFills.template]))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>Rc._new(this._root,{themeTags:It(this.labels.template.get("themeTags",[]),this.get("themeTags",[]))},[this.labels.template]))}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeTick(e,t){const i=this.ticks.make();return i._setDataItem(e),e.setRaw("tick",i),i.set("themeTags",It(i.get("themeTags"),t)),this.axis.labelsContainer.children.push(i),this.ticks.push(i),i}makeGrid(e,t){const i=this.grid.make();return i._setDataItem(e),e.setRaw("grid",i),i.set("themeTags",It(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),this.grid.push(i),i}makeAxisFill(e,t){const i=this.axisFills.make();return i._setDataItem(e),i.set("themeTags",It(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),e.setRaw("axisFill",i),this.axisFills.push(i),i}makeLabel(e,t){const i=this.labels.make();return i.set("themeTags",It(i.get("themeTags"),t)),this.axis.labelsContainer.children.moveValue(i,0),i._setDataItem(e),e.setRaw("label",i),this.labels.push(i),i}axisLength(){return 0}gridCount(){return this.axisLength()/this.get("minGridDistance",50)}_updatePositions(){}_afterNew(){super._afterNew(),this.set("isMeasured",!1);const e=this.thumb;e&&(this._disposers.push(e.events.on("pointerdown",t=>{this._handleThumbDown(t.originalEvent)})),this._disposers.push(e.events.on("globalpointerup",t=>{this._handleThumbUp(t.originalEvent)})),this._disposers.push(e.events.on("globalpointermove",t=>{this._handleThumbMove(t.originalEvent)})))}_changed(){if(super._changed(),this.isDirty("pan")){const e=this.thumb;if(e){const t=this.axis.labelsContainer,i=this.get("pan");i=="zoom"?t.children.push(e):i=="none"&&t.children.removeValue(e)}}}_handleThumbDown(e){this._thumbDownPoint=this.toLocal(this._root.documentPointToRoot({x:e.clientX,y:e.clientY}));const t=this.axis;this._downStart=t.get("start"),this._downEnd=t.get("end")}_handleThumbUp(e){this._thumbDownPoint=void 0}_handleThumbMove(e){const t=this._thumbDownPoint;if(t){const i=this.toLocal(this._root.documentPointToRoot({x:e.clientX,y:e.clientY})),n=this._downStart,s=this._downEnd,a=this._getPan(i,t)*Math.min(1,s-n)/2;this.axis.setAll({start:n-a,end:s+a})}}_getPan(e,t){return 0}positionToCoordinate(e){return this._inversed?(this._end-e)*this._axisLength:(e-this._start)*this._axisLength}updateTooltipBounds(e){}_updateSize(){this.markDirty(),this._clear=!0}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e=e*(i-t),this.get("inversed")?e=i-e:e=t+e,e}fixPosition(e){return this.get("inversed")?1-e:e}_updateLC(){}toggleVisibility(e,t,i,n){let s=this.axis;const a=s.get("start",0),l=s.get("end",1);let h=a+(l-a)*(i-1e-4),c=a+(l-a)*(n+1e-4);t<h||t>c?e.setPrivate("visible",!1):e.setPrivate("visible",!0)}_positionTooltip(e,t){const i=this.chart;i&&(i.inPlot(t)?e.set("pointTo",this._display.toGlobal(t)):e.hide())}processAxis(){}}Object.defineProperty(fo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRenderer"});Object.defineProperty(fo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:wi.classNames.concat([fo.className])});class Wu extends fo{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:Tn.new(this._root,{width:ze,isMeasured:!1,themeTags:["axis","x","thumb"]})})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["renderer","x"]),super._afterNew(),this.setPrivateRaw("letter","X");const e=this.grid.template;e.set("height",ze),e.set("width",0),e.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(0,i.height())}),this.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(i.width(),0)})}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("x",-1e3);const t="opposite",i="inside";if(this.isDirty(t)||this.isDirty(i)){const n=this.chart,s=e.children;if(this.get(i)?e.addTag(i):e.removeTag(i),n){if(this.get(t)){const a=n.topAxesContainer.children;a.indexOf(e)==-1&&a.insertIndex(0,e),e.addTag(t),s.moveValue(this)}else{const a=n.bottomAxesContainer.children;a.indexOf(e)==-1&&a.moveValue(e),e.removeTag(t),s.moveValue(this,0)}e.ghostLabel._applyThemes(),this.labels.each(a=>{a._applyThemes()}),this.root._markDirtyRedraw()}e.markDirtySize()}this.thumb.setPrivate("height",e.labelsContainer.height())}_getPan(e,t){return(t.x-e.x)/this.width()}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e-=this._ls,e=e*(i-t)/this._lc,this.get("inversed")?e=i-e:e=t+e,e}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerWidth();this._lc=this.axisLength()/i,this._ls=(e.x()-t.get("paddingLeft",0))/i}}_updatePositions(){const e=this.axis,t=e.x()-ai(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0);e.gridContainer.set("x",t),e.topGridContainer.set("x",t),e.bulletsContainer.set("y",this.y());const i=e.chart;if(i){const n=i.plotContainer,s=e.axisHeader;let a=e.get("marginLeft",0),l=e.x()-a;const h=e.parent;h&&(l-=h.get("paddingLeft",0)),s.children.length>0?(a=e.axisHeader.width(),e.set("marginLeft",a+1)):s.set("width",a),s.setAll({x:l,y:-1,height:n.height()+2})}}processAxis(){super.processAxis();const e=this.axis;e.set("width",ze);const t=this._root.verticalLayout;e.set("layout",t),e.labelsContainer.set("width",ze),e.axisHeader.setAll({layout:t})}axisLength(){return this.axis.width()}positionToPoint(e){return{x:this.positionToCoordinate(e),y:0}}updateTick(e,t,i,n){if(e){ve(t)||(t=0);let s=.5;ve(n)&&n>1?s=e.get("multiLocation",s):s=e.get("location",s),ve(i)&&i!=t&&(t=t+(i-t)*s),e.set("x",this.positionToCoordinate(t));let a=e.get("length",0);const l=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("y",ze),l||(a*=-1)):(e.set("y",0),l&&(a*=-1)),e.set("draw",h=>{h.moveTo(0,0),h.lineTo(0,a)}),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateLabel(e,t,i,n){if(e){let s=.5;ve(n)&&n>1?s=e.get("multiLocation",s):s=e.get("location",s),ve(t)||(t=0);const a=e.get("inside",this.get("inside",!1));this.get("opposite")?a?(e.set("position","absolute"),e.set("y",0)):(e.set("position","relative"),e.set("y",ze)):a?(e.set("y",0),e.set("position","absolute")):(e.set("y",void 0),e.set("position","relative")),ve(i)&&i!=t&&(t=t+(i-t)*s),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){ve(t)||(t=0);let n=e.get("location",.5);ve(i)&&i!=t&&(t=t+(i-t)*n),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateBullet(e,t,i){if(e){const n=e.get("sprite");if(n){ve(t)||(t=0);let s=e.get("location",.5);ve(i)&&i!=t&&(t=t+(i-t)*s);let a=this.axis.roundAxisPosition(t,s),l=this.axis._bullets[a],h=-1;if(this.get("opposite")&&(h=1),e.get("stacked"))if(l){let c=l.get("sprite");c&&n.set("y",c.y()+c.height()*h)}else n.set("y",0);this.axis._bullets[a]=e,n.set("x",this.positionToCoordinate(t)),this.toggleVisibility(n,t,0,1)}}}updateFill(e,t,i){if(e){ve(t)||(t=0),ve(i)||(i=1);let n=this.positionToCoordinate(t),s=this.positionToCoordinate(i);this.fillDrawMethod(e,n,s)}}fillDrawMethod(e,t,i){e.set("draw",n=>{const s=this.axis.gridContainer.height(),a=this.width();i<t&&([i,t]=[t,i]),!(t>a||i<0)&&(n.moveTo(t,0),n.lineTo(i,0),n.lineTo(i,s),n.lineTo(t,s),n.lineTo(t,0))})}positionTooltip(e,t){this._positionTooltip(e,{x:this.positionToCoordinate(t),y:0})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let n=this._display.toGlobal({x:0,y:0}),s=n.x,a=0,l=this.axisLength(),h=i,c="up";this.get("opposite")?t?(c="up",a=n.y,h=i):(c="down",a=n.y-i,h=i):t?(c="down",a=n.y-i,h=i):(c="up",a=n.y,h=i);const p={left:s,right:s+l,top:a,bottom:a+h},g=e.get("bounds");Rv(p,g)||(e.set("bounds",p),e.set("pointerOrientation",c))}}Object.defineProperty(Wu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererX"});Object.defineProperty(Wu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:fo.classNames.concat([Wu.className])});class ju extends fo{constructor(){super(...arguments),Object.defineProperty(this,"_downY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:Tn.new(this._root,{height:ze,isMeasured:!1,themeTags:["axis","y","thumb"]})})}_afterNew(){this._settings.themeTags=It(this._settings.themeTags,["renderer","y"]),this._settings.opposite&&this._settings.themeTags.push("opposite"),super._afterNew(),this.setPrivateRaw("letter","Y");const e=this.grid.template;e.set("width",ze),e.set("height",0),e.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(i.width(),0)}),this.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(0,i.height())})}_getPan(e,t){return(e.y-t.y)/this.height()}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("y",-1e3);const t=this.thumb,i="opposite",n="inside",s=this.chart;if(this.isDirty(i)||this.isDirty(n)){const l=e.children;if(this.get(n)?e.addTag(n):e.removeTag(n),s){if(this.get(i)){const h=s.rightAxesContainer.children;h.indexOf(e)==-1&&h.moveValue(e,0),e.addTag(i),l.moveValue(this,0)}else{const h=s.leftAxesContainer.children;h.indexOf(e)==-1&&h.moveValue(e),e.removeTag(i),l.moveValue(this)}e.ghostLabel._applyThemes(),this.labels.each(h=>{h._applyThemes()}),this.root._markDirtyRedraw()}e.markDirtySize()}const a=e.labelsContainer.width();s&&(this.get(i)?t.set("centerX",0):t.set("centerX",a)),t.setPrivate("width",a)}processAxis(){super.processAxis();const e=this.axis;e.get("height")==null&&e.set("height",ze);const t=this._root.horizontalLayout;e.set("layout",t),e.labelsContainer.set("height",ze),e.axisHeader.set("layout",t)}_updatePositions(){const e=this.axis,t=e.y()-ai(e.get("centerY",0),e.height());e.gridContainer.set("y",t),e.topGridContainer.set("y",t),e.bulletsContainer.set("x",this.x());const i=e.chart;if(i){const n=i.plotContainer,s=e.axisHeader;let a=e.get("marginTop",0);s.children.length>0?(a=e.axisHeader.height(),e.set("marginTop",a+1)):s.set("height",a),s.setAll({y:e.y()-a,x:-1,width:n.width()+2})}}axisLength(){return this.axis.innerHeight()}positionToPoint(e){return{x:0,y:this.positionToCoordinate(e)}}updateLabel(e,t,i,n){if(e){ve(t)||(t=0);let s=.5;ve(n)&&n>1?s=e.get("multiLocation",s):s=e.get("location",s);const a=this.get("opposite"),l=e.get("inside",this.get("inside",!1));a?(e.set("x",0),l?e.set("position","absolute"):e.set("position","relative")):l?(e.set("x",0),e.set("position","absolute")):(e.set("x",void 0),e.set("position","relative")),ve(i)&&i!=t&&(t=t+(i-t)*s),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){ve(t)||(t=0);let n=e.get("location",.5);ve(i)&&i!=t&&(t=t+(i-t)*n),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateTick(e,t,i,n){if(e){ve(t)||(t=0);let s=.5;ve(n)&&n>1?s=e.get("multiLocation",s):s=e.get("location",s),ve(i)&&i!=t&&(t=t+(i-t)*s),e.set("y",this.positionToCoordinate(t));let a=e.get("length",0);const l=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("x",0),l&&(a*=-1)):l||(a*=-1),e.set("draw",h=>{h.moveTo(0,0),h.lineTo(a,0)}),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateBullet(e,t,i){if(e){const n=e.get("sprite");if(n){ve(t)||(t=0);let s=e.get("location",.5);ve(i)&&i!=t&&(t=t+(i-t)*s);let a=this.axis.roundAxisPosition(t,s),l=this.axis._bullets[a],h=1;if(this.get("opposite")&&(h=-1),e.get("stacked"))if(l){let c=l.get("sprite");c&&n.set("x",c.x()+c.width()*h)}else n.set("x",0);this.axis._bullets[a]=e,n.set("y",this.positionToCoordinate(t)),this.toggleVisibility(n,t,0,1)}}}updateFill(e,t,i){if(e){ve(t)||(t=0),ve(i)||(i=1);let n=this.positionToCoordinate(t),s=this.positionToCoordinate(i);this.fillDrawMethod(e,n,s)}}fillDrawMethod(e,t,i){e.set("draw",n=>{const s=this.axis.gridContainer.width(),a=this.height();i<t&&([i,t]=[t,i]),!(t>a||i<0)&&(n.moveTo(0,t),n.lineTo(s,t),n.lineTo(s,i),n.lineTo(0,i),n.lineTo(0,t))})}positionToCoordinate(e){return this._inversed?(e-this._start)*this._axisLength:(this._end-e)*this._axisLength}positionTooltip(e,t){this._positionTooltip(e,{x:0,y:this.positionToCoordinate(t)})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let n=this._display.toGlobal({x:0,y:0}),s=n.y,a=0,l=this.axisLength(),h=i,c="right";this.get("opposite")?t?(c="right",a=n.x-i,h=i):(c="left",a=n.x,h=i):t?(c="left",a=n.x,h=i):(c="right",a=n.x-i,h=i);const p={left:a,right:a+h,top:s,bottom:s+l},g=e.get("bounds");Rv(p,g)||(e.set("bounds",p),e.set("pointerOrientation",c))}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerHeight();this._lc=this.axisLength()/i,this._ls=e.y()/i}}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e-=this._ls,e=e*(i-t)/this._lc,this.get("inversed")?e=t+e:e=i-e,e}fixPosition(e){return this.get("inversed")?e:1-e}}Object.defineProperty(ju,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererY"});Object.defineProperty(ju,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:fo.classNames.concat([ju.className])});class Xu extends ho{constructor(){super(...arguments),Object.defineProperty(this,"columns",{enumerable:!0,configurable:!0,writable:!0,value:new $r(Hi.new({}),()=>ya._new(this._root,{position:"absolute",themeTags:It(this.columns.template.get("themeTags",[]),["series","column"])},[this.columns.template]))})}makeColumn(e,t){const i=this.mainContainer.children.push(t.make());return i._setDataItem(e),t.push(i),i}_processAxisRange(e){super._processAxisRange(e),e.columns=new $r(Hi.new({}),()=>ya._new(this._root,{position:"absolute",themeTags:It(e.columns.template.get("themeTags",[]),["series","column"])},[this.columns.template,e.columns.template]))}}Object.defineProperty(Xu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColumnSeries"});Object.defineProperty(Xu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ho.classNames.concat([Xu.className])});class ip extends Zc{setupDefaultRules(){super.setupDefaultRules(),this.rule("Component").setAll({interpolationDuration:600}),this.rule("Hierarchy").set("animationDuration",600),this.rule("Scrollbar").set("animationDuration",600),this.rule("Tooltip").set("animationDuration",300),this.rule("MapChart").set("animationDuration",1e3),this.rule("MapChart").set("wheelDuration",300),this.rule("Entity").setAll({stateAnimationDuration:600}),this.rule("Sprite").states.create("default",{stateAnimationDuration:600}),this.rule("Tooltip",["axis"]).setAll({animationDuration:200}),this.rule("WordCloud").set("animationDuration",500)}}function v3(r){const e=th.new("analytics__commonSum");e.setThemes([ip.new(e)]);var t=e.container.children.push(Nu.new(e,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0})),i=t.set("cursor",Hu.new(e,{}));i.lineY.set("visible",!1);var n=Wu.new(e,{minGridDistance:30});n.labels.template.setAll({rotation:-90,centerY:ot,centerX:ze,paddingRight:15}),n.grid.template.setAll({location:1});var s=t.xAxes.push(ba.new(e,{maxDeviation:.3,categoryField:"name",renderer:n,tooltip:Ws.new(e,{})}));s.children.push(cr.new(e,{text:"ТБ",x:ot,centerX:ot}));var a=t.yAxes.push(Uu.new(e,{maxDeviation:.3,renderer:ju.new(e,{strokeOpacity:.1})}));a.children.unshift(cr.new(e,{rotation:-90,text:"Риски, млн. руб.",y:ot,centerX:ot}));var l=t.series.push(Xu.new(e,{name:"Series 1",xAxis:s,yAxis:a,valueYField:"sum",sequencedInterpolation:!0,categoryXField:"name",tooltip:Ws.new(e,{labelText:"{valueY}"})}));l.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5,strokeOpacity:0}),l.columns.template.adapters.add("fill",function(h,c){return t.get("colors").getIndex(l.columns.indexOf(c))}),l.columns.template.adapters.add("stroke",function(h,c){return t.get("colors").getIndex(l.columns.indexOf(c))}),s.data.setAll(r),l.data.setAll(r),l.appear(1e3),t.appear(1e3,100)}function y3(r){var e=th.new("analytics__GosbBlock");e.setThemes([ip.new(e)]);var t=e.container.children.push(Nu.new(e,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0})),i=t.set("cursor",Hu.new(e,{}));i.lineY.set("visible",!1);var n=Wu.new(e,{minGridDistance:30});n.labels.template.setAll({rotation:-90,centerY:ot,centerX:ze,paddingRight:15}),n.grid.template.setAll({location:1});var s=t.xAxes.push(ba.new(e,{maxDeviation:.3,categoryField:"gosbId",renderer:n,tooltip:Ws.new(e,{})}));s.children.push(cr.new(e,{text:"ГОСБ",x:ot,centerX:ot}));var a=t.yAxes.push(Uu.new(e,{maxDeviation:.3,renderer:ju.new(e,{strokeOpacity:.1})}));a.children.unshift(cr.new(e,{rotation:-90,text:"Риски, млн. руб.",y:ot,centerX:ot}));var l=t.series.push(Xu.new(e,{name:"Series 1",xAxis:s,yAxis:a,valueYField:"gosbSum",sequencedInterpolation:!0,categoryXField:"gosbId",tooltip:Ws.new(e,{labelText:"{valueY}"})}));l.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5,strokeOpacity:0}),l.columns.template.adapters.add("fill",function(h,c){return t.get("colors").getIndex(l.columns.indexOf(c))}),l.columns.template.adapters.add("stroke",function(h,c){return t.get("colors").getIndex(l.columns.indexOf(c))}),s.data.setAll(r),l.data.setAll(r),l.appear(1e3),t.appear(1e3,100)}class b3 extends Zc{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this.rule.bind(this);t("PercentSeries").setAll({legendLabelText:"{category}",legendValueText:"{valuePercentTotal.formatNumber('0.00p')}",colors:gl.new(this._root,{}),width:ze,height:ze}),t("PieChart").setAll({radius:ar(80),startAngle:-90,endAngle:270}),t("PieSeries").setAll({alignLabels:!0,startAngle:-90,endAngle:270}),t("PieSeries").states.create("hidden",{endAngle:-90,opacity:0}),t("Slice",["pie"]).setAll({position:"absolute",isMeasured:!1,x:0,y:0,toggleKey:"active",tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}",strokeWidth:1,strokeOpacity:1,role:"figure",lineJoin:"round"}),t("Slice",["pie"]).states.create("active",{shiftRadius:20,scale:1}),t("Slice",["pie"]).states.create("hoverActive",{scale:1.04}),t("Slice",["pie"]).states.create("hover",{scale:1.04}),t("RadialLabel",["pie"]).setAll({textType:"aligned",radius:10,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",paddingTop:5,paddingBottom:5,populateText:!0}),t("Tick",["pie"]).setAll({location:1}),t("SlicedChart").setAll({paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),t("FunnelSeries").setAll({startLocation:0,endLocation:1,orientation:"vertical",alignLabels:!0,sequencedInterpolation:!0}),t("FunnelSlice").setAll({interactive:!0,expandDistance:0}),t("FunnelSlice").states.create("hover",{expandDistance:.15}),t("Label",["funnel"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:ot}),t("Label",["funnel","horizontal"]).setAll({centerX:0,centerY:ot,rotation:-90}),t("Label",["funnel","vertical"]).setAll({centerY:ot,centerX:0}),t("Tick",["funnel"]).setAll({location:1}),t("FunnelSlice",["funnel","link"]).setAll({fillOpacity:.5,strokeOpacity:0,expandDistance:-.1}),t("FunnelSlice",["funnel","link","vertical"]).setAll({height:10}),t("FunnelSlice",["funnel","link","horizontal"]).setAll({width:10}),t("PyramidSeries").setAll({valueIs:"area"}),t("FunnelSlice",["pyramid","link"]).setAll({fillOpacity:.5}),t("FunnelSlice",["pyramid","link","vertical"]).setAll({height:0}),t("FunnelSlice",["pyramid","link","horizontal"]).setAll({width:0}),t("FunnelSlice",["pyramid"]).setAll({interactive:!0,expandDistance:0}),t("FunnelSlice",["pyramid"]).states.create("hover",{expandDistance:.15}),t("Label",["pyramid"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:ot}),t("Label",["pyramid","horizontal"]).setAll({centerX:0,centerY:ot,rotation:-90}),t("Label",["pyramid","vertical"]).setAll({centerY:ot,centerX:0}),t("Tick",["pyramid"]).setAll({location:1}),t("FunnelSlice",["pictorial"]).setAll({interactive:!0,tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}"}),t("Label",["pictorial"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:ot}),t("Label",["pictorial","horizontal"]).setAll({centerX:0,centerY:ot,rotation:-90}),t("Label",["pictorial","vertical"]).setAll({centerY:ot,centerX:0}),t("FunnelSlice",["pictorial","link"]).setAll({fillOpacity:.5,width:0,height:0}),t("Tick",["pictorial"]).setAll({location:.5});{const i=t("Graphics",["pictorial","background"]);i.setAll({fillOpacity:.2}),Ze(i,"fill",e,"alternativeBackground")}}}class Gu extends uo{_afterNew(){this._defaultThemes.push(b3.new(this._root)),super._afterNew(),this.chartContainer.children.push(this.seriesContainer),this.seriesContainer.children.push(this.bulletsContainer)}_processSeries(e){super._processSeries(e),this.seriesContainer.children.moveValue(this.bulletsContainer,this.seriesContainer.children.length-1)}}Object.defineProperty(Gu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentChart"});Object.defineProperty(Gu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:uo.classNames.concat([Gu.className])});class Yu extends js{constructor(){super(...arguments),Object.defineProperty(this,"slicesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"ticksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Qe.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"_lLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_rLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_hLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:this._makeSlices()}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this._makeLabels()}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:this._makeTicks()})}makeSlice(e){const t=this.slicesContainer.children.push(this.slices.make());return t.on("fill",()=>{this.updateLegendMarker(e)}),t.on("stroke",()=>{this.updateLegendMarker(e)}),t._setDataItem(e),e.set("slice",t),this.slices.push(t),t}makeLabel(e){const t=this.labelsContainer.children.push(this.labels.make());return t._setDataItem(e),e.set("label",t),this.labels.push(t),t}_shouldMakeBullet(e){return e.get("value")!=null}makeTick(e){const t=this.ticksContainer.children.push(this.ticks.make());return t._setDataItem(e),e.set("tick",t),this.ticks.push(t),t}_afterNew(){this.fields.push("category","fill"),super._afterNew()}_onDataClear(){const e=this.get("colors");e&&e.reset()}_prepareChildren(){if(super._prepareChildren(),this._lLabels=[],this._rLabels=[],this._hLabels=[],this._valuesDirty){let e=0,t=0,i=0,n=1/0,s=0;ce(this._dataItems,a=>{let l=a.get("valueWorking",0);e+=l,t+=Math.abs(l)}),ce(this._dataItems,a=>{let l=a.get("valueWorking",0);l>i&&(i=l),l<n&&(n=l),s++;let h=l/t;t==0&&(h=0),a.setRaw("valuePercentTotal",h*100)}),this.setPrivateRaw("valueLow",n),this.setPrivateRaw("valueHigh",i),this.setPrivateRaw("valueSum",e),this.setPrivateRaw("valueAverage",e/s),this.setPrivateRaw("valueAbsoluteSum",t)}}show(e){const t=Object.create(null,{show:{get:()=>super.show}});return Oi(this,void 0,void 0,function*(){let i=[];i.push(t.show.call(this,e)),i.push(this._sequencedShowHide(!0,e)),yield Promise.all(i)})}hide(e){const t=Object.create(null,{hide:{get:()=>super.hide}});return Oi(this,void 0,void 0,function*(){let i=[];i.push(t.hide.call(this,e)),i.push(this._sequencedShowHide(!1,e)),yield Promise.all(i)})}_updateChildren(){super._updateChildren(),this._valuesDirty&&ce(this._dataItems,e=>{e.get("label").text.markDirtyText()}),(this.isDirty("legendLabelText")||this.isDirty("legendValueText"))&&ce(this._dataItems,e=>{this.updateLegendValue(e)}),this._arrange()}_arrange(){this._arrangeDown(this._lLabels),this._arrangeUp(this._lLabels),this._arrangeDown(this._rLabels),this._arrangeUp(this._rLabels),this._arrangeLeft(this._hLabels),this._arrangeRight(this._hLabels),ce(this.dataItems,e=>{this._updateTick(e)})}_afterChanged(){super._afterChanged(),this._arrange()}processDataItem(e){if(super.processDataItem(e),e.get("fill")==null){let t=this.get("colors");t&&e.setRaw("fill",t.next())}}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)];ve(t)||(t=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");let a=e.get("value");const l=e.animate({key:"valueWorking",to:a,duration:t,easing:s});l&&n.push(l.waitForStop());const h=e.get("tick");h&&n.push(h.show(t));const c=e.get("label");c&&n.push(c.show(t));const p=e.get("slice");p&&n.push(p.show(t)),p.get("active")&&p.states.applyAnimate("active"),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return Oi(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.states.create("hidden",{});ve(t)||(t=s.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const a=s.get("stateAnimationEasing",this.get("stateAnimationEasing")),l=e.animate({key:"valueWorking",to:0,duration:t,easing:a});l&&n.push(l.waitForStop());const h=e.get("tick");h&&n.push(h.hide(t));const c=e.get("label");c&&n.push(c.hide(t));const p=e.get("slice");p.hideTooltip(),p&&n.push(p.hide(t)),yield Promise.all(n)})}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("label");t&&(this.labels.removeValue(t),t.dispose());let i=e.get("tick");i&&(this.ticks.removeValue(i),i.dispose());let n=e.get("slice");n&&(this.slices.removeValue(n),n.dispose())}hoverDataItem(e){const t=e.get("slice");t&&!t.isHidden()&&t.hover()}unhoverDataItem(e){const t=e.get("slice");t&&t.unhover()}updateLegendMarker(e){if(e){const t=e.get("slice");if(t){const i=e.get("legendDataItem");if(i){const n=i.get("markerRectangle");ce(Uv,s=>{t.get(s)!=null&&n.set(s,t.get(s))})}}}}_arrangeDown(e){if(e){let t=this._getNextDown();e.sort((i,n)=>i.y>n.y?1:i.y<n.y?-1:0),ce(e,i=>{const n=i.label.adjustedLocalBounds();let s=n.top;i.y+s<t&&(i.y=t-s),i.label.set("y",i.y),t=i.y+n.bottom})}}_getNextUp(){return this.labelsContainer.maxHeight()}_getNextDown(){return 0}_arrangeUp(e){if(e){let t=this._getNextUp();e.sort((i,n)=>i.y<n.y?1:i.y>n.y?-1:0),ce(e,i=>{const n=i.label.adjustedLocalBounds();let s=n.bottom;i.y+s>t&&(i.y=t-s),i.label.set("y",i.y),t=i.y+n.top})}}_arrangeRight(e){if(e){let t=0;e.sort((i,n)=>i.y>n.y?1:i.y<n.y?-1:0),ce(e,i=>{const n=i.label.adjustedLocalBounds();let s=n.left;i.y+s<t&&(i.y=t-s),i.label.set("x",i.y),t=i.y+n.right})}}_arrangeLeft(e){if(e){let t=this.labelsContainer.maxWidth();e.sort((i,n)=>i.y<n.y?1:i.y>n.y?-1:0),ce(e,i=>{const n=i.label.adjustedLocalBounds();let s=n.right;i.y+s>t&&(i.y=t-s),i.label.set("x",i.y),t=i.y+n.left})}}_updateSize(){super._updateSize(),this.markDirty()}_updateTick(e){}_dispose(){super._dispose();const e=this.chart;e&&e.series.removeValue(this)}}Object.defineProperty(Yu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentSeries"});Object.defineProperty(Yu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:js.classNames.concat([Yu.className])});class Bc extends Gu{constructor(){super(...arguments),Object.defineProperty(this,"_maxRadius",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){super._afterNew(),this.seriesContainer.setAll({x:ot,y:ot})}_prepareChildren(){super._prepareChildren();const e=this.chartContainer,t=e.innerWidth(),i=e.innerHeight(),n=this.get("startAngle",0),s=this.get("endAngle",0),a=this.get("innerRadius");let l=_d(0,0,n,s,1);const h=t/(l.right-l.left),c=i/(l.bottom-l.top);let p={left:0,right:0,top:0,bottom:0};if(a instanceof gt){let _=a.value,b=Math.min(h,c);_=Math.max(b*_,b-Math.min(i,t))/b,p=_d(0,0,n,s,_),this.setPrivateRaw("irModifyer",_/a.value)}l=JO([l,p]);const g=this._maxRadius;this._maxRadius=Math.min(h,c);const m=ai(this.get("radius",0),this._maxRadius);this.seriesContainer.setAll({dy:-m*(l.bottom+l.top)/2,dx:-m*(l.right+l.left)/2}),(this.isDirty("startAngle")||this.isDirty("endAngle")||g!=this._maxRadius)&&this.series.each(_=>{_._markDirtyKey("startAngle")}),(this.isDirty("innerRadius")||this.isDirty("radius"))&&this.series.each(_=>{_._markDirtyKey("innerRadius")})}radius(e){let t=ai(this.get("radius",0),this._maxRadius),i=ai(this.get("innerRadius",0),t);if(e){let n=this.series.indexOf(e),s=this.series.length,a=e.get("radius");return a!=null?i+ai(a,t-i):i+(t-i)/s*(n+1)}return t}innerRadius(e){const t=this.radius();let i=ai(this.get("innerRadius",0),t);if(i<0&&(i=t+i),e){let n=this.series.indexOf(e),s=this.series.length,a=e.get("innerRadius");return a!=null?i+ai(a,t-i):i+(t-i)/s*n}return i}}Object.defineProperty(Bc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieChart"});Object.defineProperty(Bc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Gu.classNames.concat([Bc.className])});class Vu extends Yu{_makeSlices(){return new $r(Hi.new({}),()=>Fc._new(this._root,{themeTags:It(this.slices.template.get("themeTags",[]),["pie","series"])},[this.slices.template]))}_makeLabels(){return new $r(Hi.new({}),()=>Oc._new(this._root,{themeTags:It(this.labels.template.get("themeTags",[]),["pie","series"])},[this.labels.template]))}_makeTicks(){return new $r(Hi.new({}),()=>pl._new(this._root,{themeTags:It(this.ticks.template.get("themeTags",[]),["pie","series"])},[this.ticks.template]))}processDataItem(e){super.processDataItem(e);const t=this.makeSlice(e);t.on("scale",()=>{this._updateTick(e)}),t.on("shiftRadius",()=>{this._updateTick(e)}),t.events.on("positionchanged",()=>{this._updateTick(e)});const i=this.makeLabel(e);i.events.on("positionchanged",()=>{this._updateTick(e)}),this.makeTick(e),t.events.on("positionchanged",()=>{i.markDirty()})}_getNextUp(){const e=this.chart;return e?e._maxRadius:this.labelsContainer.maxHeight()/2}_getNextDown(){const e=this.chart;return e?-e._maxRadius:-this.labelsContainer.maxHeight()/2}_prepareChildren(){super._prepareChildren();const e=this.chart;if(e){if(this.isDirty("alignLabels")){let t=this.labels.template;if(this.get("alignLabels"))t.set("textType","aligned");else{let i=t.get("textType");(i==null||i=="aligned")&&t.set("textType","adjusted")}}if(this._valuesDirty||this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle")||this.isDirty("alignLabels")){this.markDirtyBounds();const t=this.get("startAngle",e.get("startAngle",-90)),n=this.get("endAngle",e.get("endAngle",270))-t;let s=t;const a=e.radius(this);this.setPrivateRaw("radius",a);let l=e.innerRadius(this)*e.getPrivate("irModifyer",1);l<0&&(l=a+l),ce(this._dataItems,h=>{this.updateLegendValue(h);let c=n*h.get("valuePercentTotal")/100;const p=h.get("slice");if(p){p.set("radius",a),p.set("innerRadius",l),p.set("startAngle",s),p.set("arc",c);const _=h.get("fill");p._setDefault("fill",_),p._setDefault("stroke",_)}let g=tp(s+c/2);const m=h.get("label");if(m&&(m.setPrivate("radius",a),m.setPrivate("innerRadius",l),m.set("labelAngle",g),m.get("textType")=="aligned")){let _=a+m.get("radius",0),b=a*bn(g);g>90&&g<=270?(!m.isHidden()&&!m.isHiding()&&this._lLabels.push({label:m,y:b}),_*=-1,_-=this.labelsContainer.get("paddingLeft",0),m.set("centerX",ze),m.setPrivateRaw("left",!0)):(!m.isHidden()&&!m.isHiding()&&this._rLabels.push({label:m,y:b}),_+=this.labelsContainer.get("paddingRight",0),m.set("centerX",0),m.setPrivateRaw("left",!1)),m.set("x",_),m.set("y",a*bn(g))}s+=c,this._updateTick(h)})}}}_updateTick(e){const t=e.get("tick"),i=e.get("label"),n=e.get("slice"),s=t.get("location",1);if(t&&i&&n){const a=(n.get("shiftRadius",0)+n.get("radius",0))*n.get("scale",1)*s,l=i.get("labelAngle",0),h=cs(l),c=bn(l),p=this.labelsContainer,g=p.get("paddingLeft",0),m=p.get("paddingRight",0);let _=0,b=0;if(_=i.x(),b=i.y(),i.get("textType")=="circular"){const w=i.radius()-i.get("paddingBottom",0),P=i.get("labelAngle",0);_=w*cs(P),b=w*bn(P)}let x=-m;i.getPrivate("left")&&(x=g),t.set("points",[{x:n.x()+a*h,y:n.y()+a*c},{x:_+x,y:b},{x:_,y:b}])}}_positionBullet(e){const t=e.get("sprite");if(t){const n=t.dataItem.get("slice");if(n){const s=n.get("innerRadius",0),a=n.get("radius",0),l=n.get("startAngle",0),h=n.get("arc",0),c=e.get("locationX",.5),p=e.get("locationY",.5),g=l+h*c,m=s+(a-s)*p;t.setAll({x:cs(g)*m,y:bn(g)*m})}}}}Object.defineProperty(Vu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieSeries"});Object.defineProperty(Vu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Yu.classNames.concat([Vu.className])});function w3(r){var e=th.new("analytics__sumAndCount");e.setThemes([ip.new(e)]);var t=e.container.children.push(Bc.new(e,{layout:e.verticalLayout,innerRadius:ar(40),radius:ar(95)})),i=t.series.push(Vu.new(e,{valueField:"check",categoryField:"metrics"}));i.slices.template.set("toggleKey","none"),i.ticks.template.set("forceHidden",!0),i.labels.template.set("forceHidden",!0),i.slices.template.setAll({stroke:"#ffffff",strokeWidth:2,tooltipText:"{category}: {value} ед."}),i.slices.template.states.create("hover",{scale:.95});var n=t.series.push(Vu.new(e,{valueField:"check_sum",categoryField:"metrics"}));n.ticks.template.set("forceHidden",!0),n.labels.template.set("forceHidden",!0),n.slices.template.setAll({stroke:"#ffffff",strokeWidth:2,tooltipText:"{category}: {value} млрд. руб"}),n.slices.template.set("toggleKey","none"),i.data.setAll(r),n.data.setAll(r);var s=t.children.push(Dc.new(e,{centerY:ar(85),y:ar(85),layout:e.verticalLayout}));s.data.setAll(i.dataItems),i.appear(1e3,100),n.appear(1e3,100)}function T3(){document.querySelector(".filters__list").classList.add("disabled"),document.querySelector(".filters__btns").classList.add("disabled"),document.getElementById("nav__analytics-btn").classList.add("disabled"),document.getElementById("nav__analytics-btn").setAttribute("disabled","true"),document.getElementById("filters__cancel-btn").classList.add("disabled"),document.getElementById("filters__cancel-btn").setAttribute("disabled","true"),document.getElementById("filters__access-btn").classList.add("disabled"),document.getElementById("filters__access-btn").setAttribute("disabled","true"),document.querySelectorAll(".filters__input, .filters__checkbox").forEach(e=>{e.setAttribute("disabled","true")})}function Yv(){document.querySelector(".filters__list").classList.remove("disabled"),document.querySelector(".filters__btns").classList.remove("disabled"),document.getElementById("nav__analytics-btn").classList.remove("disabled"),document.getElementById("nav__analytics-btn").removeAttribute("disabled"),document.getElementById("filters__cancel-btn").classList.remove("disabled"),document.getElementById("filters__cancel-btn").removeAttribute("disabled"),document.getElementById("filters__access-btn").classList.remove("disabled"),document.getElementById("filters__access-btn").removeAttribute("disabled"),document.querySelectorAll(".filters__input, .filters__checkbox").forEach(e=>{e.removeAttribute("disabled")})}function bd(r,e){let t=0,i=0,n=r.getBounds();e.eachLayer(s=>{n.contains(s.getLatLng())&&(i+=s.options.sum,t++)}),document.getElementById("info__count").textContent=t,document.getElementById("info__sum").textContent=i.toLocaleString("ru").split(",")[0]}function Nc(){document.querySelectorAll(".filters__input").forEach(r=>{r.value=""}),document.querySelectorAll(".filters__checkbox").forEach(r=>{r.checked=!1})}function k3(){return{id:"",address:"",check:[],region:[],type:[],hzk:[],minRisk:0,maxRisk:1/0}}function rp(){const r=k3();return document.querySelectorAll(".filters__input").forEach(e=>{let t=null;switch(e.id){case"filters__search":t="id";break;case"filters__address":t="address";break;case"filters__min-sum":t="minRisk";break;case"filters__max-sum":t="maxRisk";break}e.value.length&&(r[t]=e.value)}),document.querySelectorAll(".filters__checkbox").forEach(e=>{const t=e.className.split(" ")[1].split("_")[3];let i=e.value;e.checked&&((t==="region"||t==="check"||t==="hzk")&&(i=+i),r[t].push(i))}),r}function P3(r,e){const t=[];return r.forEach(i=>{let n;const{address:s,check:a,check4q:l,gosb:h,hzk:c,point:p,reg:g,sum:m,type:_}=i;[47,49,50].includes(i.point)&&(i.lon=Tr.Util.wrapNum(i.lon,[0,360],!0));const b=Tr.marker([i.lat,i.lon],{address:s,check:a,check4q:l,gosb:h,hzk:c,point:p,reg:g,sum:m,type:_});i.sum<5e5?n="markerGreen":5e5<=i.sum&&i.sum<1e6?n="markerYellow":i.sum>1e6&&(n="markerRed");const x=Tr.icon({iconUrl:`./images/${n}.svg`,iconSize:[38,44],iconAnchor:[19,39]});b.setIcon(x),b.on("click",w=>{const P=w.target.options,E=`${P.reg}_${P.gosb}_${P.point}`;document.getElementById("details").classList.remove("display-none"),document.getElementById("details__id").textContent=E,document.getElementById("details__type").textContent=P.type,document.getElementById("details__address").textContent=P.address,document.getElementById("details__sum").textContent=P.sum.toLocaleString("ru").split(",")[0],P.hzk!=0&&document.getElementById("details__item-hzk").classList.remove("display-none")}),t.push(b)}),e.on("click",()=>{document.getElementById("details").classList.add("display-none")}),t}function wd(r,e){document.getElementById(`analytics__${e}`)&&document.getElementById(`analytics__${e}`).remove();const t=document.createElement("div");switch(t.setAttribute("id",`analytics__${e}`),document.getElementById(`analytics__item_${e}`).append(t),document.getElementById(`analytics__${e}`).classList.add(`analytics__${e}`),e){case"commonSum":v3(r);break;case"GosbBlock":y3(r);break;case"sumAndCount":w3(r);break}}function E3(r){const e=dO.cloneDeep(zm),t=rp(),i=r.filter(n=>(t.type.includes(n.type)||t.type.length===0)&&(t.check.includes(n.check)||t.check.length===0)&&(t.hzk.includes(n.hzk)||t.hzk.length===0));return e.forEach(n=>{n.sum=0,i.forEach(s=>{s.reg===n.number&&(n.sum+=s.sum)}),n.sum=Math.round(n.sum/1e5)/10}),e}function A3(r){let e=0,t=0,i=0,n=0;return r.forEach(s=>{s.check?(e+=s.check,i+=s.sum):(t+=1,n+=s.sum)}),{all_point:r.length,checked_point:e,checked_sum:Math.round(i/1e7)/100,unchecked_point:t,unchecked_sum:Math.round(n/1e7)/100}}function C3(r){const e=document.getElementById("analytics__item_GosbBlock"),t=document.getElementById("analytics__GosbBlock")||null,i=document.getElementById("analytics__item_sumAndCount"),n=rp();if(n.region.length===1){const s=[];zm.find(l=>l.number===n.region[0]).gosb.forEach(l=>{let h=0;r.filter(p=>p.gosb===l).forEach(p=>{h+=Math.round(p.sum/1e5)/10}),s.push({gosbId:String(l),gosbSum:h})}),i.classList.add("display-none"),e.classList.remove("display-none"),wd(s,"GosbBlock")}else i.classList.remove("display-none"),e.classList.add("display-none"),t&&t.remove()}function S3(){const r=document.createElement("div"),e=document.createElement("form"),t=document.createElement("label"),i=document.createElement("input"),n=document.createElement("input");return r.classList.add("verification"),e.classList.add("verification__form"),t.classList.add("verification__label","section-title"),i.classList.add("verification__password"),n.classList.add("btn","verification__btn"),r.setAttribute("id","verification"),e.setAttribute("id","verification__form"),i.setAttribute("id","verification__password"),i.setAttribute("type","password"),i.setAttribute("required","true"),i.setAttribute("autofocus","true"),n.setAttribute("id","verification__btn"),n.setAttribute("type","submit"),n.setAttribute("value","Продолжить"),t.textContent="Введите пароль",e.append(t),e.append(i),e.append(n),r.append(e),document.body.append(r),{verif:r,verifForm:e,verifPass:i}}function D3(){const r=Tr.map("map",{center:[64.6863136,97.7453061],crs:Tr.CRS.EPSG3857,zoom:4,minZoom:3.4,zoomControl:!1,preferCanvas:!1});Tr.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{}).addTo(r);const e={StreetView:Tr.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),Places:Tr.tileLayer.wms("http://ows.mundialis.de/services/service?",{layers:"OSM-Overlay-WMS"})};Tr.control.layers(e).addTo(r);let t=null;r.locate({setView:!0,watch:!1,maxZoom:14}).on("locationfound",n=>{t=Tr.marker([n.latitude,n.longitude],{icon:Tr.icon({iconUrl:"./images/locate.svg",iconSize:[40,40]})}).addTo(r)}).on("locationerror",()=>{Tr.popup().setLatLng(r.getCenter()).setContent("Доступ к определению местоположения отключён").openOn(r),bd(r,i)}),r.on("zoomend",()=>{r.hasLayer(t)&&t.removeFrom(r),bd(r,i)});const i=Tr.markerClusterGroup({iconCreateFunction:n=>{const s=n.getChildCount();let a=" marker-cluster-";return s<50?a+="small":s<300?a+="medium":a+="large",Tr.divIcon({html:`<div><span>${s}</span></div>`,className:"marker-cluster"+a,iconSize:new Tr.Point(40,40)})}}).addTo(r);return{map:r,markerCluster:i}}function L3(r){const e=rp();return r.filter(i=>`${i.reg}_${i.gosb}_${i.point}`.includes(e.id)&&i.address.includes(e.address)&&(e.region.includes(i.reg)||e.region.length===0)&&(e.type.includes(i.type)||e.type.length===0)&&(e.check.includes(i.check)||e.check.length===0)&&(e.hzk.includes(i.hzk)||e.hzk.length===0)&&i.sum>=e.minRisk&&i.sum<=e.maxRisk)}function Zu(r,e,t){const i=L3(r);t.clearLayers(),t.addLayers(P3(i,e)),t.getLayers().length>0?e.fitBounds(t.getBounds()):e.locate({setView:!0,watch:!1});const n=E3(r),s=A3(i);wd(n,"commonSum"),wd([{metrics:"Проверяются",check:s.checked_point,check_sum:s.checked_sum},{metrics:"Не проверяются",check:s.unchecked_point,check_sum:s.unchecked_sum}],"sumAndCount"),C3(i),bd(e,t)}function O3(r,e,t,i){if(!r.files[0]){Nc(),Zu(e,t,i),document.getElementById("filters__file-text").textContent="Файл не выбран",document.getElementById("analytics").classList.remove("analytics--open"),document.getElementById("analytics").classList.remove("analytics--openWithFilter"),document.getElementById("nav__analytics-btn").classList.remove("nav__analytics-btn--open"),T3();return}const n=r.files[0];document.getElementById("filters__file-text").textContent=n.name;const s=new FileReader;s.readAsBinaryString(n),s.onerror=a=>console.error(`Файл не может быть прочитан. Ошибка: ${a.target.error.message}`),s.onload=a=>{const l=a.target.result,h=Tc(l,{type:"binary"});h.SheetNames.forEach(c=>{Pv.sheet_to_row_object_array(h.Sheets[c]).forEach(g=>{const m=g.urf.split("_").reverse();delete g.urf,g.reg=+m[2],g.point=+m[0],e.push(g)}),Nc(),Zu(e,t,i)}),Yv()}}function M3(r,e,t,i){const n=`${r}.xlsx`,s=new XMLHttpRequest;s.open("GET",`/src/data/${n}`,!0),s.responseType="arraybuffer",s.onload=()=>{if(s.status===200){const a=s.response;if(a){const l=new Uint8Array(a),h=Tc(l,{type:"array"});Pv.sheet_to_json(h.Sheets[h.SheetNames[0]],{header:1,range:1,blankrows:!1}).forEach(p=>{const g={},m=p[0].split("_").reverse();p.splice(0,1),m.forEach(_=>p.unshift(+_)),g.reg=p[0],g.gosb=p[1],g.point=p[2],g.sum=p[3],g.lat=p[4],g.lon=p[5],g.address=p[6],g.check=p[7],g.check4q=p[8],g.type=p[9],g.hzk=p[10],e.push(g)}),Nc(),Zu(e,t,i)}}else alert("File "+n+" not found!")},s.send()}function F3(r,e,t){const i=document.getElementById("filters__year"),n=document.getElementById("filters__quarter");let s=null,a=null,l=null;const h=[];Jf.forEach(p=>h.push(p.split("_")[1])),Array.from(new Set(h)).forEach(p=>{const g=document.createElement("option");g.setAttribute("value",p),g.textContent=`${p} год`,i.append(g)}),i.addEventListener("change",p=>{n.classList.remove("disabled"),n.removeAttribute("disabled"),s=p.target.value;const g=[];Jf.forEach(b=>g.push(b.split("_"))),g.filter(b=>b[1]===s).map(b=>b[0]).forEach(b=>{const x=document.createElement("option");x.setAttribute("value",b),x.textContent=`${b} квартал`,n.append(x)})}),n.addEventListener("change",p=>{a=p.target.value,l=`${a}_${s}`,Yv(),r.splice(0,r.length),M3(l,r,e,t)})}function R3(){const r=[];document.body.innerHTML=pO();const{map:e,markerCluster:t}=D3();if(Jf.length===0){document.getElementById("filters__period").classList.add("display-none");const i=document.getElementById("filters__file-input");i.addEventListener("change",()=>{r.splice(0,r.length),O3(i,r,e,t)})}else document.getElementById("filters__file").classList.add("display-none"),F3(r,e,t);(function(){const n=document.getElementById("filters"),s=document.getElementById("nav"),a=document.getElementById("nav__filter-btn"),l=document.getElementById("analytics"),h=document.getElementById("nav__analytics-btn");a.addEventListener("click",c=>{c.preventDefault(),n.classList.toggle("filters--open"),s.classList.toggle("nav--openFilter"),a.classList.toggle("nav__filter-btn--open"),!s.classList.contains("nav--openFilter")&&l.classList.contains("analytics--open")&&l.classList.remove("analytics--openWithFilter"),s.classList.contains("nav--openFilter")&&l.classList.contains("analytics--open")&&l.classList.add("analytics--openWithFilter")}),h.addEventListener("click",c=>{c.preventDefault(),l.classList.toggle("analytics--open"),h.classList.toggle("nav__analytics-btn--open"),s.classList.contains("nav--openFilter")&&l.classList.toggle("analytics--openWithFilter")})})(),function(){const n=document.getElementById("filters__cancel-btn"),s=document.getElementById("filters__access-btn");n.addEventListener("click",()=>{Nc(),Zu(r,e,t)}),s.addEventListener("click",()=>{Zu(r,e,t)})}(),function(){["filters","analytics"].forEach(s=>{document.getElementById(s).addEventListener("touchmove",a=>{a.touches.length>1&&a.preventDefault()})})}(),window.addEventListener("resize",()=>{const i=document.body.clientHeight,n=document.documentElement.clientHeight;i>n?(document.querySelector(".layout").style.marginTop="31px",document.getElementById("filters").style.height=calc("100% - 31px"),document.getElementById("analytics").style.paddingTop=calc("100% - 31px")):(document.querySelector(".layout").style.marginTop="0",document.getElementById("filters").style.height="100%",document.getElementById("analytics").style.paddingTop="100%")})}document.addEventListener("DOMContentLoaded",()=>{(function(){const{verif:e,verifForm:t,verifPass:i}=S3();t.addEventListener("submit",n=>{n.preventDefault();const s=hk.MD5(i.value).toString(),a=FT.find(l=>l.name==="Admin").password;s===a?(e.remove(),R3()):alert("Неверный пароль!")})})()});
